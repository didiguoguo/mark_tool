(function (e, t) {
    "use strict";
    if (typeof module === "object" && typeof module.exports === "object") {
        module.exports = e.document ? t(e, true) : function (e) {
            if (!e.document) {
                throw new Error("jQuery requires a window with a document")
            }
            return t(e)
        }
    } else {
        t(e)
    }
})(typeof window !== "undefined" ? window : this, function (E, e) {
    "use strict";
    var t = [];
    var k = E.document;
    var i = Object.getPrototypeOf;
    var s = t.slice;
    var v = t.concat;
    var l = t.push;
    var r = t.indexOf;
    var n = {};
    var o = n.toString;
    var g = n.hasOwnProperty;
    var a = g.toString;
    var u = a.call(Object);
    var _ = {};
    var y = function e(t) {
        return typeof t === "function" && typeof t.nodeType !== "number"
    };
    var m = function e(t) {
        return t != null && t === t.window
    };
    var c = {
        type: true,
        src: true,
        noModule: true
    };

    function b(e, t, n) {
        t = t || k;
        var i, r = t.createElement("script");
        r.text = e;
        if (n) {
            for (i in c) {
                if (n[i]) {
                    r[i] = n[i]
                }
            }
        }
        t.head.appendChild(r).parentNode.removeChild(r)
    }

    function w(e) {
        if (e == null) {
            return e + ""
        }
        return typeof e === "object" || typeof e === "function" ? n[o.call(e)] || "object" : typeof e
    }
    var f = "3.3.1",
        T = function (e, t) {
            return new T.fn.init(e, t)
        },
        h = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
    T.fn = T.prototype = {
        jquery: f,
        constructor: T,
        length: 0,
        toArray: function () {
            return s.call(this)
        },
        get: function (e) {
            if (e == null) {
                return s.call(this)
            }
            return e < 0 ? this[e + this.length] : this[e]
        },
        pushStack: function (e) {
            var t = T.merge(this.constructor(), e);
            t.prevObject = this;
            return t
        },
        each: function (e) {
            return T.each(this, e)
        },
        map: function (n) {
            return this.pushStack(T.map(this, function (e, t) {
                return n.call(e, t, e)
            }))
        },
        slice: function () {
            return this.pushStack(s.apply(this, arguments))
        },
        first: function () {
            return this.eq(0)
        },
        last: function () {
            return this.eq(-1)
        },
        eq: function (e) {
            var t = this.length,
                n = +e + (e < 0 ? t : 0);
            return this.pushStack(n >= 0 && n < t ? [this[n]] : [])
        },
        end: function () {
            return this.prevObject || this.constructor()
        },
        push: l,
        sort: t.sort,
        splice: t.splice
    };
    T.extend = T.fn.extend = function () {
        var e, t, n, i, r, o, a = arguments[0] || {},
            s = 1,
            l = arguments.length,
            u = false;
        if (typeof a === "boolean") {
            u = a;
            a = arguments[s] || {};
            s++
        }
        if (typeof a !== "object" && !y(a)) {
            a = {}
        }
        if (s === l) {
            a = this;
            s--
        }
        for (; s < l; s++) {
            if ((e = arguments[s]) != null) {
                for (t in e) {
                    n = a[t];
                    i = e[t];
                    if (a === i) {
                        continue
                    }
                    if (u && i && (T.isPlainObject(i) || (r = Array.isArray(i)))) {
                        if (r) {
                            r = false;
                            o = n && Array.isArray(n) ? n : []
                        } else {
                            o = n && T.isPlainObject(n) ? n : {}
                        }
                        a[t] = T.extend(u, o, i)
                    } else if (i !== undefined) {
                        a[t] = i
                    }
                }
            }
        }
        return a
    };
    T.extend({
        expando: "jQuery" + (f + Math.random()).replace(/\D/g, ""),
        isReady: true,
        error: function (e) {
            throw new Error(e)
        },
        noop: function () {},
        isPlainObject: function (e) {
            var t, n;
            if (!e || o.call(e) !== "[object Object]") {
                return false
            }
            t = i(e);
            if (!t) {
                return true
            }
            n = g.call(t, "constructor") && t.constructor;
            return typeof n === "function" && a.call(n) === u
        },
        isEmptyObject: function (e) {
            var t;
            for (t in e) {
                return false
            }
            return true
        },
        globalEval: function (e) {
            b(e)
        },
        each: function (e, t) {
            var n, i = 0;
            if (d(e)) {
                n = e.length;
                for (; i < n; i++) {
                    if (t.call(e[i], i, e[i]) === false) {
                        break
                    }
                }
            } else {
                for (i in e) {
                    if (t.call(e[i], i, e[i]) === false) {
                        break
                    }
                }
            }
            return e
        },
        trim: function (e) {
            return e == null ? "" : (e + "").replace(h, "")
        },
        makeArray: function (e, t) {
            var n = t || [];
            if (e != null) {
                if (d(Object(e))) {
                    T.merge(n, typeof e === "string" ? [e] : e)
                } else {
                    l.call(n, e)
                }
            }
            return n
        },
        inArray: function (e, t, n) {
            return t == null ? -1 : r.call(t, e, n)
        },
        merge: function (e, t) {
            var n = +t.length,
                i = 0,
                r = e.length;
            for (; i < n; i++) {
                e[r++] = t[i]
            }
            e.length = r;
            return e
        },
        grep: function (e, t, n) {
            var i, r = [],
                o = 0,
                a = e.length,
                s = !n;
            for (; o < a; o++) {
                i = !t(e[o], o);
                if (i !== s) {
                    r.push(e[o])
                }
            }
            return r
        },
        map: function (e, t, n) {
            var i, r, o = 0,
                a = [];
            if (d(e)) {
                i = e.length;
                for (; o < i; o++) {
                    r = t(e[o], o, n);
                    if (r != null) {
                        a.push(r)
                    }
                }
            } else {
                for (o in e) {
                    r = t(e[o], o, n);
                    if (r != null) {
                        a.push(r)
                    }
                }
            }
            return v.apply([], a)
        },
        guid: 1,
        support: _
    });
    if (typeof Symbol === "function") {
        T.fn[Symbol.iterator] = t[Symbol.iterator]
    }
    T.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (e, t) {
        n["[object " + t + "]"] = t.toLowerCase()
    });

    function d(e) {
        var t = !!e && "length" in e && e.length,
            n = w(e);
        if (y(e) || m(e)) {
            return false
        }
        return n === "array" || t === 0 || typeof t === "number" && t > 0 && t - 1 in e
    }
    var p = function (n) {
        var e, d, b, o, r, p, f, v, w, l, u, x, E, a, k, g, s, c, _, T = "sizzle" + 1 * new Date,
            y = n.document,
            O = 0,
            i = 0,
            h = ae(),
            m = ae(),
            S = ae(),
            C = function (e, t) {
                if (e === t) {
                    u = true
                }
                return 0
            },
            A = {}.hasOwnProperty,
            t = [],
            j = t.pop,
            P = t.push,
            D = t.push,
            I = t.slice,
            N = function (e, t) {
                var n = 0,
                    i = e.length;
                for (; n < i; n++) {
                    if (e[n] === t) {
                        return n
                    }
                }
                return -1
            },
            L = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
            R = "[\\x20\\t\\r\\n\\f]",
            M = "(?:\\\\.|[\\w-]|[^\0-\\xa0])+",
            B = "\\[" + R + "*(" + M + ")(?:" + R + "*([*^$|!~]?=)" + R + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + M + "))|)" + R + "*\\]",
            q = ":(" + M + ")(?:\\((" + "('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" + "((?:\\\\.|[^\\\\()[\\]]|" + B + ")*)|" + ".*" + ")\\)|)",
            $ = new RegExp(R + "+", "g"),
            U = new RegExp("^" + R + "+|((?:^|[^\\\\])(?:\\\\.)*)" + R + "+$", "g"),
            V = new RegExp("^" + R + "*," + R + "*"),
            H = new RegExp("^" + R + "*([>+~]|" + R + ")" + R + "*"),
            F = new RegExp("=" + R + "*([^\\]'\"]*?)" + R + "*\\]", "g"),
            W = new RegExp(q),
            z = new RegExp("^" + M + "$"),
            Y = {
                ID: new RegExp("^#(" + M + ")"),
                CLASS: new RegExp("^\\.(" + M + ")"),
                TAG: new RegExp("^(" + M + "|[*])"),
                ATTR: new RegExp("^" + B),
                PSEUDO: new RegExp("^" + q),
                CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + R + "*(even|odd|(([+-]|)(\\d*)n|)" + R + "*(?:([+-]|)" + R + "*(\\d+)|))" + R + "*\\)|)", "i"),
                bool: new RegExp("^(?:" + L + ")$", "i"),
                needsContext: new RegExp("^" + R + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + R + "*((?:-\\d)?\\d*)" + R + "*\\)|)(?=[^-]|$)", "i")
            },
            G = /^(?:input|select|textarea|button)$/i,
            K = /^h\d$/i,
            X = /^[^{]+\{\s*\[native \w/,
            Z = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
            Q = /[+~]/,
            J = new RegExp("\\\\([\\da-f]{1,6}" + R + "?|(" + R + ")|.)", "ig"),
            ee = function (e, t, n) {
                var i = "0x" + t - 65536;
                return i !== i || n ? t : i < 0 ? String.fromCharCode(i + 65536) : String.fromCharCode(i >> 10 | 55296, i & 1023 | 56320)
            },
            te = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,
            ne = function (e, t) {
                if (t) {
                    if (e === "\0") {
                        return "�"
                    }
                    return e.slice(0, -1) + "\\" + e.charCodeAt(e.length - 1).toString(16) + " "
                }
                return "\\" + e
            },
            ie = function () {
                x()
            },
            re = ye(function (e) {
                return e.disabled === true && ("form" in e || "label" in e)
            }, {
                dir: "parentNode",
                next: "legend"
            });
        try {
            D.apply(t = I.call(y.childNodes), y.childNodes);
            t[y.childNodes.length].nodeType
        } catch (e) {
            D = {
                apply: t.length ? function (e, t) {
                    P.apply(e, I.call(t))
                } : function (e, t) {
                    var n = e.length,
                        i = 0;
                    while (e[n++] = t[i++]) {}
                    e.length = n - 1
                }
            }
        }

        function oe(e, t, n, i) {
            var r, o, a, s, l, u, c, f = t && t.ownerDocument,
                h = t ? t.nodeType : 9;
            n = n || [];
            if (typeof e !== "string" || !e || h !== 1 && h !== 9 && h !== 11) {
                return n
            }
            if (!i) {
                if ((t ? t.ownerDocument || t : y) !== E) {
                    x(t)
                }
                t = t || E;
                if (k) {
                    if (h !== 11 && (l = Z.exec(e))) {
                        if (r = l[1]) {
                            if (h === 9) {
                                if (a = t.getElementById(r)) {
                                    if (a.id === r) {
                                        n.push(a);
                                        return n
                                    }
                                } else {
                                    return n
                                }
                            } else {
                                if (f && (a = f.getElementById(r)) && _(t, a) && a.id === r) {
                                    n.push(a);
                                    return n
                                }
                            }
                        } else if (l[2]) {
                            D.apply(n, t.getElementsByTagName(e));
                            return n
                        } else if ((r = l[3]) && d.getElementsByClassName && t.getElementsByClassName) {
                            D.apply(n, t.getElementsByClassName(r));
                            return n
                        }
                    }
                    if (d.qsa && !S[e + " "] && (!g || !g.test(e))) {
                        if (h !== 1) {
                            f = t;
                            c = e
                        } else if (t.nodeName.toLowerCase() !== "object") {
                            if (s = t.getAttribute("id")) {
                                s = s.replace(te, ne)
                            } else {
                                t.setAttribute("id", s = T)
                            }
                            u = p(e);
                            o = u.length;
                            while (o--) {
                                u[o] = "#" + s + " " + _e(u[o])
                            }
                            c = u.join(",");
                            f = Q.test(e) && ve(t.parentNode) || t
                        }
                        if (c) {
                            try {
                                D.apply(n, f.querySelectorAll(c));
                                return n
                            } catch (e) {} finally {
                                if (s === T) {
                                    t.removeAttribute("id")
                                }
                            }
                        }
                    }
                }
            }
            return v(e.replace(U, "$1"), t, n, i)
        }

        function ae() {
            var n = [];

            function i(e, t) {
                if (n.push(e + " ") > b.cacheLength) {
                    delete i[n.shift()]
                }
                return i[e + " "] = t
            }
            return i
        }

        function se(e) {
            e[T] = true;
            return e
        }

        function le(e) {
            var t = E.createElement("fieldset");
            try {
                return !!e(t)
            } catch (e) {
                return false
            } finally {
                if (t.parentNode) {
                    t.parentNode.removeChild(t)
                }
                t = null
            }
        }

        function ue(e, t) {
            var n = e.split("|"),
                i = n.length;
            while (i--) {
                b.attrHandle[n[i]] = t
            }
        }

        function ce(e, t) {
            var n = t && e,
                i = n && e.nodeType === 1 && t.nodeType === 1 && e.sourceIndex - t.sourceIndex;
            if (i) {
                return i
            }
            if (n) {
                while (n = n.nextSibling) {
                    if (n === t) {
                        return -1
                    }
                }
            }
            return e ? 1 : -1
        }

        function fe(n) {
            return function (e) {
                var t = e.nodeName.toLowerCase();
                return t === "input" && e.type === n
            }
        }

        function he(n) {
            return function (e) {
                var t = e.nodeName.toLowerCase();
                return (t === "input" || t === "button") && e.type === n
            }
        }

        function de(t) {
            return function (e) {
                if ("form" in e) {
                    if (e.parentNode && e.disabled === false) {
                        if ("label" in e) {
                            if ("label" in e.parentNode) {
                                return e.parentNode.disabled === t
                            } else {
                                return e.disabled === t
                            }
                        }
                        return e.isDisabled === t || e.isDisabled !== !t && re(e) === t
                    }
                    return e.disabled === t
                } else if ("label" in e) {
                    return e.disabled === t
                }
                return false
            }
        }

        function pe(a) {
            return se(function (o) {
                o = +o;
                return se(function (e, t) {
                    var n, i = a([], e.length, o),
                        r = i.length;
                    while (r--) {
                        if (e[n = i[r]]) {
                            e[n] = !(t[n] = e[n])
                        }
                    }
                })
            })
        }

        function ve(e) {
            return e && typeof e.getElementsByTagName !== "undefined" && e
        }
        d = oe.support = {};
        r = oe.isXML = function (e) {
            var t = e && (e.ownerDocument || e).documentElement;
            return t ? t.nodeName !== "HTML" : false
        };
        x = oe.setDocument = function (e) {
            var t, n, i = e ? e.ownerDocument || e : y;
            if (i === E || i.nodeType !== 9 || !i.documentElement) {
                return E
            }
            E = i;
            a = E.documentElement;
            k = !r(E);
            if (y !== E && (n = E.defaultView) && n.top !== n) {
                if (n.addEventListener) {
                    n.addEventListener("unload", ie, false)
                } else if (n.attachEvent) {
                    n.attachEvent("onunload", ie)
                }
            }
            d.attributes = le(function (e) {
                e.className = "i";
                return !e.getAttribute("className")
            });
            d.getElementsByTagName = le(function (e) {
                e.appendChild(E.createComment(""));
                return !e.getElementsByTagName("*").length
            });
            d.getElementsByClassName = X.test(E.getElementsByClassName);
            d.getById = le(function (e) {
                a.appendChild(e).id = T;
                return !E.getElementsByName || !E.getElementsByName(T).length
            });
            if (d.getById) {
                b.filter["ID"] = function (e) {
                    var t = e.replace(J, ee);
                    return function (e) {
                        return e.getAttribute("id") === t
                    }
                };
                b.find["ID"] = function (e, t) {
                    if (typeof t.getElementById !== "undefined" && k) {
                        var n = t.getElementById(e);
                        return n ? [n] : []
                    }
                }
            } else {
                b.filter["ID"] = function (e) {
                    var n = e.replace(J, ee);
                    return function (e) {
                        var t = typeof e.getAttributeNode !== "undefined" && e.getAttributeNode("id");
                        return t && t.value === n
                    }
                };
                b.find["ID"] = function (e, t) {
                    if (typeof t.getElementById !== "undefined" && k) {
                        var n, i, r, o = t.getElementById(e);
                        if (o) {
                            n = o.getAttributeNode("id");
                            if (n && n.value === e) {
                                return [o]
                            }
                            r = t.getElementsByName(e);
                            i = 0;
                            while (o = r[i++]) {
                                n = o.getAttributeNode("id");
                                if (n && n.value === e) {
                                    return [o]
                                }
                            }
                        }
                        return []
                    }
                }
            }
            b.find["TAG"] = d.getElementsByTagName ? function (e, t) {
                    if (typeof t.getElementsByTagName !== "undefined") {
                        return t.getElementsByTagName(e)
                    } else if (d.qsa) {
                        return t.querySelectorAll(e)
                    }
                } :
                function (e, t) {
                    var n, i = [],
                        r = 0,
                        o = t.getElementsByTagName(e);
                    if (e === "*") {
                        while (n = o[r++]) {
                            if (n.nodeType === 1) {
                                i.push(n)
                            }
                        }
                        return i
                    }
                    return o
                };
            b.find["CLASS"] = d.getElementsByClassName && function (e, t) {
                if (typeof t.getElementsByClassName !== "undefined" && k) {
                    return t.getElementsByClassName(e)
                }
            };
            s = [];
            g = [];
            if (d.qsa = X.test(E.querySelectorAll)) {
                le(function (e) {
                    a.appendChild(e).innerHTML = "<a id='" + T + "'></a>" + "<select id='" + T + "-\r\\' msallowcapture=''>" + "<option selected=''></option></select>";
                    if (e.querySelectorAll("[msallowcapture^='']").length) {
                        g.push("[*^$]=" + R + "*(?:''|\"\")")
                    }
                    if (!e.querySelectorAll("[selected]").length) {
                        g.push("\\[" + R + "*(?:value|" + L + ")")
                    }
                    if (!e.querySelectorAll("[id~=" + T + "-]").length) {
                        g.push("~=")
                    }
                    if (!e.querySelectorAll(":checked").length) {
                        g.push(":checked")
                    }
                    if (!e.querySelectorAll("a#" + T + "+*").length) {
                        g.push(".#.+[+~]")
                    }
                });
                le(function (e) {
                    e.innerHTML = "<a href='' disabled='disabled'></a>" + "<select disabled='disabled'><option/></select>";
                    var t = E.createElement("input");
                    t.setAttribute("type", "hidden");
                    e.appendChild(t).setAttribute("name", "D");
                    if (e.querySelectorAll("[name=d]").length) {
                        g.push("name" + R + "*[*^$|!~]?=")
                    }
                    if (e.querySelectorAll(":enabled").length !== 2) {
                        g.push(":enabled", ":disabled")
                    }
                    a.appendChild(e).disabled = true;
                    if (e.querySelectorAll(":disabled").length !== 2) {
                        g.push(":enabled", ":disabled")
                    }
                    e.querySelectorAll("*,:x");
                    g.push(",.*:")
                })
            }
            if (d.matchesSelector = X.test(c = a.matches || a.webkitMatchesSelector || a.mozMatchesSelector || a.oMatchesSelector || a.msMatchesSelector)) {
                le(function (e) {
                    d.disconnectedMatch = c.call(e, "*");
                    c.call(e, "[s!='']:x");
                    s.push("!=", q)
                })
            }
            g = g.length && new RegExp(g.join("|"));
            s = s.length && new RegExp(s.join("|"));
            t = X.test(a.compareDocumentPosition);
            _ = t || X.test(a.contains) ? function (e, t) {
                    var n = e.nodeType === 9 ? e.documentElement : e,
                        i = t && t.parentNode;
                    return e === i || !!(i && i.nodeType === 1 && (n.contains ? n.contains(i) : e.compareDocumentPosition && e.compareDocumentPosition(i) & 16))
                } :
                function (e, t) {
                    if (t) {
                        while (t = t.parentNode) {
                            if (t === e) {
                                return true
                            }
                        }
                    }
                    return false
                };
            C = t ? function (e, t) {
                    if (e === t) {
                        u = true;
                        return 0
                    }
                    var n = !e.compareDocumentPosition - !t.compareDocumentPosition;
                    if (n) {
                        return n
                    }
                    n = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1;
                    if (n & 1 || !d.sortDetached && t.compareDocumentPosition(e) === n) {
                        if (e === E || e.ownerDocument === y && _(y, e)) {
                            return -1
                        }
                        if (t === E || t.ownerDocument === y && _(y, t)) {
                            return 1
                        }
                        return l ? N(l, e) - N(l, t) : 0
                    }
                    return n & 4 ? -1 : 1
                } :
                function (e, t) {
                    if (e === t) {
                        u = true;
                        return 0
                    }
                    var n, i = 0,
                        r = e.parentNode,
                        o = t.parentNode,
                        a = [e],
                        s = [t];
                    if (!r || !o) {
                        return e === E ? -1 : t === E ? 1 : r ? -1 : o ? 1 : l ? N(l, e) - N(l, t) : 0
                    } else if (r === o) {
                        return ce(e, t)
                    }
                    n = e;
                    while (n = n.parentNode) {
                        a.unshift(n)
                    }
                    n = t;
                    while (n = n.parentNode) {
                        s.unshift(n)
                    }
                    while (a[i] === s[i]) {
                        i++
                    }
                    return i ? ce(a[i], s[i]) : a[i] === y ? -1 : s[i] === y ? 1 : 0
                };
            return E
        };
        oe.matches = function (e, t) {
            return oe(e, null, null, t)
        };
        oe.matchesSelector = function (e, t) {
            if ((e.ownerDocument || e) !== E) {
                x(e)
            }
            t = t.replace(F, "='$1']");
            if (d.matchesSelector && k && !S[t + " "] && (!s || !s.test(t)) && (!g || !g.test(t))) {
                try {
                    var n = c.call(e, t);
                    if (n || d.disconnectedMatch || e.document && e.document.nodeType !== 11) {
                        return n
                    }
                } catch (e) {}
            }
            return oe(t, E, null, [e]).length > 0
        };
        oe.contains = function (e, t) {
            if ((e.ownerDocument || e) !== E) {
                x(e)
            }
            return _(e, t)
        };
        oe.attr = function (e, t) {
            if ((e.ownerDocument || e) !== E) {
                x(e)
            }
            var n = b.attrHandle[t.toLowerCase()],
                i = n && A.call(b.attrHandle, t.toLowerCase()) ? n(e, t, !k) : undefined;
            return i !== undefined ? i : d.attributes || !k ? e.getAttribute(t) : (i = e.getAttributeNode(t)) && i.specified ? i.value : null
        };
        oe.escape = function (e) {
            return (e + "").replace(te, ne)
        };
        oe.error = function (e) {
            throw new Error("Syntax error, unrecognized expression: " + e)
        };
        oe.uniqueSort = function (e) {
            var t, n = [],
                i = 0,
                r = 0;
            u = !d.detectDuplicates;
            l = !d.sortStable && e.slice(0);
            e.sort(C);
            if (u) {
                while (t = e[r++]) {
                    if (t === e[r]) {
                        i = n.push(r)
                    }
                }
                while (i--) {
                    e.splice(n[i], 1)
                }
            }
            l = null;
            return e
        };
        o = oe.getText = function (e) {
            var t, n = "",
                i = 0,
                r = e.nodeType;
            if (!r) {
                while (t = e[i++]) {
                    n += o(t)
                }
            } else if (r === 1 || r === 9 || r === 11) {
                if (typeof e.textContent === "string") {
                    return e.textContent
                } else {
                    for (e = e.firstChild; e; e = e.nextSibling) {
                        n += o(e)
                    }
                }
            } else if (r === 3 || r === 4) {
                return e.nodeValue
            }
            return n
        };
        b = oe.selectors = {
            cacheLength: 50,
            createPseudo: se,
            match: Y,
            attrHandle: {},
            find: {},
            relative: {
                ">": {
                    dir: "parentNode",
                    first: true
                },
                " ": {
                    dir: "parentNode"
                },
                "+": {
                    dir: "previousSibling",
                    first: true
                },
                "~": {
                    dir: "previousSibling"
                }
            },
            preFilter: {
                ATTR: function (e) {
                    e[1] = e[1].replace(J, ee);
                    e[3] = (e[3] || e[4] || e[5] || "").replace(J, ee);
                    if (e[2] === "~=") {
                        e[3] = " " + e[3] + " "
                    }
                    return e.slice(0, 4)
                },
                CHILD: function (e) {
                    e[1] = e[1].toLowerCase();
                    if (e[1].slice(0, 3) === "nth") {
                        if (!e[3]) {
                            oe.error(e[0])
                        }
                        e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * (e[3] === "even" || e[3] === "odd"));
                        e[5] = +(e[7] + e[8] || e[3] === "odd")
                    } else if (e[3]) {
                        oe.error(e[0])
                    }
                    return e
                },
                PSEUDO: function (e) {
                    var t, n = !e[6] && e[2];
                    if (Y["CHILD"].test(e[0])) {
                        return null
                    }
                    if (e[3]) {
                        e[2] = e[4] || e[5] || ""
                    } else if (n && W.test(n) && (t = p(n, true)) && (t = n.indexOf(")", n.length - t) - n.length)) {
                        e[0] = e[0].slice(0, t);
                        e[2] = n.slice(0, t)
                    }
                    return e.slice(0, 3)
                }
            },
            filter: {
                TAG: function (e) {
                    var t = e.replace(J, ee).toLowerCase();
                    return e === "*" ? function () {
                            return true
                        } :
                        function (e) {
                            return e.nodeName && e.nodeName.toLowerCase() === t
                        }
                },
                CLASS: function (e) {
                    var t = h[e + " "];
                    return t || (t = new RegExp("(^|" + R + ")" + e + "(" + R + "|$)")) && h(e, function (e) {
                        return t.test(typeof e.className === "string" && e.className || typeof e.getAttribute !== "undefined" && e.getAttribute("class") || "")
                    })
                },
                ATTR: function (n, i, r) {
                    return function (e) {
                        var t = oe.attr(e, n);
                        if (t == null) {
                            return i === "!="
                        }
                        if (!i) {
                            return true
                        }
                        t += "";
                        return i === "=" ? t === r : i === "!=" ? t !== r : i === "^=" ? r && t.indexOf(r) === 0 : i === "*=" ? r && t.indexOf(r) > -1 : i === "$=" ? r && t.slice(-r.length) === r : i === "~=" ? (" " + t.replace($, " ") + " ").indexOf(r) > -1 : i === "|=" ? t === r || t.slice(0, r.length + 1) === r + "-" : false
                    }
                },
                CHILD: function (p, e, t, v, g) {
                    var _ = p.slice(0, 3) !== "nth",
                        y = p.slice(-4) !== "last",
                        m = e === "of-type";
                    return v === 1 && g === 0 ? function (e) {
                            return !!e.parentNode
                        } :
                        function (e, t, n) {
                            var i, r, o, a, s, l, u = _ !== y ? "nextSibling" : "previousSibling",
                                c = e.parentNode,
                                f = m && e.nodeName.toLowerCase(),
                                h = !n && !m,
                                d = false;
                            if (c) {
                                if (_) {
                                    while (u) {
                                        a = e;
                                        while (a = a[u]) {
                                            if (m ? a.nodeName.toLowerCase() === f : a.nodeType === 1) {
                                                return false
                                            }
                                        }
                                        l = u = p === "only" && !l && "nextSibling"
                                    }
                                    return true
                                }
                                l = [y ? c.firstChild : c.lastChild];
                                if (y && h) {
                                    a = c;
                                    o = a[T] || (a[T] = {});
                                    r = o[a.uniqueID] || (o[a.uniqueID] = {});
                                    i = r[p] || [];
                                    s = i[0] === O && i[1];
                                    d = s && i[2];
                                    a = s && c.childNodes[s];
                                    while (a = ++s && a && a[u] || (d = s = 0) || l.pop()) {
                                        if (a.nodeType === 1 && ++d && a === e) {
                                            r[p] = [O, s, d];
                                            break
                                        }
                                    }
                                } else {
                                    if (h) {
                                        a = e;
                                        o = a[T] || (a[T] = {});
                                        r = o[a.uniqueID] || (o[a.uniqueID] = {});
                                        i = r[p] || [];
                                        s = i[0] === O && i[1];
                                        d = s
                                    }
                                    if (d === false) {
                                        while (a = ++s && a && a[u] || (d = s = 0) || l.pop()) {
                                            if ((m ? a.nodeName.toLowerCase() === f : a.nodeType === 1) && ++d) {
                                                if (h) {
                                                    o = a[T] || (a[T] = {});
                                                    r = o[a.uniqueID] || (o[a.uniqueID] = {});
                                                    r[p] = [O, d]
                                                }
                                                if (a === e) {
                                                    break
                                                }
                                            }
                                        }
                                    }
                                }
                                d -= g;
                                return d === v || d % v === 0 && d / v >= 0
                            }
                        }
                },
                PSEUDO: function (e, o) {
                    var t, a = b.pseudos[e] || b.setFilters[e.toLowerCase()] || oe.error("unsupported pseudo: " + e);
                    if (a[T]) {
                        return a(o)
                    }
                    if (a.length > 1) {
                        t = [e, e, "", o];
                        return b.setFilters.hasOwnProperty(e.toLowerCase()) ? se(function (e, t) {
                            var n, i = a(e, o),
                                r = i.length;
                            while (r--) {
                                n = N(e, i[r]);
                                e[n] = !(t[n] = i[r])
                            }
                        }) : function (e) {
                            return a(e, 0, t)
                        }
                    }
                    return a
                }
            },
            pseudos: {
                not: se(function (e) {
                    var i = [],
                        r = [],
                        s = f(e.replace(U, "$1"));
                    return s[T] ? se(function (e, t, n, i) {
                        var r, o = s(e, null, i, []),
                            a = e.length;
                        while (a--) {
                            if (r = o[a]) {
                                e[a] = !(t[a] = r)
                            }
                        }
                    }) : function (e, t, n) {
                        i[0] = e;
                        s(i, null, n, r);
                        i[0] = null;
                        return !r.pop()
                    }
                }),
                has: se(function (t) {
                    return function (e) {
                        return oe(t, e).length > 0
                    }
                }),
                contains: se(function (t) {
                    t = t.replace(J, ee);
                    return function (e) {
                        return (e.textContent || e.innerText || o(e)).indexOf(t) > -1
                    }
                }),
                lang: se(function (n) {
                    if (!z.test(n || "")) {
                        oe.error("unsupported lang: " + n)
                    }
                    n = n.replace(J, ee).toLowerCase();
                    return function (e) {
                        var t;
                        do {
                            if (t = k ? e.lang : e.getAttribute("xml:lang") || e.getAttribute("lang")) {
                                t = t.toLowerCase();
                                return t === n || t.indexOf(n + "-") === 0
                            }
                        } while ((e = e.parentNode) && e.nodeType === 1);
                        return false
                    }
                }),
                target: function (e) {
                    var t = n.location && n.location.hash;
                    return t && t.slice(1) === e.id
                },
                root: function (e) {
                    return e === a
                },
                focus: function (e) {
                    return e === E.activeElement && (!E.hasFocus || E.hasFocus()) && !!(e.type || e.href || ~e.tabIndex)
                },
                enabled: de(false),
                disabled: de(true),
                checked: function (e) {
                    var t = e.nodeName.toLowerCase();
                    return t === "input" && !!e.checked || t === "option" && !!e.selected
                },
                selected: function (e) {
                    if (e.parentNode) {
                        e.parentNode.selectedIndex
                    }
                    return e.selected === true
                },
                empty: function (e) {
                    for (e = e.firstChild; e; e = e.nextSibling) {
                        if (e.nodeType < 6) {
                            return false
                        }
                    }
                    return true
                },
                parent: function (e) {
                    return !b.pseudos["empty"](e)
                },
                header: function (e) {
                    return K.test(e.nodeName)
                },
                input: function (e) {
                    return G.test(e.nodeName)
                },
                button: function (e) {
                    var t = e.nodeName.toLowerCase();
                    return t === "input" && e.type === "button" || t === "button"
                },
                text: function (e) {
                    var t;
                    return e.nodeName.toLowerCase() === "input" && e.type === "text" && ((t = e.getAttribute("type")) == null || t.toLowerCase() === "text")
                },
                first: pe(function () {
                    return [0]
                }),
                last: pe(function (e, t) {
                    return [t - 1]
                }),
                eq: pe(function (e, t, n) {
                    return [n < 0 ? n + t : n]
                }),
                even: pe(function (e, t) {
                    var n = 0;
                    for (; n < t; n += 2) {
                        e.push(n)
                    }
                    return e
                }),
                odd: pe(function (e, t) {
                    var n = 1;
                    for (; n < t; n += 2) {
                        e.push(n)
                    }
                    return e
                }),
                lt: pe(function (e, t, n) {
                    var i = n < 0 ? n + t : n;
                    for (; --i >= 0;) {
                        e.push(i)
                    }
                    return e
                }),
                gt: pe(function (e, t, n) {
                    var i = n < 0 ? n + t : n;
                    for (; ++i < t;) {
                        e.push(i)
                    }
                    return e
                })
            }
        };
        b.pseudos["nth"] = b.pseudos["eq"];
        for (e in {
                radio: true,
                checkbox: true,
                file: true,
                password: true,
                image: true
            }) {
            b.pseudos[e] = fe(e)
        }
        for (e in {
                submit: true,
                reset: true
            }) {
            b.pseudos[e] = he(e)
        }

        function ge() {}
        ge.prototype = b.filters = b.pseudos;
        b.setFilters = new ge;
        p = oe.tokenize = function (e, t) {
            var n, i, r, o, a, s, l, u = m[e + " "];
            if (u) {
                return t ? 0 : u.slice(0)
            }
            a = e;
            s = [];
            l = b.preFilter;
            while (a) {
                if (!n || (i = V.exec(a))) {
                    if (i) {
                        a = a.slice(i[0].length) || a
                    }
                    s.push(r = [])
                }
                n = false;
                if (i = H.exec(a)) {
                    n = i.shift();
                    r.push({
                        value: n,
                        type: i[0].replace(U, " ")
                    });
                    a = a.slice(n.length)
                }
                for (o in b.filter) {
                    if ((i = Y[o].exec(a)) && (!l[o] || (i = l[o](i)))) {
                        n = i.shift();
                        r.push({
                            value: n,
                            type: o,
                            matches: i
                        });
                        a = a.slice(n.length)
                    }
                }
                if (!n) {
                    break
                }
            }
            return t ? a.length : a ? oe.error(e) : m(e, s).slice(0)
        };

        function _e(e) {
            var t = 0,
                n = e.length,
                i = "";
            for (; t < n; t++) {
                i += e[t].value
            }
            return i
        }

        function ye(s, e, t) {
            var l = e.dir,
                u = e.next,
                c = u || l,
                f = t && c === "parentNode",
                h = i++;
            return e.first ? function (e, t, n) {
                    while (e = e[l]) {
                        if (e.nodeType === 1 || f) {
                            return s(e, t, n)
                        }
                    }
                    return false
                } :
                function (e, t, n) {
                    var i, r, o, a = [O, h];
                    if (n) {
                        while (e = e[l]) {
                            if (e.nodeType === 1 || f) {
                                if (s(e, t, n)) {
                                    return true
                                }
                            }
                        }
                    } else {
                        while (e = e[l]) {
                            if (e.nodeType === 1 || f) {
                                o = e[T] || (e[T] = {});
                                r = o[e.uniqueID] || (o[e.uniqueID] = {});
                                if (u && u === e.nodeName.toLowerCase()) {
                                    e = e[l] || e
                                } else if ((i = r[c]) && i[0] === O && i[1] === h) {
                                    return a[2] = i[2]
                                } else {
                                    r[c] = a;
                                    if (a[2] = s(e, t, n)) {
                                        return true
                                    }
                                }
                            }
                        }
                    }
                    return false
                }
        }

        function me(r) {
            return r.length > 1 ? function (e, t, n) {
                    var i = r.length;
                    while (i--) {
                        if (!r[i](e, t, n)) {
                            return false
                        }
                    }
                    return true
                } :
                r[0]
        }

        function be(e, t, n) {
            var i = 0,
                r = t.length;
            for (; i < r; i++) {
                oe(e, t[i], n)
            }
            return n
        }

        function we(e, t, n, i, r) {
            var o, a = [],
                s = 0,
                l = e.length,
                u = t != null;
            for (; s < l; s++) {
                if (o = e[s]) {
                    if (!n || n(o, i, r)) {
                        a.push(o);
                        if (u) {
                            t.push(s)
                        }
                    }
                }
            }
            return a
        }

        function xe(d, p, v, g, _, e) {
            if (g && !g[T]) {
                g = xe(g)
            }
            if (_ && !_[T]) {
                _ = xe(_, e)
            }
            return se(function (e, t, n, i) {
                var r, o, a, s = [],
                    l = [],
                    u = t.length,
                    c = e || be(p || "*", n.nodeType ? [n] : n, []),
                    f = d && (e || !p) ? we(c, s, d, n, i) : c,
                    h = v ? _ || (e ? d : u || g) ? [] : t : f;
                if (v) {
                    v(f, h, n, i)
                }
                if (g) {
                    r = we(h, l);
                    g(r, [], n, i);
                    o = r.length;
                    while (o--) {
                        if (a = r[o]) {
                            h[l[o]] = !(f[l[o]] = a)
                        }
                    }
                }
                if (e) {
                    if (_ || d) {
                        if (_) {
                            r = [];
                            o = h.length;
                            while (o--) {
                                if (a = h[o]) {
                                    r.push(f[o] = a)
                                }
                            }
                            _(null, h = [], r, i)
                        }
                        o = h.length;
                        while (o--) {
                            if ((a = h[o]) && (r = _ ? N(e, a) : s[o]) > -1) {
                                e[r] = !(t[r] = a)
                            }
                        }
                    }
                } else {
                    h = we(h === t ? h.splice(u, h.length) : h);
                    if (_) {
                        _(null, t, h, i)
                    } else {
                        D.apply(t, h)
                    }
                }
            })
        }

        function Ee(e) {
            var r, t, n, i = e.length,
                o = b.relative[e[0].type],
                a = o || b.relative[" "],
                s = o ? 1 : 0,
                l = ye(function (e) {
                    return e === r
                }, a, true),
                u = ye(function (e) {
                    return N(r, e) > -1
                }, a, true),
                c = [function (e, t, n) {
                    var i = !o && (n || t !== w) || ((r = t).nodeType ? l(e, t, n) : u(e, t, n));
                    r = null;
                    return i
                }];
            for (; s < i; s++) {
                if (t = b.relative[e[s].type]) {
                    c = [ye(me(c), t)]
                } else {
                    t = b.filter[e[s].type].apply(null, e[s].matches);
                    if (t[T]) {
                        n = ++s;
                        for (; n < i; n++) {
                            if (b.relative[e[n].type]) {
                                break
                            }
                        }
                        return xe(s > 1 && me(c), s > 1 && _e(e.slice(0, s - 1).concat({
                            value: e[s - 2].type === " " ? "*" : ""
                        })).replace(U, "$1"), t, s < n && Ee(e.slice(s, n)), n < i && Ee(e = e.slice(n)), n < i && _e(e))
                    }
                    c.push(t)
                }
            }
            return me(c)
        }

        function ke(g, _) {
            var y = _.length > 0,
                m = g.length > 0,
                e = function (e, t, n, i, r) {
                    var o, a, s, l = 0,
                        u = "0",
                        c = e && [],
                        f = [],
                        h = w,
                        d = e || m && b.find["TAG"]("*", r),
                        p = O += h == null ? 1 : Math.random() || .1,
                        v = d.length;
                    if (r) {
                        w = t === E || t || r
                    }
                    for (; u !== v && (o = d[u]) != null; u++) {
                        if (m && o) {
                            a = 0;
                            if (!t && o.ownerDocument !== E) {
                                x(o);
                                n = !k
                            }
                            while (s = g[a++]) {
                                if (s(o, t || E, n)) {
                                    i.push(o);
                                    break
                                }
                            }
                            if (r) {
                                O = p
                            }
                        }
                        if (y) {
                            if (o = !s && o) {
                                l--
                            }
                            if (e) {
                                c.push(o)
                            }
                        }
                    }
                    l += u;
                    if (y && u !== l) {
                        a = 0;
                        while (s = _[a++]) {
                            s(c, f, t, n)
                        }
                        if (e) {
                            if (l > 0) {
                                while (u--) {
                                    if (!(c[u] || f[u])) {
                                        f[u] = j.call(i)
                                    }
                                }
                            }
                            f = we(f)
                        }
                        D.apply(i, f);
                        if (r && !e && f.length > 0 && l + _.length > 1) {
                            oe.uniqueSort(i)
                        }
                    }
                    if (r) {
                        O = p;
                        w = h
                    }
                    return c
                };
            return y ? se(e) : e
        }
        f = oe.compile = function (e, t) {
            var n, i = [],
                r = [],
                o = S[e + " "];
            if (!o) {
                if (!t) {
                    t = p(e)
                }
                n = t.length;
                while (n--) {
                    o = Ee(t[n]);
                    if (o[T]) {
                        i.push(o)
                    } else {
                        r.push(o)
                    }
                }
                o = S(e, ke(r, i));
                o.selector = e
            }
            return o
        };
        v = oe.select = function (e, t, n, i) {
            var r, o, a, s, l, u = typeof e === "function" && e,
                c = !i && p(e = u.selector || e);
            n = n || [];
            if (c.length === 1) {
                o = c[0] = c[0].slice(0);
                if (o.length > 2 && (a = o[0]).type === "ID" && t.nodeType === 9 && k && b.relative[o[1].type]) {
                    t = (b.find["ID"](a.matches[0].replace(J, ee), t) || [])[0];
                    if (!t) {
                        return n
                    } else if (u) {
                        t = t.parentNode
                    }
                    e = e.slice(o.shift().value.length)
                }
                r = Y["needsContext"].test(e) ? 0 : o.length;
                while (r--) {
                    a = o[r];
                    if (b.relative[s = a.type]) {
                        break
                    }
                    if (l = b.find[s]) {
                        if (i = l(a.matches[0].replace(J, ee), Q.test(o[0].type) && ve(t.parentNode) || t)) {
                            o.splice(r, 1);
                            e = i.length && _e(o);
                            if (!e) {
                                D.apply(n, i);
                                return n
                            }
                            break
                        }
                    }
                }
            }
            (u || f(e, c))(i, t, !k, n, !t || Q.test(e) && ve(t.parentNode) || t);
            return n
        };
        d.sortStable = T.split("").sort(C).join("") === T;
        d.detectDuplicates = !!u;
        x();
        d.sortDetached = le(function (e) {
            return e.compareDocumentPosition(E.createElement("fieldset")) & 1
        });
        if (!le(function (e) {
                e.innerHTML = "<a href='#'></a>";
                return e.firstChild.getAttribute("href") === "#"
            })) {
            ue("type|href|height|width", function (e, t, n) {
                if (!n) {
                    return e.getAttribute(t, t.toLowerCase() === "type" ? 1 : 2)
                }
            })
        }
        if (!d.attributes || !le(function (e) {
                e.innerHTML = "<input/>";
                e.firstChild.setAttribute("value", "");
                return e.firstChild.getAttribute("value") === ""
            })) {
            ue("value", function (e, t, n) {
                if (!n && e.nodeName.toLowerCase() === "input") {
                    return e.defaultValue
                }
            })
        }
        if (!le(function (e) {
                return e.getAttribute("disabled") == null
            })) {
            ue(L, function (e, t, n) {
                var i;
                if (!n) {
                    return e[t] === true ? t.toLowerCase() : (i = e.getAttributeNode(t)) && i.specified ? i.value : null
                }
            })
        }
        return oe
    }(E);
    T.find = p;
    T.expr = p.selectors;
    T.expr[":"] = T.expr.pseudos;
    T.uniqueSort = T.unique = p.uniqueSort;
    T.text = p.getText;
    T.isXMLDoc = p.isXML;
    T.contains = p.contains;
    T.escapeSelector = p.escape;
    var x = function (e, t, n) {
        var i = [],
            r = n !== undefined;
        while ((e = e[t]) && e.nodeType !== 9) {
            if (e.nodeType === 1) {
                if (r && T(e).is(n)) {
                    break
                }
                i.push(e)
            }
        }
        return i
    };
    var O = function (e, t) {
        var n = [];
        for (; e; e = e.nextSibling) {
            if (e.nodeType === 1 && e !== t) {
                n.push(e)
            }
        }
        return n
    };
    var S = T.expr.match.needsContext;

    function C(e, t) {
        return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
    }
    var A = /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;

    function j(e, n, i) {
        if (y(n)) {
            return T.grep(e, function (e, t) {
                return !!n.call(e, t, e) !== i
            })
        }
        if (n.nodeType) {
            return T.grep(e, function (e) {
                return e === n !== i
            })
        }
        if (typeof n !== "string") {
            return T.grep(e, function (e) {
                return r.call(n, e) > -1 !== i
            })
        }
        return T.filter(n, e, i)
    }
    T.filter = function (e, t, n) {
        var i = t[0];
        if (n) {
            e = ":not(" + e + ")"
        }
        if (t.length === 1 && i.nodeType === 1) {
            return T.find.matchesSelector(i, e) ? [i] : []
        }
        return T.find.matches(e, T.grep(t, function (e) {
            return e.nodeType === 1
        }))
    };
    T.fn.extend({
        find: function (e) {
            var t, n, i = this.length,
                r = this;
            if (typeof e !== "string") {
                return this.pushStack(T(e).filter(function () {
                    for (t = 0; t < i; t++) {
                        if (T.contains(r[t], this)) {
                            return true
                        }
                    }
                }))
            }
            n = this.pushStack([]);
            for (t = 0; t < i; t++) {
                T.find(e, r[t], n)
            }
            return i > 1 ? T.uniqueSort(n) : n
        },
        filter: function (e) {
            return this.pushStack(j(this, e || [], false))
        },
        not: function (e) {
            return this.pushStack(j(this, e || [], true))
        },
        is: function (e) {
            return !!j(this, typeof e === "string" && S.test(e) ? T(e) : e || [], false).length
        }
    });
    var P, D = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,
        I = T.fn.init = function (e, t, n) {
            var i, r;
            if (!e) {
                return this
            }
            n = n || P;
            if (typeof e === "string") {
                if (e[0] === "<" && e[e.length - 1] === ">" && e.length >= 3) {
                    i = [null, e, null]
                } else {
                    i = D.exec(e)
                }
                if (i && (i[1] || !t)) {
                    if (i[1]) {
                        t = t instanceof T ? t[0] : t;
                        T.merge(this, T.parseHTML(i[1], t && t.nodeType ? t.ownerDocument || t : k, true));
                        if (A.test(i[1]) && T.isPlainObject(t)) {
                            for (i in t) {
                                if (y(this[i])) {
                                    this[i](t[i])
                                } else {
                                    this.attr(i, t[i])
                                }
                            }
                        }
                        return this
                    } else {
                        r = k.getElementById(i[2]);
                        if (r) {
                            this[0] = r;
                            this.length = 1
                        }
                        return this
                    }
                } else if (!t || t.jquery) {
                    return (t || n).find(e)
                } else {
                    return this.constructor(t).find(e)
                }
            } else if (e.nodeType) {
                this[0] = e;
                this.length = 1;
                return this
            } else if (y(e)) {
                return n.ready !== undefined ? n.ready(e) : e(T)
            }
            return T.makeArray(e, this)
        };
    I.prototype = T.fn;
    P = T(k);
    var N = /^(?:parents|prev(?:Until|All))/,
        L = {
            children: true,
            contents: true,
            next: true,
            prev: true
        };
    T.fn.extend({
        has: function (e) {
            var t = T(e, this),
                n = t.length;
            return this.filter(function () {
                var e = 0;
                for (; e < n; e++) {
                    if (T.contains(this, t[e])) {
                        return true
                    }
                }
            })
        },
        closest: function (e, t) {
            var n, i = 0,
                r = this.length,
                o = [],
                a = typeof e !== "string" && T(e);
            if (!S.test(e)) {
                for (; i < r; i++) {
                    for (n = this[i]; n && n !== t; n = n.parentNode) {
                        if (n.nodeType < 11 && (a ? a.index(n) > -1 : n.nodeType === 1 && T.find.matchesSelector(n, e))) {
                            o.push(n);
                            break
                        }
                    }
                }
            }
            return this.pushStack(o.length > 1 ? T.uniqueSort(o) : o)
        },
        index: function (e) {
            if (!e) {
                return this[0] && this[0].parentNode ? this.first().prevAll().length : -1
            }
            if (typeof e === "string") {
                return r.call(T(e), this[0])
            }
            return r.call(this, e.jquery ? e[0] : e)
        },
        add: function (e, t) {
            return this.pushStack(T.uniqueSort(T.merge(this.get(), T(e, t))))
        },
        addBack: function (e) {
            return this.add(e == null ? this.prevObject : this.prevObject.filter(e))
        }
    });

    function R(e, t) {
        while ((e = e[t]) && e.nodeType !== 1) {}
        return e
    }
    T.each({
        parent: function (e) {
            var t = e.parentNode;
            return t && t.nodeType !== 11 ? t : null
        },
        parents: function (e) {
            return x(e, "parentNode")
        },
        parentsUntil: function (e, t, n) {
            return x(e, "parentNode", n)
        },
        next: function (e) {
            return R(e, "nextSibling")
        },
        prev: function (e) {
            return R(e, "previousSibling")
        },
        nextAll: function (e) {
            return x(e, "nextSibling")
        },
        prevAll: function (e) {
            return x(e, "previousSibling")
        },
        nextUntil: function (e, t, n) {
            return x(e, "nextSibling", n)
        },
        prevUntil: function (e, t, n) {
            return x(e, "previousSibling", n)
        },
        siblings: function (e) {
            return O((e.parentNode || {}).firstChild, e)
        },
        children: function (e) {
            return O(e.firstChild)
        },
        contents: function (e) {
            if (C(e, "iframe")) {
                return e.contentDocument
            }
            if (C(e, "template")) {
                e = e.content || e
            }
            return T.merge([], e.childNodes)
        }
    }, function (i, r) {
        T.fn[i] = function (e, t) {
            var n = T.map(this, r, e);
            if (i.slice(-5) !== "Until") {
                t = e
            }
            if (t && typeof t === "string") {
                n = T.filter(t, n)
            }
            if (this.length > 1) {
                if (!L[i]) {
                    T.uniqueSort(n)
                }
                if (N.test(i)) {
                    n.reverse()
                }
            }
            return this.pushStack(n)
        }
    });
    var M = /[^\x20\t\r\n\f]+/g;

    function B(e) {
        var n = {};
        T.each(e.match(M) || [], function (e, t) {
            n[t] = true
        });
        return n
    }
    T.Callbacks = function (i) {
        i = typeof i === "string" ? B(i) : T.extend({}, i);
        var n, e, t, r, o = [],
            a = [],
            s = -1,
            l = function () {
                r = r || i.once;
                t = n = true;
                for (; a.length; s = -1) {
                    e = a.shift();
                    while (++s < o.length) {
                        if (o[s].apply(e[0], e[1]) === false && i.stopOnFalse) {
                            s = o.length;
                            e = false
                        }
                    }
                }
                if (!i.memory) {
                    e = false
                }
                n = false;
                if (r) {
                    if (e) {
                        o = []
                    } else {
                        o = ""
                    }
                }
            },
            u = {
                add: function () {
                    if (o) {
                        if (e && !n) {
                            s = o.length - 1;
                            a.push(e)
                        }
                        (function n(e) {
                            T.each(e, function (e, t) {
                                if (y(t)) {
                                    if (!i.unique || !u.has(t)) {
                                        o.push(t)
                                    }
                                } else if (t && t.length && w(t) !== "string") {
                                    n(t)
                                }
                            })
                        })(arguments);
                        if (e && !n) {
                            l()
                        }
                    }
                    return this
                },
                remove: function () {
                    T.each(arguments, function (e, t) {
                        var n;
                        while ((n = T.inArray(t, o, n)) > -1) {
                            o.splice(n, 1);
                            if (n <= s) {
                                s--
                            }
                        }
                    });
                    return this
                },
                has: function (e) {
                    return e ? T.inArray(e, o) > -1 : o.length > 0
                },
                empty: function () {
                    if (o) {
                        o = []
                    }
                    return this
                },
                disable: function () {
                    r = a = [];
                    o = e = "";
                    return this
                },
                disabled: function () {
                    return !o
                },
                lock: function () {
                    r = a = [];
                    if (!e && !n) {
                        o = e = ""
                    }
                    return this
                },
                locked: function () {
                    return !!r
                },
                fireWith: function (e, t) {
                    if (!r) {
                        t = t || [];
                        t = [e, t.slice ? t.slice() : t];
                        a.push(t);
                        if (!n) {
                            l()
                        }
                    }
                    return this
                },
                fire: function () {
                    u.fireWith(this, arguments);
                    return this
                },
                fired: function () {
                    return !!t
                }
            };
        return u
    };

    function q(e) {
        return e
    }

    function $(e) {
        throw e
    }

    function U(e, t, n, i) {
        var r;
        try {
            if (e && y(r = e.promise)) {
                r.call(e).done(t).fail(n)
            } else if (e && y(r = e.then)) {
                r.call(e, t, n)
            } else {
                t.apply(undefined, [e].slice(i))
            }
        } catch (e) {
            n.apply(undefined, [e])
        }
    }
    T.extend({
        Deferred: function (e) {
            var o = [
                    ["notify", "progress", T.Callbacks("memory"), T.Callbacks("memory"), 2],
                    ["resolve", "done", T.Callbacks("once memory"), T.Callbacks("once memory"), 0, "resolved"],
                    ["reject", "fail", T.Callbacks("once memory"), T.Callbacks("once memory"), 1, "rejected"]
                ],
                r = "pending",
                a = {
                    state: function () {
                        return r
                    },
                    always: function () {
                        s.done(arguments).fail(arguments);
                        return this
                    },
                    catch: function (e) {
                        return a.then(null, e)
                    },
                    pipe: function () {
                        var r = arguments;
                        return T.Deferred(function (i) {
                            T.each(o, function (e, t) {
                                var n = y(r[t[4]]) && r[t[4]];
                                s[t[1]](function () {
                                    var e = n && n.apply(this, arguments);
                                    if (e && y(e.promise)) {
                                        e.promise().progress(i.notify).done(i.resolve).fail(i.reject)
                                    } else {
                                        i[t[0] + "With"](this, n ? [e] : arguments)
                                    }
                                })
                            });
                            r = null
                        }).promise()
                    },
                    then: function (t, n, i) {
                        var l = 0;

                        function u(r, o, a, s) {
                            return function () {
                                var n = this,
                                    i = arguments,
                                    e = function () {
                                        var e, t;
                                        if (r < l) {
                                            return
                                        }
                                        e = a.apply(n, i);
                                        if (e === o.promise()) {
                                            throw new TypeError("Thenable self-resolution")
                                        }
                                        t = e && (typeof e === "object" || typeof e === "function") && e.then;
                                        if (y(t)) {
                                            if (s) {
                                                t.call(e, u(l, o, q, s), u(l, o, $, s))
                                            } else {
                                                l++;
                                                t.call(e, u(l, o, q, s), u(l, o, $, s), u(l, o, q, o.notifyWith))
                                            }
                                        } else {
                                            if (a !== q) {
                                                n = undefined;
                                                i = [e]
                                            }
                                            (s || o.resolveWith)(n, i)
                                        }
                                    },
                                    t = s ? e : function () {
                                        try {
                                            e()
                                        } catch (e) {
                                            if (T.Deferred.exceptionHook) {
                                                T.Deferred.exceptionHook(e, t.stackTrace)
                                            }
                                            if (r + 1 >= l) {
                                                if (a !== $) {
                                                    n = undefined;
                                                    i = [e]
                                                }
                                                o.rejectWith(n, i)
                                            }
                                        }
                                    };
                                if (r) {
                                    t()
                                } else {
                                    if (T.Deferred.getStackHook) {
                                        t.stackTrace = T.Deferred.getStackHook()
                                    }
                                    E.setTimeout(t)
                                }
                            }
                        }
                        return T.Deferred(function (e) {
                            o[0][3].add(u(0, e, y(i) ? i : q, e.notifyWith));
                            o[1][3].add(u(0, e, y(t) ? t : q));
                            o[2][3].add(u(0, e, y(n) ? n : $))
                        }).promise()
                    },
                    promise: function (e) {
                        return e != null ? T.extend(e, a) : a
                    }
                },
                s = {};
            T.each(o, function (e, t) {
                var n = t[2],
                    i = t[5];
                a[t[1]] = n.add;
                if (i) {
                    n.add(function () {
                        r = i
                    }, o[3 - e][2].disable, o[3 - e][3].disable, o[0][2].lock, o[0][3].lock)
                }
                n.add(t[3].fire);
                s[t[0]] = function () {
                    s[t[0] + "With"](this === s ? undefined : this, arguments);
                    return this
                };
                s[t[0] + "With"] = n.fireWith
            });
            a.promise(s);
            if (e) {
                e.call(s, s)
            }
            return s
        },
        when: function (e) {
            var n = arguments.length,
                t = n,
                i = Array(t),
                r = s.call(arguments),
                o = T.Deferred(),
                a = function (t) {
                    return function (e) {
                        i[t] = this;
                        r[t] = arguments.length > 1 ? s.call(arguments) : e;
                        if (!--n) {
                            o.resolveWith(i, r)
                        }
                    }
                };
            if (n <= 1) {
                U(e, o.done(a(t)).resolve, o.reject, !n);
                if (o.state() === "pending" || y(r[t] && r[t].then)) {
                    return o.then()
                }
            }
            while (t--) {
                U(r[t], a(t), o.reject)
            }
            return o.promise()
        }
    });
    var V = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;
    T.Deferred.exceptionHook = function (e, t) {
        if (E.console && E.console.warn && e && V.test(e.name)) {
            E.console.warn("jQuery.Deferred exception: " + e.message, e.stack, t)
        }
    };
    T.readyException = function (e) {
        E.setTimeout(function () {
            throw e
        })
    };
    var H = T.Deferred();
    T.fn.ready = function (e) {
        H.then(e).catch(function (e) {
            T.readyException(e)
        });
        return this
    };
    T.extend({
        isReady: false,
        readyWait: 1,
        ready: function (e) {
            if (e === true ? --T.readyWait : T.isReady) {
                return
            }
            T.isReady = true;
            if (e !== true && --T.readyWait > 0) {
                return
            }
            H.resolveWith(k, [T])
        }
    });
    T.ready.then = H.then;

    function F() {
        k.removeEventListener("DOMContentLoaded", F);
        E.removeEventListener("load", F);
        T.ready()
    }
    if (k.readyState === "complete" || k.readyState !== "loading" && !k.documentElement.doScroll) {
        E.setTimeout(T.ready)
    } else {
        k.addEventListener("DOMContentLoaded", F);
        E.addEventListener("load", F)
    }
    var W = function (e, t, n, i, r, o, a) {
        var s = 0,
            l = e.length,
            u = n == null;
        if (w(n) === "object") {
            r = true;
            for (s in n) {
                W(e, t, s, n[s], true, o, a)
            }
        } else if (i !== undefined) {
            r = true;
            if (!y(i)) {
                a = true
            }
            if (u) {
                if (a) {
                    t.call(e, i);
                    t = null
                } else {
                    u = t;
                    t = function (e, t, n) {
                        return u.call(T(e), n)
                    }
                }
            }
            if (t) {
                for (; s < l; s++) {
                    t(e[s], n, a ? i : i.call(e[s], s, t(e[s], n)))
                }
            }
        }
        if (r) {
            return e
        }
        if (u) {
            return t.call(e)
        }
        return l ? t(e[0], n) : o
    };
    var z = /^-ms-/,
        Y = /-([a-z])/g;

    function G(e, t) {
        return t.toUpperCase()
    }

    function K(e) {
        return e.replace(z, "ms-").replace(Y, G)
    }
    var X = function (e) {
        return e.nodeType === 1 || e.nodeType === 9 || !+e.nodeType
    };

    function Z() {
        this.expando = T.expando + Z.uid++
    }
    Z.uid = 1;
    Z.prototype = {
        cache: function (e) {
            var t = e[this.expando];
            if (!t) {
                t = {};
                if (X(e)) {
                    if (e.nodeType) {
                        e[this.expando] = t
                    } else {
                        Object.defineProperty(e, this.expando, {
                            value: t,
                            configurable: true
                        })
                    }
                }
            }
            return t
        },
        set: function (e, t, n) {
            var i, r = this.cache(e);
            if (typeof t === "string") {
                r[K(t)] = n
            } else {
                for (i in t) {
                    r[K(i)] = t[i]
                }
            }
            return r
        },
        get: function (e, t) {
            return t === undefined ? this.cache(e) : e[this.expando] && e[this.expando][K(t)]
        },
        access: function (e, t, n) {
            if (t === undefined || t && typeof t === "string" && n === undefined) {
                return this.get(e, t)
            }
            this.set(e, t, n);
            return n !== undefined ? n : t
        },
        remove: function (e, t) {
            var n, i = e[this.expando];
            if (i === undefined) {
                return
            }
            if (t !== undefined) {
                if (Array.isArray(t)) {
                    t = t.map(K)
                } else {
                    t = K(t);
                    t = t in i ? [t] : t.match(M) || []
                }
                n = t.length;
                while (n--) {
                    delete i[t[n]]
                }
            }
            if (t === undefined || T.isEmptyObject(i)) {
                if (e.nodeType) {
                    e[this.expando] = undefined
                } else {
                    delete e[this.expando]
                }
            }
        },
        hasData: function (e) {
            var t = e[this.expando];
            return t !== undefined && !T.isEmptyObject(t)
        }
    };
    var Q = new Z;
    var J = new Z;
    var ee = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        te = /[A-Z]/g;

    function ne(e) {
        if (e === "true") {
            return true
        }
        if (e === "false") {
            return false
        }
        if (e === "null") {
            return null
        }
        if (e === +e + "") {
            return +e
        }
        if (ee.test(e)) {
            return JSON.parse(e)
        }
        return e
    }

    function ie(e, t, n) {
        var i;
        if (n === undefined && e.nodeType === 1) {
            i = "data-" + t.replace(te, "-$&").toLowerCase();
            n = e.getAttribute(i);
            if (typeof n === "string") {
                try {
                    n = ne(n)
                } catch (e) {}
                J.set(e, t, n)
            } else {
                n = undefined
            }
        }
        return n
    }
    T.extend({
        hasData: function (e) {
            return J.hasData(e) || Q.hasData(e)
        },
        data: function (e, t, n) {
            return J.access(e, t, n)
        },
        removeData: function (e, t) {
            J.remove(e, t)
        },
        _data: function (e, t, n) {
            return Q.access(e, t, n)
        },
        _removeData: function (e, t) {
            Q.remove(e, t)
        }
    });
    T.fn.extend({
        data: function (n, e) {
            var t, i, r, o = this[0],
                a = o && o.attributes;
            if (n === undefined) {
                if (this.length) {
                    r = J.get(o);
                    if (o.nodeType === 1 && !Q.get(o, "hasDataAttrs")) {
                        t = a.length;
                        while (t--) {
                            if (a[t]) {
                                i = a[t].name;
                                if (i.indexOf("data-") === 0) {
                                    i = K(i.slice(5));
                                    ie(o, i, r[i])
                                }
                            }
                        }
                        Q.set(o, "hasDataAttrs", true)
                    }
                }
                return r
            }
            if (typeof n === "object") {
                return this.each(function () {
                    J.set(this, n)
                })
            }
            return W(this, function (e) {
                var t;
                if (o && e === undefined) {
                    t = J.get(o, n);
                    if (t !== undefined) {
                        return t
                    }
                    t = ie(o, n);
                    if (t !== undefined) {
                        return t
                    }
                    return
                }
                this.each(function () {
                    J.set(this, n, e)
                })
            }, null, e, arguments.length > 1, null, true)
        },
        removeData: function (e) {
            return this.each(function () {
                J.remove(this, e)
            })
        }
    });
    T.extend({
        queue: function (e, t, n) {
            var i;
            if (e) {
                t = (t || "fx") + "queue";
                i = Q.get(e, t);
                if (n) {
                    if (!i || Array.isArray(n)) {
                        i = Q.access(e, t, T.makeArray(n))
                    } else {
                        i.push(n)
                    }
                }
                return i || []
            }
        },
        dequeue: function (e, t) {
            t = t || "fx";
            var n = T.queue(e, t),
                i = n.length,
                r = n.shift(),
                o = T._queueHooks(e, t),
                a = function () {
                    T.dequeue(e, t)
                };
            if (r === "inprogress") {
                r = n.shift();
                i--
            }
            if (r) {
                if (t === "fx") {
                    n.unshift("inprogress")
                }
                delete o.stop;
                r.call(e, a, o)
            }
            if (!i && o) {
                o.empty.fire()
            }
        },
        _queueHooks: function (e, t) {
            var n = t + "queueHooks";
            return Q.get(e, n) || Q.access(e, n, {
                empty: T.Callbacks("once memory").add(function () {
                    Q.remove(e, [t + "queue", n])
                })
            })
        }
    });
    T.fn.extend({
        queue: function (t, n) {
            var e = 2;
            if (typeof t !== "string") {
                n = t;
                t = "fx";
                e--
            }
            if (arguments.length < e) {
                return T.queue(this[0], t)
            }
            return n === undefined ? this : this.each(function () {
                var e = T.queue(this, t, n);
                T._queueHooks(this, t);
                if (t === "fx" && e[0] !== "inprogress") {
                    T.dequeue(this, t)
                }
            })
        },
        dequeue: function (e) {
            return this.each(function () {
                T.dequeue(this, e)
            })
        },
        clearQueue: function (e) {
            return this.queue(e || "fx", [])
        },
        promise: function (e, t) {
            var n, i = 1,
                r = T.Deferred(),
                o = this,
                a = this.length,
                s = function () {
                    if (!--i) {
                        r.resolveWith(o, [o])
                    }
                };
            if (typeof e !== "string") {
                t = e;
                e = undefined
            }
            e = e || "fx";
            while (a--) {
                n = Q.get(o[a], e + "queueHooks");
                if (n && n.empty) {
                    i++;
                    n.empty.add(s)
                }
            }
            s();
            return r.promise(t)
        }
    });
    var re = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;
    var oe = new RegExp("^(?:([+-])=|)(" + re + ")([a-z%]*)$", "i");
    var ae = ["Top", "Right", "Bottom", "Left"];
    var se = function (e, t) {
        e = t || e;
        return e.style.display === "none" || e.style.display === "" && T.contains(e.ownerDocument, e) && T.css(e, "display") === "none"
    };
    var le = function (e, t, n, i) {
        var r, o, a = {};
        for (o in t) {
            a[o] = e.style[o];
            e.style[o] = t[o]
        }
        r = n.apply(e, i || []);
        for (o in t) {
            e.style[o] = a[o]
        }
        return r
    };

    function ue(e, t, n, i) {
        var r, o, a = 20,
            s = i ? function () {
                return i.cur()
            } :
            function () {
                return T.css(e, t, "")
            },
            l = s(),
            u = n && n[3] || (T.cssNumber[t] ? "" : "px"),
            c = (T.cssNumber[t] || u !== "px" && +l) && oe.exec(T.css(e, t));
        if (c && c[3] !== u) {
            l = l / 2;
            u = u || c[3];
            c = +l || 1;
            while (a--) {
                T.style(e, t, c + u);
                if ((1 - o) * (1 - (o = s() / l || .5)) <= 0) {
                    a = 0
                }
                c = c / o
            }
            c = c * 2;
            T.style(e, t, c + u);
            n = n || []
        }
        if (n) {
            c = +c || +l || 0;
            r = n[1] ? c + (n[1] + 1) * n[2] : +n[2];
            if (i) {
                i.unit = u;
                i.start = c;
                i.end = r
            }
        }
        return r
    }
    var ce = {};

    function fe(e) {
        var t, n = e.ownerDocument,
            i = e.nodeName,
            r = ce[i];
        if (r) {
            return r
        }
        t = n.body.appendChild(n.createElement(i));
        r = T.css(t, "display");
        t.parentNode.removeChild(t);
        if (r === "none") {
            r = "block"
        }
        ce[i] = r;
        return r
    }

    function he(e, t) {
        var n, i, r = [],
            o = 0,
            a = e.length;
        for (; o < a; o++) {
            i = e[o];
            if (!i.style) {
                continue
            }
            n = i.style.display;
            if (t) {
                if (n === "none") {
                    r[o] = Q.get(i, "display") || null;
                    if (!r[o]) {
                        i.style.display = ""
                    }
                }
                if (i.style.display === "" && se(i)) {
                    r[o] = fe(i)
                }
            } else {
                if (n !== "none") {
                    r[o] = "none";
                    Q.set(i, "display", n)
                }
            }
        }
        for (o = 0; o < a; o++) {
            if (r[o] != null) {
                e[o].style.display = r[o]
            }
        }
        return e
    }
    T.fn.extend({
        show: function () {
            return he(this, true)
        },
        hide: function () {
            return he(this)
        },
        toggle: function (e) {
            if (typeof e === "boolean") {
                return e ? this.show() : this.hide()
            }
            return this.each(function () {
                if (se(this)) {
                    T(this).show()
                } else {
                    T(this).hide()
                }
            })
        }
    });
    var de = /^(?:checkbox|radio)$/i;
    var pe = /<([a-z][^\/\0>\x20\t\r\n\f]+)/i;
    var ve = /^$|^module$|\/(?:java|ecma)script/i;
    var ge = {
        option: [1, "<select multiple='multiple'>", "</select>"],
        thead: [1, "<table>", "</table>"],
        col: [2, "<table><colgroup>", "</colgroup></table>"],
        tr: [2, "<table><tbody>", "</tbody></table>"],
        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
        _default: [0, "", ""]
    };
    ge.optgroup = ge.option;
    ge.tbody = ge.tfoot = ge.colgroup = ge.caption = ge.thead;
    ge.th = ge.td;

    function _e(e, t) {
        var n;
        if (typeof e.getElementsByTagName !== "undefined") {
            n = e.getElementsByTagName(t || "*")
        } else if (typeof e.querySelectorAll !== "undefined") {
            n = e.querySelectorAll(t || "*")
        } else {
            n = []
        }
        if (t === undefined || t && C(e, t)) {
            return T.merge([e], n)
        }
        return n
    }

    function ye(e, t) {
        var n = 0,
            i = e.length;
        for (; n < i; n++) {
            Q.set(e[n], "globalEval", !t || Q.get(t[n], "globalEval"))
        }
    }
    var me = /<|&#?\w+;/;

    function be(e, t, n, i, r) {
        var o, a, s, l, u, c, f = t.createDocumentFragment(),
            h = [],
            d = 0,
            p = e.length;
        for (; d < p; d++) {
            o = e[d];
            if (o || o === 0) {
                if (w(o) === "object") {
                    T.merge(h, o.nodeType ? [o] : o)
                } else if (!me.test(o)) {
                    h.push(t.createTextNode(o))
                } else {
                    a = a || f.appendChild(t.createElement("div"));
                    s = (pe.exec(o) || ["", ""])[1].toLowerCase();
                    l = ge[s] || ge._default;
                    a.innerHTML = l[1] + T.htmlPrefilter(o) + l[2];
                    c = l[0];
                    while (c--) {
                        a = a.lastChild
                    }
                    T.merge(h, a.childNodes);
                    a = f.firstChild;
                    a.textContent = ""
                }
            }
        }
        f.textContent = "";
        d = 0;
        while (o = h[d++]) {
            if (i && T.inArray(o, i) > -1) {
                if (r) {
                    r.push(o)
                }
                continue
            }
            u = T.contains(o.ownerDocument, o);
            a = _e(f.appendChild(o), "script");
            if (u) {
                ye(a)
            }
            if (n) {
                c = 0;
                while (o = a[c++]) {
                    if (ve.test(o.type || "")) {
                        n.push(o)
                    }
                }
            }
        }
        return f
    }
    (function () {
        var e = k.createDocumentFragment(),
            t = e.appendChild(k.createElement("div")),
            n = k.createElement("input");
        n.setAttribute("type", "radio");
        n.setAttribute("checked", "checked");
        n.setAttribute("name", "t");
        t.appendChild(n);
        _.checkClone = t.cloneNode(true).cloneNode(true).lastChild.checked;
        t.innerHTML = "<textarea>x</textarea>";
        _.noCloneChecked = !!t.cloneNode(true).lastChild.defaultValue
    })();
    var we = k.documentElement;
    var xe = /^key/,
        Ee = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
        ke = /^([^.]*)(?:\.(.+)|)/;

    function Te() {
        return true
    }

    function Oe() {
        return false
    }

    function Se() {
        try {
            return k.activeElement
        } catch (e) {}
    }

    function Ce(e, t, n, i, r, o) {
        var a, s;
        if (typeof t === "object") {
            if (typeof n !== "string") {
                i = i || n;
                n = undefined
            }
            for (s in t) {
                Ce(e, s, n, i, t[s], o)
            }
            return e
        }
        if (i == null && r == null) {
            r = n;
            i = n = undefined
        } else if (r == null) {
            if (typeof n === "string") {
                r = i;
                i = undefined
            } else {
                r = i;
                i = n;
                n = undefined
            }
        }
        if (r === false) {
            r = Oe
        } else if (!r) {
            return e
        }
        if (o === 1) {
            a = r;
            r = function (e) {
                T().off(e);
                return a.apply(this, arguments)
            };
            r.guid = a.guid || (a.guid = T.guid++)
        }
        return e.each(function () {
            T.event.add(this, t, r, i, n)
        })
    }
    T.event = {
        global: {},
        add: function (t, e, n, i, r) {
            var o, a, s, l, u, c, f, h, d, p, v, g = Q.get(t);
            if (!g) {
                return
            }
            if (n.handler) {
                o = n;
                n = o.handler;
                r = o.selector
            }
            if (r) {
                T.find.matchesSelector(we, r)
            }
            if (!n.guid) {
                n.guid = T.guid++
            }
            if (!(l = g.events)) {
                l = g.events = {}
            }
            if (!(a = g.handle)) {
                a = g.handle = function (e) {
                    return typeof T !== "undefined" && T.event.triggered !== e.type ? T.event.dispatch.apply(t, arguments) : undefined
                }
            }
            e = (e || "").match(M) || [""];
            u = e.length;
            while (u--) {
                s = ke.exec(e[u]) || [];
                d = v = s[1];
                p = (s[2] || "").split(".").sort();
                if (!d) {
                    continue
                }
                f = T.event.special[d] || {};
                d = (r ? f.delegateType : f.bindType) || d;
                f = T.event.special[d] || {};
                c = T.extend({
                    type: d,
                    origType: v,
                    data: i,
                    handler: n,
                    guid: n.guid,
                    selector: r,
                    needsContext: r && T.expr.match.needsContext.test(r),
                    namespace: p.join(".")
                }, o);
                if (!(h = l[d])) {
                    h = l[d] = [];
                    h.delegateCount = 0;
                    if (!f.setup || f.setup.call(t, i, p, a) === false) {
                        if (t.addEventListener) {
                            t.addEventListener(d, a)
                        }
                    }
                }
                if (f.add) {
                    f.add.call(t, c);
                    if (!c.handler.guid) {
                        c.handler.guid = n.guid
                    }
                }
                if (r) {
                    h.splice(h.delegateCount++, 0, c)
                } else {
                    h.push(c)
                }
                T.event.global[d] = true
            }
        },
        remove: function (e, t, n, i, r) {
            var o, a, s, l, u, c, f, h, d, p, v, g = Q.hasData(e) && Q.get(e);
            if (!g || !(l = g.events)) {
                return
            }
            t = (t || "").match(M) || [""];
            u = t.length;
            while (u--) {
                s = ke.exec(t[u]) || [];
                d = v = s[1];
                p = (s[2] || "").split(".").sort();
                if (!d) {
                    for (d in l) {
                        T.event.remove(e, d + t[u], n, i, true)
                    }
                    continue
                }
                f = T.event.special[d] || {};
                d = (i ? f.delegateType : f.bindType) || d;
                h = l[d] || [];
                s = s[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)");
                a = o = h.length;
                while (o--) {
                    c = h[o];
                    if ((r || v === c.origType) && (!n || n.guid === c.guid) && (!s || s.test(c.namespace)) && (!i || i === c.selector || i === "**" && c.selector)) {
                        h.splice(o, 1);
                        if (c.selector) {
                            h.delegateCount--
                        }
                        if (f.remove) {
                            f.remove.call(e, c)
                        }
                    }
                }
                if (a && !h.length) {
                    if (!f.teardown || f.teardown.call(e, p, g.handle) === false) {
                        T.removeEvent(e, d, g.handle)
                    }
                    delete l[d]
                }
            }
            if (T.isEmptyObject(l)) {
                Q.remove(e, "handle events")
            }
        },
        dispatch: function (e) {
            var t = T.event.fix(e);
            var n, i, r, o, a, s, l = new Array(arguments.length),
                u = (Q.get(this, "events") || {})[t.type] || [],
                c = T.event.special[t.type] || {};
            l[0] = t;
            for (n = 1; n < arguments.length; n++) {
                l[n] = arguments[n]
            }
            t.delegateTarget = this;
            if (c.preDispatch && c.preDispatch.call(this, t) === false) {
                return
            }
            s = T.event.handlers.call(this, t, u);
            n = 0;
            while ((o = s[n++]) && !t.isPropagationStopped()) {
                t.currentTarget = o.elem;
                i = 0;
                while ((a = o.handlers[i++]) && !t.isImmediatePropagationStopped()) {
                    if (!t.rnamespace || t.rnamespace.test(a.namespace)) {
                        t.handleObj = a;
                        t.data = a.data;
                        r = ((T.event.special[a.origType] || {}).handle || a.handler).apply(o.elem, l);
                        if (r !== undefined) {
                            if ((t.result = r) === false) {
                                t.preventDefault();
                                t.stopPropagation()
                            }
                        }
                    }
                }
            }
            if (c.postDispatch) {
                c.postDispatch.call(this, t)
            }
            return t.result
        },
        handlers: function (e, t) {
            var n, i, r, o, a, s = [],
                l = t.delegateCount,
                u = e.target;
            if (l && u.nodeType && !(e.type === "click" && e.button >= 1)) {
                for (; u !== this; u = u.parentNode || this) {
                    if (u.nodeType === 1 && !(e.type === "click" && u.disabled === true)) {
                        o = [];
                        a = {};
                        for (n = 0; n < l; n++) {
                            i = t[n];
                            r = i.selector + " ";
                            if (a[r] === undefined) {
                                a[r] = i.needsContext ? T(r, this).index(u) > -1 : T.find(r, this, null, [u]).length
                            }
                            if (a[r]) {
                                o.push(i)
                            }
                        }
                        if (o.length) {
                            s.push({
                                elem: u,
                                handlers: o
                            })
                        }
                    }
                }
            }
            u = this;
            if (l < t.length) {
                s.push({
                    elem: u,
                    handlers: t.slice(l)
                })
            }
            return s
        },
        addProp: function (t, e) {
            Object.defineProperty(T.Event.prototype, t, {
                enumerable: true,
                configurable: true,
                get: y(e) ? function () {
                    if (this.originalEvent) {
                        return e(this.originalEvent)
                    }
                } : function () {
                    if (this.originalEvent) {
                        return this.originalEvent[t]
                    }
                },
                set: function (e) {
                    Object.defineProperty(this, t, {
                        enumerable: true,
                        configurable: true,
                        writable: true,
                        value: e
                    })
                }
            })
        },
        fix: function (e) {
            return e[T.expando] ? e : new T.Event(e)
        },
        special: {
            load: {
                noBubble: true
            },
            focus: {
                trigger: function () {
                    if (this !== Se() && this.focus) {
                        this.focus();
                        return false
                    }
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function () {
                    if (this === Se() && this.blur) {
                        this.blur();
                        return false
                    }
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function () {
                    if (this.type === "checkbox" && this.click && C(this, "input")) {
                        this.click();
                        return false
                    }
                },
                _default: function (e) {
                    return C(e.target, "a")
                }
            },
            beforeunload: {
                postDispatch: function (e) {
                    if (e.result !== undefined && e.originalEvent) {
                        e.originalEvent.returnValue = e.result
                    }
                }
            }
        }
    };
    T.removeEvent = function (e, t, n) {
        if (e.removeEventListener) {
            e.removeEventListener(t, n)
        }
    };
    T.Event = function (e, t) {
        if (!(this instanceof T.Event)) {
            return new T.Event(e, t)
        }
        if (e && e.type) {
            this.originalEvent = e;
            this.type = e.type;
            this.isDefaultPrevented = e.defaultPrevented || e.defaultPrevented === undefined && e.returnValue === false ? Te : Oe;
            this.target = e.target && e.target.nodeType === 3 ? e.target.parentNode : e.target;
            this.currentTarget = e.currentTarget;
            this.relatedTarget = e.relatedTarget
        } else {
            this.type = e
        }
        if (t) {
            T.extend(this, t)
        }
        this.timeStamp = e && e.timeStamp || Date.now();
        this[T.expando] = true
    };
    T.Event.prototype = {
        constructor: T.Event,
        isDefaultPrevented: Oe,
        isPropagationStopped: Oe,
        isImmediatePropagationStopped: Oe,
        isSimulated: false,
        preventDefault: function () {
            var e = this.originalEvent;
            this.isDefaultPrevented = Te;
            if (e && !this.isSimulated) {
                e.preventDefault()
            }
        },
        stopPropagation: function () {
            var e = this.originalEvent;
            this.isPropagationStopped = Te;
            if (e && !this.isSimulated) {
                e.stopPropagation()
            }
        },
        stopImmediatePropagation: function () {
            var e = this.originalEvent;
            this.isImmediatePropagationStopped = Te;
            if (e && !this.isSimulated) {
                e.stopImmediatePropagation()
            }
            this.stopPropagation()
        }
    };
    T.each({
        altKey: true,
        bubbles: true,
        cancelable: true,
        changedTouches: true,
        ctrlKey: true,
        detail: true,
        eventPhase: true,
        metaKey: true,
        pageX: true,
        pageY: true,
        shiftKey: true,
        view: true,
        char: true,
        charCode: true,
        key: true,
        keyCode: true,
        button: true,
        buttons: true,
        clientX: true,
        clientY: true,
        offsetX: true,
        offsetY: true,
        pointerId: true,
        pointerType: true,
        screenX: true,
        screenY: true,
        targetTouches: true,
        toElement: true,
        touches: true,
        which: function (e) {
            var t = e.button;
            if (e.which == null && xe.test(e.type)) {
                return e.charCode != null ? e.charCode : e.keyCode
            }
            if (!e.which && t !== undefined && Ee.test(e.type)) {
                if (t & 1) {
                    return 1
                }
                if (t & 2) {
                    return 3
                }
                if (t & 4) {
                    return 2
                }
                return 0
            }
            return e.which
        }
    }, T.event.addProp);
    T.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function (e, o) {
        T.event.special[e] = {
            delegateType: o,
            bindType: o,
            handle: function (e) {
                var t, n = this,
                    i = e.relatedTarget,
                    r = e.handleObj;
                if (!i || i !== n && !T.contains(n, i)) {
                    e.type = r.origType;
                    t = r.handler.apply(this, arguments);
                    e.type = o
                }
                return t
            }
        }
    });
    T.fn.extend({
        on: function (e, t, n, i) {
            return Ce(this, e, t, n, i)
        },
        one: function (e, t, n, i) {
            return Ce(this, e, t, n, i, 1)
        },
        off: function (e, t, n) {
            var i, r;
            if (e && e.preventDefault && e.handleObj) {
                i = e.handleObj;
                T(e.delegateTarget).off(i.namespace ? i.origType + "." + i.namespace : i.origType, i.selector, i.handler);
                return this
            }
            if (typeof e === "object") {
                for (r in e) {
                    this.off(r, t, e[r])
                }
                return this
            }
            if (t === false || typeof t === "function") {
                n = t;
                t = undefined
            }
            if (n === false) {
                n = Oe
            }
            return this.each(function () {
                T.event.remove(this, e, n, t)
            })
        }
    });
    var Ae = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,
        je = /<script|<style|<link/i,
        Pe = /checked\s*(?:[^=]|=\s*.checked.)/i,
        De = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;

    function Ie(e, t) {
        if (C(e, "table") && C(t.nodeType !== 11 ? t : t.firstChild, "tr")) {
            return T(e).children("tbody")[0] || e
        }
        return e
    }

    function Ne(e) {
        e.type = (e.getAttribute("type") !== null) + "/" + e.type;
        return e
    }

    function Le(e) {
        if ((e.type || "").slice(0, 5) === "true/") {
            e.type = e.type.slice(5)
        } else {
            e.removeAttribute("type")
        }
        return e
    }

    function Re(e, t) {
        var n, i, r, o, a, s, l, u;
        if (t.nodeType !== 1) {
            return
        }
        if (Q.hasData(e)) {
            o = Q.access(e);
            a = Q.set(t, o);
            u = o.events;
            if (u) {
                delete a.handle;
                a.events = {};
                for (r in u) {
                    for (n = 0,
                        i = u[r].length; n < i; n++) {
                        T.event.add(t, r, u[r][n])
                    }
                }
            }
        }
        if (J.hasData(e)) {
            s = J.access(e);
            l = T.extend({}, s);
            J.set(t, l)
        }
    }

    function Me(e, t) {
        var n = t.nodeName.toLowerCase();
        if (n === "input" && de.test(e.type)) {
            t.checked = e.checked
        } else if (n === "input" || n === "textarea") {
            t.defaultValue = e.defaultValue
        }
    }

    function Be(n, i, r, o) {
        i = v.apply([], i);
        var e, t, a, s, l, u, c = 0,
            f = n.length,
            h = f - 1,
            d = i[0],
            p = y(d);
        if (p || f > 1 && typeof d === "string" && !_.checkClone && Pe.test(d)) {
            return n.each(function (e) {
                var t = n.eq(e);
                if (p) {
                    i[0] = d.call(this, e, t.html())
                }
                Be(t, i, r, o)
            })
        }
        if (f) {
            e = be(i, n[0].ownerDocument, false, n, o);
            t = e.firstChild;
            if (e.childNodes.length === 1) {
                e = t
            }
            if (t || o) {
                a = T.map(_e(e, "script"), Ne);
                s = a.length;
                for (; c < f; c++) {
                    l = e;
                    if (c !== h) {
                        l = T.clone(l, true, true);
                        if (s) {
                            T.merge(a, _e(l, "script"))
                        }
                    }
                    r.call(n[c], l, c)
                }
                if (s) {
                    u = a[a.length - 1].ownerDocument;
                    T.map(a, Le);
                    for (c = 0; c < s; c++) {
                        l = a[c];
                        if (ve.test(l.type || "") && !Q.access(l, "globalEval") && T.contains(u, l)) {
                            if (l.src && (l.type || "").toLowerCase() !== "module") {
                                if (T._evalUrl) {
                                    T._evalUrl(l.src)
                                }
                            } else {
                                b(l.textContent.replace(De, ""), u, l)
                            }
                        }
                    }
                }
            }
        }
        return n
    }

    function qe(e, t, n) {
        var i, r = t ? T.filter(t, e) : e,
            o = 0;
        for (;
            (i = r[o]) != null; o++) {
            if (!n && i.nodeType === 1) {
                T.cleanData(_e(i))
            }
            if (i.parentNode) {
                if (n && T.contains(i.ownerDocument, i)) {
                    ye(_e(i, "script"))
                }
                i.parentNode.removeChild(i)
            }
        }
        return e
    }
    T.extend({
        htmlPrefilter: function (e) {
            return e.replace(Ae, "<$1></$2>")
        },
        clone: function (e, t, n) {
            var i, r, o, a, s = e.cloneNode(true),
                l = T.contains(e.ownerDocument, e);
            if (!_.noCloneChecked && (e.nodeType === 1 || e.nodeType === 11) && !T.isXMLDoc(e)) {
                a = _e(s);
                o = _e(e);
                for (i = 0,
                    r = o.length; i < r; i++) {
                    Me(o[i], a[i])
                }
            }
            if (t) {
                if (n) {
                    o = o || _e(e);
                    a = a || _e(s);
                    for (i = 0,
                        r = o.length; i < r; i++) {
                        Re(o[i], a[i])
                    }
                } else {
                    Re(e, s)
                }
            }
            a = _e(s, "script");
            if (a.length > 0) {
                ye(a, !l && _e(e, "script"))
            }
            return s
        },
        cleanData: function (e) {
            var t, n, i, r = T.event.special,
                o = 0;
            for (;
                (n = e[o]) !== undefined; o++) {
                if (X(n)) {
                    if (t = n[Q.expando]) {
                        if (t.events) {
                            for (i in t.events) {
                                if (r[i]) {
                                    T.event.remove(n, i)
                                } else {
                                    T.removeEvent(n, i, t.handle)
                                }
                            }
                        }
                        n[Q.expando] = undefined
                    }
                    if (n[J.expando]) {
                        n[J.expando] = undefined
                    }
                }
            }
        }
    });
    T.fn.extend({
        detach: function (e) {
            return qe(this, e, true)
        },
        remove: function (e) {
            return qe(this, e)
        },
        text: function (e) {
            return W(this, function (e) {
                return e === undefined ? T.text(this) : this.empty().each(function () {
                    if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
                        this.textContent = e
                    }
                })
            }, null, e, arguments.length)
        },
        append: function () {
            return Be(this, arguments, function (e) {
                if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
                    var t = Ie(this, e);
                    t.appendChild(e)
                }
            })
        },
        prepend: function () {
            return Be(this, arguments, function (e) {
                if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
                    var t = Ie(this, e);
                    t.insertBefore(e, t.firstChild)
                }
            })
        },
        before: function () {
            return Be(this, arguments, function (e) {
                if (this.parentNode) {
                    this.parentNode.insertBefore(e, this)
                }
            })
        },
        after: function () {
            return Be(this, arguments, function (e) {
                if (this.parentNode) {
                    this.parentNode.insertBefore(e, this.nextSibling)
                }
            })
        },
        empty: function () {
            var e, t = 0;
            for (;
                (e = this[t]) != null; t++) {
                if (e.nodeType === 1) {
                    T.cleanData(_e(e, false));
                    e.textContent = ""
                }
            }
            return this
        },
        clone: function (e, t) {
            e = e == null ? false : e;
            t = t == null ? e : t;
            return this.map(function () {
                return T.clone(this, e, t)
            })
        },
        html: function (e) {
            return W(this, function (e) {
                var t = this[0] || {},
                    n = 0,
                    i = this.length;
                if (e === undefined && t.nodeType === 1) {
                    return t.innerHTML
                }
                if (typeof e === "string" && !je.test(e) && !ge[(pe.exec(e) || ["", ""])[1].toLowerCase()]) {
                    e = T.htmlPrefilter(e);
                    try {
                        for (; n < i; n++) {
                            t = this[n] || {};
                            if (t.nodeType === 1) {
                                T.cleanData(_e(t, false));
                                t.innerHTML = e
                            }
                        }
                        t = 0
                    } catch (e) {}
                }
                if (t) {
                    this.empty().append(e)
                }
            }, null, e, arguments.length)
        },
        replaceWith: function () {
            var n = [];
            return Be(this, arguments, function (e) {
                var t = this.parentNode;
                if (T.inArray(this, n) < 0) {
                    T.cleanData(_e(this));
                    if (t) {
                        t.replaceChild(e, this)
                    }
                }
            }, n)
        }
    });
    T.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function (e, a) {
        T.fn[e] = function (e) {
            var t, n = [],
                i = T(e),
                r = i.length - 1,
                o = 0;
            for (; o <= r; o++) {
                t = o === r ? this : this.clone(true);
                T(i[o])[a](t);
                l.apply(n, t.get())
            }
            return this.pushStack(n)
        }
    });
    var $e = new RegExp("^(" + re + ")(?!px)[a-z%]+$", "i");
    var Ue = function (e) {
        var t = e.ownerDocument.defaultView;
        if (!t || !t.opener) {
            t = E
        }
        return t.getComputedStyle(e)
    };
    var Ve = new RegExp(ae.join("|"), "i");
    (function () {
        function e() {
            if (!l) {
                return
            }
            s.style.cssText = "position:absolute;left:-11111px;width:60px;" + "margin-top:1px;padding:0;border:0";
            l.style.cssText = "position:relative;display:block;box-sizing:border-box;overflow:scroll;" + "margin:auto;border:1px;padding:1px;" + "width:60%;top:1%";
            we.appendChild(s).appendChild(l);
            var e = E.getComputedStyle(l);
            n = e.top !== "1%";
            a = t(e.marginLeft) === 12;
            l.style.right = "60%";
            o = t(e.right) === 36;
            i = t(e.width) === 36;
            l.style.position = "absolute";
            r = l.offsetWidth === 36 || "absolute";
            we.removeChild(s);
            l = null
        }

        function t(e) {
            return Math.round(parseFloat(e))
        }
        var n, i, r, o, a, s = k.createElement("div"),
            l = k.createElement("div");
        if (!l.style) {
            return
        }
        l.style.backgroundClip = "content-box";
        l.cloneNode(true).style.backgroundClip = "";
        _.clearCloneStyle = l.style.backgroundClip === "content-box";
        T.extend(_, {
            boxSizingReliable: function () {
                e();
                return i
            },
            pixelBoxStyles: function () {
                e();
                return o
            },
            pixelPosition: function () {
                e();
                return n
            },
            reliableMarginLeft: function () {
                e();
                return a
            },
            scrollboxSize: function () {
                e();
                return r
            }
        })
    })();

    function He(e, t, n) {
        var i, r, o, a, s = e.style;
        n = n || Ue(e);
        if (n) {
            a = n.getPropertyValue(t) || n[t];
            if (a === "" && !T.contains(e.ownerDocument, e)) {
                a = T.style(e, t)
            }
            if (!_.pixelBoxStyles() && $e.test(a) && Ve.test(t)) {
                i = s.width;
                r = s.minWidth;
                o = s.maxWidth;
                s.minWidth = s.maxWidth = s.width = a;
                a = n.width;
                s.width = i;
                s.minWidth = r;
                s.maxWidth = o
            }
        }
        return a !== undefined ? a + "" : a
    }

    function Fe(e, t) {
        return {
            get: function () {
                if (e()) {
                    delete this.get;
                    return
                }
                return (this.get = t).apply(this, arguments)
            }
        }
    }
    var We = /^(none|table(?!-c[ea]).+)/,
        ze = /^--/,
        Ye = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        Ge = {
            letterSpacing: "0",
            fontWeight: "400"
        },
        Ke = ["Webkit", "Moz", "ms"],
        Xe = k.createElement("div").style;

    function Ze(e) {
        if (e in Xe) {
            return e
        }
        var t = e[0].toUpperCase() + e.slice(1),
            n = Ke.length;
        while (n--) {
            e = Ke[n] + t;
            if (e in Xe) {
                return e
            }
        }
    }

    function Qe(e) {
        var t = T.cssProps[e];
        if (!t) {
            t = T.cssProps[e] = Ze(e) || e
        }
        return t
    }

    function Je(e, t, n) {
        var i = oe.exec(t);
        return i ? Math.max(0, i[2] - (n || 0)) + (i[3] || "px") : t
    }

    function et(e, t, n, i, r, o) {
        var a = t === "width" ? 1 : 0,
            s = 0,
            l = 0;
        if (n === (i ? "border" : "content")) {
            return 0
        }
        for (; a < 4; a += 2) {
            if (n === "margin") {
                l += T.css(e, n + ae[a], true, r)
            }
            if (!i) {
                l += T.css(e, "padding" + ae[a], true, r);
                if (n !== "padding") {
                    l += T.css(e, "border" + ae[a] + "Width", true, r)
                } else {
                    s += T.css(e, "border" + ae[a] + "Width", true, r)
                }
            } else {
                if (n === "content") {
                    l -= T.css(e, "padding" + ae[a], true, r)
                }
                if (n !== "margin") {
                    l -= T.css(e, "border" + ae[a] + "Width", true, r)
                }
            }
        }
        if (!i && o >= 0) {
            l += Math.max(0, Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - o - l - s - .5))
        }
        return l
    }

    function tt(e, t, n) {
        var i = Ue(e),
            r = He(e, t, i),
            o = T.css(e, "boxSizing", false, i) === "border-box",
            a = o;
        if ($e.test(r)) {
            if (!n) {
                return r
            }
            r = "auto"
        }
        a = a && (_.boxSizingReliable() || r === e.style[t]);
        if (r === "auto" || !parseFloat(r) && T.css(e, "display", false, i) === "inline") {
            r = e["offset" + t[0].toUpperCase() + t.slice(1)];
            a = true
        }
        r = parseFloat(r) || 0;
        return r + et(e, t, n || (o ? "border" : "content"), a, i, r) + "px"
    }
    T.extend({
        cssHooks: {
            opacity: {
                get: function (e, t) {
                    if (t) {
                        var n = He(e, "opacity");
                        return n === "" ? "1" : n
                    }
                }
            }
        },
        cssNumber: {
            animationIterationCount: true,
            columnCount: true,
            fillOpacity: true,
            flexGrow: true,
            flexShrink: true,
            fontWeight: true,
            lineHeight: true,
            opacity: true,
            order: true,
            orphans: true,
            widows: true,
            zIndex: true,
            zoom: true
        },
        cssProps: {},
        style: function (e, t, n, i) {
            if (!e || e.nodeType === 3 || e.nodeType === 8 || !e.style) {
                return
            }
            var r, o, a, s = K(t),
                l = ze.test(t),
                u = e.style;
            if (!l) {
                t = Qe(s)
            }
            a = T.cssHooks[t] || T.cssHooks[s];
            if (n !== undefined) {
                o = typeof n;
                if (o === "string" && (r = oe.exec(n)) && r[1]) {
                    n = ue(e, t, r);
                    o = "number"
                }
                if (n == null || n !== n) {
                    return
                }
                if (o === "number") {
                    n += r && r[3] || (T.cssNumber[s] ? "" : "px")
                }
                if (!_.clearCloneStyle && n === "" && t.indexOf("background") === 0) {
                    u[t] = "inherit"
                }
                if (!a || !("set" in a) || (n = a.set(e, n, i)) !== undefined) {
                    if (l) {
                        u.setProperty(t, n)
                    } else {
                        u[t] = n
                    }
                }
            } else {
                if (a && "get" in a && (r = a.get(e, false, i)) !== undefined) {
                    return r
                }
                return u[t]
            }
        },
        css: function (e, t, n, i) {
            var r, o, a, s = K(t),
                l = ze.test(t);
            if (!l) {
                t = Qe(s)
            }
            a = T.cssHooks[t] || T.cssHooks[s];
            if (a && "get" in a) {
                r = a.get(e, true, n)
            }
            if (r === undefined) {
                r = He(e, t, i)
            }
            if (r === "normal" && t in Ge) {
                r = Ge[t]
            }
            if (n === "" || n) {
                o = parseFloat(r);
                return n === true || isFinite(o) ? o || 0 : r
            }
            return r
        }
    });
    T.each(["height", "width"], function (e, s) {
        T.cssHooks[s] = {
            get: function (e, t, n) {
                if (t) {
                    return We.test(T.css(e, "display")) && (!e.getClientRects().length || !e.getBoundingClientRect().width) ? le(e, Ye, function () {
                        return tt(e, s, n)
                    }) : tt(e, s, n)
                }
            },
            set: function (e, t, n) {
                var i, r = Ue(e),
                    o = T.css(e, "boxSizing", false, r) === "border-box",
                    a = n && et(e, s, n, o, r);
                if (o && _.scrollboxSize() === r.position) {
                    a -= Math.ceil(e["offset" + s[0].toUpperCase() + s.slice(1)] - parseFloat(r[s]) - et(e, s, "border", false, r) - .5)
                }
                if (a && (i = oe.exec(t)) && (i[3] || "px") !== "px") {
                    e.style[s] = t;
                    t = T.css(e, s)
                }
                return Je(e, t, a)
            }
        }
    });
    T.cssHooks.marginLeft = Fe(_.reliableMarginLeft, function (e, t) {
        if (t) {
            return (parseFloat(He(e, "marginLeft")) || e.getBoundingClientRect().left - le(e, {
                marginLeft: 0
            }, function () {
                return e.getBoundingClientRect().left
            })) + "px"
        }
    });
    T.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function (r, o) {
        T.cssHooks[r + o] = {
            expand: function (e) {
                var t = 0,
                    n = {},
                    i = typeof e === "string" ? e.split(" ") : [e];
                for (; t < 4; t++) {
                    n[r + ae[t] + o] = i[t] || i[t - 2] || i[0]
                }
                return n
            }
        };
        if (r !== "margin") {
            T.cssHooks[r + o].set = Je
        }
    });
    T.fn.extend({
        css: function (e, t) {
            return W(this, function (e, t, n) {
                var i, r, o = {},
                    a = 0;
                if (Array.isArray(t)) {
                    i = Ue(e);
                    r = t.length;
                    for (; a < r; a++) {
                        o[t[a]] = T.css(e, t[a], false, i)
                    }
                    return o
                }
                return n !== undefined ? T.style(e, t, n) : T.css(e, t)
            }, e, t, arguments.length > 1)
        }
    });

    function nt(e, t, n, i, r) {
        return new nt.prototype.init(e, t, n, i, r)
    }
    T.Tween = nt;
    nt.prototype = {
        constructor: nt,
        init: function (e, t, n, i, r, o) {
            this.elem = e;
            this.prop = n;
            this.easing = r || T.easing._default;
            this.options = t;
            this.start = this.now = this.cur();
            this.end = i;
            this.unit = o || (T.cssNumber[n] ? "" : "px")
        },
        cur: function () {
            var e = nt.propHooks[this.prop];
            return e && e.get ? e.get(this) : nt.propHooks._default.get(this)
        },
        run: function (e) {
            var t, n = nt.propHooks[this.prop];
            if (this.options.duration) {
                this.pos = t = T.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration)
            } else {
                this.pos = t = e
            }
            this.now = (this.end - this.start) * t + this.start;
            if (this.options.step) {
                this.options.step.call(this.elem, this.now, this)
            }
            if (n && n.set) {
                n.set(this)
            } else {
                nt.propHooks._default.set(this)
            }
            return this
        }
    };
    nt.prototype.init.prototype = nt.prototype;
    nt.propHooks = {
        _default: {
            get: function (e) {
                var t;
                if (e.elem.nodeType !== 1 || e.elem[e.prop] != null && e.elem.style[e.prop] == null) {
                    return e.elem[e.prop]
                }
                t = T.css(e.elem, e.prop, "");
                return !t || t === "auto" ? 0 : t
            },
            set: function (e) {
                if (T.fx.step[e.prop]) {
                    T.fx.step[e.prop](e)
                } else if (e.elem.nodeType === 1 && (e.elem.style[T.cssProps[e.prop]] != null || T.cssHooks[e.prop])) {
                    T.style(e.elem, e.prop, e.now + e.unit)
                } else {
                    e.elem[e.prop] = e.now
                }
            }
        }
    };
    nt.propHooks.scrollTop = nt.propHooks.scrollLeft = {
        set: function (e) {
            if (e.elem.nodeType && e.elem.parentNode) {
                e.elem[e.prop] = e.now
            }
        }
    };
    T.easing = {
        linear: function (e) {
            return e
        },
        swing: function (e) {
            return .5 - Math.cos(e * Math.PI) / 2
        },
        _default: "swing"
    };
    T.fx = nt.prototype.init;
    T.fx.step = {};
    var it, rt, ot = /^(?:toggle|show|hide)$/,
        at = /queueHooks$/;

    function st() {
        if (rt) {
            if (k.hidden === false && E.requestAnimationFrame) {
                E.requestAnimationFrame(st)
            } else {
                E.setTimeout(st, T.fx.interval)
            }
            T.fx.tick()
        }
    }

    function lt() {
        E.setTimeout(function () {
            it = undefined
        });
        return it = Date.now()
    }

    function ut(e, t) {
        var n, i = 0,
            r = {
                height: e
            };
        t = t ? 1 : 0;
        for (; i < 4; i += 2 - t) {
            n = ae[i];
            r["margin" + n] = r["padding" + n] = e
        }
        if (t) {
            r.opacity = r.width = e
        }
        return r
    }

    function ct(e, t, n) {
        var i, r = (dt.tweeners[t] || []).concat(dt.tweeners["*"]),
            o = 0,
            a = r.length;
        for (; o < a; o++) {
            if (i = r[o].call(n, t, e)) {
                return i
            }
        }
    }

    function ft(e, t, n) {
        var i, r, o, a, s, l, u, c, f = "width" in t || "height" in t,
            h = this,
            d = {},
            p = e.style,
            v = e.nodeType && se(e),
            g = Q.get(e, "fxshow");
        if (!n.queue) {
            a = T._queueHooks(e, "fx");
            if (a.unqueued == null) {
                a.unqueued = 0;
                s = a.empty.fire;
                a.empty.fire = function () {
                    if (!a.unqueued) {
                        s()
                    }
                }
            }
            a.unqueued++;
            h.always(function () {
                h.always(function () {
                    a.unqueued--;
                    if (!T.queue(e, "fx").length) {
                        a.empty.fire()
                    }
                })
            })
        }
        for (i in t) {
            r = t[i];
            if (ot.test(r)) {
                delete t[i];
                o = o || r === "toggle";
                if (r === (v ? "hide" : "show")) {
                    if (r === "show" && g && g[i] !== undefined) {
                        v = true
                    } else {
                        continue
                    }
                }
                d[i] = g && g[i] || T.style(e, i)
            }
        }
        l = !T.isEmptyObject(t);
        if (!l && T.isEmptyObject(d)) {
            return
        }
        if (f && e.nodeType === 1) {
            n.overflow = [p.overflow, p.overflowX, p.overflowY];
            u = g && g.display;
            if (u == null) {
                u = Q.get(e, "display")
            }
            c = T.css(e, "display");
            if (c === "none") {
                if (u) {
                    c = u
                } else {
                    he([e], true);
                    u = e.style.display || u;
                    c = T.css(e, "display");
                    he([e])
                }
            }
            if (c === "inline" || c === "inline-block" && u != null) {
                if (T.css(e, "float") === "none") {
                    if (!l) {
                        h.done(function () {
                            p.display = u
                        });
                        if (u == null) {
                            c = p.display;
                            u = c === "none" ? "" : c
                        }
                    }
                    p.display = "inline-block"
                }
            }
        }
        if (n.overflow) {
            p.overflow = "hidden";
            h.always(function () {
                p.overflow = n.overflow[0];
                p.overflowX = n.overflow[1];
                p.overflowY = n.overflow[2]
            })
        }
        l = false;
        for (i in d) {
            if (!l) {
                if (g) {
                    if ("hidden" in g) {
                        v = g.hidden
                    }
                } else {
                    g = Q.access(e, "fxshow", {
                        display: u
                    })
                }
                if (o) {
                    g.hidden = !v
                }
                if (v) {
                    he([e], true)
                }
                h.done(function () {
                    if (!v) {
                        he([e])
                    }
                    Q.remove(e, "fxshow");
                    for (i in d) {
                        T.style(e, i, d[i])
                    }
                })
            }
            l = ct(v ? g[i] : 0, i, h);
            if (!(i in g)) {
                g[i] = l.start;
                if (v) {
                    l.end = l.start;
                    l.start = 0
                }
            }
        }
    }

    function ht(e, t) {
        var n, i, r, o, a;
        for (n in e) {
            i = K(n);
            r = t[i];
            o = e[n];
            if (Array.isArray(o)) {
                r = o[1];
                o = e[n] = o[0]
            }
            if (n !== i) {
                e[i] = o;
                delete e[n]
            }
            a = T.cssHooks[i];
            if (a && "expand" in a) {
                o = a.expand(o);
                delete e[i];
                for (n in o) {
                    if (!(n in e)) {
                        e[n] = o[n];
                        t[n] = r
                    }
                }
            } else {
                t[i] = r
            }
        }
    }

    function dt(a, e, t) {
        var n, s, i = 0,
            r = dt.prefilters.length,
            l = T.Deferred().always(function () {
                delete o.elem
            }),
            o = function () {
                if (s) {
                    return false
                }
                var e = it || lt(),
                    t = Math.max(0, u.startTime + u.duration - e),
                    n = t / u.duration || 0,
                    i = 1 - n,
                    r = 0,
                    o = u.tweens.length;
                for (; r < o; r++) {
                    u.tweens[r].run(i)
                }
                l.notifyWith(a, [u, i, t]);
                if (i < 1 && o) {
                    return t
                }
                if (!o) {
                    l.notifyWith(a, [u, 1, 0])
                }
                l.resolveWith(a, [u]);
                return false
            },
            u = l.promise({
                elem: a,
                props: T.extend({}, e),
                opts: T.extend(true, {
                    specialEasing: {},
                    easing: T.easing._default
                }, t),
                originalProperties: e,
                originalOptions: t,
                startTime: it || lt(),
                duration: t.duration,
                tweens: [],
                createTween: function (e, t) {
                    var n = T.Tween(a, u.opts, e, t, u.opts.specialEasing[e] || u.opts.easing);
                    u.tweens.push(n);
                    return n
                },
                stop: function (e) {
                    var t = 0,
                        n = e ? u.tweens.length : 0;
                    if (s) {
                        return this
                    }
                    s = true;
                    for (; t < n; t++) {
                        u.tweens[t].run(1)
                    }
                    if (e) {
                        l.notifyWith(a, [u, 1, 0]);
                        l.resolveWith(a, [u, e])
                    } else {
                        l.rejectWith(a, [u, e])
                    }
                    return this
                }
            }),
            c = u.props;
        ht(c, u.opts.specialEasing);
        for (; i < r; i++) {
            n = dt.prefilters[i].call(u, a, c, u.opts);
            if (n) {
                if (y(n.stop)) {
                    T._queueHooks(u.elem, u.opts.queue).stop = n.stop.bind(n)
                }
                return n
            }
        }
        T.map(c, ct, u);
        if (y(u.opts.start)) {
            u.opts.start.call(a, u)
        }
        u.progress(u.opts.progress).done(u.opts.done, u.opts.complete).fail(u.opts.fail).always(u.opts.always);
        T.fx.timer(T.extend(o, {
            elem: a,
            anim: u,
            queue: u.opts.queue
        }));
        return u
    }
    T.Animation = T.extend(dt, {
        tweeners: {
            "*": [function (e, t) {
                var n = this.createTween(e, t);
                ue(n.elem, e, oe.exec(t), n);
                return n
            }]
        },
        tweener: function (e, t) {
            if (y(e)) {
                t = e;
                e = ["*"]
            } else {
                e = e.match(M)
            }
            var n, i = 0,
                r = e.length;
            for (; i < r; i++) {
                n = e[i];
                dt.tweeners[n] = dt.tweeners[n] || [];
                dt.tweeners[n].unshift(t)
            }
        },
        prefilters: [ft],
        prefilter: function (e, t) {
            if (t) {
                dt.prefilters.unshift(e)
            } else {
                dt.prefilters.push(e)
            }
        }
    });
    T.speed = function (e, t, n) {
        var i = e && typeof e === "object" ? T.extend({}, e) : {
            complete: n || !n && t || y(e) && e,
            duration: e,
            easing: n && t || t && !y(t) && t
        };
        if (T.fx.off) {
            i.duration = 0
        } else {
            if (typeof i.duration !== "number") {
                if (i.duration in T.fx.speeds) {
                    i.duration = T.fx.speeds[i.duration]
                } else {
                    i.duration = T.fx.speeds._default
                }
            }
        }
        if (i.queue == null || i.queue === true) {
            i.queue = "fx"
        }
        i.old = i.complete;
        i.complete = function () {
            if (y(i.old)) {
                i.old.call(this)
            }
            if (i.queue) {
                T.dequeue(this, i.queue)
            }
        };
        return i
    };
    T.fn.extend({
        fadeTo: function (e, t, n, i) {
            return this.filter(se).css("opacity", 0).show().end().animate({
                opacity: t
            }, e, n, i)
        },
        animate: function (t, e, n, i) {
            var r = T.isEmptyObject(t),
                o = T.speed(e, n, i),
                a = function () {
                    var e = dt(this, T.extend({}, t), o);
                    if (r || Q.get(this, "finish")) {
                        e.stop(true)
                    }
                };
            a.finish = a;
            return r || o.queue === false ? this.each(a) : this.queue(o.queue, a)
        },
        stop: function (r, e, o) {
            var a = function (e) {
                var t = e.stop;
                delete e.stop;
                t(o)
            };
            if (typeof r !== "string") {
                o = e;
                e = r;
                r = undefined
            }
            if (e && r !== false) {
                this.queue(r || "fx", [])
            }
            return this.each(function () {
                var e = true,
                    t = r != null && r + "queueHooks",
                    n = T.timers,
                    i = Q.get(this);
                if (t) {
                    if (i[t] && i[t].stop) {
                        a(i[t])
                    }
                } else {
                    for (t in i) {
                        if (i[t] && i[t].stop && at.test(t)) {
                            a(i[t])
                        }
                    }
                }
                for (t = n.length; t--;) {
                    if (n[t].elem === this && (r == null || n[t].queue === r)) {
                        n[t].anim.stop(o);
                        e = false;
                        n.splice(t, 1)
                    }
                }
                if (e || !o) {
                    T.dequeue(this, r)
                }
            })
        },
        finish: function (a) {
            if (a !== false) {
                a = a || "fx"
            }
            return this.each(function () {
                var e, t = Q.get(this),
                    n = t[a + "queue"],
                    i = t[a + "queueHooks"],
                    r = T.timers,
                    o = n ? n.length : 0;
                t.finish = true;
                T.queue(this, a, []);
                if (i && i.stop) {
                    i.stop.call(this, true)
                }
                for (e = r.length; e--;) {
                    if (r[e].elem === this && r[e].queue === a) {
                        r[e].anim.stop(true);
                        r.splice(e, 1)
                    }
                }
                for (e = 0; e < o; e++) {
                    if (n[e] && n[e].finish) {
                        n[e].finish.call(this)
                    }
                }
                delete t.finish
            })
        }
    });
    T.each(["toggle", "show", "hide"], function (e, i) {
        var r = T.fn[i];
        T.fn[i] = function (e, t, n) {
            return e == null || typeof e === "boolean" ? r.apply(this, arguments) : this.animate(ut(i, true), e, t, n)
        }
    });
    T.each({
        slideDown: ut("show"),
        slideUp: ut("hide"),
        slideToggle: ut("toggle"),
        fadeIn: {
            opacity: "show"
        },
        fadeOut: {
            opacity: "hide"
        },
        fadeToggle: {
            opacity: "toggle"
        }
    }, function (e, i) {
        T.fn[e] = function (e, t, n) {
            return this.animate(i, e, t, n)
        }
    });
    T.timers = [];
    T.fx.tick = function () {
        var e, t = 0,
            n = T.timers;
        it = Date.now();
        for (; t < n.length; t++) {
            e = n[t];
            if (!e() && n[t] === e) {
                n.splice(t--, 1)
            }
        }
        if (!n.length) {
            T.fx.stop()
        }
        it = undefined
    };
    T.fx.timer = function (e) {
        T.timers.push(e);
        T.fx.start()
    };
    T.fx.interval = 13;
    T.fx.start = function () {
        if (rt) {
            return
        }
        rt = true;
        st()
    };
    T.fx.stop = function () {
        rt = null
    };
    T.fx.speeds = {
        slow: 600,
        fast: 200,
        _default: 400
    };
    T.fn.delay = function (i, e) {
        i = T.fx ? T.fx.speeds[i] || i : i;
        e = e || "fx";
        return this.queue(e, function (e, t) {
            var n = E.setTimeout(e, i);
            t.stop = function () {
                E.clearTimeout(n)
            }
        })
    };
    (function () {
        var e = k.createElement("input"),
            t = k.createElement("select"),
            n = t.appendChild(k.createElement("option"));
        e.type = "checkbox";
        _.checkOn = e.value !== "";
        _.optSelected = n.selected;
        e = k.createElement("input");
        e.value = "t";
        e.type = "radio";
        _.radioValue = e.value === "t"
    })();
    var pt, vt = T.expr.attrHandle;
    T.fn.extend({
        attr: function (e, t) {
            return W(this, T.attr, e, t, arguments.length > 1)
        },
        removeAttr: function (e) {
            return this.each(function () {
                T.removeAttr(this, e)
            })
        }
    });
    T.extend({
        attr: function (e, t, n) {
            var i, r, o = e.nodeType;
            if (o === 3 || o === 8 || o === 2) {
                return
            }
            if (typeof e.getAttribute === "undefined") {
                return T.prop(e, t, n)
            }
            if (o !== 1 || !T.isXMLDoc(e)) {
                r = T.attrHooks[t.toLowerCase()] || (T.expr.match.bool.test(t) ? pt : undefined)
            }
            if (n !== undefined) {
                if (n === null) {
                    T.removeAttr(e, t);
                    return
                }
                if (r && "set" in r && (i = r.set(e, n, t)) !== undefined) {
                    return i
                }
                e.setAttribute(t, n + "");
                return n
            }
            if (r && "get" in r && (i = r.get(e, t)) !== null) {
                return i
            }
            i = T.find.attr(e, t);
            return i == null ? undefined : i
        },
        attrHooks: {
            type: {
                set: function (e, t) {
                    if (!_.radioValue && t === "radio" && C(e, "input")) {
                        var n = e.value;
                        e.setAttribute("type", t);
                        if (n) {
                            e.value = n
                        }
                        return t
                    }
                }
            }
        },
        removeAttr: function (e, t) {
            var n, i = 0,
                r = t && t.match(M);
            if (r && e.nodeType === 1) {
                while (n = r[i++]) {
                    e.removeAttribute(n)
                }
            }
        }
    });
    pt = {
        set: function (e, t, n) {
            if (t === false) {
                T.removeAttr(e, n)
            } else {
                e.setAttribute(n, n)
            }
            return n
        }
    };
    T.each(T.expr.match.bool.source.match(/\w+/g), function (e, t) {
        var a = vt[t] || T.find.attr;
        vt[t] = function (e, t, n) {
            var i, r, o = t.toLowerCase();
            if (!n) {
                r = vt[o];
                vt[o] = i;
                i = a(e, t, n) != null ? o : null;
                vt[o] = r
            }
            return i
        }
    });
    var gt = /^(?:input|select|textarea|button)$/i,
        _t = /^(?:a|area)$/i;
    T.fn.extend({
        prop: function (e, t) {
            return W(this, T.prop, e, t, arguments.length > 1)
        },
        removeProp: function (e) {
            return this.each(function () {
                delete this[T.propFix[e] || e]
            })
        }
    });
    T.extend({
        prop: function (e, t, n) {
            var i, r, o = e.nodeType;
            if (o === 3 || o === 8 || o === 2) {
                return
            }
            if (o !== 1 || !T.isXMLDoc(e)) {
                t = T.propFix[t] || t;
                r = T.propHooks[t]
            }
            if (n !== undefined) {
                if (r && "set" in r && (i = r.set(e, n, t)) !== undefined) {
                    return i
                }
                return e[t] = n
            }
            if (r && "get" in r && (i = r.get(e, t)) !== null) {
                return i
            }
            return e[t]
        },
        propHooks: {
            tabIndex: {
                get: function (e) {
                    var t = T.find.attr(e, "tabindex");
                    if (t) {
                        return parseInt(t, 10)
                    }
                    if (gt.test(e.nodeName) || _t.test(e.nodeName) && e.href) {
                        return 0
                    }
                    return -1
                }
            }
        },
        propFix: {
            for: "htmlFor",
            class: "className"
        }
    });
    if (!_.optSelected) {
        T.propHooks.selected = {
            get: function (e) {
                var t = e.parentNode;
                if (t && t.parentNode) {
                    t.parentNode.selectedIndex
                }
                return null
            },
            set: function (e) {
                var t = e.parentNode;
                if (t) {
                    t.selectedIndex;
                    if (t.parentNode) {
                        t.parentNode.selectedIndex
                    }
                }
            }
        }
    }
    T.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () {
        T.propFix[this.toLowerCase()] = this
    });

    function yt(e) {
        var t = e.match(M) || [];
        return t.join(" ")
    }

    function mt(e) {
        return e.getAttribute && e.getAttribute("class") || ""
    }

    function bt(e) {
        if (Array.isArray(e)) {
            return e
        }
        if (typeof e === "string") {
            return e.match(M) || []
        }
        return []
    }
    T.fn.extend({
        addClass: function (t) {
            var e, n, i, r, o, a, s, l = 0;
            if (y(t)) {
                return this.each(function (e) {
                    T(this).addClass(t.call(this, e, mt(this)))
                })
            }
            e = bt(t);
            if (e.length) {
                while (n = this[l++]) {
                    r = mt(n);
                    i = n.nodeType === 1 && " " + yt(r) + " ";
                    if (i) {
                        a = 0;
                        while (o = e[a++]) {
                            if (i.indexOf(" " + o + " ") < 0) {
                                i += o + " "
                            }
                        }
                        s = yt(i);
                        if (r !== s) {
                            n.setAttribute("class", s)
                        }
                    }
                }
            }
            return this
        },
        removeClass: function (t) {
            var e, n, i, r, o, a, s, l = 0;
            if (y(t)) {
                return this.each(function (e) {
                    T(this).removeClass(t.call(this, e, mt(this)))
                })
            }
            if (!arguments.length) {
                return this.attr("class", "")
            }
            e = bt(t);
            if (e.length) {
                while (n = this[l++]) {
                    r = mt(n);
                    i = n.nodeType === 1 && " " + yt(r) + " ";
                    if (i) {
                        a = 0;
                        while (o = e[a++]) {
                            while (i.indexOf(" " + o + " ") > -1) {
                                i = i.replace(" " + o + " ", " ")
                            }
                        }
                        s = yt(i);
                        if (r !== s) {
                            n.setAttribute("class", s)
                        }
                    }
                }
            }
            return this
        },
        toggleClass: function (r, t) {
            var o = typeof r,
                a = o === "string" || Array.isArray(r);
            if (typeof t === "boolean" && a) {
                return t ? this.addClass(r) : this.removeClass(r)
            }
            if (y(r)) {
                return this.each(function (e) {
                    T(this).toggleClass(r.call(this, e, mt(this), t), t)
                })
            }
            return this.each(function () {
                var e, t, n, i;
                if (a) {
                    t = 0;
                    n = T(this);
                    i = bt(r);
                    while (e = i[t++]) {
                        if (n.hasClass(e)) {
                            n.removeClass(e)
                        } else {
                            n.addClass(e)
                        }
                    }
                } else if (r === undefined || o === "boolean") {
                    e = mt(this);
                    if (e) {
                        Q.set(this, "__className__", e)
                    }
                    if (this.setAttribute) {
                        this.setAttribute("class", e || r === false ? "" : Q.get(this, "__className__") || "")
                    }
                }
            })
        },
        hasClass: function (e) {
            var t, n, i = 0;
            t = " " + e + " ";
            while (n = this[i++]) {
                if (n.nodeType === 1 && (" " + yt(mt(n)) + " ").indexOf(t) > -1) {
                    return true
                }
            }
            return false
        }
    });
    var wt = /\r/g;
    T.fn.extend({
        val: function (n) {
            var i, e, r, t = this[0];
            if (!arguments.length) {
                if (t) {
                    i = T.valHooks[t.type] || T.valHooks[t.nodeName.toLowerCase()];
                    if (i && "get" in i && (e = i.get(t, "value")) !== undefined) {
                        return e
                    }
                    e = t.value;
                    if (typeof e === "string") {
                        return e.replace(wt, "")
                    }
                    return e == null ? "" : e
                }
                return
            }
            r = y(n);
            return this.each(function (e) {
                var t;
                if (this.nodeType !== 1) {
                    return
                }
                if (r) {
                    t = n.call(this, e, T(this).val())
                } else {
                    t = n
                }
                if (t == null) {
                    t = ""
                } else if (typeof t === "number") {
                    t += ""
                } else if (Array.isArray(t)) {
                    t = T.map(t, function (e) {
                        return e == null ? "" : e + ""
                    })
                }
                i = T.valHooks[this.type] || T.valHooks[this.nodeName.toLowerCase()];
                if (!i || !("set" in i) || i.set(this, t, "value") === undefined) {
                    this.value = t
                }
            })
        }
    });
    T.extend({
        valHooks: {
            option: {
                get: function (e) {
                    var t = T.find.attr(e, "value");
                    return t != null ? t : yt(T.text(e))
                }
            },
            select: {
                get: function (e) {
                    var t, n, i, r = e.options,
                        o = e.selectedIndex,
                        a = e.type === "select-one",
                        s = a ? null : [],
                        l = a ? o + 1 : r.length;
                    if (o < 0) {
                        i = l
                    } else {
                        i = a ? o : 0
                    }
                    for (; i < l; i++) {
                        n = r[i];
                        if ((n.selected || i === o) && !n.disabled && (!n.parentNode.disabled || !C(n.parentNode, "optgroup"))) {
                            t = T(n).val();
                            if (a) {
                                return t
                            }
                            s.push(t)
                        }
                    }
                    return s
                },
                set: function (e, t) {
                    var n, i, r = e.options,
                        o = T.makeArray(t),
                        a = r.length;
                    while (a--) {
                        i = r[a];
                        if (i.selected = T.inArray(T.valHooks.option.get(i), o) > -1) {
                            n = true
                        }
                    }
                    if (!n) {
                        e.selectedIndex = -1
                    }
                    return o
                }
            }
        }
    });
    T.each(["radio", "checkbox"], function () {
        T.valHooks[this] = {
            set: function (e, t) {
                if (Array.isArray(t)) {
                    return e.checked = T.inArray(T(e).val(), t) > -1
                }
            }
        };
        if (!_.checkOn) {
            T.valHooks[this].get = function (e) {
                return e.getAttribute("value") === null ? "on" : e.value
            }
        }
    });
    _.focusin = "onfocusin" in E;
    var xt = /^(?:focusinfocus|focusoutblur)$/,
        Et = function (e) {
            e.stopPropagation()
        };
    T.extend(T.event, {
        trigger: function (e, t, n, i) {
            var r, o, a, s, l, u, c, f, h = [n || k],
                d = g.call(e, "type") ? e.type : e,
                p = g.call(e, "namespace") ? e.namespace.split(".") : [];
            o = f = a = n = n || k;
            if (n.nodeType === 3 || n.nodeType === 8) {
                return
            }
            if (xt.test(d + T.event.triggered)) {
                return
            }
            if (d.indexOf(".") > -1) {
                p = d.split(".");
                d = p.shift();
                p.sort()
            }
            l = d.indexOf(":") < 0 && "on" + d;
            e = e[T.expando] ? e : new T.Event(d, typeof e === "object" && e);
            e.isTrigger = i ? 2 : 3;
            e.namespace = p.join(".");
            e.rnamespace = e.namespace ? new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)") : null;
            e.result = undefined;
            if (!e.target) {
                e.target = n
            }
            t = t == null ? [e] : T.makeArray(t, [e]);
            c = T.event.special[d] || {};
            if (!i && c.trigger && c.trigger.apply(n, t) === false) {
                return
            }
            if (!i && !c.noBubble && !m(n)) {
                s = c.delegateType || d;
                if (!xt.test(s + d)) {
                    o = o.parentNode
                }
                for (; o; o = o.parentNode) {
                    h.push(o);
                    a = o
                }
                if (a === (n.ownerDocument || k)) {
                    h.push(a.defaultView || a.parentWindow || E)
                }
            }
            r = 0;
            while ((o = h[r++]) && !e.isPropagationStopped()) {
                f = o;
                e.type = r > 1 ? s : c.bindType || d;
                u = (Q.get(o, "events") || {})[e.type] && Q.get(o, "handle");
                if (u) {
                    u.apply(o, t)
                }
                u = l && o[l];
                if (u && u.apply && X(o)) {
                    e.result = u.apply(o, t);
                    if (e.result === false) {
                        e.preventDefault()
                    }
                }
            }
            e.type = d;
            if (!i && !e.isDefaultPrevented()) {
                if ((!c._default || c._default.apply(h.pop(), t) === false) && X(n)) {
                    if (l && y(n[d]) && !m(n)) {
                        a = n[l];
                        if (a) {
                            n[l] = null
                        }
                        T.event.triggered = d;
                        if (e.isPropagationStopped()) {
                            f.addEventListener(d, Et)
                        }
                        n[d]();
                        if (e.isPropagationStopped()) {
                            f.removeEventListener(d, Et)
                        }
                        T.event.triggered = undefined;
                        if (a) {
                            n[l] = a
                        }
                    }
                }
            }
            return e.result
        },
        simulate: function (e, t, n) {
            var i = T.extend(new T.Event, n, {
                type: e,
                isSimulated: true
            });
            T.event.trigger(i, null, t)
        }
    });
    T.fn.extend({
        trigger: function (e, t) {
            return this.each(function () {
                T.event.trigger(e, t, this)
            })
        },
        triggerHandler: function (e, t) {
            var n = this[0];
            if (n) {
                return T.event.trigger(e, t, n, true)
            }
        }
    });
    if (!_.focusin) {
        T.each({
            focus: "focusin",
            blur: "focusout"
        }, function (n, i) {
            var r = function (e) {
                T.event.simulate(i, e.target, T.event.fix(e))
            };
            T.event.special[i] = {
                setup: function () {
                    var e = this.ownerDocument || this,
                        t = Q.access(e, i);
                    if (!t) {
                        e.addEventListener(n, r, true)
                    }
                    Q.access(e, i, (t || 0) + 1)
                },
                teardown: function () {
                    var e = this.ownerDocument || this,
                        t = Q.access(e, i) - 1;
                    if (!t) {
                        e.removeEventListener(n, r, true);
                        Q.remove(e, i)
                    } else {
                        Q.access(e, i, t)
                    }
                }
            }
        })
    }
    var kt = E.location;
    var Tt = Date.now();
    var Ot = /\?/;
    T.parseXML = function (e) {
        var t;
        if (!e || typeof e !== "string") {
            return null
        }
        try {
            t = (new E.DOMParser).parseFromString(e, "text/xml")
        } catch (e) {
            t = undefined
        }
        if (!t || t.getElementsByTagName("parsererror").length) {
            T.error("Invalid XML: " + e)
        }
        return t
    };
    var St = /\[\]$/,
        Ct = /\r?\n/g,
        At = /^(?:submit|button|image|reset|file)$/i,
        jt = /^(?:input|select|textarea|keygen)/i;

    function Pt(n, e, i, r) {
        var t;
        if (Array.isArray(e)) {
            T.each(e, function (e, t) {
                if (i || St.test(n)) {
                    r(n, t)
                } else {
                    Pt(n + "[" + (typeof t === "object" && t != null ? e : "") + "]", t, i, r)
                }
            })
        } else if (!i && w(e) === "object") {
            for (t in e) {
                Pt(n + "[" + t + "]", e[t], i, r)
            }
        } else {
            r(n, e)
        }
    }
    T.param = function (e, t) {
        var n, i = [],
            r = function (e, t) {
                var n = y(t) ? t() : t;
                i[i.length] = encodeURIComponent(e) + "=" + encodeURIComponent(n == null ? "" : n)
            };
        if (Array.isArray(e) || e.jquery && !T.isPlainObject(e)) {
            T.each(e, function () {
                r(this.name, this.value)
            })
        } else {
            for (n in e) {
                Pt(n, e[n], t, r)
            }
        }
        return i.join("&")
    };
    T.fn.extend({
        serialize: function () {
            return T.param(this.serializeArray())
        },
        serializeArray: function () {
            return this.map(function () {
                var e = T.prop(this, "elements");
                return e ? T.makeArray(e) : this
            }).filter(function () {
                var e = this.type;
                return this.name && !T(this).is(":disabled") && jt.test(this.nodeName) && !At.test(e) && (this.checked || !de.test(e))
            }).map(function (e, t) {
                var n = T(this).val();
                if (n == null) {
                    return null
                }
                if (Array.isArray(n)) {
                    return T.map(n, function (e) {
                        return {
                            name: t.name,
                            value: e.replace(Ct, "\r\n")
                        }
                    })
                }
                return {
                    name: t.name,
                    value: n.replace(Ct, "\r\n")
                }
            }).get()
        }
    });
    var Dt = /%20/g,
        It = /#.*$/,
        Nt = /([?&])_=[^&]*/,
        Lt = /^(.*?):[ \t]*([^\r\n]*)$/gm,
        Rt = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        Mt = /^(?:GET|HEAD)$/,
        Bt = /^\/\//,
        qt = {},
        $t = {},
        Ut = "*/".concat("*"),
        Vt = k.createElement("a");
    Vt.href = kt.href;

    function Ht(o) {
        return function (e, t) {
            if (typeof e !== "string") {
                t = e;
                e = "*"
            }
            var n, i = 0,
                r = e.toLowerCase().match(M) || [];
            if (y(t)) {
                while (n = r[i++]) {
                    if (n[0] === "+") {
                        n = n.slice(1) || "*";
                        (o[n] = o[n] || []).unshift(t)
                    } else {
                        (o[n] = o[n] || []).push(t)
                    }
                }
            }
        }
    }

    function Ft(t, r, o, a) {
        var s = {},
            l = t === $t;

        function u(e) {
            var i;
            s[e] = true;
            T.each(t[e] || [], function (e, t) {
                var n = t(r, o, a);
                if (typeof n === "string" && !l && !s[n]) {
                    r.dataTypes.unshift(n);
                    u(n);
                    return false
                } else if (l) {
                    return !(i = n)
                }
            });
            return i
        }
        return u(r.dataTypes[0]) || !s["*"] && u("*")
    }

    function Wt(e, t) {
        var n, i, r = T.ajaxSettings.flatOptions || {};
        for (n in t) {
            if (t[n] !== undefined) {
                (r[n] ? e : i || (i = {}))[n] = t[n]
            }
        }
        if (i) {
            T.extend(true, e, i)
        }
        return e
    }

    function zt(e, t, n) {
        var i, r, o, a, s = e.contents,
            l = e.dataTypes;
        while (l[0] === "*") {
            l.shift();
            if (i === undefined) {
                i = e.mimeType || t.getResponseHeader("Content-Type")
            }
        }
        if (i) {
            for (r in s) {
                if (s[r] && s[r].test(i)) {
                    l.unshift(r);
                    break
                }
            }
        }
        if (l[0] in n) {
            o = l[0]
        } else {
            for (r in n) {
                if (!l[0] || e.converters[r + " " + l[0]]) {
                    o = r;
                    break
                }
                if (!a) {
                    a = r
                }
            }
            o = o || a
        }
        if (o) {
            if (o !== l[0]) {
                l.unshift(o)
            }
            return n[o]
        }
    }

    function Yt(e, t, n, i) {
        var r, o, a, s, l, u = {},
            c = e.dataTypes.slice();
        if (c[1]) {
            for (a in e.converters) {
                u[a.toLowerCase()] = e.converters[a]
            }
        }
        o = c.shift();
        while (o) {
            if (e.responseFields[o]) {
                n[e.responseFields[o]] = t
            }
            if (!l && i && e.dataFilter) {
                t = e.dataFilter(t, e.dataType)
            }
            l = o;
            o = c.shift();
            if (o) {
                if (o === "*") {
                    o = l
                } else if (l !== "*" && l !== o) {
                    a = u[l + " " + o] || u["* " + o];
                    if (!a) {
                        for (r in u) {
                            s = r.split(" ");
                            if (s[1] === o) {
                                a = u[l + " " + s[0]] || u["* " + s[0]];
                                if (a) {
                                    if (a === true) {
                                        a = u[r]
                                    } else if (u[r] !== true) {
                                        o = s[0];
                                        c.unshift(s[1])
                                    }
                                    break
                                }
                            }
                        }
                    }
                    if (a !== true) {
                        if (a && e.throws) {
                            t = a(t)
                        } else {
                            try {
                                t = a(t)
                            } catch (e) {
                                return {
                                    state: "parsererror",
                                    error: a ? e : "No conversion from " + l + " to " + o
                                }
                            }
                        }
                    }
                }
            }
        }
        return {
            state: "success",
            data: t
        }
    }
    T.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: kt.href,
            type: "GET",
            isLocal: Rt.test(kt.protocol),
            global: true,
            processData: true,
            async: true,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": Ut,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {
                xml: /\bxml\b/,
                html: /\bhtml/,
                json: /\bjson\b/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText",
                json: "responseJSON"
            },
            converters: {
                "* text": String,
                "text html": true,
                "text json": JSON.parse,
                "text xml": T.parseXML
            },
            flatOptions: {
                url: true,
                context: true
            }
        },
        ajaxSetup: function (e, t) {
            return t ? Wt(Wt(e, T.ajaxSettings), t) : Wt(T.ajaxSettings, e)
        },
        ajaxPrefilter: Ht(qt),
        ajaxTransport: Ht($t),
        ajax: function (e, t) {
            if (typeof e === "object") {
                t = e;
                e = undefined
            }
            t = t || {};
            var c, f, h, n, d, i, p, v, r, o, g = T.ajaxSetup({}, t),
                _ = g.context || g,
                y = g.context && (_.nodeType || _.jquery) ? T(_) : T.event,
                m = T.Deferred(),
                b = T.Callbacks("once memory"),
                w = g.statusCode || {},
                a = {},
                s = {},
                l = "canceled",
                x = {
                    readyState: 0,
                    getResponseHeader: function (e) {
                        var t;
                        if (p) {
                            if (!n) {
                                n = {};
                                while (t = Lt.exec(h)) {
                                    n[t[1].toLowerCase()] = t[2]
                                }
                            }
                            t = n[e.toLowerCase()]
                        }
                        return t == null ? null : t
                    },
                    getAllResponseHeaders: function () {
                        return p ? h : null
                    },
                    setRequestHeader: function (e, t) {
                        if (p == null) {
                            e = s[e.toLowerCase()] = s[e.toLowerCase()] || e;
                            a[e] = t
                        }
                        return this
                    },
                    overrideMimeType: function (e) {
                        if (p == null) {
                            g.mimeType = e
                        }
                        return this
                    },
                    statusCode: function (e) {
                        var t;
                        if (e) {
                            if (p) {
                                x.always(e[x.status])
                            } else {
                                for (t in e) {
                                    w[t] = [w[t], e[t]]
                                }
                            }
                        }
                        return this
                    },
                    abort: function (e) {
                        var t = e || l;
                        if (c) {
                            c.abort(t)
                        }
                        u(0, t);
                        return this
                    }
                };
            m.promise(x);
            g.url = ((e || g.url || kt.href) + "").replace(Bt, kt.protocol + "//");
            g.type = t.method || t.type || g.method || g.type;
            g.dataTypes = (g.dataType || "*").toLowerCase().match(M) || [""];
            if (g.crossDomain == null) {
                i = k.createElement("a");
                try {
                    i.href = g.url;
                    i.href = i.href;
                    g.crossDomain = Vt.protocol + "//" + Vt.host !== i.protocol + "//" + i.host
                } catch (e) {
                    g.crossDomain = true
                }
            }
            if (g.data && g.processData && typeof g.data !== "string") {
                g.data = T.param(g.data, g.traditional)
            }
            Ft(qt, g, t, x);
            if (p) {
                return x
            }
            v = T.event && g.global;
            if (v && T.active++ === 0) {
                T.event.trigger("ajaxStart")
            }
            g.type = g.type.toUpperCase();
            g.hasContent = !Mt.test(g.type);
            f = g.url.replace(It, "");
            if (!g.hasContent) {
                o = g.url.slice(f.length);
                if (g.data && (g.processData || typeof g.data === "string")) {
                    f += (Ot.test(f) ? "&" : "?") + g.data;
                    delete g.data
                }
                if (g.cache === false) {
                    f = f.replace(Nt, "$1");
                    o = (Ot.test(f) ? "&" : "?") + "_=" + Tt++ + o
                }
                g.url = f + o
            } else if (g.data && g.processData && (g.contentType || "").indexOf("application/x-www-form-urlencoded") === 0) {
                g.data = g.data.replace(Dt, "+")
            }
            if (g.ifModified) {
                if (T.lastModified[f]) {
                    x.setRequestHeader("If-Modified-Since", T.lastModified[f])
                }
                if (T.etag[f]) {
                    x.setRequestHeader("If-None-Match", T.etag[f])
                }
            }
            if (g.data && g.hasContent && g.contentType !== false || t.contentType) {
                x.setRequestHeader("Content-Type", g.contentType)
            }
            x.setRequestHeader("Accept", g.dataTypes[0] && g.accepts[g.dataTypes[0]] ? g.accepts[g.dataTypes[0]] + (g.dataTypes[0] !== "*" ? ", " + Ut + "; q=0.01" : "") : g.accepts["*"]);
            for (r in g.headers) {
                x.setRequestHeader(r, g.headers[r])
            }
            if (g.beforeSend && (g.beforeSend.call(_, x, g) === false || p)) {
                return x.abort()
            }
            l = "abort";
            b.add(g.complete);
            x.done(g.success);
            x.fail(g.error);
            c = Ft($t, g, t, x);
            if (!c) {
                u(-1, "No Transport")
            } else {
                x.readyState = 1;
                if (v) {
                    y.trigger("ajaxSend", [x, g])
                }
                if (p) {
                    return x
                }
                if (g.async && g.timeout > 0) {
                    d = E.setTimeout(function () {
                        x.abort("timeout")
                    }, g.timeout)
                }
                try {
                    p = false;
                    c.send(a, u)
                } catch (e) {
                    if (p) {
                        throw e
                    }
                    u(-1, e)
                }
            }

            function u(e, t, n, i) {
                var r, o, a, s, l, u = t;
                if (p) {
                    return
                }
                p = true;
                if (d) {
                    E.clearTimeout(d)
                }
                c = undefined;
                h = i || "";
                x.readyState = e > 0 ? 4 : 0;
                r = e >= 200 && e < 300 || e === 304;
                if (n) {
                    s = zt(g, x, n)
                }
                s = Yt(g, s, x, r);
                if (r) {
                    if (g.ifModified) {
                        l = x.getResponseHeader("Last-Modified");
                        if (l) {
                            T.lastModified[f] = l
                        }
                        l = x.getResponseHeader("etag");
                        if (l) {
                            T.etag[f] = l
                        }
                    }
                    if (e === 204 || g.type === "HEAD") {
                        u = "nocontent"
                    } else if (e === 304) {
                        u = "notmodified"
                    } else {
                        u = s.state;
                        o = s.data;
                        a = s.error;
                        r = !a
                    }
                } else {
                    a = u;
                    if (e || !u) {
                        u = "error";
                        if (e < 0) {
                            e = 0
                        }
                    }
                }
                x.status = e;
                x.statusText = (t || u) + "";
                if (r) {
                    m.resolveWith(_, [o, u, x])
                } else {
                    m.rejectWith(_, [x, u, a])
                }
                x.statusCode(w);
                w = undefined;
                if (v) {
                    y.trigger(r ? "ajaxSuccess" : "ajaxError", [x, g, r ? o : a])
                }
                b.fireWith(_, [x, u]);
                if (v) {
                    y.trigger("ajaxComplete", [x, g]);
                    if (!--T.active) {
                        T.event.trigger("ajaxStop")
                    }
                }
            }
            return x
        },
        getJSON: function (e, t, n) {
            return T.get(e, t, n, "json")
        },
        getScript: function (e, t) {
            return T.get(e, undefined, t, "script")
        }
    });
    T.each(["get", "post"], function (e, r) {
        T[r] = function (e, t, n, i) {
            if (y(t)) {
                i = i || n;
                n = t;
                t = undefined
            }
            return T.ajax(T.extend({
                url: e,
                type: r,
                dataType: i,
                data: t,
                success: n
            }, T.isPlainObject(e) && e))
        }
    });
    T._evalUrl = function (e) {
        return T.ajax({
            url: e,
            type: "GET",
            dataType: "script",
            cache: true,
            async: false,
            global: false,
            throws: true
        })
    };
    T.fn.extend({
        wrapAll: function (e) {
            var t;
            if (this[0]) {
                if (y(e)) {
                    e = e.call(this[0])
                }
                t = T(e, this[0].ownerDocument).eq(0).clone(true);
                if (this[0].parentNode) {
                    t.insertBefore(this[0])
                }
                t.map(function () {
                    var e = this;
                    while (e.firstElementChild) {
                        e = e.firstElementChild
                    }
                    return e
                }).append(this)
            }
            return this
        },
        wrapInner: function (n) {
            if (y(n)) {
                return this.each(function (e) {
                    T(this).wrapInner(n.call(this, e))
                })
            }
            return this.each(function () {
                var e = T(this),
                    t = e.contents();
                if (t.length) {
                    t.wrapAll(n)
                } else {
                    e.append(n)
                }
            })
        },
        wrap: function (t) {
            var n = y(t);
            return this.each(function (e) {
                T(this).wrapAll(n ? t.call(this, e) : t)
            })
        },
        unwrap: function (e) {
            this.parent(e).not("body").each(function () {
                T(this).replaceWith(this.childNodes)
            });
            return this
        }
    });
    T.expr.pseudos.hidden = function (e) {
        return !T.expr.pseudos.visible(e)
    };
    T.expr.pseudos.visible = function (e) {
        return !!(e.offsetWidth || e.offsetHeight || e.getClientRects().length)
    };
    T.ajaxSettings.xhr = function () {
        try {
            return new E.XMLHttpRequest
        } catch (e) {}
    };
    var Gt = {
            0: 200,
            1223: 204
        },
        Kt = T.ajaxSettings.xhr();
    _.cors = !!Kt && "withCredentials" in Kt;
    _.ajax = Kt = !!Kt;
    T.ajaxTransport(function (r) {
        var o, a;
        if (_.cors || Kt && !r.crossDomain) {
            return {
                send: function (e, t) {
                    var n, i = r.xhr();
                    i.open(r.type, r.url, r.async, r.username, r.password);
                    if (r.xhrFields) {
                        for (n in r.xhrFields) {
                            i[n] = r.xhrFields[n]
                        }
                    }
                    if (r.mimeType && i.overrideMimeType) {
                        i.overrideMimeType(r.mimeType)
                    }
                    if (!r.crossDomain && !e["X-Requested-With"]) {
                        e["X-Requested-With"] = "XMLHttpRequest"
                    }
                    for (n in e) {
                        i.setRequestHeader(n, e[n])
                    }
                    o = function (e) {
                        return function () {
                            if (o) {
                                o = a = i.onload = i.onerror = i.onabort = i.ontimeout = i.onreadystatechange = null;
                                if (e === "abort") {
                                    i.abort()
                                } else if (e === "error") {
                                    if (typeof i.status !== "number") {
                                        t(0, "error")
                                    } else {
                                        t(i.status, i.statusText)
                                    }
                                } else {
                                    t(Gt[i.status] || i.status, i.statusText, (i.responseType || "text") !== "text" || typeof i.responseText !== "string" ? {
                                        binary: i.response
                                    } : {
                                        text: i.responseText
                                    }, i.getAllResponseHeaders())
                                }
                            }
                        }
                    };
                    i.onload = o();
                    a = i.onerror = i.ontimeout = o("error");
                    if (i.onabort !== undefined) {
                        i.onabort = a
                    } else {
                        i.onreadystatechange = function () {
                            if (i.readyState === 4) {
                                E.setTimeout(function () {
                                    if (o) {
                                        a()
                                    }
                                })
                            }
                        }
                    }
                    o = o("abort");
                    try {
                        i.send(r.hasContent && r.data || null)
                    } catch (e) {
                        if (o) {
                            throw e
                        }
                    }
                },
                abort: function () {
                    if (o) {
                        o()
                    }
                }
            }
        }
    });
    T.ajaxPrefilter(function (e) {
        if (e.crossDomain) {
            e.contents.script = false
        }
    });
    T.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, " + "application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /\b(?:java|ecma)script\b/
        },
        converters: {
            "text script": function (e) {
                T.globalEval(e);
                return e
            }
        }
    });
    T.ajaxPrefilter("script", function (e) {
        if (e.cache === undefined) {
            e.cache = false
        }
        if (e.crossDomain) {
            e.type = "GET"
        }
    });
    T.ajaxTransport("script", function (n) {
        if (n.crossDomain) {
            var i, r;
            return {
                send: function (e, t) {
                    i = T("<script>").prop({
                        charset: n.scriptCharset,
                        src: n.url
                    }).on("load error", r = function (e) {
                        i.remove();
                        r = null;
                        if (e) {
                            t(e.type === "error" ? 404 : 200, e.type)
                        }
                    });
                    k.head.appendChild(i[0])
                },
                abort: function () {
                    if (r) {
                        r()
                    }
                }
            }
        }
    });
    var Xt = [],
        Zt = /(=)\?(?=&|$)|\?\?/;
    T.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function () {
            var e = Xt.pop() || T.expando + "_" + Tt++;
            this[e] = true;
            return e
        }
    });
    T.ajaxPrefilter("json jsonp", function (e, t, n) {
        var i, r, o, a = e.jsonp !== false && (Zt.test(e.url) ? "url" : typeof e.data === "string" && (e.contentType || "").indexOf("application/x-www-form-urlencoded") === 0 && Zt.test(e.data) && "data");
        if (a || e.dataTypes[0] === "jsonp") {
            i = e.jsonpCallback = y(e.jsonpCallback) ? e.jsonpCallback() : e.jsonpCallback;
            if (a) {
                e[a] = e[a].replace(Zt, "$1" + i)
            } else if (e.jsonp !== false) {
                e.url += (Ot.test(e.url) ? "&" : "?") + e.jsonp + "=" + i
            }
            e.converters["script json"] = function () {
                if (!o) {
                    T.error(i + " was not called")
                }
                return o[0]
            };
            e.dataTypes[0] = "json";
            r = E[i];
            E[i] = function () {
                o = arguments
            };
            n.always(function () {
                if (r === undefined) {
                    T(E).removeProp(i)
                } else {
                    E[i] = r
                }
                if (e[i]) {
                    e.jsonpCallback = t.jsonpCallback;
                    Xt.push(i)
                }
                if (o && y(r)) {
                    r(o[0])
                }
                o = r = undefined
            });
            return "script"
        }
    });
    _.createHTMLDocument = function () {
        var e = k.implementation.createHTMLDocument("").body;
        e.innerHTML = "<form></form><form></form>";
        return e.childNodes.length === 2
    }();
    T.parseHTML = function (e, t, n) {
        if (typeof e !== "string") {
            return []
        }
        if (typeof t === "boolean") {
            n = t;
            t = false
        }
        var i, r, o;
        if (!t) {
            if (_.createHTMLDocument) {
                t = k.implementation.createHTMLDocument("");
                i = t.createElement("base");
                i.href = k.location.href;
                t.head.appendChild(i)
            } else {
                t = k
            }
        }
        r = A.exec(e);
        o = !n && [];
        if (r) {
            return [t.createElement(r[1])]
        }
        r = be([e], t, o);
        if (o && o.length) {
            T(o).remove()
        }
        return T.merge([], r.childNodes)
    };
    T.fn.load = function (e, t, n) {
        var i, r, o, a = this,
            s = e.indexOf(" ");
        if (s > -1) {
            i = yt(e.slice(s));
            e = e.slice(0, s)
        }
        if (y(t)) {
            n = t;
            t = undefined
        } else if (t && typeof t === "object") {
            r = "POST"
        }
        if (a.length > 0) {
            T.ajax({
                url: e,
                type: r || "GET",
                dataType: "html",
                data: t
            }).done(function (e) {
                o = arguments;
                a.html(i ? T("<div>").append(T.parseHTML(e)).find(i) : e)
            }).always(n && function (e, t) {
                a.each(function () {
                    n.apply(this, o || [e.responseText, t, e])
                })
            })
        }
        return this
    };
    T.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (e, t) {
        T.fn[t] = function (e) {
            return this.on(t, e)
        }
    });
    T.expr.pseudos.animated = function (t) {
        return T.grep(T.timers, function (e) {
            return t === e.elem
        }).length
    };
    T.offset = {
        setOffset: function (e, t, n) {
            var i, r, o, a, s, l, u, c = T.css(e, "position"),
                f = T(e),
                h = {};
            if (c === "static") {
                e.style.position = "relative"
            }
            s = f.offset();
            o = T.css(e, "top");
            l = T.css(e, "left");
            u = (c === "absolute" || c === "fixed") && (o + l).indexOf("auto") > -1;
            if (u) {
                i = f.position();
                a = i.top;
                r = i.left
            } else {
                a = parseFloat(o) || 0;
                r = parseFloat(l) || 0
            }
            if (y(t)) {
                t = t.call(e, n, T.extend({}, s))
            }
            if (t.top != null) {
                h.top = t.top - s.top + a
            }
            if (t.left != null) {
                h.left = t.left - s.left + r
            }
            if ("using" in t) {
                t.using.call(e, h)
            } else {
                f.css(h)
            }
        }
    };
    T.fn.extend({
        offset: function (t) {
            if (arguments.length) {
                return t === undefined ? this : this.each(function (e) {
                    T.offset.setOffset(this, t, e)
                })
            }
            var e, n, i = this[0];
            if (!i) {
                return
            }
            if (!i.getClientRects().length) {
                return {
                    top: 0,
                    left: 0
                }
            }
            e = i.getBoundingClientRect();
            n = i.ownerDocument.defaultView;
            return {
                top: e.top + n.pageYOffset,
                left: e.left + n.pageXOffset
            }
        },
        position: function () {
            if (!this[0]) {
                return
            }
            var e, t, n, i = this[0],
                r = {
                    top: 0,
                    left: 0
                };
            if (T.css(i, "position") === "fixed") {
                t = i.getBoundingClientRect()
            } else {
                t = this.offset();
                n = i.ownerDocument;
                e = i.offsetParent || n.documentElement;
                while (e && (e === n.body || e === n.documentElement) && T.css(e, "position") === "static") {
                    e = e.parentNode
                }
                if (e && e !== i && e.nodeType === 1) {
                    r = T(e).offset();
                    r.top += T.css(e, "borderTopWidth", true);
                    r.left += T.css(e, "borderLeftWidth", true)
                }
            }
            return {
                top: t.top - r.top - T.css(i, "marginTop", true),
                left: t.left - r.left - T.css(i, "marginLeft", true)
            }
        },
        offsetParent: function () {
            return this.map(function () {
                var e = this.offsetParent;
                while (e && T.css(e, "position") === "static") {
                    e = e.offsetParent
                }
                return e || we
            })
        }
    });
    T.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function (t, r) {
        var o = "pageYOffset" === r;
        T.fn[t] = function (e) {
            return W(this, function (e, t, n) {
                var i;
                if (m(e)) {
                    i = e
                } else if (e.nodeType === 9) {
                    i = e.defaultView
                }
                if (n === undefined) {
                    return i ? i[r] : e[t]
                }
                if (i) {
                    i.scrollTo(!o ? n : i.pageXOffset, o ? n : i.pageYOffset)
                } else {
                    e[t] = n
                }
            }, t, e, arguments.length)
        }
    });
    T.each(["top", "left"], function (e, n) {
        T.cssHooks[n] = Fe(_.pixelPosition, function (e, t) {
            if (t) {
                t = He(e, n);
                return $e.test(t) ? T(e).position()[n] + "px" : t
            }
        })
    });
    T.each({
        Height: "height",
        Width: "width"
    }, function (a, s) {
        T.each({
            padding: "inner" + a,
            content: s,
            "": "outer" + a
        }, function (i, o) {
            T.fn[o] = function (e, t) {
                var n = arguments.length && (i || typeof e !== "boolean"),
                    r = i || (e === true || t === true ? "margin" : "border");
                return W(this, function (e, t, n) {
                    var i;
                    if (m(e)) {
                        return o.indexOf("outer") === 0 ? e["inner" + a] : e.document.documentElement["client" + a]
                    }
                    if (e.nodeType === 9) {
                        i = e.documentElement;
                        return Math.max(e.body["scroll" + a], i["scroll" + a], e.body["offset" + a], i["offset" + a], i["client" + a])
                    }
                    return n === undefined ? T.css(e, t, r) : T.style(e, t, n, r)
                }, s, n ? e : undefined, n)
            }
        })
    });
    T.each(("blur focus focusin focusout resize scroll click dblclick " + "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " + "change select submit keydown keypress keyup contextmenu").split(" "), function (e, n) {
        T.fn[n] = function (e, t) {
            return arguments.length > 0 ? this.on(n, null, e, t) : this.trigger(n)
        }
    });
    T.fn.extend({
        hover: function (e, t) {
            return this.mouseenter(e).mouseleave(t || e)
        }
    });
    T.fn.extend({
        bind: function (e, t, n) {
            return this.on(e, null, t, n)
        },
        unbind: function (e, t) {
            return this.off(e, null, t)
        },
        delegate: function (e, t, n, i) {
            return this.on(t, e, n, i)
        },
        undelegate: function (e, t, n) {
            return arguments.length === 1 ? this.off(e, "**") : this.off(t, e || "**", n)
        }
    });
    T.proxy = function (e, t) {
        var n, i, r;
        if (typeof t === "string") {
            n = e[t];
            t = e;
            e = n
        }
        if (!y(e)) {
            return undefined
        }
        i = s.call(arguments, 2);
        r = function () {
            return e.apply(t || this, i.concat(s.call(arguments)))
        };
        r.guid = e.guid = e.guid || T.guid++;
        return r
    };
    T.holdReady = function (e) {
        if (e) {
            T.readyWait++
        } else {
            T.ready(true)
        }
    };
    T.isArray = Array.isArray;
    T.parseJSON = JSON.parse;
    T.nodeName = C;
    T.isFunction = y;
    T.isWindow = m;
    T.camelCase = K;
    T.type = w;
    T.now = Date.now;
    T.isNumeric = function (e) {
        var t = T.type(e);
        return (t === "number" || t === "string") && !isNaN(e - parseFloat(e))
    };
    if (typeof define === "function" && define.amd) {
        define("jquery", [], function () {
            return T
        })
    }
    var Qt = E.jQuery,
        Jt = E.$;
    T.noConflict = function (e) {
        if (E.$ === T) {
            E.$ = Jt
        }
        if (e && E.jQuery === T) {
            E.jQuery = Qt
        }
        return T
    };
    if (!e) {
        E.jQuery = E.$ = T
    }
    return T
});
(function () {
    var lc;
    var uc = "4.17.4";
    var cc = 200;
    var fc = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",
        hc = "Expected a function";
    var dc = "__lodash_hash_undefined__";
    var pc = 500;
    var vc = "__lodash_placeholder__";
    var gc = 1,
        _c = 2,
        yc = 4;
    var mc = 1,
        bc = 2;
    var wc = 1,
        xc = 2,
        Ec = 4,
        kc = 8,
        Tc = 16,
        Oc = 32,
        Sc = 64,
        Cc = 128,
        Ac = 256,
        jc = 512;
    var Pc = 30,
        Dc = "...";
    var Ic = 800,
        Nc = 16;
    var Lc = 1,
        Rc = 2,
        Mc = 3;
    var Bc = 1 / 0,
        qc = 9007199254740991,
        $c = 1.7976931348623157e308,
        Uc = 0 / 0;
    var Vc = 4294967295,
        Hc = Vc - 1,
        Fc = Vc >>> 1;
    var Wc = [
        ["ary", Cc],
        ["bind", wc],
        ["bindKey", xc],
        ["curry", kc],
        ["curryRight", Tc],
        ["flip", jc],
        ["partial", Oc],
        ["partialRight", Sc],
        ["rearg", Ac]
    ];
    var zc = "[object Arguments]",
        Yc = "[object Array]",
        Gc = "[object AsyncFunction]",
        Kc = "[object Boolean]",
        Xc = "[object Date]",
        Zc = "[object DOMException]",
        Qc = "[object Error]",
        Jc = "[object Function]",
        ef = "[object GeneratorFunction]",
        tf = "[object Map]",
        nf = "[object Number]",
        rf = "[object Null]",
        of = "[object Object]",
        af = "[object Promise]",
        sf = "[object Proxy]",
        lf = "[object RegExp]",
        uf = "[object Set]",
        cf = "[object String]",
        ff = "[object Symbol]",
        hf = "[object Undefined]",
        df = "[object WeakMap]",
        pf = "[object WeakSet]";
    var vf = "[object ArrayBuffer]",
        gf = "[object DataView]",
        _f = "[object Float32Array]",
        yf = "[object Float64Array]",
        mf = "[object Int8Array]",
        bf = "[object Int16Array]",
        wf = "[object Int32Array]",
        xf = "[object Uint8Array]",
        Ef = "[object Uint8ClampedArray]",
        kf = "[object Uint16Array]",
        Tf = "[object Uint32Array]";
    var Of = /\b__p \+= '';/g,
        Sf = /\b(__p \+=) '' \+/g,
        Cf = /(__e\(.*?\)|\b__t\)) \+\n'';/g;
    var Af = /&(?:amp|lt|gt|quot|#39);/g,
        jf = /[&<>"']/g,
        Pf = RegExp(Af.source),
        Df = RegExp(jf.source);
    var If = /<%-([\s\S]+?)%>/g,
        Nf = /<%([\s\S]+?)%>/g,
        Lf = /<%=([\s\S]+?)%>/g;
    var Rf = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,
        Mf = /^\w*$/,
        Bf = /^\./,
        qf = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;
    var $f = /[\\^$.*+?()[\]{}|]/g,
        Uf = RegExp($f.source);
    var Vf = /^\s+|\s+$/g,
        Hf = /^\s+/,
        Ff = /\s+$/;
    var Wf = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,
        zf = /\{\n\/\* \[wrapped with (.+)\] \*/,
        Yf = /,? & /;
    var t = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;
    var Gf = /\\(\\)?/g;
    var Kf = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;
    var Xf = /\w*$/;
    var Zf = /^[-+]0x[0-9a-f]+$/i;
    var Qf = /^0b[01]+$/i;
    var Jf = /^\[object .+?Constructor\]$/;
    var eh = /^0o[0-7]+$/i;
    var th = /^(?:0|[1-9]\d*)$/;
    var nh = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;
    var ih = /($^)/;
    var rh = /['\n\r\u2028\u2029\\]/g;
    var e = "\\ud800-\\udfff",
        n = "\\u0300-\\u036f",
        i = "\\ufe20-\\ufe2f",
        r = "\\u20d0-\\u20ff",
        o = n + i + r,
        a = "\\u2700-\\u27bf",
        s = "a-z\\xdf-\\xf6\\xf8-\\xff",
        l = "\\xac\\xb1\\xd7\\xf7",
        u = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",
        c = "\\u2000-\\u206f",
        f = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",
        h = "A-Z\\xc0-\\xd6\\xd8-\\xde",
        d = "\\ufe0e\\ufe0f",
        p = l + u + c + f;
    var v = "['’]",
        g = "[" + e + "]",
        _ = "[" + p + "]",
        y = "[" + o + "]",
        m = "\\d+",
        b = "[" + a + "]",
        w = "[" + s + "]",
        x = "[^" + e + p + m + a + s + h + "]",
        E = "\\ud83c[\\udffb-\\udfff]",
        k = "(?:" + y + "|" + E + ")",
        T = "[^" + e + "]",
        O = "(?:\\ud83c[\\udde6-\\uddff]){2}",
        S = "[\\ud800-\\udbff][\\udc00-\\udfff]",
        C = "[" + h + "]",
        A = "\\u200d";
    var j = "(?:" + w + "|" + x + ")",
        P = "(?:" + C + "|" + x + ")",
        D = "(?:" + v + "(?:d|ll|m|re|s|t|ve))?",
        I = "(?:" + v + "(?:D|LL|M|RE|S|T|VE))?",
        N = k + "?",
        L = "[" + d + "]?",
        R = "(?:" + A + "(?:" + [T, O, S].join("|") + ")" + L + N + ")*",
        M = "\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",
        B = "\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",
        q = L + N + R,
        $ = "(?:" + [b, O, S].join("|") + ")" + q,
        U = "(?:" + [T + y + "?", y, O, S, g].join("|") + ")";
    var oh = RegExp(v, "g");
    var ah = RegExp(y, "g");
    var V = RegExp(E + "(?=" + E + ")|" + U + q, "g");
    var H = RegExp([C + "?" + w + "+" + D + "(?=" + [_, C, "$"].join("|") + ")", P + "+" + I + "(?=" + [_, C + j, "$"].join("|") + ")", C + "?" + j + "+" + D, C + "+" + I, B, M, m, $].join("|"), "g");
    var F = RegExp("[" + A + e + o + d + "]");
    var W = /[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;
    var sh = ["Array", "Buffer", "DataView", "Date", "Error", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Math", "Object", "Promise", "RegExp", "Set", "String", "Symbol", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "WeakMap", "_", "clearTimeout", "isFinite", "parseInt", "setTimeout"];
    var lh = -1;
    var uh = {};
    uh[_f] = uh[yf] = uh[mf] = uh[bf] = uh[wf] = uh[xf] = uh[Ef] = uh[kf] = uh[Tf] = true;
    uh[zc] = uh[Yc] = uh[vf] = uh[Kc] = uh[gf] = uh[Xc] = uh[Qc] = uh[Jc] = uh[tf] = uh[nf] = uh[ of ] = uh[lf] = uh[uf] = uh[cf] = uh[df] = false;
    var ch = {};
    ch[zc] = ch[Yc] = ch[vf] = ch[gf] = ch[Kc] = ch[Xc] = ch[_f] = ch[yf] = ch[mf] = ch[bf] = ch[wf] = ch[tf] = ch[nf] = ch[ of ] = ch[lf] = ch[uf] = ch[cf] = ch[ff] = ch[xf] = ch[Ef] = ch[kf] = ch[Tf] = true;
    ch[Qc] = ch[Jc] = ch[df] = false;
    var z = {
        "À": "A",
        "Á": "A",
        "Â": "A",
        "Ã": "A",
        "Ä": "A",
        "Å": "A",
        "à": "a",
        "á": "a",
        "â": "a",
        "ã": "a",
        "ä": "a",
        "å": "a",
        "Ç": "C",
        "ç": "c",
        "Ð": "D",
        "ð": "d",
        "È": "E",
        "É": "E",
        "Ê": "E",
        "Ë": "E",
        "è": "e",
        "é": "e",
        "ê": "e",
        "ë": "e",
        "Ì": "I",
        "Í": "I",
        "Î": "I",
        "Ï": "I",
        "ì": "i",
        "í": "i",
        "î": "i",
        "ï": "i",
        "Ñ": "N",
        "ñ": "n",
        "Ò": "O",
        "Ó": "O",
        "Ô": "O",
        "Õ": "O",
        "Ö": "O",
        "Ø": "O",
        "ò": "o",
        "ó": "o",
        "ô": "o",
        "õ": "o",
        "ö": "o",
        "ø": "o",
        "Ù": "U",
        "Ú": "U",
        "Û": "U",
        "Ü": "U",
        "ù": "u",
        "ú": "u",
        "û": "u",
        "ü": "u",
        "Ý": "Y",
        "ý": "y",
        "ÿ": "y",
        "Æ": "Ae",
        "æ": "ae",
        "Þ": "Th",
        "þ": "th",
        "ß": "ss",
        "Ā": "A",
        "Ă": "A",
        "Ą": "A",
        "ā": "a",
        "ă": "a",
        "ą": "a",
        "Ć": "C",
        "Ĉ": "C",
        "Ċ": "C",
        "Č": "C",
        "ć": "c",
        "ĉ": "c",
        "ċ": "c",
        "č": "c",
        "Ď": "D",
        "Đ": "D",
        "ď": "d",
        "đ": "d",
        "Ē": "E",
        "Ĕ": "E",
        "Ė": "E",
        "Ę": "E",
        "Ě": "E",
        "ē": "e",
        "ĕ": "e",
        "ė": "e",
        "ę": "e",
        "ě": "e",
        "Ĝ": "G",
        "Ğ": "G",
        "Ġ": "G",
        "Ģ": "G",
        "ĝ": "g",
        "ğ": "g",
        "ġ": "g",
        "ģ": "g",
        "Ĥ": "H",
        "Ħ": "H",
        "ĥ": "h",
        "ħ": "h",
        "Ĩ": "I",
        "Ī": "I",
        "Ĭ": "I",
        "Į": "I",
        "İ": "I",
        "ĩ": "i",
        "ī": "i",
        "ĭ": "i",
        "į": "i",
        "ı": "i",
        "Ĵ": "J",
        "ĵ": "j",
        "Ķ": "K",
        "ķ": "k",
        "ĸ": "k",
        "Ĺ": "L",
        "Ļ": "L",
        "Ľ": "L",
        "Ŀ": "L",
        "Ł": "L",
        "ĺ": "l",
        "ļ": "l",
        "ľ": "l",
        "ŀ": "l",
        "ł": "l",
        "Ń": "N",
        "Ņ": "N",
        "Ň": "N",
        "Ŋ": "N",
        "ń": "n",
        "ņ": "n",
        "ň": "n",
        "ŋ": "n",
        "Ō": "O",
        "Ŏ": "O",
        "Ő": "O",
        "ō": "o",
        "ŏ": "o",
        "ő": "o",
        "Ŕ": "R",
        "Ŗ": "R",
        "Ř": "R",
        "ŕ": "r",
        "ŗ": "r",
        "ř": "r",
        "Ś": "S",
        "Ŝ": "S",
        "Ş": "S",
        "Š": "S",
        "ś": "s",
        "ŝ": "s",
        "ş": "s",
        "š": "s",
        "Ţ": "T",
        "Ť": "T",
        "Ŧ": "T",
        "ţ": "t",
        "ť": "t",
        "ŧ": "t",
        "Ũ": "U",
        "Ū": "U",
        "Ŭ": "U",
        "Ů": "U",
        "Ű": "U",
        "Ų": "U",
        "ũ": "u",
        "ū": "u",
        "ŭ": "u",
        "ů": "u",
        "ű": "u",
        "ų": "u",
        "Ŵ": "W",
        "ŵ": "w",
        "Ŷ": "Y",
        "ŷ": "y",
        "Ÿ": "Y",
        "Ź": "Z",
        "Ż": "Z",
        "Ž": "Z",
        "ź": "z",
        "ż": "z",
        "ž": "z",
        "Ĳ": "IJ",
        "ĳ": "ij",
        "Œ": "Oe",
        "œ": "oe",
        "ŉ": "'n",
        "ſ": "s"
    };
    var Y = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
    };
    var G = {
        "&amp;": "&",
        "&lt;": "<",
        "&gt;": ">",
        "&quot;": '"',
        "&#39;": "'"
    };
    var K = {
        "\\": "\\",
        "'": "'",
        "\n": "n",
        "\r": "r",
        "\u2028": "u2028",
        "\u2029": "u2029"
    };
    var fh = parseFloat,
        hh = parseInt;
    var X = typeof global == "object" && global && global.Object === Object && global;
    var Z = typeof self == "object" && self && self.Object === Object && self;
    var dh = X || Z || Function("return this")();
    var Q = typeof exports == "object" && exports && !exports.nodeType && exports;
    var J = Q && typeof module == "object" && module && !module.nodeType && module;
    var ph = J && J.exports === Q;
    var ee = ph && X.process;
    var te = function () {
        try {
            return ee && ee.binding && ee.binding("util")
        } catch (e) {}
    }();
    var vh = te && te.isArrayBuffer,
        gh = te && te.isDate,
        _h = te && te.isMap,
        yh = te && te.isRegExp,
        mh = te && te.isSet,
        bh = te && te.isTypedArray;

    function wh(e, t) {
        e.set(t[0], t[1]);
        return e
    }

    function xh(e, t) {
        e.add(t);
        return e
    }

    function Eh(e, t, n) {
        switch (n.length) {
            case 0:
                return e.call(t);
            case 1:
                return e.call(t, n[0]);
            case 2:
                return e.call(t, n[0], n[1]);
            case 3:
                return e.call(t, n[0], n[1], n[2])
        }
        return e.apply(t, n)
    }

    function kh(e, t, n, i) {
        var r = -1,
            o = e == null ? 0 : e.length;
        while (++r < o) {
            var a = e[r];
            t(i, a, n(a), e)
        }
        return i
    }

    function Th(e, t) {
        var n = -1,
            i = e == null ? 0 : e.length;
        while (++n < i) {
            if (t(e[n], n, e) === false) {
                break
            }
        }
        return e
    }

    function Oh(e, t) {
        var n = e == null ? 0 : e.length;
        while (n--) {
            if (t(e[n], n, e) === false) {
                break
            }
        }
        return e
    }

    function Sh(e, t) {
        var n = -1,
            i = e == null ? 0 : e.length;
        while (++n < i) {
            if (!t(e[n], n, e)) {
                return false
            }
        }
        return true
    }

    function Ch(e, t) {
        var n = -1,
            i = e == null ? 0 : e.length,
            r = 0,
            o = [];
        while (++n < i) {
            var a = e[n];
            if (t(a, n, e)) {
                o[r++] = a
            }
        }
        return o
    }

    function Ah(e, t) {
        var n = e == null ? 0 : e.length;
        return !!n && qh(e, t, 0) > -1
    }

    function jh(e, t, n) {
        var i = -1,
            r = e == null ? 0 : e.length;
        while (++i < r) {
            if (n(t, e[i])) {
                return true
            }
        }
        return false
    }

    function Ph(e, t) {
        var n = -1,
            i = e == null ? 0 : e.length,
            r = Array(i);
        while (++n < i) {
            r[n] = t(e[n], n, e)
        }
        return r
    }

    function Dh(e, t) {
        var n = -1,
            i = t.length,
            r = e.length;
        while (++n < i) {
            e[r + n] = t[n]
        }
        return e
    }

    function Ih(e, t, n, i) {
        var r = -1,
            o = e == null ? 0 : e.length;
        if (i && o) {
            n = e[++r]
        }
        while (++r < o) {
            n = t(n, e[r], r, e)
        }
        return n
    }

    function Nh(e, t, n, i) {
        var r = e == null ? 0 : e.length;
        if (i && r) {
            n = e[--r]
        }
        while (r--) {
            n = t(n, e[r], r, e)
        }
        return n
    }

    function Lh(e, t) {
        var n = -1,
            i = e == null ? 0 : e.length;
        while (++n < i) {
            if (t(e[n], n, e)) {
                return true
            }
        }
        return false
    }
    var ne = Hh("length");

    function ie(e) {
        return e.split("")
    }

    function Rh(e) {
        return e.match(t) || []
    }

    function Mh(e, i, t) {
        var r;
        t(e, function (e, t, n) {
            if (i(e, t, n)) {
                r = t;
                return false
            }
        });
        return r
    }

    function Bh(e, t, n, i) {
        var r = e.length,
            o = n + (i ? 1 : -1);
        while (i ? o-- : ++o < r) {
            if (t(e[o], o, e)) {
                return o
            }
        }
        return -1
    }

    function qh(e, t, n) {
        return t === t ? oe(e, t, n) : Bh(e, Uh, n)
    }

    function $h(e, t, n, i) {
        var r = n - 1,
            o = e.length;
        while (++r < o) {
            if (i(e[r], t)) {
                return r
            }
        }
        return -1
    }

    function Uh(e) {
        return e !== e
    }

    function Vh(e, t) {
        var n = e == null ? 0 : e.length;
        return n ? zh(e, t) / n : Uc
    }

    function Hh(t) {
        return function (e) {
            return e == null ? lc : e[t]
        }
    }

    function re(t) {
        return function (e) {
            return t == null ? lc : t[e]
        }
    }

    function Fh(e, i, r, o, t) {
        t(e, function (e, t, n) {
            r = o ? (o = false,
                e) : i(r, e, t, n)
        });
        return r
    }

    function Wh(e, t) {
        var n = e.length;
        e.sort(t);
        while (n--) {
            e[n] = e[n].value
        }
        return e
    }

    function zh(e, t) {
        var n, i = -1,
            r = e.length;
        while (++i < r) {
            var o = t(e[i]);
            if (o !== lc) {
                n = n === lc ? o : n + o
            }
        }
        return n
    }

    function Yh(e, t) {
        var n = -1,
            i = Array(e);
        while (++n < e) {
            i[n] = t(n)
        }
        return i
    }

    function Gh(t, e) {
        return Ph(e, function (e) {
            return [e, t[e]]
        })
    }

    function Kh(t) {
        return function (e) {
            return t(e)
        }
    }

    function Xh(t, e) {
        return Ph(e, function (e) {
            return t[e]
        })
    }

    function Zh(e, t) {
        return e.has(t)
    }

    function Qh(e, t) {
        var n = -1,
            i = e.length;
        while (++n < i && qh(t, e[n], 0) > -1) {}
        return n
    }

    function Jh(e, t) {
        var n = e.length;
        while (n-- && qh(t, e[n], 0) > -1) {}
        return n
    }

    function ed(e, t) {
        var n = e.length,
            i = 0;
        while (n--) {
            if (e[n] === t) {
                ++i
            }
        }
        return i
    }
    var td = re(z);
    var nd = re(Y);

    function id(e) {
        return "\\" + K[e]
    }

    function rd(e, t) {
        return e == null ? lc : e[t]
    }

    function od(e) {
        return F.test(e)
    }

    function ad(e) {
        return W.test(e)
    }

    function sd(e) {
        var t, n = [];
        while (!(t = e.next()).done) {
            n.push(t.value)
        }
        return n
    }

    function ld(e) {
        var n = -1,
            i = Array(e.size);
        e.forEach(function (e, t) {
            i[++n] = [t, e]
        });
        return i
    }

    function ud(t, n) {
        return function (e) {
            return t(n(e))
        }
    }

    function cd(e, t) {
        var n = -1,
            i = e.length,
            r = 0,
            o = [];
        while (++n < i) {
            var a = e[n];
            if (a === t || a === vc) {
                e[n] = vc;
                o[r++] = n
            }
        }
        return o
    }

    function fd(e) {
        var t = -1,
            n = Array(e.size);
        e.forEach(function (e) {
            n[++t] = e
        });
        return n
    }

    function hd(e) {
        var t = -1,
            n = Array(e.size);
        e.forEach(function (e) {
            n[++t] = [e, e]
        });
        return n
    }

    function oe(e, t, n) {
        var i = n - 1,
            r = e.length;
        while (++i < r) {
            if (e[i] === t) {
                return i
            }
        }
        return -1
    }

    function dd(e, t, n) {
        var i = n + 1;
        while (i--) {
            if (e[i] === t) {
                return i
            }
        }
        return i
    }

    function pd(e) {
        return od(e) ? ae(e) : ne(e)
    }

    function vd(e) {
        return od(e) ? se(e) : ie(e)
    }
    var gd = re(G);

    function ae(e) {
        var t = V.lastIndex = 0;
        while (V.test(e)) {
            ++t
        }
        return t
    }

    function se(e) {
        return e.match(V) || []
    }

    function _d(e) {
        return e.match(H) || []
    }
    var le = function e(t) {
        t = t == null ? dh : yd.defaults(dh.Object(), t, yd.pick(dh, sh));
        var T = t.Array,
            n = t.Date,
            i = t.Error,
            g = t.Function,
            o = t.Math,
            d = t.Object,
            _ = t.RegExp,
            c = t.String,
            x = t.TypeError;
        var a = T.prototype,
            r = g.prototype,
            s = d.prototype;
        var l = t["__core-js_shared__"];
        var u = r.toString;
        var w = s.hasOwnProperty;
        var f = 0;
        var h = function () {
            var e = /[^.]+$/.exec(l && l.keys && l.keys.IE_PROTO || "");
            return e ? "Symbol(src)_1." + e : ""
        }();
        var p = s.toString;
        var v = u.call(d);
        var y = dh._;
        var m = _("^" + u.call(w).replace($f, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$");
        var b = ph ? t.Buffer : lc,
            E = t.Symbol,
            k = t.Uint8Array,
            O = b ? b.allocUnsafe : lc,
            S = ud(d.getPrototypeOf, d),
            C = d.create,
            A = s.propertyIsEnumerable,
            j = a.splice,
            P = E ? E.isConcatSpreadable : lc,
            D = E ? E.iterator : lc,
            I = E ? E.toStringTag : lc;
        var N = function () {
            try {
                var e = qi(d, "defineProperty");
                e({}, "", {});
                return e
            } catch (e) {}
        }();
        var L = t.clearTimeout !== dh.clearTimeout && t.clearTimeout,
            R = n && n.now !== dh.Date.now && n.now,
            M = t.setTimeout !== dh.setTimeout && t.setTimeout;
        var B = o.ceil,
            q = o.floor,
            $ = d.getOwnPropertySymbols,
            U = b ? b.isBuffer : lc,
            V = t.isFinite,
            H = a.join,
            F = ud(d.keys, d),
            W = o.max,
            z = o.min,
            Y = n.now,
            G = t.parseInt,
            K = o.random,
            X = a.reverse;
        var Z = qi(t, "DataView"),
            Q = qi(t, "Map"),
            J = qi(t, "Promise"),
            ee = qi(t, "Set"),
            te = qi(t, "WeakMap"),
            ne = qi(d, "create");
        var ie = te && new te;
        var re = {};
        var oe = Er(Z),
            ae = Er(Q),
            se = Er(J),
            le = Er(ee),
            ue = Er(te);
        var ce = E ? E.prototype : lc,
            fe = ce ? ce.valueOf : lc,
            he = ce ? ce.toString : lc;

        function de(e) {
            if (_s(e) && !es(e) && !(e instanceof _e)) {
                if (e instanceof ge) {
                    return e
                }
                if (w.call(e, "__wrapped__")) {
                    return Tr(e)
                }
            }
            return new ge(e)
        }
        var pe = function () {
            function n() {}
            return function (e) {
                if (!gs(e)) {
                    return {}
                }
                if (C) {
                    return C(e)
                }
                n.prototype = e;
                var t = new n;
                n.prototype = lc;
                return t
            }
        }();

        function ve() {}

        function ge(e, t) {
            this.__wrapped__ = e;
            this.__actions__ = [];
            this.__chain__ = !!t;
            this.__index__ = 0;
            this.__values__ = lc
        }
        de.templateSettings = {
            escape: If,
            evaluate: Nf,
            interpolate: Lf,
            variable: "",
            imports: {
                _: de
            }
        };
        de.prototype = ve.prototype;
        de.prototype.constructor = de;
        ge.prototype = pe(ve.prototype);
        ge.prototype.constructor = ge;

        function _e(e) {
            this.__wrapped__ = e;
            this.__actions__ = [];
            this.__dir__ = 1;
            this.__filtered__ = false;
            this.__iteratees__ = [];
            this.__takeCount__ = Vc;
            this.__views__ = []
        }

        function ye() {
            var e = new _e(this.__wrapped__);
            e.__actions__ = Xn(this.__actions__);
            e.__dir__ = this.__dir__;
            e.__filtered__ = this.__filtered__;
            e.__iteratees__ = Xn(this.__iteratees__);
            e.__takeCount__ = this.__takeCount__;
            e.__views__ = Xn(this.__views__);
            return e
        }

        function me() {
            if (this.__filtered__) {
                var e = new _e(this);
                e.__dir__ = -1;
                e.__filtered__ = true
            } else {
                e = this.clone();
                e.__dir__ *= -1
            }
            return e
        }

        function be() {
            var e = this.__wrapped__.value(),
                t = this.__dir__,
                n = es(e),
                i = t < 0,
                r = n ? e.length : 0,
                o = Fi(0, r, this.__views__),
                a = o.start,
                s = o.end,
                l = s - a,
                u = i ? s : a - 1,
                c = this.__iteratees__,
                f = c.length,
                h = 0,
                d = z(l, this.__takeCount__);
            if (!n || !i && r == l && d == l) {
                return An(e, this.__actions__)
            }
            var p = [];
            e: while (l-- && h < d) {
                u += t;
                var v = -1,
                    g = e[u];
                while (++v < f) {
                    var _ = c[v],
                        y = _.iteratee,
                        m = _.type,
                        b = y(g);
                    if (m == Rc) {
                        g = b
                    } else if (!b) {
                        if (m == Lc) {
                            continue e
                        } else {
                            break e
                        }
                    }
                }
                p[h++] = g
            }
            return p
        }
        _e.prototype = pe(ve.prototype);
        _e.prototype.constructor = _e;

        function we(e) {
            var t = -1,
                n = e == null ? 0 : e.length;
            this.clear();
            while (++t < n) {
                var i = e[t];
                this.set(i[0], i[1])
            }
        }

        function xe() {
            this.__data__ = ne ? ne(null) : {};
            this.size = 0
        }

        function Ee(e) {
            var t = this.has(e) && delete this.__data__[e];
            this.size -= t ? 1 : 0;
            return t
        }

        function ke(e) {
            var t = this.__data__;
            if (ne) {
                var n = t[e];
                return n === dc ? lc : n
            }
            return w.call(t, e) ? t[e] : lc
        }

        function Te(e) {
            var t = this.__data__;
            return ne ? t[e] !== lc : w.call(t, e)
        }

        function Oe(e, t) {
            var n = this.__data__;
            this.size += this.has(e) ? 0 : 1;
            n[e] = ne && t === lc ? dc : t;
            return this
        }
        we.prototype.clear = xe;
        we.prototype["delete"] = Ee;
        we.prototype.get = ke;
        we.prototype.has = Te;
        we.prototype.set = Oe;

        function Se(e) {
            var t = -1,
                n = e == null ? 0 : e.length;
            this.clear();
            while (++t < n) {
                var i = e[t];
                this.set(i[0], i[1])
            }
        }

        function Ce() {
            this.__data__ = [];
            this.size = 0
        }

        function Ae(e) {
            var t = this.__data__,
                n = et(t, e);
            if (n < 0) {
                return false
            }
            var i = t.length - 1;
            if (n == i) {
                t.pop()
            } else {
                j.call(t, n, 1)
            }
            --this.size;
            return true
        }

        function je(e) {
            var t = this.__data__,
                n = et(t, e);
            return n < 0 ? lc : t[n][1]
        }

        function Pe(e) {
            return et(this.__data__, e) > -1
        }

        function De(e, t) {
            var n = this.__data__,
                i = et(n, e);
            if (i < 0) {
                ++this.size;
                n.push([e, t])
            } else {
                n[i][1] = t
            }
            return this
        }
        Se.prototype.clear = Ce;
        Se.prototype["delete"] = Ae;
        Se.prototype.get = je;
        Se.prototype.has = Pe;
        Se.prototype.set = De;

        function Ie(e) {
            var t = -1,
                n = e == null ? 0 : e.length;
            this.clear();
            while (++t < n) {
                var i = e[t];
                this.set(i[0], i[1])
            }
        }

        function Ne() {
            this.size = 0;
            this.__data__ = {
                hash: new we,
                map: new(Q || Se),
                string: new we
            }
        }

        function Le(e) {
            var t = Mi(this, e)["delete"](e);
            this.size -= t ? 1 : 0;
            return t
        }

        function Re(e) {
            return Mi(this, e).get(e)
        }

        function Me(e) {
            return Mi(this, e).has(e)
        }

        function Be(e, t) {
            var n = Mi(this, e),
                i = n.size;
            n.set(e, t);
            this.size += n.size == i ? 0 : 1;
            return this
        }
        Ie.prototype.clear = Ne;
        Ie.prototype["delete"] = Le;
        Ie.prototype.get = Re;
        Ie.prototype.has = Me;
        Ie.prototype.set = Be;

        function qe(e) {
            var t = -1,
                n = e == null ? 0 : e.length;
            this.__data__ = new Ie;
            while (++t < n) {
                this.add(e[t])
            }
        }

        function $e(e) {
            this.__data__.set(e, dc);
            return this
        }

        function Ue(e) {
            return this.__data__.has(e)
        }
        qe.prototype.add = qe.prototype.push = $e;
        qe.prototype.has = Ue;

        function Ve(e) {
            var t = this.__data__ = new Se(e);
            this.size = t.size
        }

        function He() {
            this.__data__ = new Se;
            this.size = 0
        }

        function Fe(e) {
            var t = this.__data__,
                n = t["delete"](e);
            this.size = t.size;
            return n
        }

        function We(e) {
            return this.__data__.get(e)
        }

        function ze(e) {
            return this.__data__.has(e)
        }

        function Ye(e, t) {
            var n = this.__data__;
            if (n instanceof Se) {
                var i = n.__data__;
                if (!Q || i.length < cc - 1) {
                    i.push([e, t]);
                    this.size = ++n.size;
                    return this
                }
                n = this.__data__ = new Ie(i)
            }
            n.set(e, t);
            this.size = n.size;
            return this
        }
        Ve.prototype.clear = He;
        Ve.prototype["delete"] = Fe;
        Ve.prototype.get = We;
        Ve.prototype.has = ze;
        Ve.prototype.set = Ye;

        function Ge(e, t) {
            var n = es(e),
                i = !n && Ja(e),
                r = !n && !i && os(e),
                o = !n && !i && !r && Ds(e),
                a = n || i || r || o,
                s = a ? Yh(e.length, c) : [],
                l = s.length;
            for (var u in e) {
                if ((t || w.call(e, u)) && !(a && (u == "length" || r && (u == "offset" || u == "parent") || o && (u == "buffer" || u == "byteLength" || u == "byteOffset") || Qi(u, l)))) {
                    s.push(u)
                }
            }
            return s
        }

        function Ke(e) {
            var t = e.length;
            return t ? e[ln(0, t - 1)] : lc
        }

        function Xe(e, t) {
            return br(Xn(e), at(t, 0, e.length))
        }

        function Ze(e) {
            return br(Xn(e))
        }

        function Qe(e, t, n) {
            if (n !== lc && !Xa(e[t], n) || n === lc && !(t in e)) {
                rt(e, t, n)
            }
        }

        function Je(e, t, n) {
            var i = e[t];
            if (!(w.call(e, t) && Xa(i, n)) || n === lc && !(t in e)) {
                rt(e, t, n)
            }
        }

        function et(e, t) {
            var n = e.length;
            while (n--) {
                if (Xa(e[n][0], t)) {
                    return n
                }
            }
            return -1
        }

        function tt(e, i, r, o) {
            ht(e, function (e, t, n) {
                i(o, e, r(e), n)
            });
            return o
        }

        function nt(e, t) {
            return e && Zn(t, pl(t), e)
        }

        function it(e, t) {
            return e && Zn(t, vl(t), e)
        }

        function rt(e, t, n) {
            if (t == "__proto__" && N) {
                N(e, t, {
                    configurable: true,
                    enumerable: true,
                    value: n,
                    writable: true
                })
            } else {
                e[t] = n
            }
        }

        function ot(e, t) {
            var n = -1,
                i = t.length,
                r = T(i),
                o = e == null;
            while (++n < i) {
                r[n] = o ? lc : ll(e, t[n])
            }
            return r
        }

        function at(e, t, n) {
            if (e === e) {
                if (n !== lc) {
                    e = e <= n ? e : n
                }
                if (t !== lc) {
                    e = e >= t ? e : t
                }
            }
            return e
        }

        function st(n, i, r, e, t, o) {
            var a, s = i & gc,
                l = i & _c,
                u = i & yc;
            if (r) {
                a = t ? r(n, e, t, o) : r(n)
            }
            if (a !== lc) {
                return a
            }
            if (!gs(n)) {
                return n
            }
            var c = es(n);
            if (c) {
                a = Yi(n);
                if (!s) {
                    return Xn(n, a)
                }
            } else {
                var f = Hi(n),
                    h = f == Jc || f == ef;
                if (os(n)) {
                    return Bn(n, s)
                }
                if (f == of || f == zc || h && !t) {
                    a = l || h ? {} : Gi(n);
                    if (!s) {
                        return l ? Jn(n, it(a, n)) : Qn(n, nt(a, n))
                    }
                } else {
                    if (!ch[f]) {
                        return t ? n : {}
                    }
                    a = Ki(n, f, st, s)
                }
            }
            o || (o = new Ve);
            var d = o.get(n);
            if (d) {
                return d
            }
            o.set(n, a);
            var p = u ? l ? Di : Pi : l ? vl : pl;
            var v = c ? lc : p(n);
            Th(v || n, function (e, t) {
                if (v) {
                    t = e;
                    e = n[t]
                }
                Je(a, t, st(e, i, r, t, n, o))
            });
            return a
        }

        function lt(t) {
            var n = pl(t);
            return function (e) {
                return ut(e, t, n)
            }
        }

        function ut(e, t, n) {
            var i = n.length;
            if (e == null) {
                return !i
            }
            e = d(e);
            while (i--) {
                var r = n[i],
                    o = t[r],
                    a = e[r];
                if (a === lc && !(r in e) || !o(a)) {
                    return false
                }
            }
            return true
        }

        function ct(e, t, n) {
            if (typeof e != "function") {
                throw new x(hc)
            }
            return gr(function () {
                e.apply(lc, n)
            }, t)
        }

        function ft(e, t, n, i) {
            var r = -1,
                o = Ah,
                a = true,
                s = e.length,
                l = [],
                u = t.length;
            if (!s) {
                return l
            }
            if (n) {
                t = Ph(t, Kh(n))
            }
            if (i) {
                o = jh;
                a = false
            } else if (t.length >= cc) {
                o = Zh;
                a = false;
                t = new qe(t)
            }
            e: while (++r < s) {
                var c = e[r],
                    f = n == null ? c : n(c);
                c = i || c !== 0 ? c : 0;
                if (a && f === f) {
                    var h = u;
                    while (h--) {
                        if (t[h] === f) {
                            continue e
                        }
                    }
                    l.push(c)
                } else if (!o(t, f, i)) {
                    l.push(c)
                }
            }
            return l
        }
        var ht = ni(wt);
        var dt = ni(xt, true);

        function pt(e, i) {
            var r = true;
            ht(e, function (e, t, n) {
                r = !!i(e, t, n);
                return r
            });
            return r
        }

        function vt(e, t, n) {
            var i = -1,
                r = e.length;
            while (++i < r) {
                var o = e[i],
                    a = t(o);
                if (a != null && (s === lc ? a === a && !Ps(a) : n(a, s))) {
                    var s = a,
                        l = o
                }
            }
            return l
        }

        function gt(e, t, n, i) {
            var r = e.length;
            n = $s(n);
            if (n < 0) {
                n = -n > r ? 0 : r + n
            }
            i = i === lc || i > r ? r : $s(i);
            if (i < 0) {
                i += r
            }
            i = n > i ? 0 : Us(i);
            while (n < i) {
                e[n++] = t
            }
            return e
        }

        function _t(e, i) {
            var r = [];
            ht(e, function (e, t, n) {
                if (i(e, t, n)) {
                    r.push(e)
                }
            });
            return r
        }

        function yt(e, t, n, i, r) {
            var o = -1,
                a = e.length;
            n || (n = Zi);
            r || (r = []);
            while (++o < a) {
                var s = e[o];
                if (t > 0 && n(s)) {
                    if (t > 1) {
                        yt(s, t - 1, n, i, r)
                    } else {
                        Dh(r, s)
                    }
                } else if (!i) {
                    r[r.length] = s
                }
            }
            return r
        }
        var mt = ii();
        var bt = ii(true);

        function wt(e, t) {
            return e && mt(e, t, pl)
        }

        function xt(e, t) {
            return e && bt(e, t, pl)
        }

        function Et(t, e) {
            return Ch(e, function (e) {
                return ds(t[e])
            })
        }

        function kt(e, t) {
            t = Nn(t, e);
            var n = 0,
                i = t.length;
            while (e != null && n < i) {
                e = e[xr(t[n++])]
            }
            return n && n == i ? e : lc
        }

        function Tt(e, t, n) {
            var i = t(e);
            return es(e) ? i : Dh(i, n(e))
        }

        function Ot(e) {
            if (e == null) {
                return e === lc ? hf : rf
            }
            return I && I in d(e) ? $i(e) : fr(e)
        }

        function St(e, t) {
            return e > t
        }

        function Ct(e, t) {
            return e != null && w.call(e, t)
        }

        function At(e, t) {
            return e != null && t in d(e)
        }

        function jt(e, t, n) {
            return e >= z(t, n) && e < W(t, n)
        }

        function Pt(e, t, n) {
            var i = n ? jh : Ah,
                r = e[0].length,
                o = e.length,
                a = o,
                s = T(o),
                l = Infinity,
                u = [];
            while (a--) {
                var c = e[a];
                if (a && t) {
                    c = Ph(c, Kh(t))
                }
                l = z(c.length, l);
                s[a] = !n && (t || r >= 120 && c.length >= 120) ? new qe(a && c) : lc
            }
            c = e[0];
            var f = -1,
                h = s[0];
            e: while (++f < r && u.length < l) {
                var d = c[f],
                    p = t ? t(d) : d;
                d = n || d !== 0 ? d : 0;
                if (!(h ? Zh(h, p) : i(u, p, n))) {
                    a = o;
                    while (--a) {
                        var v = s[a];
                        if (!(v ? Zh(v, p) : i(e[a], p, n))) {
                            continue e
                        }
                    }
                    if (h) {
                        h.push(p)
                    }
                    u.push(d)
                }
            }
            return u
        }

        function Dt(e, i, r, o) {
            wt(e, function (e, t, n) {
                i(o, r(e), t, n)
            });
            return o
        }

        function It(e, t, n) {
            t = Nn(t, e);
            e = dr(e, t);
            var i = e == null ? e : e[xr(Xr(t))];
            return i == null ? lc : Eh(i, e, n)
        }

        function Nt(e) {
            return _s(e) && Ot(e) == zc
        }

        function Lt(e) {
            return _s(e) && Ot(e) == vf
        }

        function Rt(e) {
            return _s(e) && Ot(e) == Xc
        }

        function Mt(e, t, n, i, r) {
            if (e === t) {
                return true
            }
            if (e == null || t == null || !_s(e) && !_s(t)) {
                return e !== e && t !== t
            }
            return Bt(e, t, n, i, Mt, r)
        }

        function Bt(e, t, n, i, r, o) {
            var a = es(e),
                s = es(t),
                l = a ? Yc : Hi(e),
                u = s ? Yc : Hi(t);
            l = l == zc ? of : l;
            u = u == zc ? of : u;
            var c = l == of ,
                f = u == of ,
                h = l == u;
            if (h && os(e)) {
                if (!os(t)) {
                    return false
                }
                a = true;
                c = false
            }
            if (h && !c) {
                o || (o = new Ve);
                return a || Ds(e) ? Si(e, t, n, i, r, o) : Ci(e, t, l, n, i, r, o)
            }
            if (!(n & mc)) {
                var d = c && w.call(e, "__wrapped__"),
                    p = f && w.call(t, "__wrapped__");
                if (d || p) {
                    var v = d ? e.value() : e,
                        g = p ? t.value() : t;
                    o || (o = new Ve);
                    return r(v, g, n, i, o)
                }
            }
            if (!h) {
                return false
            }
            o || (o = new Ve);
            return Ai(e, t, n, i, r, o)
        }

        function qt(e) {
            return _s(e) && Hi(e) == tf
        }

        function $t(e, t, n, i) {
            var r = n.length,
                o = r,
                a = !i;
            if (e == null) {
                return !o
            }
            e = d(e);
            while (r--) {
                var s = n[r];
                if (a && s[2] ? s[1] !== e[s[0]] : !(s[0] in e)) {
                    return false
                }
            }
            while (++r < o) {
                s = n[r];
                var l = s[0],
                    u = e[l],
                    c = s[1];
                if (a && s[2]) {
                    if (u === lc && !(l in e)) {
                        return false
                    }
                } else {
                    var f = new Ve;
                    if (i) {
                        var h = i(u, c, l, e, t, f)
                    }
                    if (!(h === lc ? Mt(c, u, mc | bc, i, f) : h)) {
                        return false
                    }
                }
            }
            return true
        }

        function Ut(e) {
            if (!gs(e) || ir(e)) {
                return false
            }
            var t = ds(e) ? m : Jf;
            return t.test(Er(e))
        }

        function Vt(e) {
            return _s(e) && Ot(e) == lf
        }

        function Ht(e) {
            return _s(e) && Hi(e) == uf
        }

        function Ft(e) {
            return _s(e) && vs(e.length) && !!uh[Ot(e)]
        }

        function Wt(e) {
            if (typeof e == "function") {
                return e
            }
            if (e == null) {
                return xu
            }
            if (typeof e == "object") {
                return es(e) ? Zt(e[0], e[1]) : Xt(e)
            }
            return Lu(e)
        }

        function zt(e) {
            if (!or(e)) {
                return F(e)
            }
            var t = [];
            for (var n in d(e)) {
                if (w.call(e, n) && n != "constructor") {
                    t.push(n)
                }
            }
            return t
        }

        function Yt(e) {
            if (!gs(e)) {
                return cr(e)
            }
            var t = or(e),
                n = [];
            for (var i in e) {
                if (!(i == "constructor" && (t || !w.call(e, i)))) {
                    n.push(i)
                }
            }
            return n
        }

        function Gt(e, t) {
            return e < t
        }

        function Kt(e, i) {
            var r = -1,
                o = ns(e) ? T(e.length) : [];
            ht(e, function (e, t, n) {
                o[++r] = i(e, t, n)
            });
            return o
        }

        function Xt(t) {
            var n = Bi(t);
            if (n.length == 1 && n[0][2]) {
                return sr(n[0][0], n[0][1])
            }
            return function (e) {
                return e === t || $t(e, t, n)
            }
        }

        function Zt(n, i) {
            if (er(n) && ar(i)) {
                return sr(xr(n), i)
            }
            return function (e) {
                var t = ll(e, n);
                return t === lc && t === i ? cl(e, n) : Mt(i, t, mc | bc)
            }
        }

        function Qt(i, r, o, a, s) {
            if (i === r) {
                return
            }
            mt(r, function (e, t) {
                if (gs(e)) {
                    s || (s = new Ve);
                    Jt(i, r, t, o, Qt, a, s)
                } else {
                    var n = a ? a(i[t], e, t + "", i, r, s) : lc;
                    if (n === lc) {
                        n = e
                    }
                    Qe(i, t, n)
                }
            }, vl)
        }

        function Jt(e, t, n, i, r, o, a) {
            var s = e[n],
                l = t[n],
                u = a.get(l);
            if (u) {
                Qe(e, n, u);
                return
            }
            var c = o ? o(s, l, n + "", e, t, a) : lc;
            var f = c === lc;
            if (f) {
                var h = es(l),
                    d = !h && os(l),
                    p = !h && !d && Ds(l);
                c = l;
                if (h || d || p) {
                    if (es(s)) {
                        c = s
                    } else if (is(s)) {
                        c = Xn(s)
                    } else if (d) {
                        f = false;
                        c = Bn(l, true)
                    } else if (p) {
                        f = false;
                        c = Wn(l, true)
                    } else {
                        c = []
                    }
                } else if (Os(l) || Ja(l)) {
                    c = s;
                    if (Ja(s)) {
                        c = Hs(s)
                    } else if (!gs(s) || i && ds(s)) {
                        c = Gi(l)
                    }
                } else {
                    f = false
                }
            }
            if (f) {
                a.set(l, c);
                r(c, l, i, o, a);
                a["delete"](l)
            }
            Qe(e, n, c)
        }

        function en(e, t) {
            var n = e.length;
            if (!n) {
                return
            }
            t += t < 0 ? n : 0;
            return Qi(t, n) ? e[t] : lc
        }

        function tn(e, r, n) {
            var o = -1;
            r = Ph(r.length ? r : [xu], Kh(Ri()));
            var t = Kt(e, function (t, e, n) {
                var i = Ph(r, function (e) {
                    return e(t)
                });
                return {
                    criteria: i,
                    index: ++o,
                    value: t
                }
            });
            return Wh(t, function (e, t) {
                return Yn(e, t, n)
            })
        }

        function nn(n, e) {
            return rn(n, e, function (e, t) {
                return cl(n, t)
            })
        }

        function rn(e, t, n) {
            var i = -1,
                r = t.length,
                o = {};
            while (++i < r) {
                var a = t[i],
                    s = kt(e, a);
                if (n(s, a)) {
                    pn(o, Nn(a, e), s)
                }
            }
            return o
        }

        function on(t) {
            return function (e) {
                return kt(e, t)
            }
        }

        function an(e, t, n, i) {
            var r = i ? $h : qh,
                o = -1,
                a = t.length,
                s = e;
            if (e === t) {
                t = Xn(t)
            }
            if (n) {
                s = Ph(e, Kh(n))
            }
            while (++o < a) {
                var l = 0,
                    u = t[o],
                    c = n ? n(u) : u;
                while ((l = r(s, c, l, i)) > -1) {
                    if (s !== e) {
                        j.call(s, l, 1)
                    }
                    j.call(e, l, 1)
                }
            }
            return e
        }

        function sn(e, t) {
            var n = e ? t.length : 0,
                i = n - 1;
            while (n--) {
                var r = t[n];
                if (n == i || r !== o) {
                    var o = r;
                    if (Qi(r)) {
                        j.call(e, r, 1)
                    } else {
                        On(e, r)
                    }
                }
            }
            return e
        }

        function ln(e, t) {
            return e + q(K() * (t - e + 1))
        }

        function un(e, t, n, i) {
            var r = -1,
                o = W(B((t - e) / (n || 1)), 0),
                a = T(o);
            while (o--) {
                a[i ? o : ++r] = e;
                e += n
            }
            return a
        }

        function cn(e, t) {
            var n = "";
            if (!e || t < 1 || t > qc) {
                return n
            }
            do {
                if (t % 2) {
                    n += e
                }
                t = q(t / 2);
                if (t) {
                    e += e
                }
            } while (t);
            return n
        }

        function fn(e, t) {
            return _r(hr(e, t, xu), e + "")
        }

        function hn(e) {
            return Ke(Il(e))
        }

        function dn(e, t) {
            var n = Il(e);
            return br(n, at(t, 0, n.length))
        }

        function pn(e, t, n, i) {
            if (!gs(e)) {
                return e
            }
            t = Nn(t, e);
            var r = -1,
                o = t.length,
                a = o - 1,
                s = e;
            while (s != null && ++r < o) {
                var l = xr(t[r]),
                    u = n;
                if (r != a) {
                    var c = s[l];
                    u = i ? i(c, l, s) : lc;
                    if (u === lc) {
                        u = gs(c) ? c : Qi(t[r + 1]) ? [] : {}
                    }
                }
                Je(s, l, u);
                s = s[l]
            }
            return e
        }
        var vn = !ie ? xu : function (e, t) {
            ie.set(e, t);
            return e
        };
        var gn = !N ? xu : function (e, t) {
            return N(e, "toString", {
                configurable: true,
                enumerable: false,
                value: yu(t),
                writable: true
            })
        };

        function _n(e) {
            return br(Il(e))
        }

        function yn(e, t, n) {
            var i = -1,
                r = e.length;
            if (t < 0) {
                t = -t > r ? 0 : r + t
            }
            n = n > r ? r : n;
            if (n < 0) {
                n += r
            }
            r = t > n ? 0 : n - t >>> 0;
            t >>>= 0;
            var o = T(r);
            while (++i < r) {
                o[i] = e[i + t]
            }
            return o
        }

        function mn(e, i) {
            var r;
            ht(e, function (e, t, n) {
                r = i(e, t, n);
                return !r
            });
            return !!r
        }

        function bn(e, t, n) {
            var i = 0,
                r = e == null ? i : e.length;
            if (typeof t == "number" && t === t && r <= Fc) {
                while (i < r) {
                    var o = i + r >>> 1,
                        a = e[o];
                    if (a !== null && !Ps(a) && (n ? a <= t : a < t)) {
                        i = o + 1
                    } else {
                        r = o
                    }
                }
                return r
            }
            return wn(e, t, xu, n)
        }

        function wn(e, t, n, i) {
            t = n(t);
            var r = 0,
                o = e == null ? 0 : e.length,
                a = t !== t,
                s = t === null,
                l = Ps(t),
                u = t === lc;
            while (r < o) {
                var c = q((r + o) / 2),
                    f = n(e[c]),
                    h = f !== lc,
                    d = f === null,
                    p = f === f,
                    v = Ps(f);
                if (a) {
                    var g = i || p
                } else if (u) {
                    g = p && (i || h)
                } else if (s) {
                    g = p && h && (i || !d)
                } else if (l) {
                    g = p && h && !d && (i || !v)
                } else if (d || v) {
                    g = false
                } else {
                    g = i ? f <= t : f < t
                }
                if (g) {
                    r = c + 1
                } else {
                    o = c
                }
            }
            return z(o, Hc)
        }

        function xn(e, t) {
            var n = -1,
                i = e.length,
                r = 0,
                o = [];
            while (++n < i) {
                var a = e[n],
                    s = t ? t(a) : a;
                if (!n || !Xa(s, l)) {
                    var l = s;
                    o[r++] = a === 0 ? 0 : a
                }
            }
            return o
        }

        function En(e) {
            if (typeof e == "number") {
                return e
            }
            if (Ps(e)) {
                return Uc
            }
            return +e
        }

        function kn(e) {
            if (typeof e == "string") {
                return e
            }
            if (es(e)) {
                return Ph(e, kn) + ""
            }
            if (Ps(e)) {
                return he ? he.call(e) : ""
            }
            var t = e + "";
            return t == "0" && 1 / e == -Bc ? "-0" : t
        }

        function Tn(e, t, n) {
            var i = -1,
                r = Ah,
                o = e.length,
                a = true,
                s = [],
                l = s;
            if (n) {
                a = false;
                r = jh
            } else if (o >= cc) {
                var u = t ? null : wi(e);
                if (u) {
                    return fd(u)
                }
                a = false;
                r = Zh;
                l = new qe
            } else {
                l = t ? [] : s
            }
            e: while (++i < o) {
                var c = e[i],
                    f = t ? t(c) : c;
                c = n || c !== 0 ? c : 0;
                if (a && f === f) {
                    var h = l.length;
                    while (h--) {
                        if (l[h] === f) {
                            continue e
                        }
                    }
                    if (t) {
                        l.push(f)
                    }
                    s.push(c)
                } else if (!r(l, f, n)) {
                    if (l !== s) {
                        l.push(f)
                    }
                    s.push(c)
                }
            }
            return s
        }

        function On(e, t) {
            t = Nn(t, e);
            e = dr(e, t);
            return e == null || delete e[xr(Xr(t))]
        }

        function Sn(e, t, n, i) {
            return pn(e, t, n(kt(e, t)), i)
        }

        function Cn(e, t, n, i) {
            var r = e.length,
                o = i ? r : -1;
            while ((i ? o-- : ++o < r) && t(e[o], o, e)) {}
            return n ? yn(e, i ? 0 : o, i ? o + 1 : r) : yn(e, i ? o + 1 : 0, i ? r : o)
        }

        function An(e, t) {
            var n = e;
            if (n instanceof _e) {
                n = n.value()
            }
            return Ih(t, function (e, t) {
                return t.func.apply(t.thisArg, Dh([e], t.args))
            }, n)
        }

        function jn(e, t, n) {
            var i = e.length;
            if (i < 2) {
                return i ? Tn(e[0]) : []
            }
            var r = -1,
                o = T(i);
            while (++r < i) {
                var a = e[r],
                    s = -1;
                while (++s < i) {
                    if (s != r) {
                        o[r] = ft(o[r] || a, e[s], t, n)
                    }
                }
            }
            return Tn(yt(o, 1), t, n)
        }

        function Pn(e, t, n) {
            var i = -1,
                r = e.length,
                o = t.length,
                a = {};
            while (++i < r) {
                var s = i < o ? t[i] : lc;
                n(a, e[i], s)
            }
            return a
        }

        function Dn(e) {
            return is(e) ? e : []
        }

        function In(e) {
            return typeof e == "function" ? e : xu
        }

        function Nn(e, t) {
            if (es(e)) {
                return e
            }
            return er(e, t) ? [e] : wr(Ws(e))
        }
        var Ln = fn;

        function Rn(e, t, n) {
            var i = e.length;
            n = n === lc ? i : n;
            return !t && n >= i ? e : yn(e, t, n)
        }
        var Mn = L || function (e) {
            return dh.clearTimeout(e)
        };

        function Bn(e, t) {
            if (t) {
                return e.slice()
            }
            var n = e.length,
                i = O ? O(n) : new e.constructor(n);
            e.copy(i);
            return i
        }

        function qn(e) {
            var t = new e.constructor(e.byteLength);
            new k(t).set(new k(e));
            return t
        }

        function $n(e, t) {
            var n = t ? qn(e.buffer) : e.buffer;
            return new e.constructor(n, e.byteOffset, e.byteLength)
        }

        function Un(e, t, n) {
            var i = t ? n(ld(e), gc) : ld(e);
            return Ih(i, wh, new e.constructor)
        }

        function Vn(e) {
            var t = new e.constructor(e.source, Xf.exec(e));
            t.lastIndex = e.lastIndex;
            return t
        }

        function Hn(e, t, n) {
            var i = t ? n(fd(e), gc) : fd(e);
            return Ih(i, xh, new e.constructor)
        }

        function Fn(e) {
            return fe ? d(fe.call(e)) : {}
        }

        function Wn(e, t) {
            var n = t ? qn(e.buffer) : e.buffer;
            return new e.constructor(n, e.byteOffset, e.length)
        }

        function zn(e, t) {
            if (e !== t) {
                var n = e !== lc,
                    i = e === null,
                    r = e === e,
                    o = Ps(e);
                var a = t !== lc,
                    s = t === null,
                    l = t === t,
                    u = Ps(t);
                if (!s && !u && !o && e > t || o && a && l && !s && !u || i && a && l || !n && l || !r) {
                    return 1
                }
                if (!i && !o && !u && e < t || u && n && r && !i && !o || s && n && r || !a && r || !l) {
                    return -1
                }
            }
            return 0
        }

        function Yn(e, t, n) {
            var i = -1,
                r = e.criteria,
                o = t.criteria,
                a = r.length,
                s = n.length;
            while (++i < a) {
                var l = zn(r[i], o[i]);
                if (l) {
                    if (i >= s) {
                        return l
                    }
                    var u = n[i];
                    return l * (u == "desc" ? -1 : 1)
                }
            }
            return e.index - t.index
        }

        function Gn(e, t, n, i) {
            var r = -1,
                o = e.length,
                a = n.length,
                s = -1,
                l = t.length,
                u = W(o - a, 0),
                c = T(l + u),
                f = !i;
            while (++s < l) {
                c[s] = t[s]
            }
            while (++r < a) {
                if (f || r < o) {
                    c[n[r]] = e[r]
                }
            }
            while (u--) {
                c[s++] = e[r++]
            }
            return c
        }

        function Kn(e, t, n, i) {
            var r = -1,
                o = e.length,
                a = -1,
                s = n.length,
                l = -1,
                u = t.length,
                c = W(o - s, 0),
                f = T(c + u),
                h = !i;
            while (++r < c) {
                f[r] = e[r]
            }
            var d = r;
            while (++l < u) {
                f[d + l] = t[l]
            }
            while (++a < s) {
                if (h || r < o) {
                    f[d + n[a]] = e[r++]
                }
            }
            return f
        }

        function Xn(e, t) {
            var n = -1,
                i = e.length;
            t || (t = T(i));
            while (++n < i) {
                t[n] = e[n]
            }
            return t
        }

        function Zn(e, t, n, i) {
            var r = !n;
            n || (n = {});
            var o = -1,
                a = t.length;
            while (++o < a) {
                var s = t[o];
                var l = i ? i(n[s], e[s], s, n, e) : lc;
                if (l === lc) {
                    l = e[s]
                }
                if (r) {
                    rt(n, s, l)
                } else {
                    Je(n, s, l)
                }
            }
            return n
        }

        function Qn(e, t) {
            return Zn(e, Ui(e), t)
        }

        function Jn(e, t) {
            return Zn(e, Vi(e), t)
        }

        function ei(r, o) {
            return function (e, t) {
                var n = es(e) ? kh : tt,
                    i = o ? o() : {};
                return n(e, r, Ri(t, 2), i)
            }
        }

        function ti(s) {
            return fn(function (e, t) {
                var n = -1,
                    i = t.length,
                    r = i > 1 ? t[i - 1] : lc,
                    o = i > 2 ? t[2] : lc;
                r = s.length > 3 && typeof r == "function" ? (i--,
                    r) : lc;
                if (o && Ji(t[0], t[1], o)) {
                    r = i < 3 ? lc : r;
                    i = 1
                }
                e = d(e);
                while (++n < i) {
                    var a = t[n];
                    if (a) {
                        s(e, a, n, r)
                    }
                }
                return e
            })
        }

        function ni(o, a) {
            return function (e, t) {
                if (e == null) {
                    return e
                }
                if (!ns(e)) {
                    return o(e, t)
                }
                var n = e.length,
                    i = a ? n : -1,
                    r = d(e);
                while (a ? i-- : ++i < n) {
                    if (t(r[i], i, r) === false) {
                        break
                    }
                }
                return e
            }
        }

        function ii(l) {
            return function (e, t, n) {
                var i = -1,
                    r = d(e),
                    o = n(e),
                    a = o.length;
                while (a--) {
                    var s = o[l ? a : ++i];
                    if (t(r[s], s, r) === false) {
                        break
                    }
                }
                return e
            }
        }

        function ri(t, e, n) {
            var i = e & wc,
                r = si(t);

            function o() {
                var e = this && this !== dh && this instanceof o ? r : t;
                return e.apply(i ? n : this, arguments)
            }
            return o
        }

        function oi(r) {
            return function (e) {
                e = Ws(e);
                var t = od(e) ? vd(e) : lc;
                var n = t ? t[0] : e.charAt(0);
                var i = t ? Rn(t, 1).join("") : e.slice(1);
                return n[r]() + i
            }
        }

        function ai(t) {
            return function (e) {
                return Ih(du($l(e).replace(oh, "")), t, "")
            }
        }

        function si(i) {
            return function () {
                var e = arguments;
                switch (e.length) {
                    case 0:
                        return new i;
                    case 1:
                        return new i(e[0]);
                    case 2:
                        return new i(e[0], e[1]);
                    case 3:
                        return new i(e[0], e[1], e[2]);
                    case 4:
                        return new i(e[0], e[1], e[2], e[3]);
                    case 5:
                        return new i(e[0], e[1], e[2], e[3], e[4]);
                    case 6:
                        return new i(e[0], e[1], e[2], e[3], e[4], e[5]);
                    case 7:
                        return new i(e[0], e[1], e[2], e[3], e[4], e[5], e[6])
                }
                var t = pe(i.prototype),
                    n = i.apply(t, e);
                return gs(n) ? n : t
            }
        }

        function li(a, s, l) {
            var u = si(a);

            function c() {
                var e = arguments.length,
                    t = T(e),
                    n = e,
                    i = Li(c);
                while (n--) {
                    t[n] = arguments[n]
                }
                var r = e < 3 && t[0] !== i && t[e - 1] !== i ? [] : cd(t, i);
                e -= r.length;
                if (e < l) {
                    return mi(a, s, fi, c.placeholder, lc, t, r, lc, lc, l - e)
                }
                var o = this && this !== dh && this instanceof c ? u : a;
                return Eh(o, this, t)
            }
            return c
        }

        function ui(a) {
            return function (e, t, n) {
                var i = d(e);
                if (!ns(e)) {
                    var r = Ri(t, 3);
                    e = pl(e);
                    t = function (e) {
                        return r(i[e], e, i)
                    }
                }
                var o = a(e, t, n);
                return o > -1 ? i[r ? e[o] : o] : lc
            }
        }

        function ci(l) {
            return ji(function (r) {
                var o = r.length,
                    e = o,
                    t = ge.prototype.thru;
                if (l) {
                    r.reverse()
                }
                while (e--) {
                    var n = r[e];
                    if (typeof n != "function") {
                        throw new x(hc)
                    }
                    if (t && !a && Ni(n) == "wrapper") {
                        var a = new ge([], true)
                    }
                }
                e = a ? e : o;
                while (++e < o) {
                    n = r[e];
                    var i = Ni(n),
                        s = i == "wrapper" ? Ii(n) : lc;
                    if (s && nr(s[0]) && s[1] == (Cc | kc | Oc | Ac) && !s[4].length && s[9] == 1) {
                        a = a[Ni(s[0])].apply(a, s[3])
                    } else {
                        a = n.length == 1 && nr(n) ? a[i]() : a.thru(n)
                    }
                }
                return function () {
                    var e = arguments,
                        t = e[0];
                    if (a && e.length == 1 && es(t)) {
                        return a.plant(t).value()
                    }
                    var n = 0,
                        i = o ? r[n].apply(this, e) : t;
                    while (++n < o) {
                        i = r[n].call(this, i)
                    }
                    return i
                }
            })
        }

        function fi(l, u, c, f, h, d, p, v, g, _) {
            var y = u & Cc,
                m = u & wc,
                b = u & xc,
                w = u & (kc | Tc),
                x = u & jc,
                E = b ? lc : si(l);

            function k() {
                var e = arguments.length,
                    t = T(e),
                    n = e;
                while (n--) {
                    t[n] = arguments[n]
                }
                if (w) {
                    var i = Li(k),
                        r = ed(t, i)
                }
                if (f) {
                    t = Gn(t, f, h, w)
                }
                if (d) {
                    t = Kn(t, d, p, w)
                }
                e -= r;
                if (w && e < _) {
                    var o = cd(t, i);
                    return mi(l, u, fi, k.placeholder, c, t, o, v, g, _ - e)
                }
                var a = m ? c : this,
                    s = b ? a[l] : l;
                e = t.length;
                if (v) {
                    t = pr(t, v)
                } else if (x && e > 1) {
                    t.reverse()
                }
                if (y && g < e) {
                    t.length = g
                }
                if (this && this !== dh && this instanceof k) {
                    s = E || si(s)
                }
                return s.apply(a, t)
            }
            return k
        }

        function hi(n, i) {
            return function (e, t) {
                return Dt(e, n, i(t), {})
            }
        }

        function di(i, r) {
            return function (e, t) {
                var n;
                if (e === lc && t === lc) {
                    return r
                }
                if (e !== lc) {
                    n = e
                }
                if (t !== lc) {
                    if (n === lc) {
                        return t
                    }
                    if (typeof e == "string" || typeof t == "string") {
                        e = kn(e);
                        t = kn(t)
                    } else {
                        e = En(e);
                        t = En(t)
                    }
                    n = i(e, t)
                }
                return n
            }
        }

        function pi(i) {
            return ji(function (e) {
                e = Ph(e, Kh(Ri()));
                return fn(function (t) {
                    var n = this;
                    return i(e, function (e) {
                        return Eh(e, n, t)
                    })
                })
            })
        }

        function vi(e, t) {
            t = t === lc ? " " : kn(t);
            var n = t.length;
            if (n < 2) {
                return n ? cn(t, e) : t
            }
            var i = cn(t, B(e / pd(t)));
            return od(t) ? Rn(vd(i), 0, e).join("") : i.slice(0, e)
        }

        function gi(a, e, s, l) {
            var u = e & wc,
                c = si(a);

            function f() {
                var e = -1,
                    t = arguments.length,
                    n = -1,
                    i = l.length,
                    r = T(i + t),
                    o = this && this !== dh && this instanceof f ? c : a;
                while (++n < i) {
                    r[n] = l[n]
                }
                while (t--) {
                    r[n++] = arguments[++e]
                }
                return Eh(o, u ? s : this, r)
            }
            return f
        }

        function _i(i) {
            return function (e, t, n) {
                if (n && typeof n != "number" && Ji(e, t, n)) {
                    t = n = lc
                }
                e = qs(e);
                if (t === lc) {
                    t = e;
                    e = 0
                } else {
                    t = qs(t)
                }
                n = n === lc ? e < t ? 1 : -1 : qs(n);
                return un(e, t, n, i)
            }
        }

        function yi(n) {
            return function (e, t) {
                if (!(typeof e == "string" && typeof t == "string")) {
                    e = Vs(e);
                    t = Vs(t)
                }
                return n(e, t)
            }
        }

        function mi(e, t, n, i, r, o, a, s, l, u) {
            var c = t & kc,
                f = c ? a : lc,
                h = c ? lc : a,
                d = c ? o : lc,
                p = c ? lc : o;
            t |= c ? Oc : Sc;
            t &= ~(c ? Sc : Oc);
            if (!(t & Ec)) {
                t &= ~(wc | xc)
            }
            var v = [e, t, r, d, f, p, h, s, l, u];
            var g = n.apply(lc, v);
            if (nr(e)) {
                vr(g, v)
            }
            g.placeholder = i;
            return yr(g, e, t)
        }

        function bi(e) {
            var r = o[e];
            return function (e, t) {
                e = Vs(e);
                t = t == null ? 0 : z($s(t), 292);
                if (t) {
                    var n = (Ws(e) + "e").split("e"),
                        i = r(n[0] + "e" + (+n[1] + t));
                    n = (Ws(i) + "e").split("e");
                    return +(n[0] + "e" + (+n[1] - t))
                }
                return r(e)
            }
        }
        var wi = !(ee && 1 / fd(new ee([, -0]))[1] == Bc) ? ju : function (e) {
            return new ee(e)
        };

        function xi(n) {
            return function (e) {
                var t = Hi(e);
                if (t == tf) {
                    return ld(e)
                }
                if (t == uf) {
                    return hd(e)
                }
                return Gh(e, n(e))
            }
        }

        function Ei(e, t, n, i, r, o, a, s) {
            var l = t & xc;
            if (!l && typeof e != "function") {
                throw new x(hc)
            }
            var u = i ? i.length : 0;
            if (!u) {
                t &= ~(Oc | Sc);
                i = r = lc
            }
            a = a === lc ? a : W($s(a), 0);
            s = s === lc ? s : $s(s);
            u -= r ? r.length : 0;
            if (t & Sc) {
                var c = i,
                    f = r;
                i = r = lc
            }
            var h = l ? lc : Ii(e);
            var d = [e, t, n, i, r, c, f, o, a, s];
            if (h) {
                ur(d, h)
            }
            e = d[0];
            t = d[1];
            n = d[2];
            i = d[3];
            r = d[4];
            s = d[9] = d[9] === lc ? l ? 0 : e.length : W(d[9] - u, 0);
            if (!s && t & (kc | Tc)) {
                t &= ~(kc | Tc)
            }
            if (!t || t == wc) {
                var p = ri(e, t, n)
            } else if (t == kc || t == Tc) {
                p = li(e, t, s)
            } else if ((t == Oc || t == (wc | Oc)) && !r.length) {
                p = gi(e, t, n, i)
            } else {
                p = fi.apply(lc, d)
            }
            var v = h ? vn : vr;
            return yr(v(p, d), e, t)
        }

        function ki(e, t, n, i) {
            if (e === lc || Xa(e, s[n]) && !w.call(i, n)) {
                return t
            }
            return e
        }

        function Ti(e, t, n, i, r, o) {
            if (gs(e) && gs(t)) {
                o.set(t, e);
                Qt(e, t, lc, Ti, o);
                o["delete"](t)
            }
            return e
        }

        function Oi(e) {
            return Os(e) ? lc : e
        }

        function Si(e, t, n, i, r, o) {
            var a = n & mc,
                s = e.length,
                l = t.length;
            if (s != l && !(a && l > s)) {
                return false
            }
            var u = o.get(e);
            if (u && o.get(t)) {
                return u == t
            }
            var c = -1,
                f = true,
                h = n & bc ? new qe : lc;
            o.set(e, t);
            o.set(t, e);
            while (++c < s) {
                var d = e[c],
                    p = t[c];
                if (i) {
                    var v = a ? i(p, d, c, t, e, o) : i(d, p, c, e, t, o)
                }
                if (v !== lc) {
                    if (v) {
                        continue
                    }
                    f = false;
                    break
                }
                if (h) {
                    if (!Lh(t, function (e, t) {
                            if (!Zh(h, t) && (d === e || r(d, e, n, i, o))) {
                                return h.push(t)
                            }
                        })) {
                        f = false;
                        break
                    }
                } else if (!(d === p || r(d, p, n, i, o))) {
                    f = false;
                    break
                }
            }
            o["delete"](e);
            o["delete"](t);
            return f
        }

        function Ci(e, t, n, i, r, o, a) {
            switch (n) {
                case gf:
                    if (e.byteLength != t.byteLength || e.byteOffset != t.byteOffset) {
                        return false
                    }
                    e = e.buffer;
                    t = t.buffer;
                case vf:
                    if (e.byteLength != t.byteLength || !o(new k(e), new k(t))) {
                        return false
                    }
                    return true;
                case Kc:
                case Xc:
                case nf:
                    return Xa(+e, +t);
                case Qc:
                    return e.name == t.name && e.message == t.message;
                case lf:
                case cf:
                    return e == t + "";
                case tf:
                    var s = ld;
                case uf:
                    var l = i & mc;
                    s || (s = fd);
                    if (e.size != t.size && !l) {
                        return false
                    }
                    var u = a.get(e);
                    if (u) {
                        return u == t
                    }
                    i |= bc;
                    a.set(e, t);
                    var c = Si(s(e), s(t), i, r, o, a);
                    a["delete"](e);
                    return c;
                case ff:
                    if (fe) {
                        return fe.call(e) == fe.call(t)
                    }
            }
            return false
        }

        function Ai(e, t, n, i, r, o) {
            var a = n & mc,
                s = Pi(e),
                l = s.length,
                u = Pi(t),
                c = u.length;
            if (l != c && !a) {
                return false
            }
            var f = l;
            while (f--) {
                var h = s[f];
                if (!(a ? h in t : w.call(t, h))) {
                    return false
                }
            }
            var d = o.get(e);
            if (d && o.get(t)) {
                return d == t
            }
            var p = true;
            o.set(e, t);
            o.set(t, e);
            var v = a;
            while (++f < l) {
                h = s[f];
                var g = e[h],
                    _ = t[h];
                if (i) {
                    var y = a ? i(_, g, h, t, e, o) : i(g, _, h, e, t, o)
                }
                if (!(y === lc ? g === _ || r(g, _, n, i, o) : y)) {
                    p = false;
                    break
                }
                v || (v = h == "constructor")
            }
            if (p && !v) {
                var m = e.constructor,
                    b = t.constructor;
                if (m != b && ("constructor" in e && "constructor" in t) && !(typeof m == "function" && m instanceof m && typeof b == "function" && b instanceof b)) {
                    p = false
                }
            }
            o["delete"](e);
            o["delete"](t);
            return p
        }

        function ji(e) {
            return _r(hr(e, lc, qr), e + "")
        }

        function Pi(e) {
            return Tt(e, pl, Ui)
        }

        function Di(e) {
            return Tt(e, vl, Vi)
        }
        var Ii = !ie ? ju : function (e) {
            return ie.get(e)
        };

        function Ni(e) {
            var t = e.name + "",
                n = re[t],
                i = w.call(re, t) ? n.length : 0;
            while (i--) {
                var r = n[i],
                    o = r.func;
                if (o == null || o == e) {
                    return r.name
                }
            }
            return t
        }

        function Li(e) {
            var t = w.call(de, "placeholder") ? de : e;
            return t.placeholder
        }

        function Ri() {
            var e = de.iteratee || Eu;
            e = e === Eu ? Wt : e;
            return arguments.length ? e(arguments[0], arguments[1]) : e
        }

        function Mi(e, t) {
            var n = e.__data__;
            return tr(t) ? n[typeof t == "string" ? "string" : "hash"] : n.map
        }

        function Bi(e) {
            var t = pl(e),
                n = t.length;
            while (n--) {
                var i = t[n],
                    r = e[i];
                t[n] = [i, r, ar(r)]
            }
            return t
        }

        function qi(e, t) {
            var n = rd(e, t);
            return Ut(n) ? n : lc
        }

        function $i(e) {
            var t = w.call(e, I),
                n = e[I];
            try {
                e[I] = lc;
                var i = true
            } catch (e) {}
            var r = p.call(e);
            if (i) {
                if (t) {
                    e[I] = n
                } else {
                    delete e[I]
                }
            }
            return r
        }
        var Ui = !$ ? qu : function (t) {
            if (t == null) {
                return []
            }
            t = d(t);
            return Ch($(t), function (e) {
                return A.call(t, e)
            })
        };
        var Vi = !$ ? qu : function (e) {
            var t = [];
            while (e) {
                Dh(t, Ui(e));
                e = S(e)
            }
            return t
        };
        var Hi = Ot;
        if (Z && Hi(new Z(new ArrayBuffer(1))) != gf || Q && Hi(new Q) != tf || J && Hi(J.resolve()) != af || ee && Hi(new ee) != uf || te && Hi(new te) != df) {
            Hi = function (e) {
                var t = Ot(e),
                    n = t == of ? e.constructor : lc,
                    i = n ? Er(n) : "";
                if (i) {
                    switch (i) {
                        case oe:
                            return gf;
                        case ae:
                            return tf;
                        case se:
                            return af;
                        case le:
                            return uf;
                        case ue:
                            return df
                    }
                }
                return t
            }
        }

        function Fi(e, t, n) {
            var i = -1,
                r = n.length;
            while (++i < r) {
                var o = n[i],
                    a = o.size;
                switch (o.type) {
                    case "drop":
                        e += a;
                        break;
                    case "dropRight":
                        t -= a;
                        break;
                    case "take":
                        t = z(t, e + a);
                        break;
                    case "takeRight":
                        e = W(e, t - a);
                        break
                }
            }
            return {
                start: e,
                end: t
            }
        }

        function Wi(e) {
            var t = e.match(zf);
            return t ? t[1].split(Yf) : []
        }

        function zi(e, t, n) {
            t = Nn(t, e);
            var i = -1,
                r = t.length,
                o = false;
            while (++i < r) {
                var a = xr(t[i]);
                if (!(o = e != null && n(e, a))) {
                    break
                }
                e = e[a]
            }
            if (o || ++i != r) {
                return o
            }
            r = e == null ? 0 : e.length;
            return !!r && vs(r) && Qi(a, r) && (es(e) || Ja(e))
        }

        function Yi(e) {
            var t = e.length,
                n = e.constructor(t);
            if (t && typeof e[0] == "string" && w.call(e, "index")) {
                n.index = e.index;
                n.input = e.input
            }
            return n
        }

        function Gi(e) {
            return typeof e.constructor == "function" && !or(e) ? pe(S(e)) : {}
        }

        function Ki(e, t, n, i) {
            var r = e.constructor;
            switch (t) {
                case vf:
                    return qn(e);
                case Kc:
                case Xc:
                    return new r(+e);
                case gf:
                    return $n(e, i);
                case _f:
                case yf:
                case mf:
                case bf:
                case wf:
                case xf:
                case Ef:
                case kf:
                case Tf:
                    return Wn(e, i);
                case tf:
                    return Un(e, i, n);
                case nf:
                case cf:
                    return new r(e);
                case lf:
                    return Vn(e);
                case uf:
                    return Hn(e, i, n);
                case ff:
                    return Fn(e)
            }
        }

        function Xi(e, t) {
            var n = t.length;
            if (!n) {
                return e
            }
            var i = n - 1;
            t[i] = (n > 1 ? "& " : "") + t[i];
            t = t.join(n > 2 ? ", " : " ");
            return e.replace(Wf, "{\n/* [wrapped with " + t + "] */\n")
        }

        function Zi(e) {
            return es(e) || Ja(e) || !!(P && e && e[P])
        }

        function Qi(e, t) {
            t = t == null ? qc : t;
            return !!t && (typeof e == "number" || th.test(e)) && (e > -1 && e % 1 == 0 && e < t)
        }

        function Ji(e, t, n) {
            if (!gs(n)) {
                return false
            }
            var i = typeof t;
            if (i == "number" ? ns(n) && Qi(t, n.length) : i == "string" && t in n) {
                return Xa(n[t], e)
            }
            return false
        }

        function er(e, t) {
            if (es(e)) {
                return false
            }
            var n = typeof e;
            if (n == "number" || n == "symbol" || n == "boolean" || e == null || Ps(e)) {
                return true
            }
            return Mf.test(e) || !Rf.test(e) || t != null && e in d(t)
        }

        function tr(e) {
            var t = typeof e;
            return t == "string" || t == "number" || t == "symbol" || t == "boolean" ? e !== "__proto__" : e === null
        }

        function nr(e) {
            var t = Ni(e),
                n = de[t];
            if (typeof n != "function" || !(t in _e.prototype)) {
                return false
            }
            if (e === n) {
                return true
            }
            var i = Ii(n);
            return !!i && e === i[0]
        }

        function ir(e) {
            return !!h && h in e
        }
        var rr = l ? ds : $u;

        function or(e) {
            var t = e && e.constructor,
                n = typeof t == "function" && t.prototype || s;
            return e === n
        }

        function ar(e) {
            return e === e && !gs(e)
        }

        function sr(t, n) {
            return function (e) {
                if (e == null) {
                    return false
                }
                return e[t] === n && (n !== lc || t in d(e))
            }
        }

        function lr(e) {
            var t = Da(e, function (e) {
                if (n.size === pc) {
                    n.clear()
                }
                return e
            });
            var n = t.cache;
            return t
        }

        function ur(e, t) {
            var n = e[1],
                i = t[1],
                r = n | i,
                o = r < (wc | xc | Cc);
            var a = i == Cc && n == kc || i == Cc && n == Ac && e[7].length <= t[8] || i == (Cc | Ac) && t[7].length <= t[8] && n == kc;
            if (!(o || a)) {
                return e
            }
            if (i & wc) {
                e[2] = t[2];
                r |= n & wc ? 0 : Ec
            }
            var s = t[3];
            if (s) {
                var l = e[3];
                e[3] = l ? Gn(l, s, t[4]) : s;
                e[4] = l ? cd(e[3], vc) : t[4]
            }
            s = t[5];
            if (s) {
                l = e[5];
                e[5] = l ? Kn(l, s, t[6]) : s;
                e[6] = l ? cd(e[5], vc) : t[6]
            }
            s = t[7];
            if (s) {
                e[7] = s
            }
            if (i & Cc) {
                e[8] = e[8] == null ? t[8] : z(e[8], t[8])
            }
            if (e[9] == null) {
                e[9] = t[9]
            }
            e[0] = t[0];
            e[1] = r;
            return e
        }

        function cr(e) {
            var t = [];
            if (e != null) {
                for (var n in d(e)) {
                    t.push(n)
                }
            }
            return t
        }

        function fr(e) {
            return p.call(e)
        }

        function hr(o, a, s) {
            a = W(a === lc ? o.length - 1 : a, 0);
            return function () {
                var e = arguments,
                    t = -1,
                    n = W(e.length - a, 0),
                    i = T(n);
                while (++t < n) {
                    i[t] = e[a + t]
                }
                t = -1;
                var r = T(a + 1);
                while (++t < a) {
                    r[t] = e[t]
                }
                r[a] = s(i);
                return Eh(o, this, r)
            }
        }

        function dr(e, t) {
            return t.length < 2 ? e : kt(e, yn(t, 0, -1))
        }

        function pr(e, t) {
            var n = e.length,
                i = z(t.length, n),
                r = Xn(e);
            while (i--) {
                var o = t[i];
                e[i] = Qi(o, n) ? r[o] : lc
            }
            return e
        }
        var vr = mr(vn);
        var gr = M || function (e, t) {
            return dh.setTimeout(e, t)
        };
        var _r = mr(gn);

        function yr(e, t, n) {
            var i = t + "";
            return _r(e, Xi(i, kr(Wi(i), n)))
        }

        function mr(n) {
            var i = 0,
                r = 0;
            return function () {
                var e = Y(),
                    t = Nc - (e - r);
                r = e;
                if (t > 0) {
                    if (++i >= Ic) {
                        return arguments[0]
                    }
                } else {
                    i = 0
                }
                return n.apply(lc, arguments)
            }
        }

        function br(e, t) {
            var n = -1,
                i = e.length,
                r = i - 1;
            t = t === lc ? i : t;
            while (++n < t) {
                var o = ln(n, r),
                    a = e[o];
                e[o] = e[n];
                e[n] = a
            }
            e.length = t;
            return e
        }
        var wr = lr(function (e) {
            var r = [];
            if (Bf.test(e)) {
                r.push("")
            }
            e.replace(qf, function (e, t, n, i) {
                r.push(n ? i.replace(Gf, "$1") : t || e)
            });
            return r
        });

        function xr(e) {
            if (typeof e == "string" || Ps(e)) {
                return e
            }
            var t = e + "";
            return t == "0" && 1 / e == -Bc ? "-0" : t
        }

        function Er(e) {
            if (e != null) {
                try {
                    return u.call(e)
                } catch (e) {}
                try {
                    return e + ""
                } catch (e) {}
            }
            return ""
        }

        function kr(n, i) {
            Th(Wc, function (e) {
                var t = "_." + e[0];
                if (i & e[1] && !Ah(n, t)) {
                    n.push(t)
                }
            });
            return n.sort()
        }

        function Tr(e) {
            if (e instanceof _e) {
                return e.clone()
            }
            var t = new ge(e.__wrapped__, e.__chain__);
            t.__actions__ = Xn(e.__actions__);
            t.__index__ = e.__index__;
            t.__values__ = e.__values__;
            return t
        }

        function Or(e, t, n) {
            if (n ? Ji(e, t, n) : t === lc) {
                t = 1
            } else {
                t = W($s(t), 0)
            }
            var i = e == null ? 0 : e.length;
            if (!i || t < 1) {
                return []
            }
            var r = 0,
                o = 0,
                a = T(B(i / t));
            while (r < i) {
                a[o++] = yn(e, r, r += t)
            }
            return a
        }

        function Sr(e) {
            var t = -1,
                n = e == null ? 0 : e.length,
                i = 0,
                r = [];
            while (++t < n) {
                var o = e[t];
                if (o) {
                    r[i++] = o
                }
            }
            return r
        }

        function Cr() {
            var e = arguments.length;
            if (!e) {
                return []
            }
            var t = T(e - 1),
                n = arguments[0],
                i = e;
            while (i--) {
                t[i - 1] = arguments[i]
            }
            return Dh(es(n) ? Xn(n) : [n], yt(t, 1))
        }
        var Ar = fn(function (e, t) {
            return is(e) ? ft(e, yt(t, 1, is, true)) : []
        });
        var jr = fn(function (e, t) {
            var n = Xr(t);
            if (is(n)) {
                n = lc
            }
            return is(e) ? ft(e, yt(t, 1, is, true), Ri(n, 2)) : []
        });
        var Pr = fn(function (e, t) {
            var n = Xr(t);
            if (is(n)) {
                n = lc
            }
            return is(e) ? ft(e, yt(t, 1, is, true), lc, n) : []
        });

        function Dr(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return []
            }
            t = n || t === lc ? 1 : $s(t);
            return yn(e, t < 0 ? 0 : t, i)
        }

        function Ir(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return []
            }
            t = n || t === lc ? 1 : $s(t);
            t = i - t;
            return yn(e, 0, t < 0 ? 0 : t)
        }

        function Nr(e, t) {
            return e && e.length ? Cn(e, Ri(t, 3), true, true) : []
        }

        function Lr(e, t) {
            return e && e.length ? Cn(e, Ri(t, 3), true) : []
        }

        function Rr(e, t, n, i) {
            var r = e == null ? 0 : e.length;
            if (!r) {
                return []
            }
            if (n && typeof n != "number" && Ji(e, t, n)) {
                n = 0;
                i = r
            }
            return gt(e, t, n, i)
        }

        function Mr(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return -1
            }
            var r = n == null ? 0 : $s(n);
            if (r < 0) {
                r = W(i + r, 0)
            }
            return Bh(e, Ri(t, 3), r)
        }

        function Br(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return -1
            }
            var r = i - 1;
            if (n !== lc) {
                r = $s(n);
                r = n < 0 ? W(i + r, 0) : z(r, i - 1)
            }
            return Bh(e, Ri(t, 3), r, true)
        }

        function qr(e) {
            var t = e == null ? 0 : e.length;
            return t ? yt(e, 1) : []
        }

        function $r(e) {
            var t = e == null ? 0 : e.length;
            return t ? yt(e, Bc) : []
        }

        function Ur(e, t) {
            var n = e == null ? 0 : e.length;
            if (!n) {
                return []
            }
            t = t === lc ? 1 : $s(t);
            return yt(e, t)
        }

        function Vr(e) {
            var t = -1,
                n = e == null ? 0 : e.length,
                i = {};
            while (++t < n) {
                var r = e[t];
                i[r[0]] = r[1]
            }
            return i
        }

        function Hr(e) {
            return e && e.length ? e[0] : lc
        }

        function Fr(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return -1
            }
            var r = n == null ? 0 : $s(n);
            if (r < 0) {
                r = W(i + r, 0)
            }
            return qh(e, t, r)
        }

        function Wr(e) {
            var t = e == null ? 0 : e.length;
            return t ? yn(e, 0, -1) : []
        }
        var zr = fn(function (e) {
            var t = Ph(e, Dn);
            return t.length && t[0] === e[0] ? Pt(t) : []
        });
        var Yr = fn(function (e) {
            var t = Xr(e),
                n = Ph(e, Dn);
            if (t === Xr(n)) {
                t = lc
            } else {
                n.pop()
            }
            return n.length && n[0] === e[0] ? Pt(n, Ri(t, 2)) : []
        });
        var Gr = fn(function (e) {
            var t = Xr(e),
                n = Ph(e, Dn);
            t = typeof t == "function" ? t : lc;
            if (t) {
                n.pop()
            }
            return n.length && n[0] === e[0] ? Pt(n, lc, t) : []
        });

        function Kr(e, t) {
            return e == null ? "" : H.call(e, t)
        }

        function Xr(e) {
            var t = e == null ? 0 : e.length;
            return t ? e[t - 1] : lc
        }

        function Zr(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return -1
            }
            var r = i;
            if (n !== lc) {
                r = $s(n);
                r = r < 0 ? W(i + r, 0) : z(r, i - 1)
            }
            return t === t ? dd(e, t, r) : Bh(e, Uh, r, true)
        }

        function Qr(e, t) {
            return e && e.length ? en(e, $s(t)) : lc
        }
        var Jr = fn(eo);

        function eo(e, t) {
            return e && e.length && t && t.length ? an(e, t) : e
        }

        function to(e, t, n) {
            return e && e.length && t && t.length ? an(e, t, Ri(n, 2)) : e
        }

        function no(e, t, n) {
            return e && e.length && t && t.length ? an(e, t, lc, n) : e
        }
        var io = ji(function (e, t) {
            var n = e == null ? 0 : e.length,
                i = ot(e, t);
            sn(e, Ph(t, function (e) {
                return Qi(e, n) ? +e : e
            }).sort(zn));
            return i
        });

        function ro(e, t) {
            var n = [];
            if (!(e && e.length)) {
                return n
            }
            var i = -1,
                r = [],
                o = e.length;
            t = Ri(t, 3);
            while (++i < o) {
                var a = e[i];
                if (t(a, i, e)) {
                    n.push(a);
                    r.push(i)
                }
            }
            sn(e, r);
            return n
        }

        function oo(e) {
            return e == null ? e : X.call(e)
        }

        function ao(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return []
            }
            if (n && typeof n != "number" && Ji(e, t, n)) {
                t = 0;
                n = i
            } else {
                t = t == null ? 0 : $s(t);
                n = n === lc ? i : $s(n)
            }
            return yn(e, t, n)
        }

        function so(e, t) {
            return bn(e, t)
        }

        function lo(e, t, n) {
            return wn(e, t, Ri(n, 2))
        }

        function uo(e, t) {
            var n = e == null ? 0 : e.length;
            if (n) {
                var i = bn(e, t);
                if (i < n && Xa(e[i], t)) {
                    return i
                }
            }
            return -1
        }

        function co(e, t) {
            return bn(e, t, true)
        }

        function fo(e, t, n) {
            return wn(e, t, Ri(n, 2), true)
        }

        function ho(e, t) {
            var n = e == null ? 0 : e.length;
            if (n) {
                var i = bn(e, t, true) - 1;
                if (Xa(e[i], t)) {
                    return i
                }
            }
            return -1
        }

        function po(e) {
            return e && e.length ? xn(e) : []
        }

        function vo(e, t) {
            return e && e.length ? xn(e, Ri(t, 2)) : []
        }

        function go(e) {
            var t = e == null ? 0 : e.length;
            return t ? yn(e, 1, t) : []
        }

        function _o(e, t, n) {
            if (!(e && e.length)) {
                return []
            }
            t = n || t === lc ? 1 : $s(t);
            return yn(e, 0, t < 0 ? 0 : t)
        }

        function yo(e, t, n) {
            var i = e == null ? 0 : e.length;
            if (!i) {
                return []
            }
            t = n || t === lc ? 1 : $s(t);
            t = i - t;
            return yn(e, t < 0 ? 0 : t, i)
        }

        function mo(e, t) {
            return e && e.length ? Cn(e, Ri(t, 3), false, true) : []
        }

        function bo(e, t) {
            return e && e.length ? Cn(e, Ri(t, 3)) : []
        }
        var wo = fn(function (e) {
            return Tn(yt(e, 1, is, true))
        });
        var xo = fn(function (e) {
            var t = Xr(e);
            if (is(t)) {
                t = lc
            }
            return Tn(yt(e, 1, is, true), Ri(t, 2))
        });
        var Eo = fn(function (e) {
            var t = Xr(e);
            t = typeof t == "function" ? t : lc;
            return Tn(yt(e, 1, is, true), lc, t)
        });

        function ko(e) {
            return e && e.length ? Tn(e) : []
        }

        function To(e, t) {
            return e && e.length ? Tn(e, Ri(t, 2)) : []
        }

        function Oo(e, t) {
            t = typeof t == "function" ? t : lc;
            return e && e.length ? Tn(e, lc, t) : []
        }

        function So(t) {
            if (!(t && t.length)) {
                return []
            }
            var n = 0;
            t = Ch(t, function (e) {
                if (is(e)) {
                    n = W(e.length, n);
                    return true
                }
            });
            return Yh(n, function (e) {
                return Ph(t, Hh(e))
            })
        }

        function Co(e, t) {
            if (!(e && e.length)) {
                return []
            }
            var n = So(e);
            if (t == null) {
                return n
            }
            return Ph(n, function (e) {
                return Eh(t, lc, e)
            })
        }
        var Ao = fn(function (e, t) {
            return is(e) ? ft(e, t) : []
        });
        var jo = fn(function (e) {
            return jn(Ch(e, is))
        });
        var Po = fn(function (e) {
            var t = Xr(e);
            if (is(t)) {
                t = lc
            }
            return jn(Ch(e, is), Ri(t, 2))
        });
        var Do = fn(function (e) {
            var t = Xr(e);
            t = typeof t == "function" ? t : lc;
            return jn(Ch(e, is), lc, t)
        });
        var Io = fn(So);

        function No(e, t) {
            return Pn(e || [], t || [], Je)
        }

        function Lo(e, t) {
            return Pn(e || [], t || [], pn)
        }
        var Ro = fn(function (e) {
            var t = e.length,
                n = t > 1 ? e[t - 1] : lc;
            n = typeof n == "function" ? (e.pop(),
                n) : lc;
            return Co(e, n)
        });

        function Mo(e) {
            var t = de(e);
            t.__chain__ = true;
            return t
        }

        function Bo(e, t) {
            t(e);
            return e
        }

        function qo(e, t) {
            return t(e)
        }
        var $o = ji(function (t) {
            var n = t.length,
                e = n ? t[0] : 0,
                i = this.__wrapped__,
                r = function (e) {
                    return ot(e, t)
                };
            if (n > 1 || this.__actions__.length || !(i instanceof _e) || !Qi(e)) {
                return this.thru(r)
            }
            i = i.slice(e, +e + (n ? 1 : 0));
            i.__actions__.push({
                func: qo,
                args: [r],
                thisArg: lc
            });
            return new ge(i, this.__chain__).thru(function (e) {
                if (n && !e.length) {
                    e.push(lc)
                }
                return e
            })
        });

        function Uo() {
            return Mo(this)
        }

        function Vo() {
            return new ge(this.value(), this.__chain__)
        }

        function Ho() {
            if (this.__values__ === lc) {
                this.__values__ = Bs(this.value())
            }
            var e = this.__index__ >= this.__values__.length,
                t = e ? lc : this.__values__[this.__index__++];
            return {
                done: e,
                value: t
            }
        }

        function Fo() {
            return this
        }

        function Wo(e) {
            var t, n = this;
            while (n instanceof ve) {
                var i = Tr(n);
                i.__index__ = 0;
                i.__values__ = lc;
                if (t) {
                    r.__wrapped__ = i
                } else {
                    t = i
                }
                var r = i;
                n = n.__wrapped__
            }
            r.__wrapped__ = e;
            return t
        }

        function zo() {
            var e = this.__wrapped__;
            if (e instanceof _e) {
                var t = e;
                if (this.__actions__.length) {
                    t = new _e(this)
                }
                t = t.reverse();
                t.__actions__.push({
                    func: qo,
                    args: [oo],
                    thisArg: lc
                });
                return new ge(t, this.__chain__)
            }
            return this.thru(oo)
        }

        function Yo() {
            return An(this.__wrapped__, this.__actions__)
        }
        var Go = ei(function (e, t, n) {
            if (w.call(e, n)) {
                ++e[n]
            } else {
                rt(e, n, 1)
            }
        });

        function Ko(e, t, n) {
            var i = es(e) ? Sh : pt;
            if (n && Ji(e, t, n)) {
                t = lc
            }
            return i(e, Ri(t, 3))
        }

        function Xo(e, t) {
            var n = es(e) ? Ch : _t;
            return n(e, Ri(t, 3))
        }
        var Zo = ui(Mr);
        var Qo = ui(Br);

        function Jo(e, t) {
            return yt(la(e, t), 1)
        }

        function ea(e, t) {
            return yt(la(e, t), Bc)
        }

        function ta(e, t, n) {
            n = n === lc ? 1 : $s(n);
            return yt(la(e, t), n)
        }

        function na(e, t) {
            var n = es(e) ? Th : ht;
            return n(e, Ri(t, 3))
        }

        function ia(e, t) {
            var n = es(e) ? Oh : dt;
            return n(e, Ri(t, 3))
        }
        var ra = ei(function (e, t, n) {
            if (w.call(e, n)) {
                e[n].push(t)
            } else {
                rt(e, n, [t])
            }
        });

        function oa(e, t, n, i) {
            e = ns(e) ? e : Il(e);
            n = n && !i ? $s(n) : 0;
            var r = e.length;
            if (n < 0) {
                n = W(r + n, 0)
            }
            return js(e) ? n <= r && e.indexOf(t, n) > -1 : !!r && qh(e, t, n) > -1
        }
        var aa = fn(function (e, t, n) {
            var i = -1,
                r = typeof t == "function",
                o = ns(e) ? T(e.length) : [];
            ht(e, function (e) {
                o[++i] = r ? Eh(t, e, n) : It(e, t, n)
            });
            return o
        });
        var sa = ei(function (e, t, n) {
            rt(e, n, t)
        });

        function la(e, t) {
            var n = es(e) ? Ph : Kt;
            return n(e, Ri(t, 3))
        }

        function ua(e, t, n, i) {
            if (e == null) {
                return []
            }
            if (!es(t)) {
                t = t == null ? [] : [t]
            }
            n = i ? lc : n;
            if (!es(n)) {
                n = n == null ? [] : [n]
            }
            return tn(e, t, n)
        }
        var ca = ei(function (e, t, n) {
            e[n ? 0 : 1].push(t)
        }, function () {
            return [
                [],
                []
            ]
        });

        function fa(e, t, n) {
            var i = es(e) ? Ih : Fh,
                r = arguments.length < 3;
            return i(e, Ri(t, 4), n, r, ht)
        }

        function ha(e, t, n) {
            var i = es(e) ? Nh : Fh,
                r = arguments.length < 3;
            return i(e, Ri(t, 4), n, r, dt)
        }

        function da(e, t) {
            var n = es(e) ? Ch : _t;
            return n(e, Ia(Ri(t, 3)))
        }

        function pa(e) {
            var t = es(e) ? Ke : hn;
            return t(e)
        }

        function va(e, t, n) {
            if (n ? Ji(e, t, n) : t === lc) {
                t = 1
            } else {
                t = $s(t)
            }
            var i = es(e) ? Xe : dn;
            return i(e, t)
        }

        function ga(e) {
            var t = es(e) ? Ze : _n;
            return t(e)
        }

        function _a(e) {
            if (e == null) {
                return 0
            }
            if (ns(e)) {
                return js(e) ? pd(e) : e.length
            }
            var t = Hi(e);
            if (t == tf || t == uf) {
                return e.size
            }
            return zt(e).length
        }

        function ya(e, t, n) {
            var i = es(e) ? Lh : mn;
            if (n && Ji(e, t, n)) {
                t = lc
            }
            return i(e, Ri(t, 3))
        }
        var ma = fn(function (e, t) {
            if (e == null) {
                return []
            }
            var n = t.length;
            if (n > 1 && Ji(e, t[0], t[1])) {
                t = []
            } else if (n > 2 && Ji(t[0], t[1], t[2])) {
                t = [t[0]]
            }
            return tn(e, yt(t, 1), [])
        });
        var ba = R || function () {
            return dh.Date.now()
        };

        function wa(e, t) {
            if (typeof t != "function") {
                throw new x(hc)
            }
            e = $s(e);
            return function () {
                if (--e < 1) {
                    return t.apply(this, arguments)
                }
            }
        }

        function xa(e, t, n) {
            t = n ? lc : t;
            t = e && t == null ? e.length : t;
            return Ei(e, Cc, lc, lc, lc, lc, t)
        }

        function Ea(e, t) {
            var n;
            if (typeof t != "function") {
                throw new x(hc)
            }
            e = $s(e);
            return function () {
                if (--e > 0) {
                    n = t.apply(this, arguments)
                }
                if (e <= 1) {
                    t = lc
                }
                return n
            }
        }
        var ka = fn(function (e, t, n) {
            var i = wc;
            if (n.length) {
                var r = cd(n, Li(ka));
                i |= Oc
            }
            return Ei(e, i, t, n, r)
        });
        var Ta = fn(function (e, t, n) {
            var i = wc | xc;
            if (n.length) {
                var r = cd(n, Li(Ta));
                i |= Oc
            }
            return Ei(t, i, e, n, r)
        });

        function Oa(e, t, n) {
            t = n ? lc : t;
            var i = Ei(e, kc, lc, lc, lc, lc, lc, t);
            i.placeholder = Oa.placeholder;
            return i
        }

        function Sa(e, t, n) {
            t = n ? lc : t;
            var i = Ei(e, Tc, lc, lc, lc, lc, lc, t);
            i.placeholder = Sa.placeholder;
            return i
        }

        function Ca(i, r, e) {
            var o, a, s, l, n, u, c = 0,
                t = false,
                f = false,
                h = true;
            if (typeof i != "function") {
                throw new x(hc)
            }
            r = Vs(r) || 0;
            if (gs(e)) {
                t = !!e.leading;
                f = "maxWait" in e;
                s = f ? W(Vs(e.maxWait) || 0, r) : s;
                h = "trailing" in e ? !!e.trailing : h
            }

            function d(e) {
                var t = o,
                    n = a;
                o = a = lc;
                c = e;
                l = i.apply(n, t);
                return l
            }

            function p(e) {
                c = e;
                n = gr(_, r);
                return t ? d(e) : l
            }

            function v(e) {
                var t = e - u,
                    n = e - c,
                    i = r - t;
                return f ? z(i, s - n) : i
            }

            function g(e) {
                var t = e - u,
                    n = e - c;
                return u === lc || t >= r || t < 0 || f && n >= s
            }

            function _() {
                var e = ba();
                if (g(e)) {
                    return y(e)
                }
                n = gr(_, v(e))
            }

            function y(e) {
                n = lc;
                if (h && o) {
                    return d(e)
                }
                o = a = lc;
                return l
            }

            function m() {
                if (n !== lc) {
                    Mn(n)
                }
                c = 0;
                o = u = a = n = lc
            }

            function b() {
                return n === lc ? l : y(ba())
            }

            function w() {
                var e = ba(),
                    t = g(e);
                o = arguments;
                a = this;
                u = e;
                if (t) {
                    if (n === lc) {
                        return p(u)
                    }
                    if (f) {
                        n = gr(_, r);
                        return d(u)
                    }
                }
                if (n === lc) {
                    n = gr(_, r)
                }
                return l
            }
            w.cancel = m;
            w.flush = b;
            return w
        }
        var Aa = fn(function (e, t) {
            return ct(e, 1, t)
        });
        var ja = fn(function (e, t, n) {
            return ct(e, Vs(t) || 0, n)
        });

        function Pa(e) {
            return Ei(e, jc)
        }

        function Da(r, o) {
            if (typeof r != "function" || o != null && typeof o != "function") {
                throw new x(hc)
            }
            var a = function () {
                var e = arguments,
                    t = o ? o.apply(this, e) : e[0],
                    n = a.cache;
                if (n.has(t)) {
                    return n.get(t)
                }
                var i = r.apply(this, e);
                a.cache = n.set(t, i) || n;
                return i
            };
            a.cache = new(Da.Cache || Ie);
            return a
        }
        Da.Cache = Ie;

        function Ia(t) {
            if (typeof t != "function") {
                throw new x(hc)
            }
            return function () {
                var e = arguments;
                switch (e.length) {
                    case 0:
                        return !t.call(this);
                    case 1:
                        return !t.call(this, e[0]);
                    case 2:
                        return !t.call(this, e[0], e[1]);
                    case 3:
                        return !t.call(this, e[0], e[1], e[2])
                }
                return !t.apply(this, e)
            }
        }

        function Na(e) {
            return Ea(2, e)
        }
        var La = Ln(function (i, r) {
            r = r.length == 1 && es(r[0]) ? Ph(r[0], Kh(Ri())) : Ph(yt(r, 1), Kh(Ri()));
            var o = r.length;
            return fn(function (e) {
                var t = -1,
                    n = z(e.length, o);
                while (++t < n) {
                    e[t] = r[t].call(this, e[t])
                }
                return Eh(i, this, e)
            })
        });
        var Ra = fn(function (e, t) {
            var n = cd(t, Li(Ra));
            return Ei(e, Oc, lc, t, n)
        });
        var Ma = fn(function (e, t) {
            var n = cd(t, Li(Ma));
            return Ei(e, Sc, lc, t, n)
        });
        var Ba = ji(function (e, t) {
            return Ei(e, Ac, lc, lc, lc, t)
        });

        function qa(e, t) {
            if (typeof e != "function") {
                throw new x(hc)
            }
            t = t === lc ? t : $s(t);
            return fn(e, t)
        }

        function $a(i, r) {
            if (typeof i != "function") {
                throw new x(hc)
            }
            r = r == null ? 0 : W($s(r), 0);
            return fn(function (e) {
                var t = e[r],
                    n = Rn(e, 0, r);
                if (t) {
                    Dh(n, t)
                }
                return Eh(i, this, n)
            })
        }

        function Ua(e, t, n) {
            var i = true,
                r = true;
            if (typeof e != "function") {
                throw new x(hc)
            }
            if (gs(n)) {
                i = "leading" in n ? !!n.leading : i;
                r = "trailing" in n ? !!n.trailing : r
            }
            return Ca(e, t, {
                leading: i,
                maxWait: t,
                trailing: r
            })
        }

        function Va(e) {
            return xa(e, 1)
        }

        function Ha(e, t) {
            return Ra(In(t), e)
        }

        function Fa() {
            if (!arguments.length) {
                return []
            }
            var e = arguments[0];
            return es(e) ? e : [e]
        }

        function Wa(e) {
            return st(e, yc)
        }

        function za(e, t) {
            t = typeof t == "function" ? t : lc;
            return st(e, yc, t)
        }

        function Ya(e) {
            return st(e, gc | yc)
        }

        function Ga(e, t) {
            t = typeof t == "function" ? t : lc;
            return st(e, gc | yc, t)
        }

        function Ka(e, t) {
            return t == null || ut(e, t, pl(t))
        }

        function Xa(e, t) {
            return e === t || e !== e && t !== t
        }
        var Za = yi(St);
        var Qa = yi(function (e, t) {
            return e >= t
        });
        var Ja = Nt(function () {
            return arguments
        }()) ? Nt : function (e) {
            return _s(e) && w.call(e, "callee") && !A.call(e, "callee")
        };
        var es = T.isArray;
        var ts = vh ? Kh(vh) : Lt;

        function ns(e) {
            return e != null && vs(e.length) && !ds(e)
        }

        function is(e) {
            return _s(e) && ns(e)
        }

        function rs(e) {
            return e === true || e === false || _s(e) && Ot(e) == Kc
        }
        var os = U || $u;
        var as = gh ? Kh(gh) : Rt;

        function ss(e) {
            return _s(e) && e.nodeType === 1 && !Os(e)
        }

        function ls(e) {
            if (e == null) {
                return true
            }
            if (ns(e) && (es(e) || typeof e == "string" || typeof e.splice == "function" || os(e) || Ds(e) || Ja(e))) {
                return !e.length
            }
            var t = Hi(e);
            if (t == tf || t == uf) {
                return !e.size
            }
            if (or(e)) {
                return !zt(e).length
            }
            for (var n in e) {
                if (w.call(e, n)) {
                    return false
                }
            }
            return true
        }

        function us(e, t) {
            return Mt(e, t)
        }

        function cs(e, t, n) {
            n = typeof n == "function" ? n : lc;
            var i = n ? n(e, t) : lc;
            return i === lc ? Mt(e, t, lc, n) : !!i
        }

        function fs(e) {
            if (!_s(e)) {
                return false
            }
            var t = Ot(e);
            return t == Qc || t == Zc || typeof e.message == "string" && typeof e.name == "string" && !Os(e)
        }

        function hs(e) {
            return typeof e == "number" && V(e)
        }

        function ds(e) {
            if (!gs(e)) {
                return false
            }
            var t = Ot(e);
            return t == Jc || t == ef || t == Gc || t == sf
        }

        function ps(e) {
            return typeof e == "number" && e == $s(e)
        }

        function vs(e) {
            return typeof e == "number" && e > -1 && e % 1 == 0 && e <= qc
        }

        function gs(e) {
            var t = typeof e;
            return e != null && (t == "object" || t == "function")
        }

        function _s(e) {
            return e != null && typeof e == "object"
        }
        var ys = _h ? Kh(_h) : qt;

        function ms(e, t) {
            return e === t || $t(e, t, Bi(t))
        }

        function bs(e, t, n) {
            n = typeof n == "function" ? n : lc;
            return $t(e, t, Bi(t), n)
        }

        function ws(e) {
            return Ts(e) && e != +e
        }

        function xs(e) {
            if (rr(e)) {
                throw new i(fc)
            }
            return Ut(e)
        }

        function Es(e) {
            return e === null
        }

        function ks(e) {
            return e == null
        }

        function Ts(e) {
            return typeof e == "number" || _s(e) && Ot(e) == nf
        }

        function Os(e) {
            if (!_s(e) || Ot(e) != of ) {
                return false
            }
            var t = S(e);
            if (t === null) {
                return true
            }
            var n = w.call(t, "constructor") && t.constructor;
            return typeof n == "function" && n instanceof n && u.call(n) == v
        }
        var Ss = yh ? Kh(yh) : Vt;

        function Cs(e) {
            return ps(e) && e >= -qc && e <= qc
        }
        var As = mh ? Kh(mh) : Ht;

        function js(e) {
            return typeof e == "string" || !es(e) && _s(e) && Ot(e) == cf
        }

        function Ps(e) {
            return typeof e == "symbol" || _s(e) && Ot(e) == ff
        }
        var Ds = bh ? Kh(bh) : Ft;

        function Is(e) {
            return e === lc
        }

        function Ns(e) {
            return _s(e) && Hi(e) == df
        }

        function Ls(e) {
            return _s(e) && Ot(e) == pf
        }
        var Rs = yi(Gt);
        var Ms = yi(function (e, t) {
            return e <= t
        });

        function Bs(e) {
            if (!e) {
                return []
            }
            if (ns(e)) {
                return js(e) ? vd(e) : Xn(e)
            }
            if (D && e[D]) {
                return sd(e[D]())
            }
            var t = Hi(e),
                n = t == tf ? ld : t == uf ? fd : Il;
            return n(e)
        }

        function qs(e) {
            if (!e) {
                return e === 0 ? e : 0
            }
            e = Vs(e);
            if (e === Bc || e === -Bc) {
                var t = e < 0 ? -1 : 1;
                return t * $c
            }
            return e === e ? e : 0
        }

        function $s(e) {
            var t = qs(e),
                n = t % 1;
            return t === t ? n ? t - n : t : 0
        }

        function Us(e) {
            return e ? at($s(e), 0, Vc) : 0
        }

        function Vs(e) {
            if (typeof e == "number") {
                return e
            }
            if (Ps(e)) {
                return Uc
            }
            if (gs(e)) {
                var t = typeof e.valueOf == "function" ? e.valueOf() : e;
                e = gs(t) ? t + "" : t
            }
            if (typeof e != "string") {
                return e === 0 ? e : +e
            }
            e = e.replace(Vf, "");
            var n = Qf.test(e);
            return n || eh.test(e) ? hh(e.slice(2), n ? 2 : 8) : Zf.test(e) ? Uc : +e
        }

        function Hs(e) {
            return Zn(e, vl(e))
        }

        function Fs(e) {
            return e ? at($s(e), -qc, qc) : e === 0 ? e : 0
        }

        function Ws(e) {
            return e == null ? "" : kn(e)
        }
        var zs = ti(function (e, t) {
            if (or(t) || ns(t)) {
                Zn(t, pl(t), e);
                return
            }
            for (var n in t) {
                if (w.call(t, n)) {
                    Je(e, n, t[n])
                }
            }
        });
        var Ys = ti(function (e, t) {
            Zn(t, vl(t), e)
        });
        var Gs = ti(function (e, t, n, i) {
            Zn(t, vl(t), e, i)
        });
        var Ks = ti(function (e, t, n, i) {
            Zn(t, pl(t), e, i)
        });
        var Xs = ji(ot);

        function Zs(e, t) {
            var n = pe(e);
            return t == null ? n : nt(n, t)
        }
        var Qs = fn(function (e) {
            e.push(lc, ki);
            return Eh(Gs, lc, e)
        });
        var Js = fn(function (e) {
            e.push(lc, Ti);
            return Eh(ml, lc, e)
        });

        function el(e, t) {
            return Mh(e, Ri(t, 3), wt)
        }

        function tl(e, t) {
            return Mh(e, Ri(t, 3), xt)
        }

        function nl(e, t) {
            return e == null ? e : mt(e, Ri(t, 3), vl)
        }

        function il(e, t) {
            return e == null ? e : bt(e, Ri(t, 3), vl)
        }

        function rl(e, t) {
            return e && wt(e, Ri(t, 3))
        }

        function ol(e, t) {
            return e && xt(e, Ri(t, 3))
        }

        function al(e) {
            return e == null ? [] : Et(e, pl(e))
        }

        function sl(e) {
            return e == null ? [] : Et(e, vl(e))
        }

        function ll(e, t, n) {
            var i = e == null ? lc : kt(e, t);
            return i === lc ? n : i
        }

        function ul(e, t) {
            return e != null && zi(e, t, Ct)
        }

        function cl(e, t) {
            return e != null && zi(e, t, At)
        }
        var fl = hi(function (e, t, n) {
            e[t] = n
        }, yu(xu));
        var hl = hi(function (e, t, n) {
            if (w.call(e, t)) {
                e[t].push(n)
            } else {
                e[t] = [n]
            }
        }, Ri);
        var dl = fn(It);

        function pl(e) {
            return ns(e) ? Ge(e) : zt(e)
        }

        function vl(e) {
            return ns(e) ? Ge(e, true) : Yt(e)
        }

        function gl(e, i) {
            var r = {};
            i = Ri(i, 3);
            wt(e, function (e, t, n) {
                rt(r, i(e, t, n), e)
            });
            return r
        }

        function _l(e, i) {
            var r = {};
            i = Ri(i, 3);
            wt(e, function (e, t, n) {
                rt(r, t, i(e, t, n))
            });
            return r
        }
        var yl = ti(function (e, t, n) {
            Qt(e, t, n)
        });
        var ml = ti(function (e, t, n, i) {
            Qt(e, t, n, i)
        });
        var bl = ji(function (t, e) {
            var n = {};
            if (t == null) {
                return n
            }
            var i = false;
            e = Ph(e, function (e) {
                e = Nn(e, t);
                i || (i = e.length > 1);
                return e
            });
            Zn(t, Di(t), n);
            if (i) {
                n = st(n, gc | _c | yc, Oi)
            }
            var r = e.length;
            while (r--) {
                On(n, e[r])
            }
            return n
        });

        function wl(e, t) {
            return El(e, Ia(Ri(t)))
        }
        var xl = ji(function (e, t) {
            return e == null ? {} : nn(e, t)
        });

        function El(e, n) {
            if (e == null) {
                return {}
            }
            var t = Ph(Di(e), function (e) {
                return [e]
            });
            n = Ri(n);
            return rn(e, t, function (e, t) {
                return n(e, t[0])
            })
        }

        function kl(e, t, n) {
            t = Nn(t, e);
            var i = -1,
                r = t.length;
            if (!r) {
                r = 1;
                e = lc
            }
            while (++i < r) {
                var o = e == null ? lc : e[xr(t[i])];
                if (o === lc) {
                    i = r;
                    o = n
                }
                e = ds(o) ? o.call(e) : o
            }
            return e
        }

        function Tl(e, t, n) {
            return e == null ? e : pn(e, t, n)
        }

        function Ol(e, t, n, i) {
            i = typeof i == "function" ? i : lc;
            return e == null ? e : pn(e, t, n, i)
        }
        var Sl = xi(pl);
        var Cl = xi(vl);

        function Al(e, i, r) {
            var t = es(e),
                n = t || os(e) || Ds(e);
            i = Ri(i, 4);
            if (r == null) {
                var o = e && e.constructor;
                if (n) {
                    r = t ? new o : []
                } else if (gs(e)) {
                    r = ds(o) ? pe(S(e)) : {}
                } else {
                    r = {}
                }
            }
            (n ? Th : wt)(e, function (e, t, n) {
                return i(r, e, t, n)
            });
            return r
        }

        function jl(e, t) {
            return e == null ? true : On(e, t)
        }

        function Pl(e, t, n) {
            return e == null ? e : Sn(e, t, In(n))
        }

        function Dl(e, t, n, i) {
            i = typeof i == "function" ? i : lc;
            return e == null ? e : Sn(e, t, In(n), i)
        }

        function Il(e) {
            return e == null ? [] : Xh(e, pl(e))
        }

        function Nl(e) {
            return e == null ? [] : Xh(e, vl(e))
        }

        function Ll(e, t, n) {
            if (n === lc) {
                n = t;
                t = lc
            }
            if (n !== lc) {
                n = Vs(n);
                n = n === n ? n : 0
            }
            if (t !== lc) {
                t = Vs(t);
                t = t === t ? t : 0
            }
            return at(Vs(e), t, n)
        }

        function Rl(e, t, n) {
            t = qs(t);
            if (n === lc) {
                n = t;
                t = 0
            } else {
                n = qs(n)
            }
            e = Vs(e);
            return jt(e, t, n)
        }

        function Ml(e, t, n) {
            if (n && typeof n != "boolean" && Ji(e, t, n)) {
                t = n = lc
            }
            if (n === lc) {
                if (typeof t == "boolean") {
                    n = t;
                    t = lc
                } else if (typeof e == "boolean") {
                    n = e;
                    e = lc
                }
            }
            if (e === lc && t === lc) {
                e = 0;
                t = 1
            } else {
                e = qs(e);
                if (t === lc) {
                    t = e;
                    e = 0
                } else {
                    t = qs(t)
                }
            }
            if (e > t) {
                var i = e;
                e = t;
                t = i
            }
            if (n || e % 1 || t % 1) {
                var r = K();
                return z(e + r * (t - e + fh("1e-" + ((r + "").length - 1))), t)
            }
            return ln(e, t)
        }
        var Bl = ai(function (e, t, n) {
            t = t.toLowerCase();
            return e + (n ? ql(t) : t)
        });

        function ql(e) {
            return hu(Ws(e).toLowerCase())
        }

        function $l(e) {
            e = Ws(e);
            return e && e.replace(nh, td).replace(ah, "")
        }

        function Ul(e, t, n) {
            e = Ws(e);
            t = kn(t);
            var i = e.length;
            n = n === lc ? i : at($s(n), 0, i);
            var r = n;
            n -= t.length;
            return n >= 0 && e.slice(n, r) == t
        }

        function Vl(e) {
            e = Ws(e);
            return e && Df.test(e) ? e.replace(jf, nd) : e
        }

        function Hl(e) {
            e = Ws(e);
            return e && Uf.test(e) ? e.replace($f, "\\$&") : e
        }
        var Fl = ai(function (e, t, n) {
            return e + (n ? "-" : "") + t.toLowerCase()
        });
        var Wl = ai(function (e, t, n) {
            return e + (n ? " " : "") + t.toLowerCase()
        });
        var zl = oi("toLowerCase");

        function Yl(e, t, n) {
            e = Ws(e);
            t = $s(t);
            var i = t ? pd(e) : 0;
            if (!t || i >= t) {
                return e
            }
            var r = (t - i) / 2;
            return vi(q(r), n) + e + vi(B(r), n)
        }

        function Gl(e, t, n) {
            e = Ws(e);
            t = $s(t);
            var i = t ? pd(e) : 0;
            return t && i < t ? e + vi(t - i, n) : e
        }

        function Kl(e, t, n) {
            e = Ws(e);
            t = $s(t);
            var i = t ? pd(e) : 0;
            return t && i < t ? vi(t - i, n) + e : e
        }

        function Xl(e, t, n) {
            if (n || t == null) {
                t = 0
            } else if (t) {
                t = +t
            }
            return G(Ws(e).replace(Hf, ""), t || 0)
        }

        function Zl(e, t, n) {
            if (n ? Ji(e, t, n) : t === lc) {
                t = 1
            } else {
                t = $s(t)
            }
            return cn(Ws(e), t)
        }

        function Ql() {
            var e = arguments,
                t = Ws(e[0]);
            return e.length < 3 ? t : t.replace(e[1], e[2])
        }
        var Jl = ai(function (e, t, n) {
            return e + (n ? "_" : "") + t.toLowerCase()
        });

        function eu(e, t, n) {
            if (n && typeof n != "number" && Ji(e, t, n)) {
                t = n = lc
            }
            n = n === lc ? Vc : n >>> 0;
            if (!n) {
                return []
            }
            e = Ws(e);
            if (e && (typeof t == "string" || t != null && !Ss(t))) {
                t = kn(t);
                if (!t && od(e)) {
                    return Rn(vd(e), 0, n)
                }
            }
            return e.split(t, n)
        }
        var tu = ai(function (e, t, n) {
            return e + (n ? " " : "") + hu(t)
        });

        function nu(e, t, n) {
            e = Ws(e);
            n = n == null ? 0 : at($s(n), 0, e.length);
            t = kn(t);
            return e.slice(n, n + t.length) == t
        }

        function iu(a, e, t) {
            var n = de.templateSettings;
            if (t && Ji(a, e, t)) {
                e = lc
            }
            a = Ws(a);
            e = Gs({}, e, n, ki);
            var i = Gs({}, e.imports, n.imports, ki),
                r = pl(i),
                o = Xh(i, r);
            var s, l, u = 0,
                c = e.interpolate || ih,
                f = "__p += '";
            var h = _((e.escape || ih).source + "|" + c.source + "|" + (c === Lf ? Kf : ih).source + "|" + (e.evaluate || ih).source + "|$", "g");
            var d = "//# sourceURL=" + ("sourceURL" in e ? e.sourceURL : "lodash.templateSources[" + ++lh + "]") + "\n";
            a.replace(h, function (e, t, n, i, r, o) {
                n || (n = i);
                f += a.slice(u, o).replace(rh, id);
                if (t) {
                    s = true;
                    f += "' +\n__e(" + t + ") +\n'"
                }
                if (r) {
                    l = true;
                    f += "';\n" + r + ";\n__p += '"
                }
                if (n) {
                    f += "' +\n((__t = (" + n + ")) == null ? '' : __t) +\n'"
                }
                u = o + e.length;
                return e
            });
            f += "';\n";
            var p = e.variable;
            if (!p) {
                f = "with (obj) {\n" + f + "\n}\n"
            }
            f = (l ? f.replace(Of, "") : f).replace(Sf, "$1").replace(Cf, "$1;");
            f = "function(" + (p || "obj") + ") {\n" + (p ? "" : "obj || (obj = {});\n") + "var __t, __p = ''" + (s ? ", __e = _.escape" : "") + (l ? ", __j = Array.prototype.join;\n" + "function print() { __p += __j.call(arguments, '') }\n" : ";\n") + f + "return __p\n}";
            var v = pu(function () {
                return g(r, d + "return " + f).apply(lc, o)
            });
            v.source = f;
            if (fs(v)) {
                throw v
            }
            return v
        }

        function ru(e) {
            return Ws(e).toLowerCase()
        }

        function ou(e) {
            return Ws(e).toUpperCase()
        }

        function au(e, t, n) {
            e = Ws(e);
            if (e && (n || t === lc)) {
                return e.replace(Vf, "")
            }
            if (!e || !(t = kn(t))) {
                return e
            }
            var i = vd(e),
                r = vd(t),
                o = Qh(i, r),
                a = Jh(i, r) + 1;
            return Rn(i, o, a).join("")
        }

        function su(e, t, n) {
            e = Ws(e);
            if (e && (n || t === lc)) {
                return e.replace(Ff, "")
            }
            if (!e || !(t = kn(t))) {
                return e
            }
            var i = vd(e),
                r = Jh(i, vd(t)) + 1;
            return Rn(i, 0, r).join("")
        }

        function lu(e, t, n) {
            e = Ws(e);
            if (e && (n || t === lc)) {
                return e.replace(Hf, "")
            }
            if (!e || !(t = kn(t))) {
                return e
            }
            var i = vd(e),
                r = Qh(i, vd(t));
            return Rn(i, r).join("")
        }

        function uu(e, t) {
            var n = Pc,
                i = Dc;
            if (gs(t)) {
                var r = "separator" in t ? t.separator : r;
                n = "length" in t ? $s(t.length) : n;
                i = "omission" in t ? kn(t.omission) : i
            }
            e = Ws(e);
            var o = e.length;
            if (od(e)) {
                var a = vd(e);
                o = a.length
            }
            if (n >= o) {
                return e
            }
            var s = n - pd(i);
            if (s < 1) {
                return i
            }
            var l = a ? Rn(a, 0, s).join("") : e.slice(0, s);
            if (r === lc) {
                return l + i
            }
            if (a) {
                s += l.length - s
            }
            if (Ss(r)) {
                if (e.slice(s).search(r)) {
                    var u, c = l;
                    if (!r.global) {
                        r = _(r.source, Ws(Xf.exec(r)) + "g")
                    }
                    r.lastIndex = 0;
                    while (u = r.exec(c)) {
                        var f = u.index
                    }
                    l = l.slice(0, f === lc ? s : f)
                }
            } else if (e.indexOf(kn(r), s) != s) {
                var h = l.lastIndexOf(r);
                if (h > -1) {
                    l = l.slice(0, h)
                }
            }
            return l + i
        }

        function cu(e) {
            e = Ws(e);
            return e && Pf.test(e) ? e.replace(Af, gd) : e
        }
        var fu = ai(function (e, t, n) {
            return e + (n ? " " : "") + t.toUpperCase()
        });
        var hu = oi("toUpperCase");

        function du(e, t, n) {
            e = Ws(e);
            t = n ? lc : t;
            if (t === lc) {
                return ad(e) ? _d(e) : Rh(e)
            }
            return e.match(t) || []
        }
        var pu = fn(function (e, t) {
            try {
                return Eh(e, lc, t)
            } catch (e) {
                return fs(e) ? e : new i(e)
            }
        });
        var vu = ji(function (t, e) {
            Th(e, function (e) {
                e = xr(e);
                rt(t, e, ka(t[e], t))
            });
            return t
        });

        function gu(i) {
            var r = i == null ? 0 : i.length,
                t = Ri();
            i = !r ? [] : Ph(i, function (e) {
                if (typeof e[1] != "function") {
                    throw new x(hc)
                }
                return [t(e[0]), e[1]]
            });
            return fn(function (e) {
                var t = -1;
                while (++t < r) {
                    var n = i[t];
                    if (Eh(n[0], this, e)) {
                        return Eh(n[1], this, e)
                    }
                }
            })
        }

        function _u(e) {
            return lt(st(e, gc))
        }

        function yu(e) {
            return function () {
                return e
            }
        }

        function mu(e, t) {
            return e == null || e !== e ? t : e
        }
        var bu = ci();
        var wu = ci(true);

        function xu(e) {
            return e
        }

        function Eu(e) {
            return Wt(typeof e == "function" ? e : st(e, gc))
        }

        function ku(e) {
            return Xt(st(e, gc))
        }

        function Tu(e, t) {
            return Zt(e, st(t, gc))
        }
        var Ou = fn(function (t, n) {
            return function (e) {
                return It(e, t, n)
            }
        });
        var Su = fn(function (t, n) {
            return function (e) {
                return It(t, e, n)
            }
        });

        function Cu(r, t, e) {
            var n = pl(t),
                i = Et(t, n);
            if (e == null && !(gs(t) && (i.length || !n.length))) {
                e = t;
                t = r;
                r = this;
                i = Et(t, pl(t))
            }
            var o = !(gs(e) && "chain" in e) || !!e.chain,
                a = ds(r);
            Th(i, function (e) {
                var i = t[e];
                r[e] = i;
                if (a) {
                    r.prototype[e] = function () {
                        var e = this.__chain__;
                        if (o || e) {
                            var t = r(this.__wrapped__),
                                n = t.__actions__ = Xn(this.__actions__);
                            n.push({
                                func: i,
                                args: arguments,
                                thisArg: r
                            });
                            t.__chain__ = e;
                            return t
                        }
                        return i.apply(r, Dh([this.value()], arguments))
                    }
                }
            });
            return r
        }

        function Au() {
            if (dh._ === this) {
                dh._ = y
            }
            return this
        }

        function ju() {}

        function Pu(t) {
            t = $s(t);
            return fn(function (e) {
                return en(e, t)
            })
        }
        var Du = pi(Ph);
        var Iu = pi(Sh);
        var Nu = pi(Lh);

        function Lu(e) {
            return er(e) ? Hh(xr(e)) : on(e)
        }

        function Ru(t) {
            return function (e) {
                return t == null ? lc : kt(t, e)
            }
        }
        var Mu = _i();
        var Bu = _i(true);

        function qu() {
            return []
        }

        function $u() {
            return false
        }

        function Uu() {
            return {}
        }

        function Vu() {
            return ""
        }

        function Hu() {
            return true
        }

        function Fu(e, t) {
            e = $s(e);
            if (e < 1 || e > qc) {
                return []
            }
            var n = Vc,
                i = z(e, Vc);
            t = Ri(t);
            e -= Vc;
            var r = Yh(i, t);
            while (++n < e) {
                t(n)
            }
            return r
        }

        function Wu(e) {
            if (es(e)) {
                return Ph(e, xr)
            }
            return Ps(e) ? [e] : Xn(wr(Ws(e)))
        }

        function zu(e) {
            var t = ++f;
            return Ws(e) + t
        }
        var Yu = di(function (e, t) {
            return e + t
        }, 0);
        var Gu = bi("ceil");
        var Ku = di(function (e, t) {
            return e / t
        }, 1);
        var Xu = bi("floor");

        function Zu(e) {
            return e && e.length ? vt(e, xu, St) : lc
        }

        function Qu(e, t) {
            return e && e.length ? vt(e, Ri(t, 2), St) : lc
        }

        function Ju(e) {
            return Vh(e, xu)
        }

        function ec(e, t) {
            return Vh(e, Ri(t, 2))
        }

        function tc(e) {
            return e && e.length ? vt(e, xu, Gt) : lc
        }

        function nc(e, t) {
            return e && e.length ? vt(e, Ri(t, 2), Gt) : lc
        }
        var ic = di(function (e, t) {
            return e * t
        }, 1);
        var rc = bi("round");
        var oc = di(function (e, t) {
            return e - t
        }, 0);

        function ac(e) {
            return e && e.length ? zh(e, xu) : 0
        }

        function sc(e, t) {
            return e && e.length ? zh(e, Ri(t, 2)) : 0
        }
        de.after = wa;
        de.ary = xa;
        de.assign = zs;
        de.assignIn = Ys;
        de.assignInWith = Gs;
        de.assignWith = Ks;
        de.at = Xs;
        de.before = Ea;
        de.bind = ka;
        de.bindAll = vu;
        de.bindKey = Ta;
        de.castArray = Fa;
        de.chain = Mo;
        de.chunk = Or;
        de.compact = Sr;
        de.concat = Cr;
        de.cond = gu;
        de.conforms = _u;
        de.constant = yu;
        de.countBy = Go;
        de.create = Zs;
        de.curry = Oa;
        de.curryRight = Sa;
        de.debounce = Ca;
        de.defaults = Qs;
        de.defaultsDeep = Js;
        de.defer = Aa;
        de.delay = ja;
        de.difference = Ar;
        de.differenceBy = jr;
        de.differenceWith = Pr;
        de.drop = Dr;
        de.dropRight = Ir;
        de.dropRightWhile = Nr;
        de.dropWhile = Lr;
        de.fill = Rr;
        de.filter = Xo;
        de.flatMap = Jo;
        de.flatMapDeep = ea;
        de.flatMapDepth = ta;
        de.flatten = qr;
        de.flattenDeep = $r;
        de.flattenDepth = Ur;
        de.flip = Pa;
        de.flow = bu;
        de.flowRight = wu;
        de.fromPairs = Vr;
        de.functions = al;
        de.functionsIn = sl;
        de.groupBy = ra;
        de.initial = Wr;
        de.intersection = zr;
        de.intersectionBy = Yr;
        de.intersectionWith = Gr;
        de.invert = fl;
        de.invertBy = hl;
        de.invokeMap = aa;
        de.iteratee = Eu;
        de.keyBy = sa;
        de.keys = pl;
        de.keysIn = vl;
        de.map = la;
        de.mapKeys = gl;
        de.mapValues = _l;
        de.matches = ku;
        de.matchesProperty = Tu;
        de.memoize = Da;
        de.merge = yl;
        de.mergeWith = ml;
        de.method = Ou;
        de.methodOf = Su;
        de.mixin = Cu;
        de.negate = Ia;
        de.nthArg = Pu;
        de.omit = bl;
        de.omitBy = wl;
        de.once = Na;
        de.orderBy = ua;
        de.over = Du;
        de.overArgs = La;
        de.overEvery = Iu;
        de.overSome = Nu;
        de.partial = Ra;
        de.partialRight = Ma;
        de.partition = ca;
        de.pick = xl;
        de.pickBy = El;
        de.property = Lu;
        de.propertyOf = Ru;
        de.pull = Jr;
        de.pullAll = eo;
        de.pullAllBy = to;
        de.pullAllWith = no;
        de.pullAt = io;
        de.range = Mu;
        de.rangeRight = Bu;
        de.rearg = Ba;
        de.reject = da;
        de.remove = ro;
        de.rest = qa;
        de.reverse = oo;
        de.sampleSize = va;
        de.set = Tl;
        de.setWith = Ol;
        de.shuffle = ga;
        de.slice = ao;
        de.sortBy = ma;
        de.sortedUniq = po;
        de.sortedUniqBy = vo;
        de.split = eu;
        de.spread = $a;
        de.tail = go;
        de.take = _o;
        de.takeRight = yo;
        de.takeRightWhile = mo;
        de.takeWhile = bo;
        de.tap = Bo;
        de.throttle = Ua;
        de.thru = qo;
        de.toArray = Bs;
        de.toPairs = Sl;
        de.toPairsIn = Cl;
        de.toPath = Wu;
        de.toPlainObject = Hs;
        de.transform = Al;
        de.unary = Va;
        de.union = wo;
        de.unionBy = xo;
        de.unionWith = Eo;
        de.uniq = ko;
        de.uniqBy = To;
        de.uniqWith = Oo;
        de.unset = jl;
        de.unzip = So;
        de.unzipWith = Co;
        de.update = Pl;
        de.updateWith = Dl;
        de.values = Il;
        de.valuesIn = Nl;
        de.without = Ao;
        de.words = du;
        de.wrap = Ha;
        de.xor = jo;
        de.xorBy = Po;
        de.xorWith = Do;
        de.zip = Io;
        de.zipObject = No;
        de.zipObjectDeep = Lo;
        de.zipWith = Ro;
        de.entries = Sl;
        de.entriesIn = Cl;
        de.extend = Ys;
        de.extendWith = Gs;
        Cu(de, de);
        de.add = Yu;
        de.attempt = pu;
        de.camelCase = Bl;
        de.capitalize = ql;
        de.ceil = Gu;
        de.clamp = Ll;
        de.clone = Wa;
        de.cloneDeep = Ya;
        de.cloneDeepWith = Ga;
        de.cloneWith = za;
        de.conformsTo = Ka;
        de.deburr = $l;
        de.defaultTo = mu;
        de.divide = Ku;
        de.endsWith = Ul;
        de.eq = Xa;
        de.escape = Vl;
        de.escapeRegExp = Hl;
        de.every = Ko;
        de.find = Zo;
        de.findIndex = Mr;
        de.findKey = el;
        de.findLast = Qo;
        de.findLastIndex = Br;
        de.findLastKey = tl;
        de.floor = Xu;
        de.forEach = na;
        de.forEachRight = ia;
        de.forIn = nl;
        de.forInRight = il;
        de.forOwn = rl;
        de.forOwnRight = ol;
        de.get = ll;
        de.gt = Za;
        de.gte = Qa;
        de.has = ul;
        de.hasIn = cl;
        de.head = Hr;
        de.identity = xu;
        de.includes = oa;
        de.indexOf = Fr;
        de.inRange = Rl;
        de.invoke = dl;
        de.isArguments = Ja;
        de.isArray = es;
        de.isArrayBuffer = ts;
        de.isArrayLike = ns;
        de.isArrayLikeObject = is;
        de.isBoolean = rs;
        de.isBuffer = os;
        de.isDate = as;
        de.isElement = ss;
        de.isEmpty = ls;
        de.isEqual = us;
        de.isEqualWith = cs;
        de.isError = fs;
        de.isFinite = hs;
        de.isFunction = ds;
        de.isInteger = ps;
        de.isLength = vs;
        de.isMap = ys;
        de.isMatch = ms;
        de.isMatchWith = bs;
        de.isNaN = ws;
        de.isNative = xs;
        de.isNil = ks;
        de.isNull = Es;
        de.isNumber = Ts;
        de.isObject = gs;
        de.isObjectLike = _s;
        de.isPlainObject = Os;
        de.isRegExp = Ss;
        de.isSafeInteger = Cs;
        de.isSet = As;
        de.isString = js;
        de.isSymbol = Ps;
        de.isTypedArray = Ds;
        de.isUndefined = Is;
        de.isWeakMap = Ns;
        de.isWeakSet = Ls;
        de.join = Kr;
        de.kebabCase = Fl;
        de.last = Xr;
        de.lastIndexOf = Zr;
        de.lowerCase = Wl;
        de.lowerFirst = zl;
        de.lt = Rs;
        de.lte = Ms;
        de.max = Zu;
        de.maxBy = Qu;
        de.mean = Ju;
        de.meanBy = ec;
        de.min = tc;
        de.minBy = nc;
        de.stubArray = qu;
        de.stubFalse = $u;
        de.stubObject = Uu;
        de.stubString = Vu;
        de.stubTrue = Hu;
        de.multiply = ic;
        de.nth = Qr;
        de.noConflict = Au;
        de.noop = ju;
        de.now = ba;
        de.pad = Yl;
        de.padEnd = Gl;
        de.padStart = Kl;
        de.parseInt = Xl;
        de.random = Ml;
        de.reduce = fa;
        de.reduceRight = ha;
        de.repeat = Zl;
        de.replace = Ql;
        de.result = kl;
        de.round = rc;
        de.runInContext = e;
        de.sample = pa;
        de.size = _a;
        de.snakeCase = Jl;
        de.some = ya;
        de.sortedIndex = so;
        de.sortedIndexBy = lo;
        de.sortedIndexOf = uo;
        de.sortedLastIndex = co;
        de.sortedLastIndexBy = fo;
        de.sortedLastIndexOf = ho;
        de.startCase = tu;
        de.startsWith = nu;
        de.subtract = oc;
        de.sum = ac;
        de.sumBy = sc;
        de.template = iu;
        de.times = Fu;
        de.toFinite = qs;
        de.toInteger = $s;
        de.toLength = Us;
        de.toLower = ru;
        de.toNumber = Vs;
        de.toSafeInteger = Fs;
        de.toString = Ws;
        de.toUpper = ou;
        de.trim = au;
        de.trimEnd = su;
        de.trimStart = lu;
        de.truncate = uu;
        de.unescape = cu;
        de.uniqueId = zu;
        de.upperCase = fu;
        de.upperFirst = hu;
        de.each = na;
        de.eachRight = ia;
        de.first = Hr;
        Cu(de, function () {
            var n = {};
            wt(de, function (e, t) {
                if (!w.call(de.prototype, t)) {
                    n[t] = e
                }
            });
            return n
        }(), {
            chain: false
        });
        de.VERSION = uc;
        Th(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function (e) {
            de[e].placeholder = de
        });
        Th(["drop", "take"], function (n, i) {
            _e.prototype[n] = function (e) {
                e = e === lc ? 1 : W($s(e), 0);
                var t = this.__filtered__ && !i ? new _e(this) : this.clone();
                if (t.__filtered__) {
                    t.__takeCount__ = z(e, t.__takeCount__)
                } else {
                    t.__views__.push({
                        size: z(e, Vc),
                        type: n + (t.__dir__ < 0 ? "Right" : "")
                    })
                }
                return t
            };
            _e.prototype[n + "Right"] = function (e) {
                return this.reverse()[n](e).reverse()
            }
        });
        Th(["filter", "map", "takeWhile"], function (e, t) {
            var n = t + 1,
                i = n == Lc || n == Mc;
            _e.prototype[e] = function (e) {
                var t = this.clone();
                t.__iteratees__.push({
                    iteratee: Ri(e, 3),
                    type: n
                });
                t.__filtered__ = t.__filtered__ || i;
                return t
            }
        });
        Th(["head", "last"], function (e, t) {
            var n = "take" + (t ? "Right" : "");
            _e.prototype[e] = function () {
                return this[n](1).value()[0]
            }
        });
        Th(["initial", "tail"], function (e, t) {
            var n = "drop" + (t ? "" : "Right");
            _e.prototype[e] = function () {
                return this.__filtered__ ? new _e(this) : this[n](1)
            }
        });
        _e.prototype.compact = function () {
            return this.filter(xu)
        };
        _e.prototype.find = function (e) {
            return this.filter(e).head()
        };
        _e.prototype.findLast = function (e) {
            return this.reverse().find(e)
        };
        _e.prototype.invokeMap = fn(function (t, n) {
            if (typeof t == "function") {
                return new _e(this)
            }
            return this.map(function (e) {
                return It(e, t, n)
            })
        });
        _e.prototype.reject = function (e) {
            return this.filter(Ia(Ri(e)))
        };
        _e.prototype.slice = function (e, t) {
            e = $s(e);
            var n = this;
            if (n.__filtered__ && (e > 0 || t < 0)) {
                return new _e(n)
            }
            if (e < 0) {
                n = n.takeRight(-e)
            } else if (e) {
                n = n.drop(e)
            }
            if (t !== lc) {
                t = $s(t);
                n = t < 0 ? n.dropRight(-t) : n.take(t - e)
            }
            return n
        };
        _e.prototype.takeRightWhile = function (e) {
            return this.reverse().takeWhile(e).reverse()
        };
        _e.prototype.toArray = function () {
            return this.take(Vc)
        };
        wt(_e.prototype, function (f, e) {
            var h = /^(?:filter|find|map|reject)|While$/.test(e),
                d = /^(?:head|last)$/.test(e),
                p = de[d ? "take" + (e == "last" ? "Right" : "") : e],
                v = d || /^find/.test(e);
            if (!p) {
                return
            }
            de.prototype[e] = function () {
                var e = this.__wrapped__,
                    n = d ? [1] : arguments,
                    t = e instanceof _e,
                    i = n[0],
                    r = t || es(e);
                var o = function (e) {
                    var t = p.apply(de, Dh([e], n));
                    return d && a ? t[0] : t
                };
                if (r && h && typeof i == "function" && i.length != 1) {
                    t = r = false
                }
                var a = this.__chain__,
                    s = !!this.__actions__.length,
                    l = v && !a,
                    u = t && !s;
                if (!v && r) {
                    e = u ? e : new _e(this);
                    var c = f.apply(e, n);
                    c.__actions__.push({
                        func: qo,
                        args: [o],
                        thisArg: lc
                    });
                    return new ge(c, a)
                }
                if (l && u) {
                    return f.apply(this, n)
                }
                c = this.thru(o);
                return l ? d ? c.value()[0] : c.value() : c
            }
        });
        Th(["pop", "push", "shift", "sort", "splice", "unshift"], function (e) {
            var n = a[e],
                i = /^(?:push|sort|unshift)$/.test(e) ? "tap" : "thru",
                r = /^(?:pop|shift)$/.test(e);
            de.prototype[e] = function () {
                var t = arguments;
                if (r && !this.__chain__) {
                    var e = this.value();
                    return n.apply(es(e) ? e : [], t)
                }
                return this[i](function (e) {
                    return n.apply(es(e) ? e : [], t)
                })
            }
        });
        wt(_e.prototype, function (e, t) {
            var n = de[t];
            if (n) {
                var i = n.name + "",
                    r = re[i] || (re[i] = []);
                r.push({
                    name: t,
                    func: n
                })
            }
        });
        re[fi(lc, xc).name] = [{
            name: "wrapper",
            func: lc
        }];
        _e.prototype.clone = ye;
        _e.prototype.reverse = me;
        _e.prototype.value = be;
        de.prototype.at = $o;
        de.prototype.chain = Uo;
        de.prototype.commit = Vo;
        de.prototype.next = Ho;
        de.prototype.plant = Wo;
        de.prototype.reverse = zo;
        de.prototype.toJSON = de.prototype.valueOf = de.prototype.value = Yo;
        de.prototype.first = de.prototype.head;
        if (D) {
            de.prototype[D] = Fo
        }
        return de
    };
    var yd = le();
    if (typeof define == "function" && typeof define.amd == "object" && define.amd) {
        dh._ = yd;
        define(function () {
            return yd
        })
    } else if (J) {
        (J.exports = yd)._ = yd;
        Q._ = yd
    } else {
        dh._ = yd
    }
}).call(this);
(function e(t, n) {
    if (typeof exports === "object" && typeof module === "object")
        module.exports = n(require("lodash"));
    else if (typeof define === "function" && define.amd)
        define(["lodash"], n);
    else if (typeof exports === "object")
        exports["machina"] = n(require("lodash"));
    else
        t["machina"] = n(t["_"])
})(this, function (n) {
    return function (n) {
        var i = {};

        function r(e) {
            if (i[e])
                return i[e].exports;
            var t = i[e] = {
                exports: {},
                id: e,
                loaded: false
            };
            n[e].call(t.exports, t, t.exports, r);
            t.loaded = true;
            return t.exports
        }
        r.m = n;
        r.c = i;
        r.p = "";
        return r(0)
    }([function (e, t, n) {
        var i = n(1);
        var r = n(2);
        e.exports = i.merge(r.instance, {
            Fsm: n(5),
            BehavioralFsm: n(6),
            utils: n(3),
            eventListeners: {
                newFsm: []
            }
        })
    }, function (e, t) {
        e.exports = n
    }, function (e, t, n) {
        var i = n(3);
        var r = n(1);

        function o() {
            return {
                emit: function (e) {
                    var t = i.getLeaklessArgs(arguments);
                    if (this.eventListeners["*"]) {
                        r.each(this.eventListeners["*"], function (e) {
                            if (!this.useSafeEmit) {
                                e.apply(this, t)
                            } else {
                                try {
                                    e.apply(this, t)
                                } catch (e) {
                                    if (console && typeof console.log !== "undefined") {
                                        console.log(e.stack)
                                    }
                                }
                            }
                        }, this)
                    }
                    if (this.eventListeners[e]) {
                        r.each(this.eventListeners[e], function (e) {
                            if (!this.useSafeEmit) {
                                e.apply(this, t.slice(1))
                            } else {
                                try {
                                    e.apply(this, t.slice(1))
                                } catch (e) {
                                    if (console && typeof console.log !== "undefined") {
                                        console.log(e.stack)
                                    }
                                }
                            }
                        }, this)
                    }
                },
                on: function (e, t) {
                    var n = this;
                    n.eventListeners = n.eventListeners || {
                        "*": []
                    };
                    if (!n.eventListeners[e]) {
                        n.eventListeners[e] = []
                    }
                    n.eventListeners[e].push(t);
                    return {
                        eventName: e,
                        callback: t,
                        off: function () {
                            n.off(e, t)
                        }
                    }
                },
                off: function (e, t) {
                    this.eventListeners = this.eventListeners || {
                        "*": []
                    };
                    if (!e) {
                        this.eventListeners = {}
                    } else {
                        if (t) {
                            this.eventListeners[e] = r.without(this.eventListeners[e], t)
                        } else {
                            this.eventListeners[e] = []
                        }
                    }
                }
            }
        }
        e.exports = {
            getInstance: o,
            instance: o()
        }
    }, function (e, t, n) {
        var a = [].slice;
        var r = n(4);
        var s = n(1);
        var i = function () {
            var e = 0;
            return function () {
                return "fsm." + e++
            }
        }();

        function o() {
            return {
                initialState: "uninitialized",
                eventListeners: {
                    "*": []
                },
                states: {},
                namespace: i(),
                useSafeEmit: false,
                hierarchy: {},
                pendingDelegations: {}
            }
        }

        function l() {
            return {
                inputQueue: [],
                targetReplayState: "",
                state: undefined,
                priorState: undefined,
                priorAction: "",
                currentAction: "",
                currentActionArgs: undefined,
                inExitHandler: false
            }
        }

        function u(e, t) {
            var n = [];
            for (var i = t || 0; i < e.length; i++) {
                n[i] = e[i]
            }
            return n
        }

        function c(e) {
            if (!e) {
                return
            }
            var t = {};
            if (typeof e === "object") {
                if (e.factory) {
                    t = e;
                    t.instance = t.factory()
                } else {
                    t.factory = function () {
                        return e
                    }
                }
            } else if (typeof e === "function") {
                t.factory = e
            }
            t.instance = t.factory();
            return t
        }

        function f(i, e) {
            return e.on("*", function (e, t) {
                switch (e) {
                    case r.NO_HANDLER:
                        if (!t.ticket && !t.delegated && t.namespace !== i.namespace) {
                            t.args[1].bubbling = true
                        }
                        if (t.inputType !== "_reset") {
                            i.handle.apply(i, t.args)
                        }
                        break;
                    case r.HANDLING:
                        var n = t.ticket;
                        if (n && i.pendingDelegations[n]) {
                            delete i.pendingDelegations[n]
                        }
                        i.emit(e, t);
                        break;
                    default:
                        i.emit(e, t);
                        break
                }
            })
        }
        var h = ["states", "initialState"];
        var d = function (e, t) {
            var i = this;
            var n;
            var r = {};
            var o = function () {};
            if (e && e.hasOwnProperty("constructor")) {
                n = e.constructor
            } else {
                n = function () {
                    var e = a.call(arguments, 0);
                    e[0] = e[0] || {};
                    var t;
                    var n = e[0].states || {};
                    t = s.merge(s.cloneDeep(r), {
                        states: n
                    });
                    t.initialState = e[0].initialState || this.initialState;
                    s.extend(e[0], t);
                    i.apply(this, e)
                }
            }
            s.merge(n, i);
            o.prototype = i.prototype;
            n.prototype = new o;
            if (e) {
                s.extend(n.prototype, e);
                s.merge(r, s.transform(e, function (e, t, n) {
                    if (h.indexOf(n) !== -1) {
                        e[n] = t
                    }
                }))
            }
            if (t) {
                s.merge(n, t)
            }
            n.prototype.constructor = n;
            n.__super__ = i.prototype;
            return n
        };

        function p() {
            var e = [];
            var t = "0123456789abcdef";
            for (var n = 0; n < 36; n++) {
                e[n] = t.substr(Math.floor(Math.random() * 16), 1)
            }
            e[14] = "4";
            e[19] = t.substr(e[19] & 3 | 8, 1);
            e[8] = e[13] = e[18] = e[23] = "-";
            return e.join("")
        }
        e.exports = {
            createUUID: p,
            extend: d,
            getDefaultBehavioralOptions: o,
            getDefaultOptions: o,
            getDefaultClientMeta: l,
            getChildFsmInstance: c,
            getLeaklessArgs: u,
            listenToChild: f,
            makeFsmNamespace: i
        }
    }, function (e, t) {
        e.exports = {
            NEXT_TRANSITION: "transition",
            HANDLING: "handling",
            HANDLED: "handled",
            NO_HANDLER: "nohandler",
            TRANSITION: "transition",
            TRANSITIONED: "transitioned",
            INVALID_STATE: "invalidstate",
            DEFERRED: "deferred",
            NEW_FSM: "newfsm"
        }
    }, function (e, t, n) {
        var i = n(6);
        var r = n(3);
        var o = n(1);
        var a = {
            constructor: function () {
                i.apply(this, arguments);
                this.ensureClientMeta()
            },
            initClient: function e() {
                var t = this.initialState;
                if (!t) {
                    throw new Error("You must specify an initial state for this FSM")
                }
                if (!this.states[t]) {
                    throw new Error("The initial state specified does not exist in the states object.")
                }
                this.transition(t)
            },
            ensureClientMeta: function e() {
                if (!this._stamped) {
                    this._stamped = true;
                    o.defaults(this, o.cloneDeep(r.getDefaultClientMeta()));
                    this.initClient()
                }
                return this
            },
            ensureClientArg: function (e) {
                var t = e;
                if (typeof t[0] === "object" && !("inputType" in t[0]) && t[0] !== this) {
                    t.splice(0, 1, this)
                } else if (typeof t[0] !== "object" || typeof t[0] === "object" && "inputType" in t[0]) {
                    t.unshift(this)
                }
                return t
            },
            getHandlerArgs: function (e, t) {
                var n = e;
                var i = n[1];
                if (typeof inputType === "object") {
                    n.splice(1, 1, i.inputType)
                }
                return t ? n.slice(1) : n.slice(2)
            },
            getSystemHandlerArgs: function (e, t) {
                return e
            },
            buildEventPayload: function () {
                var e = this.ensureClientArg(r.getLeaklessArgs(arguments));
                var t = e[1];
                if (o.isPlainObject(t)) {
                    return o.extend(t, {
                        namespace: this.namespace
                    })
                } else {
                    return {
                        data: t || null,
                        namespace: this.namespace
                    }
                }
            }
        };
        o.each(["handle", "transition", "deferUntilTransition", "processQueue", "clearQueue"], function (t) {
            a[t] = function () {
                var e = this.ensureClientArg(r.getLeaklessArgs(arguments));
                return i.prototype[t].apply(this, e)
            }
        });
        a = i.extend(a);
        e.exports = a
    }, function (e, t, n) {
        var p = n(1);
        var v = n(3);
        var i = n(2);
        var r = i.instance;
        var g = n(4);
        var o = "__machina__";

        function a(e) {
            p.extend(this, e);
            p.defaults(this, v.getDefaultBehavioralOptions());
            this.initialize.apply(this, arguments);
            r.emit(g.NEW_FSM, this)
        }
        p.extend(a.prototype, {
            initialize: function () {},
            initClient: function e(t) {
                var n = this.initialState;
                if (!n) {
                    throw new Error("You must specify an initial state for this FSM")
                }
                if (!this.states[n]) {
                    throw new Error("The initial state specified does not exist in the states object.")
                }
                this.transition(t, n)
            },
            configForState: function e(t) {
                var n = this.states[t];
                var i;
                p.each(this.hierarchy, function (e, t) {
                    if (e && typeof e.off === "function") {
                        e.off()
                    }
                });
                if (n._child) {
                    n._child = v.getChildFsmInstance(n._child);
                    i = n._child && n._child.instance;
                    this.hierarchy[i.namespace] = v.listenToChild(this, i)
                }
                return i
            },
            ensureClientMeta: function e(t) {
                if (typeof t !== "object") {
                    throw new Error("An FSM client must be an object.")
                }
                t[o] = t[o] || {};
                if (!t[o][this.namespace]) {
                    t[o][this.namespace] = p.cloneDeep(v.getDefaultClientMeta());
                    this.initClient(t)
                }
                return t[o][this.namespace]
            },
            buildEventPayload: function (e, t) {
                if (p.isPlainObject(t)) {
                    return p.extend(t, {
                        client: e,
                        namespace: this.namespace
                    })
                } else {
                    return {
                        client: e,
                        data: t || null,
                        namespace: this.namespace
                    }
                }
            },
            getHandlerArgs: function (e, t) {
                var n = e.slice(0);
                var i = n[1];
                if (typeof i === "object") {
                    n.splice(1, 1, i.inputType)
                }
                return t ? n : [n[0]].concat(n.slice(2))
            },
            getSystemHandlerArgs: function (e, t) {
                return [t].concat(e)
            },
            handle: function (e, t) {
                var n = t;
                if (typeof t === "undefined") {
                    throw new Error("The input argument passed to the FSM's handle method is undefined. Did you forget to pass the input name?")
                }
                if (typeof t === "string") {
                    n = {
                        inputType: t,
                        delegated: false,
                        ticket: undefined
                    }
                }
                var i = this.ensureClientMeta(e);
                var r = v.getLeaklessArgs(arguments);
                if (typeof t !== "object") {
                    r.splice(1, 1, n)
                }
                i.currentActionArgs = r.slice(1);
                var o = i.state;
                var a = this.states[o];
                var s;
                var l;
                var u = false;
                var c;
                var f;
                var h;
                if (!i.inExitHandler) {
                    c = this.configForState(o);
                    if (c && !this.pendingDelegations[n.ticket] && !n.bubbling) {
                        n.ticket = n.ticket || v.createUUID();
                        n.delegated = true;
                        this.pendingDelegations[n.ticket] = {
                            delegatedTo: c.namespace
                        };
                        f = c.handle.apply(c, r)
                    } else {
                        if (n.ticket && this.pendingDelegations[n.ticket]) {
                            delete this.pendingDelegations[n.ticket]
                        }
                        s = a[n.inputType] ? n.inputType : "*";
                        u = s === "*";
                        l = a[s] || this[s] || this["*"];
                        h = i.state + "." + s;
                        i.currentAction = h;
                        var d = this.buildEventPayload(e, {
                            inputType: n.inputType,
                            delegated: n.delegated,
                            ticket: n.ticket
                        });
                        if (!l) {
                            this.emit(g.NO_HANDLER, p.extend({
                                args: r
                            }, d))
                        } else {
                            this.emit(g.HANDLING, d);
                            if (typeof l === "function") {
                                f = l.apply(this, this.getHandlerArgs(r, u))
                            } else {
                                f = l;
                                this.transition(e, l)
                            }
                            this.emit(g.HANDLED, d)
                        }
                        i.priorAction = i.currentAction;
                        i.currentAction = "";
                        i.currentActionArgs = undefined
                    }
                }
                return f
            },
            transition: function (e, t) {
                var n = this.ensureClientMeta(e);
                var i = n.state;
                var r = this.states[i];
                var o = this.states[t];
                var a;
                var s = v.getLeaklessArgs(arguments).slice(2);
                if (!n.inExitHandler && t !== i) {
                    if (o) {
                        a = this.configForState(t);
                        if (r && r._onExit) {
                            n.inExitHandler = true;
                            r._onExit.call(this, e);
                            n.inExitHandler = false
                        }
                        n.targetReplayState = t;
                        n.priorState = i;
                        n.state = t;
                        var l = this.buildEventPayload(e, {
                            fromState: n.priorState,
                            action: n.currentAction,
                            toState: t
                        });
                        this.emit(g.TRANSITION, l);
                        if (o._onEnter) {
                            o._onEnter.apply(this, this.getSystemHandlerArgs(s, e));
                            this.emit(g.TRANSITIONED, l)
                        }
                        if (a) {
                            a.handle(e, "_reset")
                        }
                        if (n.targetReplayState === t) {
                            this.processQueue(e, g.NEXT_TRANSITION)
                        }
                        return
                    }
                    this.emit(g.INVALID_STATE, this.buildEventPayload(e, {
                        state: n.state,
                        attemptedState: t
                    }))
                }
            },
            deferUntilTransition: function (e, t) {
                var n = this.ensureClientMeta(e);
                if (n.currentActionArgs) {
                    var i = {
                        type: g.NEXT_TRANSITION,
                        untilState: t,
                        args: n.currentActionArgs
                    };
                    n.inputQueue.push(i);
                    var r = this.buildEventPayload(e, {
                        state: n.state,
                        queuedArgs: i
                    });
                    this.emit(g.DEFERRED, r)
                }
            },
            deferAndTransition: function (e, t) {
                this.deferUntilTransition(e, t);
                this.transition(e, t)
            },
            processQueue: function (t) {
                var n = this.ensureClientMeta(t);
                var e = function (e) {
                    return !e.untilState || e.untilState === n.state
                };
                var i = p.filter(n.inputQueue, e);
                n.inputQueue = p.difference(n.inputQueue, i);
                p.each(i, function (e) {
                    this.handle.apply(this, [t].concat(e.args))
                }, this)
            },
            clearQueue: function (e, t) {
                var n = this.ensureClientMeta(e);
                if (!t) {
                    n.inputQueue = []
                } else {
                    var i = function (e) {
                        return t ? e.untilState !== t : true
                    };
                    n.inputQueue = p.filter(n.inputQueue, i)
                }
            },
            compositeState: function (e) {
                var t = this.ensureClientMeta(e);
                var n = t.state;
                var i = this.states[n]._child && this.states[n]._child.instance;
                if (i) {
                    n += "." + i.compositeState(e)
                }
                return n
            }
        }, i.getInstance());
        a.extend = v.extend;
        e.exports = a
    }])
});
(function (e) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], e)
    } else if (typeof exports === "object") {
        e(require("jquery"))
    } else {
        e(jQuery)
    }
})(function (h) {
    var t = /\+/g;

    function d(e) {
        return _.raw ? e : encodeURIComponent(e)
    }

    function p(e) {
        return _.raw ? e : decodeURIComponent(e)
    }

    function v(e) {
        return d(_.json ? JSON.stringify(e) : String(e))
    }

    function i(e) {
        if (e.indexOf('"') === 0) {
            e = e.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\")
        }
        try {
            e = decodeURIComponent(e.replace(t, " "));
            return _.json ? JSON.parse(e) : e
        } catch (e) {}
    }

    function g(e, t) {
        var n = _.raw ? e : i(e);
        return h.isFunction(t) ? t(n) : n
    }
    var _ = h.cookie = function (e, t, n) {
        if (t !== undefined && !h.isFunction(t)) {
            n = h.extend({}, _.defaults, n);
            if (typeof n.expires === "number") {
                var i = n.expires,
                    r = n.expires = new Date;
                r.setTime(+r + i * 864e5)
            }
            return document.cookie = [d(e), "=", v(t), n.expires ? "; expires=" + n.expires.toUTCString() : "", n.path ? "; path=" + n.path : "", n.domain ? "; domain=" + n.domain : "", n.secure ? "; secure" : ""].join("")
        }
        var o = e ? undefined : {};
        var a = document.cookie ? document.cookie.split("; ") : [];
        for (var s = 0, l = a.length; s < l; s++) {
            var u = a[s].split("=");
            var c = p(u.shift());
            var f = u.join("=");
            if (e && e === c) {
                o = g(f, t);
                break
            }
            if (!e && (f = g(f)) !== undefined) {
                o[c] = f
            }
        }
        return o
    };
    _.defaults = {};
    h.removeCookie = function (e, t) {
        if (h.cookie(e) === undefined) {
            return false
        }
        h.cookie(e, "", h.extend({}, t, {
            expires: -1
        }));
        return !h.cookie(e)
    }
});
! function (e) {
    "use strict";

    function f(e, t) {
        var n = (65535 & e) + (65535 & t),
            i = (e >> 16) + (t >> 16) + (n >> 16);
        return i << 16 | 65535 & n
    }

    function a(e, t) {
        return e << t | e >>> 32 - t
    }

    function s(e, t, n, i, r, o) {
        return f(a(f(f(t, e), f(i, o)), r), n)
    }

    function h(e, t, n, i, r, o, a) {
        return s(t & n | ~t & i, e, t, r, o, a)
    }

    function d(e, t, n, i, r, o, a) {
        return s(t & i | n & ~i, e, t, r, o, a)
    }

    function p(e, t, n, i, r, o, a) {
        return s(t ^ n ^ i, e, t, r, o, a)
    }

    function v(e, t, n, i, r, o, a) {
        return s(n ^ (t | ~i), e, t, r, o, a)
    }

    function l(e, t) {
        e[t >> 5] |= 128 << t % 32,
            e[(t + 64 >>> 9 << 4) + 14] = t;
        var n, i, r, o, a, s = 1732584193,
            l = -271733879,
            u = -1732584194,
            c = 271733878;
        for (n = 0; n < e.length; n += 16)
            i = s,
            r = l,
            o = u,
            a = c,
            s = h(s, l, u, c, e[n], 7, -680876936),
            c = h(c, s, l, u, e[n + 1], 12, -389564586),
            u = h(u, c, s, l, e[n + 2], 17, 606105819),
            l = h(l, u, c, s, e[n + 3], 22, -1044525330),
            s = h(s, l, u, c, e[n + 4], 7, -176418897),
            c = h(c, s, l, u, e[n + 5], 12, 1200080426),
            u = h(u, c, s, l, e[n + 6], 17, -1473231341),
            l = h(l, u, c, s, e[n + 7], 22, -45705983),
            s = h(s, l, u, c, e[n + 8], 7, 1770035416),
            c = h(c, s, l, u, e[n + 9], 12, -1958414417),
            u = h(u, c, s, l, e[n + 10], 17, -42063),
            l = h(l, u, c, s, e[n + 11], 22, -1990404162),
            s = h(s, l, u, c, e[n + 12], 7, 1804603682),
            c = h(c, s, l, u, e[n + 13], 12, -40341101),
            u = h(u, c, s, l, e[n + 14], 17, -1502002290),
            l = h(l, u, c, s, e[n + 15], 22, 1236535329),
            s = d(s, l, u, c, e[n + 1], 5, -165796510),
            c = d(c, s, l, u, e[n + 6], 9, -1069501632),
            u = d(u, c, s, l, e[n + 11], 14, 643717713),
            l = d(l, u, c, s, e[n], 20, -373897302),
            s = d(s, l, u, c, e[n + 5], 5, -701558691),
            c = d(c, s, l, u, e[n + 10], 9, 38016083),
            u = d(u, c, s, l, e[n + 15], 14, -660478335),
            l = d(l, u, c, s, e[n + 4], 20, -405537848),
            s = d(s, l, u, c, e[n + 9], 5, 568446438),
            c = d(c, s, l, u, e[n + 14], 9, -1019803690),
            u = d(u, c, s, l, e[n + 3], 14, -187363961),
            l = d(l, u, c, s, e[n + 8], 20, 1163531501),
            s = d(s, l, u, c, e[n + 13], 5, -1444681467),
            c = d(c, s, l, u, e[n + 2], 9, -51403784),
            u = d(u, c, s, l, e[n + 7], 14, 1735328473),
            l = d(l, u, c, s, e[n + 12], 20, -1926607734),
            s = p(s, l, u, c, e[n + 5], 4, -378558),
            c = p(c, s, l, u, e[n + 8], 11, -2022574463),
            u = p(u, c, s, l, e[n + 11], 16, 1839030562),
            l = p(l, u, c, s, e[n + 14], 23, -35309556),
            s = p(s, l, u, c, e[n + 1], 4, -1530992060),
            c = p(c, s, l, u, e[n + 4], 11, 1272893353),
            u = p(u, c, s, l, e[n + 7], 16, -155497632),
            l = p(l, u, c, s, e[n + 10], 23, -1094730640),
            s = p(s, l, u, c, e[n + 13], 4, 681279174),
            c = p(c, s, l, u, e[n], 11, -358537222),
            u = p(u, c, s, l, e[n + 3], 16, -722521979),
            l = p(l, u, c, s, e[n + 6], 23, 76029189),
            s = p(s, l, u, c, e[n + 9], 4, -640364487),
            c = p(c, s, l, u, e[n + 12], 11, -421815835),
            u = p(u, c, s, l, e[n + 15], 16, 530742520),
            l = p(l, u, c, s, e[n + 2], 23, -995338651),
            s = v(s, l, u, c, e[n], 6, -198630844),
            c = v(c, s, l, u, e[n + 7], 10, 1126891415),
            u = v(u, c, s, l, e[n + 14], 15, -1416354905),
            l = v(l, u, c, s, e[n + 5], 21, -57434055),
            s = v(s, l, u, c, e[n + 12], 6, 1700485571),
            c = v(c, s, l, u, e[n + 3], 10, -1894986606),
            u = v(u, c, s, l, e[n + 10], 15, -1051523),
            l = v(l, u, c, s, e[n + 1], 21, -2054922799),
            s = v(s, l, u, c, e[n + 8], 6, 1873313359),
            c = v(c, s, l, u, e[n + 15], 10, -30611744),
            u = v(u, c, s, l, e[n + 6], 15, -1560198380),
            l = v(l, u, c, s, e[n + 13], 21, 1309151649),
            s = v(s, l, u, c, e[n + 4], 6, -145523070),
            c = v(c, s, l, u, e[n + 11], 10, -1120210379),
            u = v(u, c, s, l, e[n + 2], 15, 718787259),
            l = v(l, u, c, s, e[n + 9], 21, -343485551),
            s = f(s, i),
            l = f(l, r),
            u = f(u, o),
            c = f(c, a);
        return [s, l, u, c]
    }

    function u(e) {
        var t, n = "",
            i = 32 * e.length;
        for (t = 0; t < i; t += 8)
            n += String.fromCharCode(e[t >> 5] >>> t % 32 & 255);
        return n
    }

    function c(e) {
        var t, n = [];
        for (n[(e.length >> 2) - 1] = void 0,
            t = 0; t < n.length; t += 1)
            n[t] = 0;
        var i = 8 * e.length;
        for (t = 0; t < i; t += 8)
            n[t >> 5] |= (255 & e.charCodeAt(t / 8)) << t % 32;
        return n
    }

    function t(e) {
        return u(l(c(e), 8 * e.length))
    }

    function n(e, t) {
        var n, i, r = c(e),
            o = [],
            a = [];
        for (o[15] = a[15] = void 0,
            r.length > 16 && (r = l(r, 8 * e.length)),
            n = 0; n < 16; n += 1)
            o[n] = 909522486 ^ r[n],
            a[n] = 1549556828 ^ r[n];
        return i = l(o.concat(c(t)), 512 + 8 * t.length),
            u(l(a.concat(i), 640))
    }

    function i(e) {
        var t, n, i = "0123456789abcdef",
            r = "";
        for (n = 0; n < e.length; n += 1)
            t = e.charCodeAt(n),
            r += i.charAt(t >>> 4 & 15) + i.charAt(15 & t);
        return r
    }

    function r(e) {
        return unescape(encodeURIComponent(e))
    }

    function o(e) {
        return t(r(e))
    }

    function g(e) {
        return i(o(e))
    }

    function _(e, t) {
        return n(r(e), r(t))
    }

    function y(e, t) {
        return i(_(e, t))
    }

    function m(e, t, n) {
        return t ? n ? _(t, e) : y(t, e) : n ? o(e) : g(e)
    }
    "function" == typeof define && define.amd ? define(function () {
        return m
    }) : "object" == typeof module && module.exports ? module.exports = m : e.md5 = m
}(this);
! function (o) {
    o.fn.niceSelect = function (e) {
        function i(e) {
            e.after(o("<div></div>").addClass("nice-select").addClass(e.attr("class") || "").addClass(e.attr("disabled") ? "disabled" : "").attr("tabindex", e.attr("disabled") ? null : "0").html('<span class="current"></span><ul class="list"></ul>'));
            var i = e.next(),
                t = e.find("option"),
                n = e.find("option:selected");
            i.find(".current").html(n.data("display") || n.text()),
                t.each(function (e) {
                    var t = o(this),
                        n = t.data("display");
                    i.find("ul").append(o("<li></li>").attr("data-value", t.val()).attr("data-display", n || null).addClass("option" + (t.is(":selected") ? " selected" : "") + (t.is(":disabled") ? " disabled" : "")).html(t.text()))
                })
        }
        if ("string" == typeof e)
            return "update" == e ? this.each(function () {
                    var e = o(this),
                        t = o(this).next(".nice-select"),
                        n = t.hasClass("open");
                    t.length && (t.remove(),
                        i(e),
                        n && e.next().trigger("click"))
                }) : "destroy" == e ? (this.each(function () {
                        var e = o(this),
                            t = o(this).next(".nice-select");
                        t.length && (t.remove(),
                            e.css("display", ""))
                    }),
                    0 == o(".nice-select").length && o(document).off(".nice_select")) : console.log('Method "' + e + '" does not exist.'),
                this;
        this.hide(),
            this.each(function () {
                var e = o(this);
                e.next().hasClass("nice-select") || i(e)
            }),
            o(document).off(".nice_select"),
            o(document).on("click.nice_select", ".nice-select", function (e) {
                var t = o(this);
                o(".nice-select").not(t).removeClass("open"),
                    t.toggleClass("open"),
                    t.hasClass("open") ? (t.find(".option"),
                        t.find(".focus").removeClass("focus"),
                        t.find(".selected").addClass("focus")) : t.focus()
            }),
            o(document).on("click.nice_select", function (e) {
                0 === o(e.target).closest(".nice-select").length && o(".nice-select").removeClass("open").find(".option")
            }),
            o(document).on("click.nice_select", ".nice-select .option:not(.disabled)", function (e) {
                var t = o(this),
                    n = t.closest(".nice-select");
                n.find(".selected").removeClass("selected"),
                    t.addClass("selected");
                var i = t.data("display") || t.text();
                n.find(".current").text(i),
                    n.prev("select").val(t.data("value")).trigger("change")
            }),
            o(document).on("keydown.nice_select", ".nice-select", function (e) {
                var t = o(this),
                    n = o(t.find(".focus") || t.find(".list .option.selected"));
                if (32 == e.keyCode || 13 == e.keyCode)
                    return t.hasClass("open") ? n.trigger("click") : t.trigger("click"), !1;
                if (40 == e.keyCode) {
                    if (t.hasClass("open")) {
                        var i = n.nextAll(".option:not(.disabled)").first();
                        i.length > 0 && (t.find(".focus").removeClass("focus"),
                            i.addClass("focus"))
                    } else
                        t.trigger("click");
                    return !1
                }
                if (38 == e.keyCode) {
                    if (t.hasClass("open")) {
                        var r = n.prevAll(".option:not(.disabled)").first();
                        r.length > 0 && (t.find(".focus").removeClass("focus"),
                            r.addClass("focus"))
                    } else
                        t.trigger("click");
                    return !1
                }
                if (27 == e.keyCode)
                    t.hasClass("open") && t.trigger("click");
                else if (9 == e.keyCode && t.hasClass("open"))
                    return !1
            });
        var t = document.createElement("a").style;
        return t.cssText = "pointer-events:auto",
            "auto" !== t.pointerEvents && o("html").addClass("no-csspointerevents"),
            this
    }
}(jQuery);
var Vector = function (e, t) {
    this.x = e;
    this.y = t
};
Vector.prototype.add = function (e) {
    return new Vector(this.x + e.x, this.y + e.y)
};
Vector.prototype.subtract = function (e) {
    return new Vector(this.x - e.x, this.y - e.y)
};
Vector.prototype.vectorWithinDist = function (e, t) {
    var n = this.distanceSquared(e);
    return n <= t * t
};
Vector.prototype.vectorsWithinDist = function (e, n) {
    var i = false;
    $.each(e, function (e, t) {
            if (this.vectorWithinDist(t, n))
                i = true;
            return false
        }
        .bind(this));
    return i
};
Vector.prototype.distanceSquared = function (e) {
    var t = e.y - this.y;
    var n = e.x - this.x;
    return t * t + n * n
};
Vector.prototype.withinRect = function (e) {
    var t = false;
    var n = e.x;
    var i = e.x + e.width;
    var r = e.y;
    var o = e.y + e.height;
    if (this.x >= n && this.x <= i) {
        if (this.y >= r && this.y <= o) {
            t = true
        }
    }
    return t
};
Vector.prototype.magnitude = function () {
    return Math.sqrt(this.x * this.x + this.y * this.y)
};
(function (h) {
    var d = h(window);
    var n = {};
    var p = [];
    var v = [];
    var g;
    var _ = null;
    var c = "_open";
    var y = "_close";
    var m = [];
    var b = null;
    var w;
    var f = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
    var x = {
        _init: function (e) {
            var t = h(e);
            var n = t.data("popupoptions");
            v[e.id] = false;
            p[e.id] = 0;
            if (!t.data("popup-initialized")) {
                t.attr("data-popup-initialized", "true");
                x._initonce(e)
            }
            if (n.autoopen) {
                setTimeout(function () {
                    x.show(e, 0)
                }, 0)
            }
        },
        _initonce: function (n) {
            var e = h(n);
            var t = h("body");
            var i;
            var r = e.data("popupoptions");
            var o;
            _ = parseInt(t.css("margin-right"), 10);
            b = document.body.style.webkitTransition !== undefined || document.body.style.MozTransition !== undefined || document.body.style.msTransition !== undefined || document.body.style.OTransition !== undefined || document.body.style.transition !== undefined;
            if (r.type == "tooltip") {
                r.background = false;
                r.scrolllock = false
            }
            if (r.backgroundactive) {
                r.background = false;
                r.blur = false;
                r.scrolllock = false
            }
            if (r.scrolllock) {
                var a;
                var s;
                if (typeof g === "undefined") {
                    a = h('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body");
                    s = a.children();
                    g = s.innerWidth() - s.height(99).innerWidth();
                    a.remove()
                }
            }
            if (!e.attr("id")) {
                e.attr("id", "j-popup-" + parseInt(Math.random() * 1e8, 10))
            }
            e.addClass("popup_content");
            t.prepend(n);
            e.wrap('<div id="' + n.id + '_wrapper" class="popup_wrapper" />');
            i = h("#" + n.id + "_wrapper");
            i.css({
                opacity: 0,
                visibility: "hidden",
                position: "absolute"
            });
            if (f) {
                i.css("cursor", "pointer")
            }
            if (r.type == "overlay") {
                i.css("overflow", "auto")
            }
            e.css({
                opacity: 0,
                visibility: "hidden",
                display: "inline-block"
            });
            if (r.setzindex && !r.autozindex) {
                i.css("z-index", "100001")
            }
            if (!r.outline) {
                e.css("outline", "none")
            }
            if (r.transition) {
                e.css("transition", r.transition);
                i.css("transition", r.transition)
            }
            e.attr("aria-hidden", true);
            if (r.background && !h("#" + n.id + "_background").length) {
                t.prepend('<div id="' + n.id + '_background" class="popup_background"></div>');
                var l = h("#" + n.id + "_background");
                l.css({
                    opacity: 0,
                    visibility: "hidden",
                    backgroundColor: r.color,
                    position: "fixed",
                    top: 0,
                    right: 0,
                    bottom: 0,
                    left: 0
                });
                if (r.setzindex && !r.autozindex) {
                    l.css("z-index", "100000")
                }
                if (r.transition) {
                    l.css("transition", r.transition)
                }
            }
            if (r.type == "overlay") {
                e.css({
                    textAlign: "left",
                    position: "relative",
                    verticalAlign: "middle"
                });
                o = {
                    position: "fixed",
                    width: "100%",
                    height: "100%",
                    top: 0,
                    left: 0,
                    textAlign: "center"
                };
                if (r.backgroundactive) {
                    o.position = "relative";
                    o.height = "0";
                    o.overflow = "visible"
                }
                i.css(o);
                i.append('<div class="popup_align" />');
                h(".popup_align").css({
                    display: "inline-block",
                    verticalAlign: "middle",
                    height: "100%"
                })
            }
            e.attr("role", "dialog");
            var u = r.openelement ? r.openelement : "." + n.id + c;
            h(u).each(function (e, t) {
                h(t).attr("data-popup-ordinal", e);
                if (!t.id) {
                    h(t).attr("id", "open_" + parseInt(Math.random() * 1e8, 10))
                }
            });
            if (!(e.attr("aria-labelledby") || e.attr("aria-label"))) {
                e.attr("aria-labelledby", h(u).attr("id"))
            }
            if (r.action == "hover") {
                r.keepfocus = false;
                h(u).on("mouseenter", function (e) {
                    x.show(n, h(this).data("popup-ordinal"))
                });
                h(u).on("mouseleave", function (e) {
                    x.hide(n)
                })
            } else {
                h(document).on("click", u, function (e) {
                    e.preventDefault();
                    var t = h(this).data("popup-ordinal");
                    setTimeout(function () {
                        x.show(n, t)
                    }, 0)
                })
            }
            if (r.detach) {
                e.hide().detach()
            } else {
                i.hide()
            }
        },
        show: function (e, t) {
            var n = h(e);
            if (n.data("popup-visible"))
                return;
            if (!n.data("popup-initialized")) {
                x._init(e)
            }
            n.attr("data-popup-initialized", "true");
            var i = h("body");
            var r = n.data("popupoptions");
            var o = h("#" + e.id + "_wrapper");
            var a = h("#" + e.id + "_background");
            E(e, t, r.beforeopen);
            v[e.id] = t;
            setTimeout(function () {
                m.push(e.id)
            }, 0);
            if (r.autozindex) {
                var s = document.getElementsByTagName("*");
                var l = s.length;
                var u = 0;
                for (var c = 0; c < l; c++) {
                    var f = h(s[c]).css("z-index");
                    if (f !== "auto") {
                        f = parseInt(f, 10);
                        if (u < f) {
                            u = f
                        }
                    }
                }
                p[e.id] = u;
                if (r.background) {
                    if (p[e.id] > 0) {
                        h("#" + e.id + "_background").css({
                            zIndex: p[e.id] + 1
                        })
                    }
                }
                if (p[e.id] > 0) {
                    o.css({
                        zIndex: p[e.id] + 2
                    })
                }
            }
            if (r.detach) {
                o.prepend(e);
                n.show()
            } else {
                o.show()
            }
            w = setTimeout(function () {
                o.css({
                    visibility: "visible",
                    opacity: 1
                });
                h("html").addClass("popup_visible").addClass("popup_visible_" + e.id);
                n.addClass("popup_content_visible")
            }, 20);
            if (r.scrolllock) {
                i.css("overflow", "hidden");
                if (i.height() > d.height()) {
                    i.css("margin-right", _ + g)
                }
            }
            if (r.backgroundactive) {
                n.css({
                    top: (d.height() - (n.get(0).offsetHeight + parseInt(n.css("margin-top"), 10) + parseInt(n.css("margin-bottom"), 10))) / 2 + "px"
                })
            }
            n.css({
                visibility: "visible",
                opacity: 1
            });
            if (r.background) {
                a.css({
                    visibility: "visible",
                    opacity: r.opacity
                });
                setTimeout(function () {
                    a.css({
                        opacity: r.opacity
                    })
                }, 0)
            }
            n.data("popup-visible", true);
            x.reposition(e, t);
            n.data("focusedelementbeforepopup", document.activeElement);
            if (r.keepfocus) {
                n.attr("tabindex", -1);
                setTimeout(function () {
                    if (r.focuselement === "closebutton") {
                        h("#" + e.id + " ." + e.id + y + ":first").focus()
                    } else if (r.focuselement) {
                        h(r.focuselement).focus()
                    } else {
                        n.focus()
                    }
                }, r.focusdelay)
            }
            h(r.pagecontainer).attr("aria-hidden", true);
            n.attr("aria-hidden", false);
            E(e, t, r.onopen);
            if (b) {
                o.one("transitionend", function () {
                    E(e, t, r.opentransitionend)
                })
            } else {
                E(e, t, r.opentransitionend)
            }
        },
        hide: function (t) {
            if (w)
                clearTimeout(w);
            var n = h("body");
            var i = h(t);
            var r = i.data("popupoptions");
            var o = h("#" + t.id + "_wrapper");
            var e = h("#" + t.id + "_background");
            i.data("popup-visible", false);
            if (m.length === 1) {
                h("html").removeClass("popup_visible").removeClass("popup_visible_" + t.id)
            } else {
                if (h("html").hasClass("popup_visible_" + t.id)) {
                    h("html").removeClass("popup_visible_" + t.id)
                }
            }
            m.pop();
            if (h("html").hasClass("popup_content_visible")) {
                i.removeClass("popup_content_visible")
            }
            if (r.keepfocus) {
                setTimeout(function () {
                    if (h(i.data("focusedelementbeforepopup")).is(":visible")) {
                        i.data("focusedelementbeforepopup").focus()
                    }
                }, 0)
            }
            o.css({
                visibility: "hidden",
                opacity: 0
            });
            i.css({
                visibility: "hidden",
                opacity: 0
            });
            if (r.background) {
                e.css({
                    visibility: "hidden",
                    opacity: 0
                })
            }
            h(r.pagecontainer).attr("aria-hidden", false);
            i.attr("aria-hidden", true);
            E(t, v[t.id], r.onclose);
            if (b && i.css("transition-duration") !== "0s") {
                i.one("transitionend", function (e) {
                    if (!i.data("popup-visible")) {
                        if (r.detach) {
                            i.hide().detach()
                        } else {
                            o.hide()
                        }
                    }
                    if (r.scrolllock) {
                        setTimeout(function () {
                            n.css({
                                overflow: "visible",
                                "margin-right": _
                            })
                        }, 10)
                    }
                    E(t, v[t.id], r.closetransitionend)
                })
            } else {
                if (r.detach) {
                    i.hide().detach()
                } else {
                    o.hide()
                }
                if (r.scrolllock) {
                    setTimeout(function () {
                        n.css({
                            overflow: "visible",
                            "margin-right": _
                        })
                    }, 10)
                }
                E(t, v[t.id], r.closetransitionend)
            }
        },
        toggle: function (e, t) {
            if (h(e).data("popup-visible")) {
                x.hide(e)
            } else {
                setTimeout(function () {
                    x.show(e, t)
                }, 0)
            }
        },
        reposition: function (e, t) {
            var n = h(e);
            var i = n.data("popupoptions");
            var r = h("#" + e.id + "_wrapper");
            var o = h("#" + e.id + "_background");
            t = t || 0;
            if (i.type == "tooltip") {
                r.css({
                    position: "absolute"
                });
                var a;
                if (i.tooltipanchor) {
                    a = h(i.tooltipanchor)
                } else if (i.openelement) {
                    a = h(i.openelement).filter('[data-popup-ordinal="' + t + '"]')
                } else {
                    a = h("." + e.id + c + '[data-popup-ordinal="' + t + '"]')
                }
                var s = a.offset();
                if (i.horizontal == "right") {
                    r.css("left", s.left + a.outerWidth() + i.offsetleft)
                } else if (i.horizontal == "leftedge") {
                    r.css("left", s.left + a.outerWidth() - a.outerWidth() + i.offsetleft)
                } else if (i.horizontal == "left") {
                    r.css("right", d.width() - s.left - i.offsetleft)
                } else if (i.horizontal == "rightedge") {
                    r.css("right", d.width() - s.left - a.outerWidth() - i.offsetleft)
                } else {
                    r.css("left", s.left + a.outerWidth() / 2 - n.outerWidth() / 2 - parseFloat(n.css("marginLeft")) + i.offsetleft)
                }
                if (i.vertical == "bottom") {
                    r.css("top", s.top + a.outerHeight() + i.offsettop)
                } else if (i.vertical == "bottomedge") {
                    r.css("top", s.top + a.outerHeight() - n.outerHeight() + i.offsettop)
                } else if (i.vertical == "top") {
                    r.css("bottom", d.height() - s.top - i.offsettop)
                } else if (i.vertical == "topedge") {
                    r.css("bottom", d.height() - s.top - n.outerHeight() - i.offsettop)
                } else {
                    r.css("top", s.top + a.outerHeight() / 2 - n.outerHeight() / 2 - parseFloat(n.css("marginTop")) + i.offsettop)
                }
            } else if (i.type == "overlay") {
                if (i.horizontal) {
                    r.css("text-align", i.horizontal)
                } else {
                    r.css("text-align", "center")
                }
                if (i.vertical) {
                    n.css("vertical-align", i.vertical)
                } else {
                    n.css("vertical-align", "middle")
                }
            }
        }
    };
    var E = function (e, t, n) {
        var i = h(e).data("popupoptions");
        var r = i.openelement ? i.openelement : "." + e.id + c;
        var o = h(r + '[data-popup-ordinal="' + t + '"]');
        if (typeof n == "function") {
            n.call(h(e), e, o)
        }
    };
    h(document).on("keydown", function (e) {
        if (m.length) {
            var t = m[m.length - 1];
            var n = document.getElementById(t);
            if (h(n).data("popupoptions").escape && e.keyCode == 27) {
                x.hide(n)
            }
        }
    });
    h(document).on("click", function (e) {
        if (m.length) {
            var t = m[m.length - 1];
            var n = document.getElementById(t);
            var i = h(n).data("popupoptions").closeelement ? h(n).data("popupoptions").closeelement : "." + n.id + y;
            if (h(e.target).closest(i).length) {
                e.preventDefault();
                x.hide(n)
            }
            if (h(n).data("popupoptions").blur && !h(e.target).closest("#" + t).length && e.which !== 2) {
                x.hide(n);
                if (h(n).data("popupoptions").type === "overlay") {
                    e.preventDefault()
                }
            }
        }
    });
    h(document).on("focusin", function (e) {
        if (m.length) {
            var t = m[m.length - 1];
            var n = document.getElementById(t);
            if (h(n).data("popupoptions").keepfocus) {
                if (!n.contains(e.target)) {
                    e.stopPropagation();
                    n.focus()
                }
            }
        }
    });
    h.fn.popup = function (t) {
        return this.each(function () {
            $el = h(this);
            if (typeof t === "object") {
                var e = h.extend({}, h.fn.popup.defaults, t);
                $el.data("popupoptions", e);
                n = $el.data("popupoptions");
                x._init(this)
            } else if (typeof t === "string") {
                if (!$el.data("popupoptions")) {
                    $el.data("popupoptions", h.fn.popup.defaults);
                    n = $el.data("popupoptions")
                }
                x[t].call(this, this)
            } else {
                if (!$el.data("popupoptions")) {
                    $el.data("popupoptions", h.fn.popup.defaults);
                    n = $el.data("popupoptions")
                }
                x._init(this)
            }
        })
    };
    h.fn.popup.defaults = {
        type: "overlay",
        autoopen: false,
        background: true,
        backgroundactive: false,
        color: "black",
        opacity: "0.5",
        horizontal: "center",
        vertical: "middle",
        offsettop: 0,
        offsetleft: 0,
        escape: true,
        blur: true,
        setzindex: true,
        autozindex: false,
        scrolllock: false,
        keepfocus: true,
        focuselement: null,
        focusdelay: 50,
        outline: false,
        pagecontainer: null,
        detach: false,
        openelement: null,
        closeelement: null,
        transition: null,
        tooltipanchor: null,
        beforeopen: null,
        onclose: null,
        onopen: null,
        opentransitionend: null,
        closetransitionend: null
    }
})(jQuery);
var confirmPrompt = {
    callback: function () {}
};
$(document).ready(function () {
    $("#prompt_popup").popup();
    $("#prompt_popup_ok_button").click(function () {
        $("#prompt_popup").popup("hide");
        confirmPrompt.callback()
    });
    $(document).on("keydown", function (e) {})
});
$.confirm = function (e, t, n) {
    if (!t) {
        t = function () {}
    }
    if (!n) {
        $("#prompt_popup .popup_header").css("display", "none")
    } else {
        $("#prompt_popup .popup_header").html(n);
        $("#prompt_popup .popup_header").css("display", "flex")
    }
    liHtml = "";
    $.each(e, function (e, t) {
        liHtml += "<li>" + t + "</li>"
    });
    $("#prompt_popup_ul").html(liHtml);
    var i = function (e) {
        if (e.keyCode == 13) {
            confirmPrompt.callback();
            $("#prompt_popup").popup("hide")
        }
    };
    confirmPrompt.callback = t;
    $("#prompt_popup").popup({
        autoopen: true,
        onopen: function () {
            $(document).bind("keydown", i)
        },
        onclose: function () {
            $(document).unbind("keydown", i)
        }
    })
};

function Session() {
    var t = 5;
    var e = function (e, t) {
        this.transition("authenticating");
        var n = {
            username: e,
            password_hash: t
        };
        var i = this;
        $.ajax({
            url: "/py/login.py",
            type: "POST",
            data: n,
            dataType: "json",
            success: function (e, t) {
                i.handle(e.status, e)
            }
        })
    };
    var n = function (e, t, n, i, r) {
        this.transition("registering");
        var o = {
            username: e,
            password_hash: t,
            first_name: n,
            last_name: i,
            email: r
        };
        var a = this;
        $.ajax({
            url: "/py/register.py",
            type: "POST",
            data: o,
            dataType: "json",
            success: function (e, t) {
                console.log(e, t);
                a.handle(e.status, e)
            },
            error: function (e) {
                console.log(e)
            }
        })
    };
    var i = {
        initialState: "uninitialized",
        states: {
            uninitialized: {
                INIT: "check_saved_credentials"
            },
            check_saved_credentials: {
                _onEnter: function (e) {
                    if ($.cookie("username") && $.cookie("password_hash")) {
                        this.login($.cookie("username"), $.cookie("password_hash"))
                    } else {
                        if (ENTERPRISE) {
                            this.login("ENTERPRISE", "ENTERPRISE")
                        } else {
                            this.transition("logged_out")
                        }
                    }
                },
                LOGIN: e
            },
            logged_out: {
                _onEnter: function (e) {
                    $.removeCookie("user_id");
                    $.removeCookie("username");
                    $.removeCookie("password_hash")
                },
                PROMPT_LOGIN: "awaiting_login_info",
                PROMPT_REGISTRATION: "awaiting_registration_info"
            },
            awaiting_login_info: {
                _onEnter: function () {},
                LOGIN: e,
                CANCEL_PROMPT: "logged_out"
            },
            awaiting_registration_info: {
                _onEnter: function () {},
                REGISTER: n,
                CANCEL_PROMPT: "logged_out"
            },
            authenticating: {
                _onEnter: function () {},
                LOGIN_SUCCESSFUL: function (e) {
                    this.transition("logged_in", e)
                },
                BAD_LOGIN: "logged_out"
            },
            registering: {
                _onEnter: function () {},
                REGISTER_SUCCESSFUL: function (e) {
                    this.transition("logged_in", e)
                },
                USERNAME_TAKEN: "logged_out",
                BAD_REGISTER: "logged_out"
            },
            logged_in: {
                _onEnter: function (e) {
                    this.user_id = e.user_id;
                    this.username = e.username;
                    this.password_hash = e.password_hash;
                    $.cookie("user_id", this.user_id, {
                        expires: t
                    });
                    $.cookie("username", this.username, {
                        expires: t
                    });
                    $.cookie("password_hash", this.password_hash, {
                        expires: t
                    })
                },
                LOGOUT: "logged_out"
            }
        },
        init: function () {
            this.handle("INIT")
        },
        promptLogin: function () {
            this.handle("PROMPT_LOGIN")
        },
        promptRegistration: function () {
            this.handle("PROMPT_REGISTRATION")
        },
        cancelPrompt: function () {
            this.handle("CANCEL_PROMPT")
        },
        login: function (e, t) {
            this.handle("LOGIN", e, t)
        },
        register: function (e, t, n, i, r) {
            this.handle("REGISTER", e, t, n, i, r)
        },
        badLogin: function () {
            this.handle("BAD_LOGIN")
        },
        badRegister: function () {
            this.handle("BAD_REGISTER")
        },
        loginSuccessful: function () {
            this.handle("LOGIN_SUCCESSFUL")
        },
        registerSuccessful: function () {
            this.handle("REGISTER_SUCCESSFUL")
        },
        logout: function () {
            this.handle("LOGOUT")
        },
        isLoggedIn: function () {
            return this.compositeState() == "logged_in"
        }
    };
    var r = new machina.Fsm(i);
    r.logoutIsDisabled = false;
    return r
}
var LoginPopupView = function () {
    this.__init()
};
LoginPopupView.prototype.__init = function () {
    $("#login_popup").popup({
        onclose: function () {
                $(this).trigger("LOGIN_POPUP_CLOSE")
            }
            .bind(this),
        focuselement: "#login_popup input:first"
    });
    var e = function (e) {
            e.preventDefault();
            $(this).trigger("LOGIN_POPUP_LOGIN_CLICK")
        }
        .bind(this);
    $("#login_popup_login_button").click(e);
    $("#login_popup_form").submit(e)
};
LoginPopupView.prototype.show = function () {
    $("#login_popup").popup({
        autoopen: true,
        onclose: function () {
                $(this).trigger("LOGIN_POPUP_CLOSE")
            }
            .bind(this),
        focuselement: "#login_popup input:first"
    })
};
LoginPopupView.prototype.hide = function () {
    $("#login_popup").popup("hide")
};
var LoginPopupController = function (e, t) {
    this.session = e;
    this.loginPopupView = t;
    this.__init()
};
LoginPopupController.prototype.__init = function () {
    this.session.on("transitioned", function (e) {
            if (e.action == "authenticating.BAD_LOGIN") {
                $.confirm(["Sorry, that username/password combination was not found!"])
            }
            if (this.session.state == "awaiting_login_info") {
                this.loginPopupView.show()
            } else {
                this.loginPopupView.hide()
            }
        }
        .bind(this));
    $(this.loginPopupView).on("LOGIN_POPUP_CLOSE", function () {
            if (this.session.state == "awaiting_login_info")
                this.session.cancelPrompt()
        }
        .bind(this));
    $(this.loginPopupView).on("LOGIN_POPUP_LOGIN_CLICK", function () {
            var e = $("#login_popup_username").val();
            var t = $("#login_popup_password").val();
            var n = md5(t);
            this.session.login(e, n)
        }
        .bind(this))
};
var RegisterPopupView = function () {
    this.__init()
};
RegisterPopupView.prototype.__init = function () {
    $("#register_popup").popup({
        onclose: function () {
                $(this).trigger("REGISTER_POPUP_CLOSE")
            }
            .bind(this),
        focuselement: "#register_popup input:first"
    });
    var e = function (e) {
            e.preventDefault();
            $(this).trigger("REGISTER_POPUP_REGISTER_CLICK")
        }
        .bind(this);
    $("#register_popup_register_button").click(e);
    $("#register_popup_form").submit(e)
};
RegisterPopupView.prototype.show = function () {
    $("#register_popup").popup("show")
};
RegisterPopupView.prototype.hide = function () {
    $("#register_popup").popup("hide")
};
var RegisterPopupController = function (e, t) {
    this.session = e;
    this.registerPopupView = t;
    this.__init()
};
RegisterPopupController.prototype.__init = function () {
    this.session.on("transitioned", function (e) {
            var t = function () {
                    this.session.promptRegistration()
                }
                .bind(this);
            if (e.action == "registering.BAD_REGISTER") {
                $.confirm(["Sorry, there was a problem with your registration."], t);
                wasError = true
            } else if (e.action == "registering.USERNAME_TAKEN") {
                $.confirm(["Sorry, that username has already been taken."], t);
                wasError = true
            }
            if (this.session.state == "awaiting_registration_info") {
                this.registerPopupView.show()
            } else {
                this.registerPopupView.hide()
            }
        }
        .bind(this));
    $(this.registerPopupView).on("REGISTER_POPUP_CLOSE", function () {
            if (this.session.state == "awaiting_registration_info")
                this.session.cancelPrompt()
        }
        .bind(this));
    $(this.registerPopupView).on("REGISTER_POPUP_REGISTER_CLICK", function () {
            var e = $("#register_popup_username").val();
            var t = $("#register_popup_password").val();
            var n = md5(t);
            var i = $("#register_popup_first_name").val();
            var r = $("#register_popup_last_name").val();
            var o = $("#register_popup_email").val();
            this.session.register(e, n, i, r, o)
        }
        .bind(this))
};
var SessionUI = function (e) {
    this.session = e;
    this.__init()
};
SessionUI.prototype.__init = function () {
    this.session.on("transitioned", this.__sessionStateTransitioned.bind(this));
    this.__createPopups();
    $("#login_button").click(this.__loginClick.bind(this));
    $("#logout_button").click(this.__logoutClick.bind(this));
    $("#register_button").click(this.__registerClick.bind(this));
    $("#status_text").click(this.__statusClick.bind(this))
};
SessionUI.prototype.__createPopups = function () {
    var e = new LoginPopupView;
    var t = new LoginPopupController(this.session, e);
    var n = new RegisterPopupView;
    var i = new RegisterPopupController(this.session, n)
};
SessionUI.prototype.__statusClick = function () {
    if (!ENTERPRISE)
        window.open("/account", "_self")
};
SessionUI.prototype.__loginClick = function () {
    this.session.promptLogin()
};
SessionUI.prototype.__logoutClick = function () {
    if (this.session.logoutIsDisabled) {
        $.confirm(["Logout has been disabled for this page."]);
        return
    }
    if (ENTERPRISE) {
        window.location.href = "https://medcornell.pixorize.com/mellon/logout?ReturnTo=/"
    }
    this.session.logout()
};
SessionUI.prototype.__registerClick = function () {
    this.session.promptRegistration()
};
SessionUI.prototype.__setStatusText = function (e) {
    if (e == "") {
        $("#status_text").hide()
    } else {
        $("#status_text").show()
    }
    $("#status_text").html(e)
};
SessionUI.prototype.__sessionStateTransitioned = function () {
    var e = this.session.compositeState();
    if (e == "logged_out") {
        this.__setStatusText("");
        $("#login_button").show();
        $("#register_button").show();
        $("#logout_button").hide()
    } else if (e == "awaiting_login_info") {
        this.__setStatusText("Waiting");
        $("#login_button").hide();
        $("#register_button").hide();
        $("#logout_button").hide()
    } else if (e == "awaiting_registration_info") {
        this.__setStatusText("Waiting");
        $("#login_button").hide();
        $("#register_button").hide();
        $("#logout_button").hide()
    } else if (e == "authenticating") {
        this.__setStatusText("Authenticating");
        $("#login_button").hide();
        $("#register_button").hide();
        $("#logout_button").hide()
    } else if (e == "registering") {
        this.__setStatusText("Registering");
        $("#login_button").hide();
        $("#register_button").hide();
        $("#logout_button").hide()
    } else if (e == "logged_in") {
        this.__setStatusText(this.session.username);
        $("#login_button").hide();
        $("#register_button").hide();
        $("#logout_button").show()
    }
};
var session;
$(document).ready(function () {
    session = new Session;
    var e = new SessionUI(session);
    session.init()
});
var InteractiveImage = function (e) {
    this.canvas = document.createElement("canvas");
    this.context = this.canvas.getContext("2d");
    this.__isDirty = true;
    setInterval(this.__step.bind(this), 25)
};
InteractiveImage.prototype.__step = function (e) {
    if (this.__isDirty)
        this.draw()
};
InteractiveImage.prototype.serialize = function (e) {
    return this.annotator.serialize(this.zoomer.zoom)
};
InteractiveImage.prototype.onModuleChange = function () {
    this.__isDirty = true
};
InteractiveImage.prototype.draw = function () {
    if (!this.img) {
        throw "InteractiveImage.draw(): No img set. Set using InteractiveImage.setImg(img)"
    }
    var e = 1;
    if (this.zoomer)
        e = this.zoomer.zoom;
    var t = this.getScroll();
    if (!DEBUG)
        this.context.clearRect(0, 0, this.img.width, this.img.height);
    var n = Math.floor(t.x / e);
    var i = Math.floor(t.y / e);
    this.context.drawImage(this.img, n, i, Math.floor(this.img.width - n), Math.floor(this.img.height - i), 0, 0, Math.floor(this.img.width * e - n * e), Math.floor(this.img.height * e - i * e));
    if (this.annotator)
        this.annotator.draw(this.context, this.scroller);
    if (this.toolbox)
        this.toolbox.draw(this.context, this.scroller);
    this.__isDirty = false
};
InteractiveImage.prototype.getScroll = function () {
    var e = 0;
    var t = 0;
    if (this.scroller) {
        e = this.scroller.scrollX;
        t = this.scroller.scrollY
    }
    return {
        x: e,
        y: t
    }
};
InteractiveImage.prototype.getSize = function () {
    var e = {
        width: this.img.width * this.zoomer.zoom,
        height: this.img.height * this.zoomer.zoom
    };
    return e
};
InteractiveImage.prototype.setSize = function (e, t) {
    this.width = e;
    this.height = t;
    $(this.canvas)[0].setAttribute("width", this.width);
    $(this.canvas)[0].setAttribute("height", this.height);
    if (this.img && this.scroller) {
        var n = 1;
        if (this.zoomer)
            n = this.zoomer.zoom;
        this.scroller.setBounds(this.img.width * n - this.width, this.img.height * n - this.height)
    }
};
InteractiveImage.prototype.getBounds = function () {
    var e = parseInt($(this.canvas).css("left"), 10);
    var t = parseInt($(this.canvas).css("top"), 10);
    var n = {
        x: e,
        y: t,
        width: this.width,
        height: this.height
    };
    return n
};
InteractiveImage.prototype.setImg = function (e) {
    this.img = e;
    if (this.scroller)
        this.scroller.setBounds(this.img.width - this.width, this.img.height - this.height);
    this.draw();
    if (this.positioner)
        this.positioner.position()
};
InteractiveImage.prototype.addScroller = function (e) {
    this.scroller = e;
    $(this.scroller).change(this.onModuleChange.bind(this))
};
InteractiveImage.prototype.addAnnotator = function (e) {
    this.annotator = e;
    var t = this;
    $(this.annotator).change(function () {
            t.onModuleChange()
        }
        .bind(this));
    if (this.zoomer)
        this.zoomer.setOrigAnnotations(this.annotator.annotations);
    if (this.zoomer)
        this.zoomer.updateAnnotator(this.zoomer.zoom, 1);
    this.draw()
};
InteractiveImage.prototype.addPincherPanner = function (e) {
    this.pincherPanner = e;
    if (this.width)
        this.draw()
};
InteractiveImage.prototype.addZoomer = function (e) {
    this.zoomer = e;
    $(this.zoomer).change(this.onModuleChange.bind(this));
    if (this.width)
        this.draw();
    if (this.positioner)
        this.positioner.position()
};
InteractiveImage.prototype.addPositioner = function (e) {
    this.positioner = e;
    this.positioner.position();
    $(this).triggerHandler("change")
};
InteractiveImage.prototype.addToolbox = function (e) {
    this.toolbox = e;
    $(this).triggerHandler("change");
    $(this.toolbox).on("change", function () {
            this.onModuleChange()
        }
        .bind(this))
};
InteractiveImage.prototype.destroy = function () {
    this.canvas.remove();
    if (this.ui)
        this.ui.destroy();
    if (this.pincherPanner)
        this.pincherPanner.destroy()
};
InteractiveImage.prototype.pageToImageCoords = function (e, t) {
    var n = $(this.canvas).position();
    var i = this.getScroll();
    var r = i.x + e - n.left;
    var o = i.y + t - n.top;
    return {
        x: r,
        y: o
    }
};
InteractiveImage.prototype.imageToPageCoords = function (e, t) {
    var n = $(this.canvas).position();
    var i = this.getScroll();
    var r = n.left + e - i.x;
    var o = n.top + t - i.y;
    return {
        x: r,
        y: o
    }
};
InteractiveImage.prototype.imageToCanvasCoords = function (e, t) {
    var n = this.getScroll();
    var i = e - n.x;
    var r = t - n.y;
    return {
        x: i,
        y: r
    }
};
var InteractiveImageFactory = function () {};
InteractiveImageFactory.prototype.createDefaultFromURL = function (e, r) {
    $("<img>", {
        src: e
    }).on("load", function () {
        var e = new InteractiveImage;
        var t = new Scroller;
        t.addBehavior(new DraggableScrollerBehavior(e.canvas));
        var n = new KeyboardScrollerBehavior;
        t.addBehavior(n);
        n.init();
        e.addScroller(t);
        e.setSize(250, 250);
        e.setImg(this);
        var i = new Zoomer(e);
        e.addZoomer(i);
        r(e)
    })
};
InteractiveImageFactory.prototype.createEditor = function (e, r) {
    $("<img>", {
        src: e
    }).on("load", function () {
        var e = new InteractiveImage;
        var t = new Scroller;
        t.addBehavior(new DraggableScrollerBehavior(e.canvas));
        var n = new KeyboardScrollerBehavior;
        t.addBehavior(n);
        n.init();
        e.addScroller(t);
        e.setSize(250, 250);
        e.setImg(this);
        var i = new Zoomer(e);
        e.addZoomer(i);
        r(e)
    })
};
var AnnotatorNew = function (e, t) {
    this.interactiveImage = t;
    this.__loadAnnotations(e);
    $(document).on("mousemove", this.__onDocumentMouseMove.bind(this));
    $(this.interactiveImage.canvas).on("mousedown", this.__onCanvasMouseDown.bind(this));
    $(document).on("mouseup", this.__onDocumentMouseUp.bind(this));
    $(this.interactiveImage.canvas).on("dblclick", this.__onCanvasDblClick.bind(this));
    $(this.interactiveImage.scroller).on("change", this.__onScrollerChange.bind(this));
    this.show = true;
    this.layerManager = new LayerManager
};
AnnotatorNew.prototype.serialize = function (n) {
    var i = [];
    $.each(this.annotations, function (e, t) {
        i.push(t.serialize(n))
    });
    return i
};
AnnotatorNew.prototype.__loadAnnotations = function (e) {
    this.annotations = [];
    $.each(e, function (e, t) {
            var n = t.type ? t.type : "DOT";
            var i;
            if (n == "DOT") {
                i = new PointAnnotation(t.x, t.y, t.text)
            } else if (n == "CIRCLE") {
                i = new CircleAnnotation(t.x, t.y, t.radius, t.text)
            } else if (n == "POLY") {
                i = new PolyAnnotation(t.points, t.text)
            }
            this.addAnnotation(i)
        }
        .bind(this))
};
AnnotatorNew.prototype.addAnnotation = function (e, t) {
    if (t) {
        this.annotations.unshift(e)
    } else {
        this.annotations.push(e)
    }
    $(e).on("change", this.__onAnnotationChange.bind(this));
    $(this).triggerHandler("change")
};
AnnotatorNew.prototype.deleteAnnotation = function (e) {
    var t = this.annotations.indexOf(e);
    if (t == -1)
        return;
    this.annotations.splice(t, 1);
    e.delete();
    $(this).triggerHandler("change")
};
AnnotatorNew.prototype.draw = function () {
    if (!this.show)
        return;
    var e = _.clone(this.annotations);
    e.reverse();
    this.layerManager.sort(e);
    $.each(e, function (e, t) {
            var n = this.interactiveImage.imageToCanvasCoords(t.pos.x, t.pos.y);
            t.draw(this.interactiveImage.context, n, this.interactiveImage)
        }
        .bind(this))
};
AnnotatorNew.prototype.__onScrollerChange = function (e) {
    $(this).triggerHandler("change")
};
AnnotatorNew.prototype.__onAnnotationChange = function (e) {
    $(this).triggerHandler("change")
};
AnnotatorNew.prototype.__onDocumentMouseMove = function (e) {};
AnnotatorNew.prototype.__onCanvasMouseDown = function (e) {};
AnnotatorNew.prototype.__onDocumentMouseUp = function (e) {};
AnnotatorNew.prototype.__onCanvasDblClick = function (e) {};
var LayerManager = function () {};
LayerManager.prototype.sort = function (e) {
    var r = ["POLY", "CIRCLE", "DOT"];
    var t = function (e, t) {
        var n = r.indexOf(e.type);
        var i = r.indexOf(t.type);
        if (n == i)
            return 0;
        if (n > i)
            return 1;
        if (n < i)
            return -1
    };
    e.sort(t)
};
var ScrollerBehavior = function () {};
ScrollerBehavior.prototype.setScroller = function (e) {
    this.scroller = e
};
var UP = 38;
var RIGHT = 39;
var DOWN = 40;
var LEFT = 37;
var KeyboardScrollerBehavior = function () {
    ScrollerBehavior.call(this)
};
KeyboardScrollerBehavior.prototype = Object.create(ScrollerBehavior.prototype);
KeyboardScrollerBehavior.prototype.constructor = KeyboardScrollerBehavior;
KeyboardScrollerBehavior.prototype.init = function () {
    this.SCROLL_SPEED = 10;
    this.SCROLL_STEP_INTERVAL = 20;
    this.upDown = false;
    this.rightDown = false;
    this.downDown = false;
    this.leftDown = false;
    $(document).on("keydown", this.__onDocumentKeyDown.bind(this));
    $(document).on("keyup", this.__onDocumentKeyUp.bind(this));
    setInterval(this.__step.bind(this), this.SCROLL_STEP_INTERVAL)
};
KeyboardScrollerBehavior.prototype.__step = function () {
    var e = 0;
    var t = 0;
    if (this.leftDown)
        e++;
    if (this.rightDown)
        e--;
    if (this.upDown)
        t++;
    if (this.downDown)
        t--;
    e *= this.SCROLL_SPEED;
    t *= this.SCROLL_SPEED;
    if (e != 0 || t != 0) {
        this.scroller.scroll(e, t)
    }
};
KeyboardScrollerBehavior.prototype.__onDocumentKeyDown = function (e) {
    if (document.activeElement != document.body)
        return;
    if (e.keyCode == UP)
        this.upDown = true;
    if (e.keyCode == RIGHT)
        this.rightDown = true;
    if (e.keyCode == DOWN)
        this.downDown = true;
    if (e.keyCode == LEFT)
        this.leftDown = true;
    if (this.upDown || this.rightDown || this.downDown || this.leftDown) {
        e.preventDefault()
    }
};
KeyboardScrollerBehavior.prototype.__onDocumentKeyUp = function (e) {
    if (e.keyCode == UP)
        this.upDown = false;
    if (e.keyCode == RIGHT)
        this.rightDown = false;
    if (e.keyCode == DOWN)
        this.downDown = false;
    if (e.keyCode == LEFT)
        this.leftDown = false
};
var DraggableScrollerBehavior = function (e) {
    ScrollerBehavior.call(this);
    var t = /Mobi/.test(navigator.userAgent);
    if (!t) {
        $(e).on("mousedown", this.__onCanvasMouseDown.bind(this));
        $(document).mousemove(this.__onCanvasMouseMove.bind(this));
        $(document).mouseup(this.__onCanvasMouseUp.bind(this))
    } else {
        $(e).on("touchstart", this.__onCanvasTouchStart.bind(this));
        $(e).on("touchmove", this.__onCanvasTouchMove.bind(this));
        $(e).on("touchstop", this.__onCanvasTouchStop.bind(this))
    }
};
DraggableScrollerBehavior.prototype = Object.create(ScrollerBehavior.prototype);
DraggableScrollerBehavior.prototype.constructor = DraggableScrollerBehavior;
DraggableScrollerBehavior.prototype.__onCanvasMouseDown = function (e) {
    this.__startDrag(e.pageX, e.pageY)
};
DraggableScrollerBehavior.prototype.__onCanvasTouchStart = function (e) {
    var t = e.originalEvent.touches[0];
    this.__startDrag(t.pageX, t.pageY)
};
DraggableScrollerBehavior.prototype.__startDrag = function (e, t) {
    this.lastMouseX = e;
    this.lastMouseY = t;
    this.isDragging = true
};
DraggableScrollerBehavior.prototype.__onCanvasMouseUp = function (e) {
    this.__stopDrag()
};
DraggableScrollerBehavior.prototype.__onCanvasTouchStop = function (e) {
    this.__stopDrag()
};
DraggableScrollerBehavior.prototype.__stopDrag = function () {
    this.isDragging = false
};
DraggableScrollerBehavior.prototype.__onCanvasMouseMove = function (e) {
    this.__doDrag(e.pageX, e.pageY)
};
DraggableScrollerBehavior.prototype.__onCanvasTouchMove = function (e) {
    var t = e.originalEvent.touches[0];
    this.__doDrag(t.pageX, t.pageY)
};
DraggableScrollerBehavior.prototype.__doDrag = function (e, t) {
    this.mouseX = e;
    this.mouseY = t;
    if (!this.isDragging)
        return;
    var n = this.mouseX - this.lastMouseX;
    var i = this.mouseY - this.lastMouseY;
    this.dx = n;
    this.dy = i;
    this.scroller.scroll(this.dx, this.dy);
    this.lastMouseX = e;
    this.lastMouseY = t
};
var Scroller = function () {
    this.init()
};
Scroller.prototype.init = function () {
    this.scrollX = 0;
    this.scrollY = 0;
    this.behaviors = [];
    this.canScroll = true
};
Scroller.prototype.setBounds = function (e, t) {
    console.log("SCROLLER", e, t);
    this.boundX = e;
    this.boundY = t
};
Scroller.prototype.setScroll = function (e, t) {
    if (!this.canScroll)
        return;
    this.scrollX = e;
    this.scrollY = t;
    this.scrollX = _.clamp(this.scrollX, 0, this.boundX);
    this.scrollY = _.clamp(this.scrollY, 0, this.boundY);
    $(this).trigger("change")
};
Scroller.prototype.scroll = function (e, t) {
    this.setScroll(this.scrollX - e, this.scrollY - t)
};
Scroller.prototype.addBehavior = function (e) {
    this.behaviors.push(e);
    e.setScroller(this)
};
var PLUS = 187;
var MINUS = 189;
var ZERO = 48;
var Zoomer = function (e) {
    this.interactiveImage = e;
    $(document).on("keydown", this.__onDocumentKeyDown.bind(this));
    $(document).on("keypress", this.__onDocumentKeyPress.bind(this))
};
Zoomer.prototype.__onDocumentKeyDown = function (e) {
    if (document.activeElement != document.body)
        return;
    if (e.keyCode == PLUS)
        this.setZoom(this.zoom * 2);
    if (e.keyCode == MINUS)
        this.setZoom(this.zoom * .5)
};
Zoomer.prototype.__onDocumentKeyPress = function (e) {
    if (e.keyCode == ZERO)
        this.setZoom(this.origZoom)
};
Zoomer.prototype.setOrigAnnotations = function (e) {
    this.origAnnotations = _.cloneDeep(e)
};
Zoomer.prototype.setZoom = function (e) {
    if (this.zoom == e)
        return;
    if (!this.zoom)
        this.origZoom = e;
    var t = this.zoom;
    this.zoom = e;
    if (this.interactiveImage.scroller) {
        var n = this.interactiveImage.getBounds();
        var i = this.interactiveImage.scroller.scrollX;
        var r = this.interactiveImage.scroller.scrollY;
        var o = (i + n.width / 2) / t;
        var a = (r + n.height / 2) / t
    }
    if (this.interactiveImage.annotator)
        this.updateAnnotator(e, t);
    this.__updateImage(true);
    if (this.interactiveImage.scroller) {
        var n = this.interactiveImage.getBounds();
        var s = o * e;
        var l = a * e;
        var u = s - n.width / 2;
        var c = l - n.height / 2;
        this.interactiveImage.scroller.setScroll(u, c)
    }
    this.interactiveImage.__isDirty = true;
    this.interactiveImage.draw()
};
Zoomer.prototype.updateAnnotator = function (r, o) {
    $.each(this.interactiveImage.annotator.annotations, function (e, t) {
            var t = this.interactiveImage.annotator.annotations[e];
            if (t.x) {
                t.x = this.origAnnotations[e].x * this.zoom;
                t.y = this.origAnnotations[e].y * this.zoom
            } else {
                if (t.type == "DOT") {
                    var n = r / o * t.pos.x;
                    var i = r / o * t.pos.y;
                    t.setPosition(n, i)
                } else if (t.type == "POLY" || t.type == "CIRCLE") {
                    t.zoom(r / o)
                }
            }
        }
        .bind(this))
};
Zoomer.prototype.__updateImage = function (e) {
    var t = this.interactiveImage.img.width * this.zoom;
    var n = this.interactiveImage.img.height * this.zoom;
    this.interactiveImage.setSize(50, 50);
    if (this.interactiveImage.positioner)
        this.interactiveImage.positioner.position(e)
};
var PincherPanner = function (e) {
    this.__initVars(e);
    this.__setupHandlers()
};
PincherPanner.prototype.__initVars = function (e) {
    this.interactiveImage = e;
    this.isMobile = /Mobi|Tablet|iPad|iPhone/.test(navigator.userAgent);
    this.hasRecordedScale = false;
    this.origScale;
    this.origPos;
    this.imageCenter;
    this.hammertime = new Hammer(document.body, {
        domEvents: true
    })
};
PincherPanner.prototype.destroy = function () {
    this.__destroyHandlers()
};
PincherPanner.prototype.__setupHandlers = function () {
    if (!this.isMobile)
        return;
    this.hammertime.get("pinch").set({
        enable: true
    });
    this.hammertime.on("pinch pan", this.__onPinchPan.bind(this));
    this.hammertime.on("pinchend panend", this.__onPinchPanEnd.bind(this))
};
PincherPanner.prototype.__destroyHandlers = function () {
    if (!this.isMobile)
        return;
    this.hammertime.off("pinch pan", this.__onPinchPan.bind(this));
    this.hammertime.off("pinchend panend", this.__onPinchPanEnd.bind(this))
};
PincherPanner.prototype.__onPinchPan = function (e) {
    if (!this.hasRecordedScale) {
        if (e.center.y >= $("footer").position().top)
            return;
        this.interactiveImage.scroller.canScroll = false;
        this.origScale = this.interactiveImage.zoomer.zoom;
        this.hasRecordedScale = true;
        this.imageCenter = this.interactiveImage.pageToImageCoords(e.center.x, e.center.y);
        this.origPos = {
            x: this.interactiveImage.scroller.scrollX,
            y: this.interactiveImage.scroller.scrollY
        }
    }
    this.interactiveImage.scroller.canScroll = true;
    if (e.scale != 1) {
        this.interactiveImage.zoomer.setZoom(this.origScale * e.scale)
    } else {
        this.interactiveImage.scroller.setScroll((this.origPos.x - e.deltaX) * e.scale, (this.origPos.y - e.deltaY) * e.scale)
    }
    this.interactiveImage.scroller.canScroll = false
};
PincherPanner.prototype.__onPinchPanEnd = function (e) {
    this.hasRecordedScale = false;
    this.interactiveImage.scroller.canScroll = false
};
var OverlayUI = function (e) {
    this.interactiveImage = e;
    this.interactiveImage.ui = this;
    this.isMobile = /Mobi|Tablet|iPad|iPhone/.test(navigator.userAgent);
    this.LOGO_SRC = "/images/logo_with_text_viewer.svg";
    this.ZOOM_IN_SRC = "/images/viewer/zoom_in_icon.svg";
    this.ZOOM_OUT_SRC = "/images/viewer/zoom_out_icon.svg";
    this.LIGHT_ON_SRC = "/images/viewer/light_on.svg";
    this.LIGHT_OFF_SRC = "/images/viewer/light_off.svg";
    this.LOGO_ICON_WIDTH = 120;
    this.HEIGHT = 45;
    this.PADDING = 10;
    this.__createUIContainer();
    this.__createItems();
    this.__setupHandlers();
    this.hide();
    this.__onInteractiveImageChange()
};
OverlayUI.prototype.destroy = function () {
    this.__destroyHandlers();
    this.container.remove()
};
OverlayUI.prototype.__createUIContainer = function () {
    var e = '<div id="viewer_ui_container"></div>';
    $("body").append(e);
    this.container = $("#viewer_ui_container");
    this.container.css("height", this.HEIGHT + this.PADDING + "px");
    if (!DEBUG) {
        this.container.css("overflow", "hidden")
    } else {
        this.container.css("box-sizing", "border-box");
        this.container.css("border", "solid 1px red")
    }
    if (!this.DEBUG)
        this.container.css("transition", "opacity 1s");
    this.container.css("background", "linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, .65))");
    this.container.css("pointer-events", "none")
};
OverlayUI.prototype.__createItems = function () {
    var e = 20;
    var t = 32;
    var n = this.LOGO_ICON_WIDTH;
    this.__items = [];
    this.__addItem("viewer_logo_img", this.LOGO_SRC, this.PADDING, this.__logoClick);
    this.__addItem("light_img", this.LIGHT_ON_SRC, -1 * (t + this.PADDING), this.__lightClick);
    this.__addItem("zoom_in_img", this.ZOOM_IN_SRC, -2 * this.PADDING - e - t, this.__zoomInClick);
    this.__addItem("zoom_out_img", this.ZOOM_OUT_SRC, -3 * this.PADDING - 2 * e - t, this.__zoomOutClick);
    this.__positionItems()
};
OverlayUI.prototype.__positionItems = function () {
    if (!this.bounds)
        return;
    $.each(this.__items, function (e, t) {
            t.elem.css("position", "absolute");
            t.elem.css("left", t.xPos + "px");
            if (t.xPos < 0) {
                var n = this.bounds.width;
                var i = $(window).width();
                var r = Math.min(n, i);
                var o = r + t.xPos;
                t.elem.css("left", o + "px")
            }
        }
        .bind(this))
};
OverlayUI.prototype.__addItem = function (e, t, n, i) {
    var r = $('<div id="' + e + '"></div>');
    var o = {
        id: e,
        elem: r,
        imgSrc: t,
        xPos: n,
        onClick: i
    };
    this.__items.push(o);

    function a(e, t) {
        var n = document.createElement("div");
        n.style[e] = t;
        return n.style[e] === t
    }
    var s = this;
    $("<img>", {
        src: t
    }).on("load", function () {
        o.elem.css("width", this.width);
        o.elem.css("height", this.height);
        if (DEBUG) {
            o.elem.css("box-sizing", "border-box");
            o.elem.css("border", "solid 1px red")
        } else {
            o.elem.css("pointer-events", "auto");
            o.elem.css("background-image", "url(" + t + ")");
            o.elem.css("background-color", "transparent")
        }
        s.__positionItems()
    });
    r.css("transition", "top 0.3s cubic-bezier(.25,.8,.25,1), background-color cubic-bezier(.25,.8,.25,1)");
    r.css("cursor", "pointer");
    r.click(o.onClick.bind(this));
    this.container.append(r)
};
OverlayUI.prototype.__setupHandlers = function () {
    $("body").mouseout(this.__onMouseOut.bind(this));
    $(document).mousemove(this.__onDocumentMouseMove.bind(this));
    $(this.interactiveImage).change(this.__onInteractiveImageChange.bind(this))
};
OverlayUI.prototype.__destroyHandlers = function () {
    $("body").unbind("mouseout", this.__onMouseOut.bind(this));
    $(document).unbind("mousemove", this.__onDocumentMouseMove.bind(this));
    $(this.interactiveImage).unbind("change", this.__onInteractiveImageChange.bind(this))
};
OverlayUI.prototype.__onMouseOut = function (e) {
    if (e.toElement != null)
        return;
    this.hide()
};
OverlayUI.prototype.__onInteractiveImageChange = function () {
    this.bounds = this.interactiveImage.getBounds();
    this.__positionAndSizeUIContainer();
    this.__positionItems()
};
OverlayUI.prototype.__onDocumentMouseMove = function (e) {
    if (!this.bounds)
        return;
    var t = new Vector(e.pageX, e.pageY);
    var n = t.withinRect(this.bounds);
    if (n) {
        this.show()
    } else {
        this.hide()
    }
};
OverlayUI.prototype.show = function () {
    if (!DEBUG)
        this.container.css("opacity", "1");
    var e = $(this.interactiveImage.canvas).position();
    $.each(this.__items, function (e, t) {
            var n = (this.container.height() - t.elem.height()) / 2;
            t.elem.css("top", n + 5)
        }
        .bind(this))
};
OverlayUI.prototype.hide = function () {
    if (!DEBUG)
        this.container.css("opacity", "0");
    $.each(this.__items, function (e, t) {
            var n = this.container.height();
            t.elem.css("top", n)
        }
        .bind(this))
};
OverlayUI.prototype.__logoClick = function () {
    window.open("http://pixorize.com", "_blank")
};
OverlayUI.prototype.__lightClick = function (e) {
    this.interactiveImage.annotator.show = !this.interactiveImage.annotator.show;
    if (this.interactiveImage.annotator.show) {
        setBackgroundImage($(e.target), this.LIGHT_ON_SRC)
    } else {
        setBackgroundImage($(e.target), this.LIGHT_OFF_SRC)
    }
    $(this.interactiveImage.annotator).triggerHandler("change")
};
OverlayUI.prototype.__zoomInClick = function () {
    if (this.isMobile) {
        this.interactiveImage.scroller.canScroll = true;
        this.interactiveImage.zoomer.setZoom(this.interactiveImage.zoomer.zoom * 1.2);
        this.interactiveImage.scroller.canScroll = false
    } else {
        this.interactiveImage.zoomer.setZoom(this.interactiveImage.zoomer.zoom * 1.2)
    }
};
OverlayUI.prototype.__zoomOutClick = function () {
    if (this.isMobile) {
        this.interactiveImage.scroller.canScroll = true;
        this.interactiveImage.zoomer.setZoom(this.interactiveImage.zoomer.zoom * .8);
        this.interactiveImage.scroller.canScroll = false
    } else {
        this.interactiveImage.zoomer.setZoom(this.interactiveImage.zoomer.zoom * .8)
    }
};
OverlayUI.prototype.__positionAndSizeUIContainer = function () {
    var e = this.bounds.y + this.bounds.height;
    var t = $(window).scrollTop() + $(window).height();
    var n = Math.min(e, t);
    var i = this.bounds.width;
    var r = $(window).width();
    var o = Math.min(i, r);
    this.container.css("position", "absolute");
    this.container.css("top", n - this.container.height());
    this.container.css("left", this.bounds.x);
    this.container.css("width", o + "px")
};

function cssPropertyValueSupported(e, t) {
    var n = document.createElement("div");
    n.style[e] = t;
    return n.style[e] === t
}

function createCssImage(e, t, n, i) {
    var r = cssPropertyValueSupported("mask-image", "url(" + t + ")");
    if (r) {
        e.css("mask-image", "url(" + t + ")");
        e.css("mask-repeat", "no-repeat");
        e.css("mask-position", "center");
        e.css("mask-size", n + "px " + i + "px")
    } else {
        e.css("background-image", "url(" + t + ")");
        e.css("background-color", "transparent")
    }
    return r
}

function setBackgroundImage(e, t) {
    var n = cssPropertyValueSupported("mask-image", "url(" + t + ")");
    if (n) {
        e.css("mask-image", "url(" + t + ")")
    } else {
        e.css("background-image", "url(" + t + ")")
    }
}
(function (e) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], e)
    } else if (typeof exports === "object") {
        e(require("jquery"))
    } else {
        e(jQuery)
    }
})(function (c) {
    var n = 0,
        s = Array.prototype.slice;
    c.cleanData = function (r) {
        return function (e) {
            var t, n, i;
            for (i = 0;
                (n = e[i]) != null; i++) {
                try {
                    t = c._data(n, "events");
                    if (t && t.remove) {
                        c(n).triggerHandler("remove")
                    }
                } catch (e) {}
            }
            r(e)
        }
    }(c.cleanData);
    c.widget = function (e, n, t) {
        var i, r, o, a, s = {},
            l = e.split(".")[0];
        e = e.split(".")[1];
        i = l + "-" + e;
        if (!t) {
            t = n;
            n = c.Widget
        }
        c.expr[":"][i.toLowerCase()] = function (e) {
            return !!c.data(e, i)
        };
        c[l] = c[l] || {};
        r = c[l][e];
        o = c[l][e] = function (e, t) {
            if (!this._createWidget) {
                return new o(e, t)
            }
            if (arguments.length) {
                this._createWidget(e, t)
            }
        };
        c.extend(o, r, {
            version: t.version,
            _proto: c.extend({}, t),
            _childConstructors: []
        });
        a = new n;
        a.options = c.widget.extend({}, a.options);
        c.each(t, function (t, o) {
            if (!c.isFunction(o)) {
                s[t] = o;
                return
            }
            s[t] = function () {
                var i = function () {
                        return n.prototype[t].apply(this, arguments)
                    },
                    r = function (e) {
                        return n.prototype[t].apply(this, e)
                    };
                return function () {
                    var e = this._super,
                        t = this._superApply,
                        n;
                    this._super = i;
                    this._superApply = r;
                    n = o.apply(this, arguments);
                    this._super = e;
                    this._superApply = t;
                    return n
                }
            }()
        });
        o.prototype = c.widget.extend(a, {
            widgetEventPrefix: r ? a.widgetEventPrefix || e : e
        }, s, {
            constructor: o,
            namespace: l,
            widgetName: e,
            widgetFullName: i
        });
        if (r) {
            c.each(r._childConstructors, function (e, t) {
                var n = t.prototype;
                c.widget(n.namespace + "." + n.widgetName, o, t._proto)
            });
            delete r._childConstructors
        } else {
            n._childConstructors.push(o)
        }
        c.widget.bridge(e, o);
        return o
    };
    c.widget.extend = function (e) {
        var t = s.call(arguments, 1),
            n = 0,
            i = t.length,
            r, o;
        for (; n < i; n++) {
            for (r in t[n]) {
                o = t[n][r];
                if (t[n].hasOwnProperty(r) && o !== undefined) {
                    if (c.isPlainObject(o)) {
                        e[r] = c.isPlainObject(e[r]) ? c.widget.extend({}, e[r], o) : c.widget.extend({}, o)
                    } else {
                        e[r] = o
                    }
                }
            }
        }
        return e
    };
    c.widget.bridge = function (o, t) {
        var a = t.prototype.widgetFullName || o;
        c.fn[o] = function (n) {
            var e = typeof n === "string",
                i = s.call(arguments, 1),
                r = this;
            if (e) {
                this.each(function () {
                    var e, t = c.data(this, a);
                    if (n === "instance") {
                        r = t;
                        return false
                    }
                    if (!t) {
                        return c.error("cannot call methods on " + o + " prior to initialization; " + "attempted to call method '" + n + "'")
                    }
                    if (!c.isFunction(t[n]) || n.charAt(0) === "_") {
                        return c.error("no such method '" + n + "' for " + o + " widget instance")
                    }
                    e = t[n].apply(t, i);
                    if (e !== t && e !== undefined) {
                        r = e && e.jquery ? r.pushStack(e.get()) : e;
                        return false
                    }
                })
            } else {
                if (i.length) {
                    n = c.widget.extend.apply(null, [n].concat(i))
                }
                this.each(function () {
                    var e = c.data(this, a);
                    if (e) {
                        e.option(n || {});
                        if (e._init) {
                            e._init()
                        }
                    } else {
                        c.data(this, a, new t(n, this))
                    }
                })
            }
            return r
        }
    };
    c.Widget = function () {};
    c.Widget._childConstructors = [];
    c.Widget.prototype = {
        widgetName: "widget",
        widgetEventPrefix: "",
        defaultElement: "<div>",
        options: {
            disabled: false,
            create: null
        },
        _createWidget: function (e, t) {
            t = c(t || this.defaultElement || this)[0];
            this.element = c(t);
            this.uuid = n++;
            this.eventNamespace = "." + this.widgetName + this.uuid;
            this.bindings = c();
            this.hoverable = c();
            this.focusable = c();
            if (t !== this) {
                c.data(t, this.widgetFullName, this);
                this._on(true, this.element, {
                    remove: function (e) {
                        if (e.target === t) {
                            this.destroy()
                        }
                    }
                });
                this.document = c(t.style ? t.ownerDocument : t.document || t);
                this.window = c(this.document[0].defaultView || this.document[0].parentWindow)
            }
            this.options = c.widget.extend({}, this.options, this._getCreateOptions(), e);
            this._create();
            this._trigger("create", null, this._getCreateEventData());
            this._init()
        },
        _getCreateOptions: c.noop,
        _getCreateEventData: c.noop,
        _create: c.noop,
        _init: c.noop,
        destroy: function () {
            this._destroy();
            this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(c.camelCase(this.widgetFullName));
            this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled " + "ui-state-disabled");
            this.bindings.unbind(this.eventNamespace);
            this.hoverable.removeClass("ui-state-hover");
            this.focusable.removeClass("ui-state-focus")
        },
        _destroy: c.noop,
        widget: function () {
            return this.element
        },
        option: function (e, t) {
            var n = e,
                i, r, o;
            if (arguments.length === 0) {
                return c.widget.extend({}, this.options)
            }
            if (typeof e === "string") {
                n = {};
                i = e.split(".");
                e = i.shift();
                if (i.length) {
                    r = n[e] = c.widget.extend({}, this.options[e]);
                    for (o = 0; o < i.length - 1; o++) {
                        r[i[o]] = r[i[o]] || {};
                        r = r[i[o]]
                    }
                    e = i.pop();
                    if (arguments.length === 1) {
                        return r[e] === undefined ? null : r[e]
                    }
                    r[e] = t
                } else {
                    if (arguments.length === 1) {
                        return this.options[e] === undefined ? null : this.options[e]
                    }
                    n[e] = t
                }
            }
            this._setOptions(n);
            return this
        },
        _setOptions: function (e) {
            var t;
            for (t in e) {
                this._setOption(t, e[t])
            }
            return this
        },
        _setOption: function (e, t) {
            this.options[e] = t;
            if (e === "disabled") {
                this.widget().toggleClass(this.widgetFullName + "-disabled", !!t);
                if (t) {
                    this.hoverable.removeClass("ui-state-hover");
                    this.focusable.removeClass("ui-state-focus")
                }
            }
            return this
        },
        enable: function () {
            return this._setOptions({
                disabled: false
            })
        },
        disable: function () {
            return this._setOptions({
                disabled: true
            })
        },
        _on: function (a, s, e) {
            var l, u = this;
            if (typeof a !== "boolean") {
                e = s;
                s = a;
                a = false
            }
            if (!e) {
                e = s;
                s = this.element;
                l = this.widget()
            } else {
                s = l = c(s);
                this.bindings = this.bindings.add(s)
            }
            c.each(e, function (e, t) {
                function n() {
                    if (!a && (u.options.disabled === true || c(this).hasClass("ui-state-disabled"))) {
                        return
                    }
                    return (typeof t === "string" ? u[t] : t).apply(u, arguments)
                }
                if (typeof t !== "string") {
                    n.guid = t.guid = t.guid || n.guid || c.guid++
                }
                var i = e.match(/^([\w:-]*)\s*(.*)$/),
                    r = i[1] + u.eventNamespace,
                    o = i[2];
                if (o) {
                    l.delegate(o, r, n)
                } else {
                    s.bind(r, n)
                }
            })
        },
        _off: function (e, t) {
            t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace;
            e.unbind(t).undelegate(t);
            this.bindings = c(this.bindings.not(e).get());
            this.focusable = c(this.focusable.not(e).get());
            this.hoverable = c(this.hoverable.not(e).get())
        },
        _delay: function (e, t) {
            function n() {
                return (typeof e === "string" ? i[e] : e).apply(i, arguments)
            }
            var i = this;
            return setTimeout(n, t || 0)
        },
        _hoverable: function (e) {
            this.hoverable = this.hoverable.add(e);
            this._on(e, {
                mouseenter: function (e) {
                    c(e.currentTarget).addClass("ui-state-hover")
                },
                mouseleave: function (e) {
                    c(e.currentTarget).removeClass("ui-state-hover")
                }
            })
        },
        _focusable: function (e) {
            this.focusable = this.focusable.add(e);
            this._on(e, {
                focusin: function (e) {
                    c(e.currentTarget).addClass("ui-state-focus")
                },
                focusout: function (e) {
                    c(e.currentTarget).removeClass("ui-state-focus")
                }
            })
        },
        _trigger: function (e, t, n) {
            var i, r, o = this.options[e];
            n = n || {};
            t = c.Event(t);
            t.type = (e === this.widgetEventPrefix ? e : this.widgetEventPrefix + e).toLowerCase();
            t.target = this.element[0];
            r = t.originalEvent;
            if (r) {
                for (i in r) {
                    if (!(i in t)) {
                        t[i] = r[i]
                    }
                }
            }
            this.element.trigger(t, n);
            return !(c.isFunction(o) && o.apply(this.element[0], [t].concat(n)) === false || t.isDefaultPrevented())
        }
    };
    c.each({
        show: "fadeIn",
        hide: "fadeOut"
    }, function (o, a) {
        c.Widget.prototype["_" + o] = function (t, e, n) {
            if (typeof e === "string") {
                e = {
                    effect: e
                }
            }
            var i, r = !e ? o : e === true || typeof e === "number" ? a : e.effect || a;
            e = e || {};
            if (typeof e === "number") {
                e = {
                    duration: e
                }
            }
            i = !c.isEmptyObject(e);
            e.complete = n;
            if (e.delay) {
                t.delay(e.delay)
            }
            if (i && c.effects && c.effects.effect[r]) {
                t[o](e)
            } else if (r !== o && t[r]) {
                t[r](e.duration, e.easing, n)
            } else {
                t.queue(function (e) {
                    c(this)[o]();
                    if (n) {
                        n.call(t[0])
                    }
                    e()
                })
            }
        }
    });
    var e = c.widget
});
(function (e) {
    "use strict";
    if (typeof define === "function" && define.amd) {
        define(["jquery"], e)
    } else if (typeof exports === "object") {
        e(require("jquery"))
    } else {
        e(window.jQuery)
    }
})(function (l) {
    "use strict";
    var i = 0;
    l.ajaxTransport("iframe", function (r) {
        if (r.async) {
            var o = r.initialIframeSrc || "javascript:false;",
                a, s, t;
            return {
                send: function (e, n) {
                    a = l('<form style="display:none;"></form>');
                    a.attr("accept-charset", r.formAcceptCharset);
                    t = /\?/.test(r.url) ? "&" : "?";
                    if (r.type === "DELETE") {
                        r.url = r.url + t + "_method=DELETE";
                        r.type = "POST"
                    } else if (r.type === "PUT") {
                        r.url = r.url + t + "_method=PUT";
                        r.type = "POST"
                    } else if (r.type === "PATCH") {
                        r.url = r.url + t + "_method=PATCH";
                        r.type = "POST"
                    }
                    i += 1;
                    s = l('<iframe src="' + o + '" name="iframe-transport-' + i + '"></iframe>').bind("load", function () {
                        var i, t = l.isArray(r.paramName) ? r.paramName : [r.paramName];
                        s.unbind("load").bind("load", function () {
                            var t;
                            try {
                                t = s.contents();
                                if (!t.length || !t[0].firstChild) {
                                    throw new Error
                                }
                            } catch (e) {
                                t = undefined
                            }
                            n(200, "success", {
                                iframe: t
                            });
                            l('<iframe src="' + o + '"></iframe>').appendTo(a);
                            window.setTimeout(function () {
                                a.remove()
                            }, 0)
                        });
                        a.prop("target", s.prop("name")).prop("action", r.url).prop("method", r.type);
                        if (r.formData) {
                            l.each(r.formData, function (e, t) {
                                l('<input type="hidden"/>').prop("name", t.name).val(t.value).appendTo(a)
                            })
                        }
                        if (r.fileInput && r.fileInput.length && r.type === "POST") {
                            i = r.fileInput.clone();
                            r.fileInput.after(function (e) {
                                return i[e]
                            });
                            if (r.paramName) {
                                r.fileInput.each(function (e) {
                                    l(this).prop("name", t[e] || r.paramName)
                                })
                            }
                            a.append(r.fileInput).prop("enctype", "multipart/form-data").prop("encoding", "multipart/form-data");
                            r.fileInput.removeAttr("form")
                        }
                        a.submit();
                        if (i && i.length) {
                            r.fileInput.each(function (e, t) {
                                var n = l(i[e]);
                                l(t).prop("name", n.prop("name")).attr("form", n.attr("form"));
                                n.replaceWith(t)
                            })
                        }
                    });
                    a.append(s).appendTo(document.body)
                },
                abort: function () {
                    if (s) {
                        s.unbind("load").prop("src", o)
                    }
                    if (a) {
                        a.remove()
                    }
                }
            }
        }
    });
    l.ajaxSetup({
        converters: {
            "iframe text": function (e) {
                return e && l(e[0].body).text()
            },
            "iframe json": function (e) {
                return e && l.parseJSON(l(e[0].body).text())
            },
            "iframe html": function (e) {
                return e && l(e[0].body).html()
            },
            "iframe xml": function (e) {
                var t = e && e[0];
                return t && l.isXMLDoc(t) ? t : l.parseXML(t.XMLDocument && t.XMLDocument.xml || l(t.body).html())
            },
            "iframe script": function (e) {
                return e && l.globalEval(l(e[0].body).text())
            }
        }
    })
});
(function (e) {
    "use strict";
    if (typeof define === "function" && define.amd) {
        define(["jquery", "jquery-ui/ui/widget"], e)
    } else if (typeof exports === "object") {
        e(require("jquery"), require("./vendor/jquery.ui.widget"))
    } else {
        e(window.jQuery)
    }
})(function (_) {
    "use strict";
    _.support.fileInput = !(new RegExp("(Android (1\\.[0156]|2\\.[01]))" + "|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)" + "|(w(eb)?OSBrowser)|(webOS)" + "|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent) || _('<input type="file">').prop("disabled"));
    _.support.xhrFileUpload = !!(window.ProgressEvent && window.FileReader);
    _.support.xhrFormDataFileUpload = !!window.FormData;
    _.support.blobSlice = window.Blob && (Blob.prototype.slice || Blob.prototype.webkitSlice || Blob.prototype.mozSlice);

    function e(n) {
        var i = n === "dragover";
        return function (e) {
            e.dataTransfer = e.originalEvent && e.originalEvent.dataTransfer;
            var t = e.dataTransfer;
            if (t && _.inArray("Files", t.types) !== -1 && this._trigger(n, _.Event(n, {
                    delegatedEvent: e
                })) !== false) {
                e.preventDefault();
                if (i) {
                    t.dropEffect = "copy"
                }
            }
        }
    }
    _.widget("blueimp.fileupload", {
        options: {
            dropZone: _(document),
            pasteZone: undefined,
            fileInput: undefined,
            replaceFileInput: true,
            paramName: undefined,
            singleFileUploads: true,
            limitMultiFileUploads: undefined,
            limitMultiFileUploadSize: undefined,
            limitMultiFileUploadSizeOverhead: 512,
            sequentialUploads: false,
            limitConcurrentUploads: undefined,
            forceIframeTransport: false,
            redirect: undefined,
            redirectParamName: undefined,
            postMessage: undefined,
            multipart: true,
            maxChunkSize: undefined,
            uploadedBytes: undefined,
            recalculateProgress: true,
            progressInterval: 100,
            bitrateInterval: 500,
            autoUpload: true,
            messages: {
                uploadedBytes: "Uploaded bytes exceed file size"
            },
            i18n: function (n, e) {
                n = this.messages[n] || n.toString();
                if (e) {
                    _.each(e, function (e, t) {
                        n = n.replace("{" + e + "}", t)
                    })
                }
                return n
            },
            formData: function (e) {
                return e.serializeArray()
            },
            add: function (e, t) {
                if (e.isDefaultPrevented()) {
                    return false
                }
                if (t.autoUpload || t.autoUpload !== false && _(this).fileupload("option", "autoUpload")) {
                    t.process().done(function () {
                        t.submit()
                    })
                }
            },
            processData: false,
            contentType: false,
            cache: false,
            timeout: 0
        },
        _specialOptions: ["fileInput", "dropZone", "pasteZone", "multipart", "forceIframeTransport"],
        _blobSlice: _.support.blobSlice && function () {
            var e = this.slice || this.webkitSlice || this.mozSlice;
            return e.apply(this, arguments)
        },
        _BitrateTimer: function () {
            this.timestamp = Date.now ? Date.now() : (new Date).getTime();
            this.loaded = 0;
            this.bitrate = 0;
            this.getBitrate = function (e, t, n) {
                var i = e - this.timestamp;
                if (!this.bitrate || !n || i > n) {
                    this.bitrate = (t - this.loaded) * (1e3 / i) * 8;
                    this.loaded = t;
                    this.timestamp = e
                }
                return this.bitrate
            }
        },
        _isXHRUpload: function (e) {
            return !e.forceIframeTransport && (!e.multipart && _.support.xhrFileUpload || _.support.xhrFormDataFileUpload)
        },
        _getFormData: function (e) {
            var n;
            if (_.type(e.formData) === "function") {
                return e.formData(e.form)
            }
            if (_.isArray(e.formData)) {
                return e.formData
            }
            if (_.type(e.formData) === "object") {
                n = [];
                _.each(e.formData, function (e, t) {
                    n.push({
                        name: e,
                        value: t
                    })
                });
                return n
            }
            return []
        },
        _getTotal: function (e) {
            var n = 0;
            _.each(e, function (e, t) {
                n += t.size || 1
            });
            return n
        },
        _initProgressObject: function (e) {
            var t = {
                loaded: 0,
                total: 0,
                bitrate: 0
            };
            if (e._progress) {
                _.extend(e._progress, t)
            } else {
                e._progress = t
            }
        },
        _initResponseObject: function (e) {
            var t;
            if (e._response) {
                for (t in e._response) {
                    if (e._response.hasOwnProperty(t)) {
                        delete e._response[t]
                    }
                }
            } else {
                e._response = {}
            }
        },
        _onProgress: function (e, t) {
            if (e.lengthComputable) {
                var n = Date.now ? Date.now() : (new Date).getTime(),
                    i;
                if (t._time && t.progressInterval && n - t._time < t.progressInterval && e.loaded !== e.total) {
                    return
                }
                t._time = n;
                i = Math.floor(e.loaded / e.total * (t.chunkSize || t._progress.total)) + (t.uploadedBytes || 0);
                this._progress.loaded += i - t._progress.loaded;
                this._progress.bitrate = this._bitrateTimer.getBitrate(n, this._progress.loaded, t.bitrateInterval);
                t._progress.loaded = t.loaded = i;
                t._progress.bitrate = t.bitrate = t._bitrateTimer.getBitrate(n, i, t.bitrateInterval);
                this._trigger("progress", _.Event("progress", {
                    delegatedEvent: e
                }), t);
                this._trigger("progressall", _.Event("progressall", {
                    delegatedEvent: e
                }), this._progress)
            }
        },
        _initProgressListener: function (n) {
            var i = this,
                e = n.xhr ? n.xhr() : _.ajaxSettings.xhr();
            if (e.upload) {
                _(e.upload).bind("progress", function (e) {
                    var t = e.originalEvent;
                    e.lengthComputable = t.lengthComputable;
                    e.loaded = t.loaded;
                    e.total = t.total;
                    i._onProgress(e, n)
                });
                n.xhr = function () {
                    return e
                }
            }
        },
        _isInstanceOf: function (e, t) {
            return Object.prototype.toString.call(t) === "[object " + e + "]"
        },
        _initXHRData: function (n) {
            var i = this,
                r, e = n.files[0],
                t = n.multipart || !_.support.xhrFileUpload,
                o = _.type(n.paramName) === "array" ? n.paramName[0] : n.paramName;
            n.headers = _.extend({}, n.headers);
            if (n.contentRange) {
                n.headers["Content-Range"] = n.contentRange
            }
            if (!t || n.blob || !this._isInstanceOf("File", e)) {
                n.headers["Content-Disposition"] = 'attachment; filename="' + encodeURI(e.name) + '"'
            }
            if (!t) {
                n.contentType = e.type || "application/octet-stream";
                n.data = n.blob || e
            } else if (_.support.xhrFormDataFileUpload) {
                if (n.postMessage) {
                    r = this._getFormData(n);
                    if (n.blob) {
                        r.push({
                            name: o,
                            value: n.blob
                        })
                    } else {
                        _.each(n.files, function (e, t) {
                            r.push({
                                name: _.type(n.paramName) === "array" && n.paramName[e] || o,
                                value: t
                            })
                        })
                    }
                } else {
                    if (i._isInstanceOf("FormData", n.formData)) {
                        r = n.formData
                    } else {
                        r = new FormData;
                        _.each(this._getFormData(n), function (e, t) {
                            r.append(t.name, t.value)
                        })
                    }
                    if (n.blob) {
                        r.append(o, n.blob, e.name)
                    } else {
                        _.each(n.files, function (e, t) {
                            if (i._isInstanceOf("File", t) || i._isInstanceOf("Blob", t)) {
                                r.append(_.type(n.paramName) === "array" && n.paramName[e] || o, t, t.uploadName || t.name)
                            }
                        })
                    }
                }
                n.data = r
            }
            n.blob = null
        },
        _initIframeSettings: function (e) {
            var t = _("<a></a>").prop("href", e.url).prop("host");
            e.dataType = "iframe " + (e.dataType || "");
            e.formData = this._getFormData(e);
            if (e.redirect && t && t !== location.host) {
                e.formData.push({
                    name: e.redirectParamName || "redirect",
                    value: e.redirect
                })
            }
        },
        _initDataSettings: function (e) {
            if (this._isXHRUpload(e)) {
                if (!this._chunkedUpload(e, true)) {
                    if (!e.data) {
                        this._initXHRData(e)
                    }
                    this._initProgressListener(e)
                }
                if (e.postMessage) {
                    e.dataType = "postmessage " + (e.dataType || "")
                }
            } else {
                this._initIframeSettings(e)
            }
        },
        _getParamName: function (e) {
            var t = _(e.fileInput),
                i = e.paramName;
            if (!i) {
                i = [];
                t.each(function () {
                    var e = _(this),
                        t = e.prop("name") || "files[]",
                        n = (e.prop("files") || [1]).length;
                    while (n) {
                        i.push(t);
                        n -= 1
                    }
                });
                if (!i.length) {
                    i = [t.prop("name") || "files[]"]
                }
            } else if (!_.isArray(i)) {
                i = [i]
            }
            return i
        },
        _initFormSettings: function (e) {
            if (!e.form || !e.form.length) {
                e.form = _(e.fileInput.prop("form"));
                if (!e.form.length) {
                    e.form = _(this.options.fileInput.prop("form"))
                }
            }
            e.paramName = this._getParamName(e);
            if (!e.url) {
                e.url = e.form.prop("action") || location.href
            }
            e.type = (e.type || _.type(e.form.prop("method")) === "string" && e.form.prop("method") || "").toUpperCase();
            if (e.type !== "POST" && e.type !== "PUT" && e.type !== "PATCH") {
                e.type = "POST"
            }
            if (!e.formAcceptCharset) {
                e.formAcceptCharset = e.form.attr("accept-charset")
            }
        },
        _getAJAXSettings: function (e) {
            var t = _.extend({}, this.options, e);
            this._initFormSettings(t);
            this._initDataSettings(t);
            return t
        },
        _getDeferredState: function (e) {
            if (e.state) {
                return e.state()
            }
            if (e.isResolved()) {
                return "resolved"
            }
            if (e.isRejected()) {
                return "rejected"
            }
            return "pending"
        },
        _enhancePromise: function (e) {
            e.success = e.done;
            e.error = e.fail;
            e.complete = e.always;
            return e
        },
        _getXHRPromise: function (e, t, n) {
            var i = _.Deferred(),
                r = i.promise();
            t = t || this.options.context || r;
            if (e === true) {
                i.resolveWith(t, n)
            } else if (e === false) {
                i.rejectWith(t, n)
            }
            r.abort = i.promise;
            return this._enhancePromise(r)
        },
        _addConvenienceMethods: function (e, n) {
            var i = this,
                r = function (e) {
                    return _.Deferred().resolveWith(i, e).promise()
                };
            n.process = function (e, t) {
                if (e || t) {
                    n._processQueue = this._processQueue = (this._processQueue || r([this])).then(function () {
                        if (n.errorThrown) {
                            return _.Deferred().rejectWith(i, [n]).promise()
                        }
                        return r(arguments)
                    }).then(e, t)
                }
                return this._processQueue || r([this])
            };
            n.submit = function () {
                if (this.state() !== "pending") {
                    n.jqXHR = this.jqXHR = i._trigger("submit", _.Event("submit", {
                        delegatedEvent: e
                    }), this) !== false && i._onSend(e, this)
                }
                return this.jqXHR || i._getXHRPromise()
            };
            n.abort = function () {
                if (this.jqXHR) {
                    return this.jqXHR.abort()
                }
                this.errorThrown = "abort";
                i._trigger("fail", null, this);
                return i._getXHRPromise(false)
            };
            n.state = function () {
                if (this.jqXHR) {
                    return i._getDeferredState(this.jqXHR)
                }
                if (this._processQueue) {
                    return i._getDeferredState(this._processQueue)
                }
            };
            n.processing = function () {
                return !this.jqXHR && this._processQueue && i._getDeferredState(this._processQueue) === "pending"
            };
            n.progress = function () {
                return this._progress
            };
            n.response = function () {
                return this._response
            }
        },
        _getUploadedBytes: function (e) {
            var t = e.getResponseHeader("Range"),
                n = t && t.split("-"),
                i = n && n.length > 1 && parseInt(n[1], 10);
            return i && i + 1
        },
        _chunkedUpload: function (o, e) {
            o.uploadedBytes = o.uploadedBytes || 0;
            var a = this,
                t = o.files[0],
                s = t.size,
                l = o.uploadedBytes,
                n = o.maxChunkSize || s,
                u = this._blobSlice,
                c = _.Deferred(),
                i = c.promise(),
                f, h;
            if (!(this._isXHRUpload(o) && u && (l || n < s)) || o.data) {
                return false
            }
            if (e) {
                return true
            }
            if (l >= s) {
                t.error = o.i18n("uploadedBytes");
                return this._getXHRPromise(false, o.context, [null, "error", t.error])
            }
            h = function () {
                var i = _.extend({}, o),
                    r = i._progress.loaded;
                i.blob = u.call(t, l, l + n, t.type);
                i.chunkSize = i.blob.size;
                i.contentRange = "bytes " + l + "-" + (l + i.chunkSize - 1) + "/" + s;
                a._initXHRData(i);
                a._initProgressListener(i);
                f = (a._trigger("chunksend", null, i) !== false && _.ajax(i) || a._getXHRPromise(false, i.context)).done(function (e, t, n) {
                    l = a._getUploadedBytes(n) || l + i.chunkSize;
                    if (r + i.chunkSize - i._progress.loaded) {
                        a._onProgress(_.Event("progress", {
                            lengthComputable: true,
                            loaded: l - i.uploadedBytes,
                            total: l - i.uploadedBytes
                        }), i)
                    }
                    o.uploadedBytes = i.uploadedBytes = l;
                    i.result = e;
                    i.textStatus = t;
                    i.jqXHR = n;
                    a._trigger("chunkdone", null, i);
                    a._trigger("chunkalways", null, i);
                    if (l < s) {
                        h()
                    } else {
                        c.resolveWith(i.context, [e, t, n])
                    }
                }).fail(function (e, t, n) {
                    i.jqXHR = e;
                    i.textStatus = t;
                    i.errorThrown = n;
                    a._trigger("chunkfail", null, i);
                    a._trigger("chunkalways", null, i);
                    c.rejectWith(i.context, [e, t, n])
                })
            };
            this._enhancePromise(i);
            i.abort = function () {
                return f.abort()
            };
            h();
            return i
        },
        _beforeSend: function (e, t) {
            if (this._active === 0) {
                this._trigger("start");
                this._bitrateTimer = new this._BitrateTimer;
                this._progress.loaded = this._progress.total = 0;
                this._progress.bitrate = 0
            }
            this._initResponseObject(t);
            this._initProgressObject(t);
            t._progress.loaded = t.loaded = t.uploadedBytes || 0;
            t._progress.total = t.total = this._getTotal(t.files) || 1;
            t._progress.bitrate = t.bitrate = 0;
            this._active += 1;
            this._progress.loaded += t.loaded;
            this._progress.total += t.total
        },
        _onDone: function (e, t, n, i) {
            var r = i._progress.total,
                o = i._response;
            if (i._progress.loaded < r) {
                this._onProgress(_.Event("progress", {
                    lengthComputable: true,
                    loaded: r,
                    total: r
                }), i)
            }
            o.result = i.result = e;
            o.textStatus = i.textStatus = t;
            o.jqXHR = i.jqXHR = n;
            this._trigger("done", null, i)
        },
        _onFail: function (e, t, n, i) {
            var r = i._response;
            if (i.recalculateProgress) {
                this._progress.loaded -= i._progress.loaded;
                this._progress.total -= i._progress.total
            }
            r.jqXHR = i.jqXHR = e;
            r.textStatus = i.textStatus = t;
            r.errorThrown = i.errorThrown = n;
            this._trigger("fail", null, i)
        },
        _onAlways: function (e, t, n, i) {
            this._trigger("always", null, i)
        },
        _onSend: function (e, t) {
            if (!t.submit) {
                this._addConvenienceMethods(e, t)
            }
            var r = this,
                n, i, o, a, s = r._getAJAXSettings(t),
                l = function () {
                    r._sending += 1;
                    s._bitrateTimer = new r._BitrateTimer;
                    n = n || ((i || r._trigger("send", _.Event("send", {
                        delegatedEvent: e
                    }), s) === false) && r._getXHRPromise(false, s.context, i) || r._chunkedUpload(s) || _.ajax(s)).done(function (e, t, n) {
                        r._onDone(e, t, n, s)
                    }).fail(function (e, t, n) {
                        r._onFail(e, t, n, s)
                    }).always(function (e, t, n) {
                        r._onAlways(e, t, n, s);
                        r._sending -= 1;
                        r._active -= 1;
                        if (s.limitConcurrentUploads && s.limitConcurrentUploads > r._sending) {
                            var i = r._slots.shift();
                            while (i) {
                                if (r._getDeferredState(i) === "pending") {
                                    i.resolve();
                                    break
                                }
                                i = r._slots.shift()
                            }
                        }
                        if (r._active === 0) {
                            r._trigger("stop")
                        }
                    });
                    return n
                };
            this._beforeSend(e, s);
            if (this.options.sequentialUploads || this.options.limitConcurrentUploads && this.options.limitConcurrentUploads <= this._sending) {
                if (this.options.limitConcurrentUploads > 1) {
                    o = _.Deferred();
                    this._slots.push(o);
                    a = o.then(l)
                } else {
                    this._sequence = this._sequence.then(l, l);
                    a = this._sequence
                }
                a.abort = function () {
                    i = [undefined, "abort", "abort"];
                    if (!n) {
                        if (o) {
                            o.rejectWith(s.context, i)
                        }
                        return l()
                    }
                    return n.abort()
                };
                return this._enhancePromise(a)
            }
            return l()
        },
        _onAdd: function (i, r) {
            var o = this,
                a = true,
                e = _.extend({}, this.options, r),
                t = r.files,
                n = t.length,
                s = e.limitMultiFileUploads,
                l = e.limitMultiFileUploadSize,
                u = e.limitMultiFileUploadSizeOverhead,
                c = 0,
                f = this._getParamName(e),
                h, d, p, v, g = 0;
            if (!n) {
                return false
            }
            if (l && t[0].size === undefined) {
                l = undefined
            }
            if (!(e.singleFileUploads || s || l) || !this._isXHRUpload(e)) {
                p = [t];
                h = [f]
            } else if (!(e.singleFileUploads || l) && s) {
                p = [];
                h = [];
                for (v = 0; v < n; v += s) {
                    p.push(t.slice(v, v + s));
                    d = f.slice(v, v + s);
                    if (!d.length) {
                        d = f
                    }
                    h.push(d)
                }
            } else if (!e.singleFileUploads && l) {
                p = [];
                h = [];
                for (v = 0; v < n; v = v + 1) {
                    c += t[v].size + u;
                    if (v + 1 === n || c + t[v + 1].size + u > l || s && v + 1 - g >= s) {
                        p.push(t.slice(g, v + 1));
                        d = f.slice(g, v + 1);
                        if (!d.length) {
                            d = f
                        }
                        h.push(d);
                        g = v + 1;
                        c = 0
                    }
                }
            } else {
                h = f
            }
            r.originalFiles = t;
            _.each(p || t, function (e, t) {
                var n = _.extend({}, r);
                n.files = p ? t : [t];
                n.paramName = h[e];
                o._initResponseObject(n);
                o._initProgressObject(n);
                o._addConvenienceMethods(i, n);
                a = o._trigger("add", _.Event("add", {
                    delegatedEvent: i
                }), n);
                return a
            });
            return a
        },
        _replaceFileInput: function (e) {
            var n = e.fileInput,
                i = n.clone(true),
                t = n.is(document.activeElement);
            e.fileInputClone = i;
            _("<form></form>").append(i)[0].reset();
            n.after(i).detach();
            if (t) {
                i.focus()
            }
            _.cleanData(n.unbind("remove"));
            this.options.fileInput = this.options.fileInput.map(function (e, t) {
                if (t === n[0]) {
                    return i[0]
                }
                return t
            });
            if (n[0] === this.element[0]) {
                this.element = i
            }
        },
        _handleFileTreeEntry: function (t, n) {
            var i = this,
                r = _.Deferred(),
                o = [],
                e, a = function (e) {
                    if (e && !e.entry) {
                        e.entry = t
                    }
                    r.resolve([e])
                },
                s = function (e) {
                    i._handleFileTreeEntries(e, n + t.name + "/").done(function (e) {
                        r.resolve(e)
                    }).fail(a)
                },
                l = function () {
                    e.readEntries(function (e) {
                        if (!e.length) {
                            s(o)
                        } else {
                            o = o.concat(e);
                            l()
                        }
                    }, a)
                };
            n = n || "";
            if (t.isFile) {
                if (t._file) {
                    t._file.relativePath = n;
                    r.resolve(t._file)
                } else {
                    t.file(function (e) {
                        e.relativePath = n;
                        r.resolve(e)
                    }, a)
                }
            } else if (t.isDirectory) {
                e = t.createReader();
                l()
            } else {
                r.resolve([])
            }
            return r.promise()
        },
        _handleFileTreeEntries: function (e, t) {
            var n = this;
            return _.when.apply(_, _.map(e, function (e) {
                return n._handleFileTreeEntry(e, t)
            })).then(function () {
                return Array.prototype.concat.apply([], arguments)
            })
        },
        _getDroppedFiles: function (e) {
            e = e || {};
            var t = e.items;
            if (t && t.length && (t[0].webkitGetAsEntry || t[0].getAsEntry)) {
                return this._handleFileTreeEntries(_.map(t, function (e) {
                    var t;
                    if (e.webkitGetAsEntry) {
                        t = e.webkitGetAsEntry();
                        if (t) {
                            t._file = e.getAsFile()
                        }
                        return t
                    }
                    return e.getAsEntry()
                }))
            }
            return _.Deferred().resolve(_.makeArray(e.files)).promise()
        },
        _getSingleFileInputFiles: function (e) {
            e = _(e);
            var t = e.prop("webkitEntries") || e.prop("entries"),
                n, i;
            if (t && t.length) {
                return this._handleFileTreeEntries(t)
            }
            n = _.makeArray(e.prop("files"));
            if (!n.length) {
                i = e.prop("value");
                if (!i) {
                    return _.Deferred().resolve([]).promise()
                }
                n = [{
                    name: i.replace(/^.*\\/, "")
                }]
            } else if (n[0].name === undefined && n[0].fileName) {
                _.each(n, function (e, t) {
                    t.name = t.fileName;
                    t.size = t.fileSize
                })
            }
            return _.Deferred().resolve(n).promise()
        },
        _getFileInputFiles: function (e) {
            if (!(e instanceof _) || e.length === 1) {
                return this._getSingleFileInputFiles(e)
            }
            return _.when.apply(_, _.map(e, this._getSingleFileInputFiles)).then(function () {
                return Array.prototype.concat.apply([], arguments)
            })
        },
        _onChange: function (t) {
            var n = this,
                i = {
                    fileInput: _(t.target),
                    form: _(t.target.form)
                };
            this._getFileInputFiles(i.fileInput).always(function (e) {
                i.files = e;
                if (n.options.replaceFileInput) {
                    n._replaceFileInput(i)
                }
                if (n._trigger("change", _.Event("change", {
                        delegatedEvent: t
                    }), i) !== false) {
                    n._onAdd(t, i)
                }
            })
        },
        _onPaste: function (e) {
            var t = e.originalEvent && e.originalEvent.clipboardData && e.originalEvent.clipboardData.items,
                i = {
                    files: []
                };
            if (t && t.length) {
                _.each(t, function (e, t) {
                    var n = t.getAsFile && t.getAsFile();
                    if (n) {
                        i.files.push(n)
                    }
                });
                if (this._trigger("paste", _.Event("paste", {
                        delegatedEvent: e
                    }), i) !== false) {
                    this._onAdd(e, i)
                }
            }
        },
        _onDrop: function (t) {
            t.dataTransfer = t.originalEvent && t.originalEvent.dataTransfer;
            var n = this,
                e = t.dataTransfer,
                i = {};
            if (e && e.files && e.files.length) {
                t.preventDefault();
                this._getDroppedFiles(e).always(function (e) {
                    i.files = e;
                    if (n._trigger("drop", _.Event("drop", {
                            delegatedEvent: t
                        }), i) !== false) {
                        n._onAdd(t, i)
                    }
                })
            }
        },
        _onDragOver: e("dragover"),
        _onDragEnter: e("dragenter"),
        _onDragLeave: e("dragleave"),
        _initEventHandlers: function () {
            if (this._isXHRUpload(this.options)) {
                this._on(this.options.dropZone, {
                    dragover: this._onDragOver,
                    drop: this._onDrop,
                    dragenter: this._onDragEnter,
                    dragleave: this._onDragLeave
                });
                this._on(this.options.pasteZone, {
                    paste: this._onPaste
                })
            }
            if (_.support.fileInput) {
                this._on(this.options.fileInput, {
                    change: this._onChange
                })
            }
        },
        _destroyEventHandlers: function () {
            this._off(this.options.dropZone, "dragenter dragleave dragover drop");
            this._off(this.options.pasteZone, "paste");
            this._off(this.options.fileInput, "change")
        },
        _destroy: function () {
            this._destroyEventHandlers()
        },
        _setOption: function (e, t) {
            var n = _.inArray(e, this._specialOptions) !== -1;
            if (n) {
                this._destroyEventHandlers()
            }
            this._super(e, t);
            if (n) {
                this._initSpecialOptions();
                this._initEventHandlers()
            }
        },
        _initSpecialOptions: function () {
            var e = this.options;
            if (e.fileInput === undefined) {
                e.fileInput = this.element.is('input[type="file"]') ? this.element : this.element.find('input[type="file"]')
            } else if (!(e.fileInput instanceof _)) {
                e.fileInput = _(e.fileInput)
            }
            if (!(e.dropZone instanceof _)) {
                e.dropZone = _(e.dropZone)
            }
            if (!(e.pasteZone instanceof _)) {
                e.pasteZone = _(e.pasteZone)
            }
        },
        _getRegExp: function (e) {
            var t = e.split("/"),
                n = t.pop();
            t.shift();
            return new RegExp(t.join("/"), n)
        },
        _isRegExpOption: function (e, t) {
            return e !== "url" && _.type(t) === "string" && /^\/.*\/[igm]{0,3}$/.test(t)
        },
        _initDataAttributes: function () {
            var r = this,
                o = this.options,
                a = this.element.data();
            _.each(this.element[0].attributes, function (e, t) {
                var n = t.name.toLowerCase(),
                    i;
                if (/^data-/.test(n)) {
                    n = n.slice(5).replace(/-[a-z]/g, function (e) {
                        return e.charAt(1).toUpperCase()
                    });
                    i = a[n];
                    if (r._isRegExpOption(n, i)) {
                        i = r._getRegExp(i)
                    }
                    o[n] = i
                }
            })
        },
        _create: function () {
            this._initDataAttributes();
            this._initSpecialOptions();
            this._slots = [];
            this._sequence = this._getXHRPromise(true);
            this._sending = this._active = 0;
            this._initProgressObject(this);
            this._initEventHandlers()
        },
        active: function () {
            return this._active
        },
        progress: function () {
            return this._progress
        },
        add: function (t) {
            var n = this;
            if (!t || this.options.disabled) {
                return
            }
            if (t.fileInput && !t.files) {
                this._getFileInputFiles(t.fileInput).always(function (e) {
                    t.files = e;
                    n._onAdd(null, t)
                })
            } else {
                t.files = _.makeArray(t.files);
                this._onAdd(null, t)
            }
        },
        send: function (t) {
            if (t && !this.options.disabled) {
                if (t.fileInput && !t.files) {
                    var n = this,
                        i = _.Deferred(),
                        e = i.promise(),
                        r, o;
                    e.abort = function () {
                        o = true;
                        if (r) {
                            return r.abort()
                        }
                        i.reject(null, "abort", "abort");
                        return e
                    };
                    this._getFileInputFiles(t.fileInput).always(function (e) {
                        if (o) {
                            return
                        }
                        if (!e.length) {
                            i.reject();
                            return
                        }
                        t.files = e;
                        r = n._onSend(null, t);
                        r.then(function (e, t, n) {
                            i.resolve(e, t, n)
                        }, function (e, t, n) {
                            i.reject(e, t, n)
                        })
                    });
                    return this._enhancePromise(e)
                }
                t.files = _.makeArray(t.files);
                if (t.files.length) {
                    return this._onSend(null, t)
                }
            }
            return this._getXHRPromise(false, t && t.context)
        }
    })
});
var Tooltip = function () {
    $("body").append('<div id="tooltip"><div id="tooltip_inner"></div></div>');
    $("body").append('<div id="tooltip_arrow"></div>');
    this.hide();
    var e = "#FFF";
    this.BACKGROUND_COLOR = "rgba(17, 17, 17, .9)";
    this.TEXT_PADDING = 10;
    var t = this.TEXT_PADDING + "px";
    var n = "2px";
    this.TRIANGLE_WIDTH = "10px";
    var i = "solid 1px #333";
    this.makeDownArrow();
    $("#tooltip").css("max-width", "50%");
    $("#tooltip_inner").css("max-width", "500px");
    $("#tooltip_inner").css("display", "table-cell");
    $("#tooltip").css({
        position: "absolute",
        transform: "perspective(1px) translate(-50%, 0)"
    });
    $("#tooltip_arrow").css({
        position: "absolute",
        transform: "perspective(1px) translate(0, -50%)"
    });
    $("#tooltip").css("color", e);
    $("#tooltip").css("background-color", this.BACKGROUND_COLOR);
    $("#tooltip").css("padding", t);
    $("#tooltip").css("border-radius", n);
    $("#tooltip").css("box-shadow", "0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22)");
    $("#tooltip").css("z-index", "1000002");
    $("#tooltip_arrow").css("z-index", "1000002")
};
Tooltip.prototype.makeRightArrow = function (e, t, n) {
    $("#tooltip_arrow").css("width", "0");
    $("#tooltip_arrow").css("height", "0");
    $("#tooltip_arrow").css("border-bottom", this.TRIANGLE_WIDTH + " solid transparent");
    $("#tooltip_arrow").css("border-top", this.TRIANGLE_WIDTH + " solid transparent");
    $("#tooltip_arrow").css("border-left", this.TRIANGLE_WIDTH + " solid " + this.BACKGROUND_COLOR);
    $("#tooltip_arrow").css("border-right", "")
};
Tooltip.prototype.makeUpArrow = function (e, t, n) {
    $("#tooltip_arrow").css("width", "0");
    $("#tooltip_arrow").css("height", "0");
    $("#tooltip_arrow").css("border-left", this.TRIANGLE_WIDTH + " solid transparent");
    $("#tooltip_arrow").css("border-right", this.TRIANGLE_WIDTH + " solid transparent");
    $("#tooltip_arrow").css("border-top", this.TRIANGLE_WIDTH + " solid " + this.BACKGROUND_COLOR);
    $("#tooltip_arrow").css("border-bottom", "")
};
Tooltip.prototype.makeDownArrow = function (e, t, n) {
    $("#tooltip_arrow").css("width", "0");
    $("#tooltip_arrow").css("height", "0");
    $("#tooltip_arrow").css("border-left", this.TRIANGLE_WIDTH + " solid transparent");
    $("#tooltip_arrow").css("border-right", this.TRIANGLE_WIDTH + " solid transparent");
    $("#tooltip_arrow").css("border-bottom", this.TRIANGLE_WIDTH + " solid " + this.BACKGROUND_COLOR);
    $("#tooltip_arrow").css("border-top", "")
};
Tooltip.prototype.show = function (c, f, e, t) {
    $("#tooltip_arrow").show();
    e = e.replace("background-color: rgb(255, 255, 255);", "");
    var h = 10;
    if (t == "right") {
        var n = $("#tooltip").outerWidth();
        this.makeRightArrow();
        $("#tooltip_inner").html(e);
        $("#tooltip_arrow").css({
            position: "absolute",
            left: c,
            top: f,
            transform: "perspective(1px) translate(0, -50%)"
        });
        $("#tooltip").css({
            position: "absolute",
            left: c - n,
            top: f,
            transform: "perspective(1px) translate(0, -50%)"
        });
        $("#tooltip").show()
    } else {
        $("#tooltip").css({
            position: "absolute",
            left: 0,
            width: "500px",
            top: f,
            transform: "perspective(1px) translate(-50%, 0)"
        });
        $("#tooltip").show().promise().done(function () {
                $("#tooltip_inner").html(e).promise().done(function () {
                        var e = $("#tooltip_inner").outerWidth() + this.TEXT_PADDING * 2;
                        var t = c - e / 2;
                        var n = c + e / 2;
                        var i = $(window).scrollLeft() + $(window).width();
                        var r = $("#tooltip").outerHeight();
                        var o = f + h + +r;
                        var a = $(window).scrollTop() + $(window).height();
                        var s = f;
                        var l = 1;
                        if (o > a) {
                            this.makeUpArrow();
                            f -= r;
                            s -= 3 * h;
                            h *= -3;
                            l *= -1
                        } else {
                            this.makeDownArrow()
                        }
                        var u;
                        if (t < 0 && n > i) {} else if (t < 0) {
                            u = c - t
                        } else if (n > i) {
                            u = c - (n - i)
                        } else {
                            u = c
                        }
                        $("#tooltip_arrow").css({
                            position: "absolute",
                            left: c,
                            top: s + l,
                            transform: "perspective(1px) translate(-50%, 0)"
                        });
                        $("#tooltip").css({
                            position: "absolute",
                            left: u,
                            top: f + h,
                            width: e - this.TEXT_PADDING * 2 + "px"
                        })
                    }
                    .bind(this))
            }
            .bind(this))
    }
};
Tooltip.prototype.hide = function () {
    $("#tooltip").hide();
    $("#tooltip_arrow").hide()
};
! function (n) {
    "function" == typeof define && define.amd ? define(["jquery"], n) : "object" == typeof module && module.exports ? module.exports = function (e, t) {
            return void 0 === t && (t = "undefined" != typeof window ? require("jquery") : require("jquery")(e)),
                n(t),
                t
        } :
        n(jQuery)
}(function (f) {
    "use strict";
    var t = f(document),
        u = f(window),
        n = ["a", "e", "i", "o", "u", "n", "c", "y"],
        i = [/[\xE0-\xE5]/g, /[\xE8-\xEB]/g, /[\xEC-\xEF]/g, /[\xF2-\xF6]/g, /[\xF9-\xFC]/g, /[\xF1]/g, /[\xE7]/g, /[\xFD-\xFF]/g],
        r = function (e, t) {
            var n = this;
            n.element = e,
                n.$element = f(e),
                n.state = {
                    multiple: !!n.$element.attr("multiple"),
                    enabled: !1,
                    opened: !1,
                    currValue: -1,
                    selectedIdx: -1,
                    highlightedIdx: -1
                },
                n.eventTriggers = {
                    open: n.open,
                    close: n.close,
                    destroy: n.destroy,
                    refresh: n.refresh,
                    init: n.init
                },
                n.init(t)
        };
    r.prototype = {
            utils: {
                isMobile: function () {
                    return /android|ip(hone|od|ad)/i.test(navigator.userAgent)
                },
                escapeRegExp: function (e) {
                    return e.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")
                },
                replaceDiacritics: function (e) {
                    for (var t = i.length; t--;)
                        e = e.toLowerCase().replace(i[t], n[t]);
                    return e
                },
                format: function (e) {
                    var i = arguments;
                    return ("" + e).replace(/\{(?:(\d+)|(\w+))\}/g, function (e, t, n) {
                        return n && i[1] ? i[1][n] : i[t]
                    })
                },
                nextEnabledItem: function (e, t) {
                    for (; e[t = (t + 1) % e.length].disabled;)
                    ;
                    return t
                },
                previousEnabledItem: function (e, t) {
                    for (; e[t = (t > 0 ? t : e.length) - 1].disabled;)
                    ;
                    return t
                },
                toDash: function (e) {
                    return e.replace(/([a-z0-9])([A-Z])/g, "$1-$2").toLowerCase()
                },
                triggerCallback: function (e, t) {
                    var n = t.element,
                        i = t.options["on" + e],
                        r = [n].concat([].slice.call(arguments).slice(1));
                    f.isFunction(i) && i.apply(n, r),
                        f(n).trigger("selectric-" + this.toDash(e), r)
                },
                arrayToClassname: function (e) {
                    var t = f.grep(e, function (e) {
                        return !!e
                    });
                    return f.trim(t.join(" "))
                }
            },
            init: function (e) {
                var t = this;
                if (t.options = f.extend(!0, {}, f.fn.selectric.defaults, t.options, e),
                    t.utils.triggerCallback("BeforeInit", t),
                    t.destroy(!0),
                    t.options.disableOnMobile && t.utils.isMobile())
                    return void(t.disableOnMobile = !0);
                t.classes = t.getClassNames();
                var n = f("<input/>", {
                        class: t.classes.input,
                        readonly: t.utils.isMobile()
                    }),
                    i = f("<div/>", {
                        class: t.classes.items,
                        tabindex: -1
                    }),
                    r = f("<div/>", {
                        class: t.classes.scroll
                    }),
                    o = f("<div/>", {
                        class: t.classes.prefix,
                        html: t.options.arrowButtonMarkup
                    }),
                    a = f("<span/>", {
                        class: "label"
                    }),
                    s = t.$element.wrap("<div/>").parent().append(o.prepend(a), i, n),
                    l = f("<div/>", {
                        class: t.classes.hideselect
                    });
                t.elements = {
                        input: n,
                        items: i,
                        itemsScroll: r,
                        wrapper: o,
                        label: a,
                        outerWrapper: s
                    },
                    t.options.nativeOnMobile && t.utils.isMobile() && (t.elements.input = void 0,
                        l.addClass(t.classes.prefix + "-is-native"),
                        t.$element.on("change", function () {
                            t.refresh()
                        })),
                    t.$element.on(t.eventTriggers).wrap(l),
                    t.originalTabindex = t.$element.prop("tabindex"),
                    t.$element.prop("tabindex", -1),
                    t.populate(),
                    t.activate(),
                    t.utils.triggerCallback("Init", t)
            },
            activate: function () {
                var e = this,
                    t = e.elements.items.closest(":visible").children(":hidden").addClass(e.classes.tempshow),
                    n = e.$element.width();
                t.removeClass(e.classes.tempshow),
                    e.utils.triggerCallback("BeforeActivate", e),
                    e.elements.outerWrapper.prop("class", e.utils.arrayToClassname([e.classes.wrapper, e.$element.prop("class").replace(/\S+/g, e.classes.prefix + "-$&"), e.options.responsive ? e.classes.responsive : ""])),
                    e.options.inheritOriginalWidth && n > 0 && e.elements.outerWrapper.width(n),
                    e.unbindEvents(),
                    e.$element.prop("disabled") ? (e.elements.outerWrapper.addClass(e.classes.disabled),
                        e.elements.input && e.elements.input.prop("disabled", !0)) : (e.state.enabled = !0,
                        e.elements.outerWrapper.removeClass(e.classes.disabled),
                        e.$li = e.elements.items.removeAttr("style").find("li"),
                        e.bindEvents()),
                    e.utils.triggerCallback("Activate", e)
            },
            getClassNames: function () {
                var i = this,
                    r = i.options.customClass,
                    o = {};
                return f.each("Input Items Open Disabled TempShow HideSelect Wrapper Focus Hover Responsive Above Below Scroll Group GroupLabel".split(" "), function (e, t) {
                        var n = r.prefix + t;
                        o[t.toLowerCase()] = r.camelCase ? n : i.utils.toDash(n)
                    }),
                    o.prefix = r.prefix,
                    o
            },
            setLabel: function () {
                var n = this,
                    t = n.options.labelBuilder;
                if (n.state.multiple) {
                    var e = f.isArray(n.state.currValue) ? n.state.currValue : [n.state.currValue];
                    e = 0 === e.length ? [0] : e;
                    var i = f.map(e, function (t) {
                        return f.grep(n.lookupItems, function (e) {
                            return e.index === t
                        })[0]
                    });
                    i = f.grep(i, function (e) {
                            return i.length > 1 || 0 === i.length ? "" !== f.trim(e.value) : e
                        }),
                        i = f.map(i, function (e) {
                            return f.isFunction(t) ? t(e) : n.utils.format(t, e)
                        }),
                        n.options.multiple.maxLabelEntries && (i.length >= n.options.multiple.maxLabelEntries + 1 ? (i = i.slice(0, n.options.multiple.maxLabelEntries),
                            i.push(f.isFunction(t) ? t({
                                text: "..."
                            }) : n.utils.format(t, {
                                text: "..."
                            }))) : i.slice(i.length - 1)),
                        n.elements.label.html(i.join(n.options.multiple.separator))
                } else {
                    var r = n.lookupItems[n.state.currValue];
                    n.elements.label.html(f.isFunction(t) ? t(r) : n.utils.format(t, r))
                }
            },
            populate: function () {
                var i = this,
                    e = i.$element.children(),
                    t = i.$element.find("option"),
                    n = t.filter(":selected"),
                    r = t.index(n),
                    o = 0,
                    a = i.state.multiple ? [] : 0;
                n.length > 1 && i.state.multiple && (r = [],
                        n.each(function () {
                            r.push(f(this).index())
                        })),
                    i.state.currValue = ~r ? r : a,
                    i.state.selectedIdx = i.state.currValue,
                    i.state.highlightedIdx = i.state.currValue,
                    i.items = [],
                    i.lookupItems = [],
                    e.length && (e.each(function (e) {
                            var t = f(this);
                            if (t.is("optgroup")) {
                                var n = {
                                    element: t,
                                    label: t.prop("label"),
                                    groupDisabled: t.prop("disabled"),
                                    items: []
                                };
                                t.children().each(function (e) {
                                        var t = f(this);
                                        n.items[e] = i.getItemData(o, t, n.groupDisabled || t.prop("disabled")),
                                            i.lookupItems[o] = n.items[e],
                                            o++
                                    }),
                                    i.items[e] = n
                            } else
                                i.items[e] = i.getItemData(o, t, t.prop("disabled")),
                                i.lookupItems[o] = i.items[e],
                                o++
                        }),
                        i.setLabel(),
                        i.elements.items.append(i.elements.itemsScroll.html(i.getItemsMarkup(i.items))))
            },
            getItemData: function (e, t, n) {
                var i = this;
                return {
                    index: e,
                    element: t,
                    value: t.val(),
                    className: t.prop("class"),
                    text: t.html(),
                    slug: f.trim(i.utils.replaceDiacritics(t.html())),
                    alt: t.attr("data-alt"),
                    selected: t.prop("selected"),
                    disabled: n
                }
            },
            getItemsMarkup: function (e) {
                var n = this,
                    i = "<ul>";
                return f.isFunction(n.options.listBuilder) && n.options.listBuilder && (e = n.options.listBuilder(e)),
                    f.each(e, function (e, t) {
                        void 0 !== t.label ? (i += n.utils.format('<ul class="{1}"><li class="{2}">{3}</li>', n.utils.arrayToClassname([n.classes.group, t.groupDisabled ? "disabled" : "", t.element.prop("class")]), n.classes.grouplabel, t.element.prop("label")),
                            f.each(t.items, function (e, t) {
                                i += n.getItemMarkup(t.index, t)
                            }),
                            i += "</ul>") : i += n.getItemMarkup(t.index, t)
                    }),
                    i + "</ul>"
            },
            getItemMarkup: function (e, t) {
                var n = this,
                    i = n.options.optionsItemBuilder,
                    r = {
                        value: t.value,
                        text: t.text,
                        slug: t.slug,
                        index: t.index
                    };
                return n.utils.format('<li data-index="{1}" class="{2}">{3}</li>', e, n.utils.arrayToClassname([t.className, e === n.items.length - 1 ? "last" : "", t.disabled ? "disabled" : "", t.selected ? "selected" : ""]), f.isFunction(i) ? n.utils.format(i(t, this.$element, e), t) : n.utils.format(i, r))
            },
            unbindEvents: function () {
                var e = this;
                e.elements.wrapper.add(e.$element).add(e.elements.outerWrapper).add(e.elements.input).off(".sl")
            },
            bindEvents: function () {
                var o = this;
                o.elements.outerWrapper.on("mouseenter.sl mouseleave.sl", function (e) {
                        f(this).toggleClass(o.classes.hover, "mouseenter" === e.type),
                            o.options.openOnHover && (clearTimeout(o.closeTimer),
                                "mouseleave" === e.type ? o.closeTimer = setTimeout(f.proxy(o.close, o), o.options.hoverIntentTimeout) : o.open())
                    }),
                    o.elements.wrapper.on("click.sl", function (e) {
                        o.state.opened ? o.close() : o.open(e)
                    }),
                    o.options.nativeOnMobile && o.utils.isMobile() || (o.$element.on("focus.sl", function () {
                            o.elements.input.focus()
                        }),
                        o.elements.input.prop({
                            tabindex: o.originalTabindex,
                            disabled: !1
                        }).on("keydown.sl", f.proxy(o.handleKeys, o)).on("focusin.sl", function (e) {
                            o.elements.outerWrapper.addClass(o.classes.focus),
                                o.elements.input.one("blur", function () {
                                    o.elements.input.blur()
                                }),
                                o.options.openOnFocus && !o.state.opened && o.open(e)
                        }).on("focusout.sl", function () {
                            o.elements.outerWrapper.removeClass(o.classes.focus)
                        }).on("input propertychange", function () {
                            var e = o.elements.input.val(),
                                r = new RegExp("^" + o.utils.escapeRegExp(e), "i");
                            clearTimeout(o.resetStr),
                                o.resetStr = setTimeout(function () {
                                    o.elements.input.val("")
                                }, o.options.keySearchTimeout),
                                e.length && f.each(o.items, function (e, t) {
                                    if (!t.disabled) {
                                        if (r.test(t.text) || r.test(t.slug))
                                            return void o.highlight(e);
                                        if (t.alt)
                                            for (var n = t.alt.split("|"), i = 0; i < n.length && n[i]; i++)
                                                if (r.test(n[i].trim()))
                                                    return void o.highlight(e)
                                    }
                                })
                        })),
                    o.$li.on({
                        mousedown: function (e) {
                            e.preventDefault(),
                                e.stopPropagation()
                        },
                        click: function () {
                            return o.select(f(this).data("index")), !1
                        }
                    })
            },
            handleKeys: function (e) {
                var t = this,
                    n = e.which,
                    i = t.options.keys,
                    r = f.inArray(n, i.previous) > -1,
                    o = f.inArray(n, i.next) > -1,
                    a = f.inArray(n, i.select) > -1,
                    s = f.inArray(n, i.open) > -1,
                    l = t.state.highlightedIdx,
                    u = r && 0 === l || o && l + 1 === t.items.length,
                    c = 0;
                if (13 !== n && 32 !== n || e.preventDefault(),
                    r || o) {
                    if (!t.options.allowWrap && u)
                        return;
                    r && (c = t.utils.previousEnabledItem(t.lookupItems, l)),
                        o && (c = t.utils.nextEnabledItem(t.lookupItems, l)),
                        t.highlight(c)
                }
                if (a && t.state.opened)
                    return t.select(l),
                        void(t.state.multiple && t.options.multiple.keepMenuOpen || t.close());
                s && !t.state.opened && t.open()
            },
            refresh: function () {
                var e = this;
                e.populate(),
                    e.activate(),
                    e.utils.triggerCallback("Refresh", e)
            },
            setOptionsDimensions: function () {
                var e = this,
                    t = e.elements.items.closest(":visible").children(":hidden").addClass(e.classes.tempshow),
                    n = e.options.maxHeight,
                    i = e.elements.items.outerWidth(),
                    r = e.elements.wrapper.outerWidth() - (i - e.elements.items.width());
                !e.options.expandToItemText || r > i ? e.finalWidth = r : (e.elements.items.css("overflow", "scroll"),
                        e.elements.outerWrapper.width(9e4),
                        e.finalWidth = e.elements.items.width(),
                        e.elements.items.css("overflow", ""),
                        e.elements.outerWrapper.width("")),
                    e.elements.items.width(e.finalWidth).height() > n && e.elements.items.height(n),
                    t.removeClass(e.classes.tempshow)
            },
            isInViewport: function () {
                var e = this;
                if (!0 === e.options.forceRenderAbove)
                    e.elements.outerWrapper.addClass(e.classes.above);
                else if (!0 === e.options.forceRenderBelow)
                    e.elements.outerWrapper.addClass(e.classes.below);
                else {
                    var t = u.scrollTop(),
                        n = u.height(),
                        i = e.elements.outerWrapper.offset().top,
                        r = e.elements.outerWrapper.outerHeight(),
                        o = i + r + e.itemsHeight <= t + n,
                        a = i - e.itemsHeight > t,
                        s = !o && a,
                        l = !s;
                    e.elements.outerWrapper.toggleClass(e.classes.above, s),
                        e.elements.outerWrapper.toggleClass(e.classes.below, l)
                }
            },
            detectItemVisibility: function (e) {
                var t = this,
                    n = t.$li.filter("[data-index]");
                t.state.multiple && (e = f.isArray(e) && 0 === e.length ? 0 : e,
                    e = f.isArray(e) ? Math.min.apply(Math, e) : e);
                var i = n.eq(e).outerHeight(),
                    r = n[e].offsetTop,
                    o = t.elements.itemsScroll.scrollTop(),
                    a = r + 2 * i;
                t.elements.itemsScroll.scrollTop(a > o + t.itemsHeight ? a - t.itemsHeight : r - i < o ? r - i : o)
            },
            open: function (e) {
                var r = this;
                if (r.options.nativeOnMobile && r.utils.isMobile())
                    return !1;
                r.utils.triggerCallback("BeforeOpen", r),
                    e && (e.preventDefault(),
                        r.options.stopPropagation && e.stopPropagation()),
                    r.state.enabled && (r.setOptionsDimensions(),
                        f("." + r.classes.hideselect, "." + r.classes.open).children().selectric("close"),
                        r.state.opened = !0,
                        r.itemsHeight = r.elements.items.outerHeight(),
                        r.itemsInnerHeight = r.elements.items.height(),
                        r.elements.outerWrapper.addClass(r.classes.open),
                        r.elements.input.val(""),
                        e && "focusin" !== e.type && r.elements.input.focus(),
                        setTimeout(function () {
                            t.on("click.sl", f.proxy(r.close, r)).on("scroll.sl", f.proxy(r.isInViewport, r))
                        }, 1),
                        r.isInViewport(),
                        r.options.preventWindowScroll && t.on("mousewheel.sl DOMMouseScroll.sl", "." + r.classes.scroll, function (e) {
                            var t = e.originalEvent,
                                n = f(this).scrollTop(),
                                i = 0;
                            "detail" in t && (i = -1 * t.detail),
                                "wheelDelta" in t && (i = t.wheelDelta),
                                "wheelDeltaY" in t && (i = t.wheelDeltaY),
                                "deltaY" in t && (i = -1 * t.deltaY),
                                (n === this.scrollHeight - r.itemsInnerHeight && i < 0 || 0 === n && i > 0) && e.preventDefault()
                        }),
                        r.detectItemVisibility(r.state.selectedIdx),
                        r.highlight(r.state.multiple ? -1 : r.state.selectedIdx),
                        r.utils.triggerCallback("Open", r))
            },
            close: function () {
                var e = this;
                e.utils.triggerCallback("BeforeClose", e),
                    t.off(".sl"),
                    e.elements.outerWrapper.removeClass(e.classes.open),
                    e.state.opened = !1,
                    e.utils.triggerCallback("Close", e)
            },
            change: function () {
                var n = this;
                n.utils.triggerCallback("BeforeChange", n),
                    n.state.multiple ? (f.each(n.lookupItems, function (e) {
                            n.lookupItems[e].selected = !1,
                                n.$element.find("option").prop("selected", !1)
                        }),
                        f.each(n.state.selectedIdx, function (e, t) {
                            n.lookupItems[t].selected = !0,
                                n.$element.find("option").eq(t).prop("selected", !0)
                        }),
                        n.state.currValue = n.state.selectedIdx,
                        n.setLabel(),
                        n.utils.triggerCallback("Change", n)) : n.state.currValue !== n.state.selectedIdx && (n.$element.prop("selectedIndex", n.state.currValue = n.state.selectedIdx).data("value", n.lookupItems[n.state.selectedIdx].text),
                        n.setLabel(),
                        n.utils.triggerCallback("Change", n))
            },
            highlight: function (e) {
                var t = this,
                    n = t.$li.filter("[data-index]").removeClass("highlighted");
                t.utils.triggerCallback("BeforeHighlight", t),
                    void 0 === e || -1 === e || t.lookupItems[e].disabled || (n.eq(t.state.highlightedIdx = e).addClass("highlighted"),
                        t.detectItemVisibility(e),
                        t.utils.triggerCallback("Highlight", t))
            },
            select: function (e) {
                var t = this,
                    n = t.$li.filter("[data-index]");
                if (t.utils.triggerCallback("BeforeSelect", t, e),
                    void 0 !== e && -1 !== e && !t.lookupItems[e].disabled) {
                    if (t.state.multiple) {
                        t.state.selectedIdx = f.isArray(t.state.selectedIdx) ? t.state.selectedIdx : [t.state.selectedIdx];
                        var i = f.inArray(e, t.state.selectedIdx); -
                        1 !== i ? t.state.selectedIdx.splice(i, 1) : t.state.selectedIdx.push(e),
                            n.removeClass("selected").filter(function (e) {
                                return -1 !== f.inArray(e, t.state.selectedIdx)
                            }).addClass("selected")
                    } else
                        n.removeClass("selected").eq(t.state.selectedIdx = e).addClass("selected");
                    t.state.multiple && t.options.multiple.keepMenuOpen || t.close(),
                        t.change(),
                        t.utils.triggerCallback("Select", t, e)
                }
            },
            destroy: function (e) {
                var t = this;
                t.state && t.state.enabled && (t.elements.items.add(t.elements.wrapper).add(t.elements.input).remove(),
                    e || t.$element.removeData("selectric").removeData("value"),
                    t.$element.prop("tabindex", t.originalTabindex).off(".sl").off(t.eventTriggers).unwrap().unwrap(),
                    t.state.enabled = !1)
            }
        },
        f.fn.selectric = function (t) {
            return this.each(function () {
                var e = f.data(this, "selectric");
                e && !e.disableOnMobile ? "string" == typeof t && e[t] ? e[t]() : e.init(t) : f.data(this, "selectric", new r(this, t))
            })
        },
        f.fn.selectric.defaults = {
            onChange: function (e) {
                f(e).change()
            },
            maxHeight: 300,
            keySearchTimeout: 500,
            arrowButtonMarkup: '<b class="button">&#x25be;</b>',
            disableOnMobile: !1,
            nativeOnMobile: !0,
            openOnFocus: !0,
            openOnHover: !1,
            hoverIntentTimeout: 500,
            expandToItemText: !1,
            responsive: !1,
            preventWindowScroll: !0,
            inheritOriginalWidth: !1,
            allowWrap: !0,
            forceRenderAbove: !1,
            forceRenderBelow: !1,
            stopPropagation: !0,
            optionsItemBuilder: "{text}",
            labelBuilder: "{text}",
            listBuilder: !1,
            keys: {
                previous: [37, 38],
                next: [39, 40],
                select: [9, 13, 27],
                open: [13, 32, 37, 38, 39, 40],
                close: [9, 27]
            },
            customClass: {
                prefix: "selectric",
                camelCase: !1
            },
            multiple: {
                separator: ", ",
                keepMenuOpen: !0,
                maxLabelEntries: !1
            }
        }
});
shortcut = {
    all_shortcuts: {},
    add: function (u, c, f) {
        var e = {
            type: "keydown",
            propagate: false,
            disable_in_input: false,
            target: document,
            keycode: false
        };
        if (!f)
            f = e;
        else {
            for (var t in e) {
                if (typeof f[t] == "undefined")
                    f[t] = e[t]
            }
        }
        var n = f.target;
        if (typeof f.target == "string")
            n = document.getElementById(f.target);
        var i = this;
        u = u.toLowerCase();
        var r = function (e) {
            e = e || window.event;
            if (f["disable_in_input"]) {
                var t;
                if (e.target)
                    t = e.target;
                else if (e.srcElement)
                    t = e.srcElement;
                if (t.nodeType == 3)
                    t = t.parentNode;
                if (t.tagName == "INPUT" || t.tagName == "TEXTAREA")
                    return
            }
            if (e.keyCode)
                code = e.keyCode;
            else if (e.which)
                code = e.which;
            var n = String.fromCharCode(code).toLowerCase();
            if (code == 188)
                n = ",";
            if (code == 190)
                n = ".";
            var i = u.split("+");
            var r = 0;
            var o = {
                "`": "~",
                1: "!",
                2: "@",
                3: "#",
                4: "$",
                5: "%",
                6: "^",
                7: "&",
                8: "*",
                9: "(",
                0: ")",
                "-": "_",
                "=": "+",
                ";": ":",
                "'": '"',
                ",": "<",
                ".": ">",
                "/": "?",
                "\\": "|"
            };
            var a = {
                esc: 27,
                escape: 27,
                tab: 9,
                space: 32,
                return: 13,
                enter: 13,
                backspace: 8,
                scrolllock: 145,
                scroll_lock: 145,
                scroll: 145,
                capslock: 20,
                caps_lock: 20,
                caps: 20,
                numlock: 144,
                num_lock: 144,
                num: 144,
                pause: 19,
                break: 19,
                insert: 45,
                home: 36,
                delete: 46,
                end: 35,
                pageup: 33,
                page_up: 33,
                pu: 33,
                pagedown: 34,
                page_down: 34,
                pd: 34,
                left: 37,
                up: 38,
                right: 39,
                down: 40,
                f1: 112,
                f2: 113,
                f3: 114,
                f4: 115,
                f5: 116,
                f6: 117,
                f7: 118,
                f8: 119,
                f9: 120,
                f10: 121,
                f11: 122,
                f12: 123
            };
            var s = {
                shift: {
                    wanted: false,
                    pressed: false
                },
                ctrl: {
                    wanted: false,
                    pressed: false
                },
                alt: {
                    wanted: false,
                    pressed: false
                },
                meta: {
                    wanted: false,
                    pressed: false
                }
            };
            if (e.ctrlKey)
                s.ctrl.pressed = true;
            if (e.shiftKey)
                s.shift.pressed = true;
            if (e.altKey)
                s.alt.pressed = true;
            if (e.metaKey)
                s.meta.pressed = true;
            for (var l = 0; k = i[l],
                l < i.length; l++) {
                if (k == "ctrl" || k == "control") {
                    r++;
                    s.ctrl.wanted = true
                } else if (k == "shift") {
                    r++;
                    s.shift.wanted = true
                } else if (k == "alt") {
                    r++;
                    s.alt.wanted = true
                } else if (k == "meta") {
                    r++;
                    s.meta.wanted = true
                } else if (k.length > 1) {
                    if (a[k] == code)
                        r++
                } else if (f["keycode"]) {
                    if (f["keycode"] == code)
                        r++
                } else {
                    if (n == k)
                        r++;
                    else {
                        if (o[n] && e.shiftKey) {
                            n = o[n];
                            if (n == k)
                                r++
                        }
                    }
                }
            }
            if (r == i.length && s.ctrl.pressed == s.ctrl.wanted && s.shift.pressed == s.shift.wanted && s.alt.pressed == s.alt.wanted && s.meta.pressed == s.meta.wanted) {
                c(e);
                if (!f["propagate"]) {
                    e.cancelBubble = true;
                    e.returnValue = false;
                    if (e.stopPropagation) {
                        e.stopPropagation();
                        e.preventDefault()
                    }
                    return false
                }
            }
        };
        this.all_shortcuts[u] = {
            callback: r,
            target: n,
            event: f["type"]
        };
        if (n.addEventListener)
            n.addEventListener(f["type"], r, false);
        else if (n.attachEvent)
            n.attachEvent("on" + f["type"], r);
        else
            n["on" + f["type"]] = r
    },
    remove: function (e) {
        e = e.toLowerCase();
        var t = this.all_shortcuts[e];
        delete this.all_shortcuts[e];
        if (!t)
            return;
        var n = t["event"];
        var i = t["target"];
        var r = t["callback"];
        if (i.detachEvent)
            i.detachEvent("on" + n, r);
        else if (i.removeEventListener)
            i.removeEventListener(n, r, false);
        else
            i["on" + n] = false
    }
};
(function (e) {
    "use strict";
    if (typeof define === "function" && define.amd) {
        define(["jquery"], e)
    } else if (typeof exports === "object") {
        e(require("jquery"))
    } else {
        e(jQuery)
    }
})(function (T, w) {
    "use strict";
    if (T.jstree) {
        return
    }
    var r = 0,
        o = false,
        a = false,
        s = false,
        i = [],
        e = T("script:last").attr("src"),
        m = window.document,
        b = m.createElement("LI"),
        t, n;
    b.setAttribute("role", "treeitem");
    t = m.createElement("I");
    t.className = "jstree-icon jstree-ocl";
    t.setAttribute("role", "presentation");
    b.appendChild(t);
    t = m.createElement("A");
    t.className = "jstree-anchor";
    t.setAttribute("href", "#");
    t.setAttribute("tabindex", "-1");
    n = m.createElement("I");
    n.className = "jstree-icon jstree-themeicon";
    n.setAttribute("role", "presentation");
    t.appendChild(n);
    b.appendChild(t);
    t = n = null;
    T.jstree = {
        version: "3.1.1",
        defaults: {
            plugins: []
        },
        plugins: {},
        path: e && e.indexOf("/") !== -1 ? e.replace(/\/[^\/]+$/, "") : "",
        idregex: /[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g
    };
    T.jstree.create = function (e, n) {
        var i = new T.jstree.core(++r),
            t = n;
        n = T.extend(true, {}, T.jstree.defaults, n);
        if (t && t.plugins) {
            n.plugins = t.plugins
        }
        T.each(n.plugins, function (e, t) {
            if (e !== "core") {
                i = i.plugin(t, n[t])
            }
        });
        T(e).data("jstree", i);
        i.init(e, n);
        return i
    };
    T.jstree.destroy = function () {
        T(".jstree:jstree").jstree("destroy");
        T(m).off(".jstree")
    };
    T.jstree.core = function (e) {
        this._id = e;
        this._cnt = 0;
        this._wrk = null;
        this._data = {
            core: {
                themes: {
                    name: false,
                    dots: false,
                    icons: false
                },
                selected: [],
                last_error: {},
                working: false,
                worker_queue: [],
                focused: null
            }
        }
    };
    T.jstree.reference = function (t) {
        var n = null,
            e = null;
        if (t && t.id && (!t.tagName || !t.nodeType)) {
            t = t.id
        }
        if (!e || !e.length) {
            try {
                e = T(t)
            } catch (e) {}
        }
        if (!e || !e.length) {
            try {
                e = T("#" + t.replace(T.jstree.idregex, "\\$&"))
            } catch (e) {}
        }
        if (e && e.length && (e = e.closest(".jstree")).length && (e = e.data("jstree"))) {
            n = e
        } else {
            T(".jstree").each(function () {
                var e = T(this).data("jstree");
                if (e && e._model.data[t]) {
                    n = e;
                    return false
                }
            })
        }
        return n
    };
    T.fn.jstree = function (n) {
        var i = typeof n === "string",
            r = Array.prototype.slice.call(arguments, 1),
            o = null;
        if (n === true && !this.length) {
            return false
        }
        this.each(function () {
            var e = T.jstree.reference(this),
                t = i && e ? e[n] : null;
            o = i && t ? t.apply(e, r) : null;
            if (!e && !i && (n === w || T.isPlainObject(n))) {
                T.jstree.create(this, n)
            }
            if (e && !i || n === true) {
                o = e || false
            }
            if (o !== null && o !== w) {
                return false
            }
        });
        return o !== null && o !== w ? o : this
    };
    T.expr[":"].jstree = T.expr.createPseudo(function (e) {
        return function (e) {
            return T(e).hasClass("jstree") && T(e).data("jstree") !== w
        }
    });
    T.jstree.defaults.core = {
        data: false,
        strings: false,
        check_callback: false,
        error: T.noop,
        animation: 200,
        multiple: true,
        themes: {
            name: false,
            url: false,
            dir: false,
            dots: true,
            icons: true,
            stripes: false,
            variant: false,
            responsive: false
        },
        expand_selected_onload: true,
        worker: true,
        force_text: false,
        dblclick_toggle: true
    };
    T.jstree.core.prototype = {
        plugin: function (e, t) {
            var n = T.jstree.plugins[e];
            if (n) {
                this._data[e] = {};
                n.prototype = this;
                return new n(t, this)
            }
            return this
        },
        init: function (e, t) {
            this._model = {
                data: {
                    "#": {
                        id: "#",
                        parent: null,
                        parents: [],
                        children: [],
                        children_d: [],
                        state: {
                            loaded: false
                        }
                    }
                },
                changed: [],
                force_full_redraw: false,
                redraw_timeout: false,
                default_state: {
                    loaded: true,
                    opened: false,
                    selected: false,
                    disabled: false
                }
            };
            this.element = T(e).addClass("jstree jstree-" + this._id);
            this.settings = t;
            this._data.core.ready = false;
            this._data.core.loaded = false;
            this._data.core.rtl = this.element.css("direction") === "rtl";
            this.element[this._data.core.rtl ? "addClass" : "removeClass"]("jstree-rtl");
            this.element.attr("role", "tree");
            if (this.settings.core.multiple) {
                this.element.attr("aria-multiselectable", true)
            }
            if (!this.element.attr("tabindex")) {
                this.element.attr("tabindex", "0")
            }
            this.bind();
            this.trigger("init");
            this._data.core.original_container_html = this.element.find(" > ul > li").clone(true);
            this._data.core.original_container_html.find("li").addBack().contents().filter(function () {
                return this.nodeType === 3 && (!this.nodeValue || /^\s+$/.test(this.nodeValue))
            }).remove();
            this.element.html("<" + "ul class='jstree-container-ul jstree-children' role='group'><" + "li id='j" + this._id + "_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><" + "a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>" + this.get_string("Loading ...") + "</a></li></ul>");
            this.element.attr("aria-activedescendant", "j" + this._id + "_loading");
            this._data.core.li_height = this.get_container_ul().children("li").first().height() || 24;
            this.trigger("loading");
            this.load_node("#")
        },
        destroy: function (e) {
            if (this._wrk) {
                try {
                    window.URL.revokeObjectURL(this._wrk);
                    this._wrk = null
                } catch (e) {}
            }
            if (!e) {
                this.element.empty()
            }
            this.teardown()
        },
        teardown: function () {
            this.unbind();
            this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class", function () {
                return this.className.replace(/jstree[^ ]*|$/gi, "")
            });
            this.element = null
        },
        bind: function () {
            var o = "",
                a = null,
                t = 0;
            this.element.on("dblclick.jstree", function () {
                if (m.selection && m.selection.empty) {
                    m.selection.empty()
                } else {
                    if (window.getSelection) {
                        var e = window.getSelection();
                        try {
                            e.removeAllRanges();
                            e.collapse()
                        } catch (e) {}
                    }
                }
            }).on("mousedown.jstree", T.proxy(function (e) {
                if (e.target === this.element[0]) {
                    e.preventDefault();
                    t = +new Date
                }
            }, this)).on("mousedown.jstree", ".jstree-ocl", function (e) {
                e.preventDefault()
            }).on("click.jstree", ".jstree-ocl", T.proxy(function (e) {
                this.toggle_node(e.target)
            }, this)).on("dblclick.jstree", ".jstree-anchor", T.proxy(function (e) {
                if (this.settings.core.dblclick_toggle) {
                    this.toggle_node(e.target)
                }
            }, this)).on("click.jstree", ".jstree-anchor", T.proxy(function (e) {
                e.preventDefault();
                if (e.currentTarget !== m.activeElement) {
                    T(e.currentTarget).focus()
                }
                this.activate_node(e.currentTarget, e)
            }, this)).on("keydown.jstree", ".jstree-anchor", T.proxy(function (e) {
                if (e.target.tagName === "INPUT") {
                    return true
                }
                if (e.which !== 32 && e.which !== 13 && (e.shiftKey || e.ctrlKey || e.altKey || e.metaKey)) {
                    return true
                }
                var t = null;
                if (this._data.core.rtl) {
                    if (e.which === 37) {
                        e.which = 39
                    } else if (e.which === 39) {
                        e.which = 37
                    }
                }
                switch (e.which) {
                    case 32:
                        if (e.ctrlKey) {
                            e.type = "click";
                            T(e.currentTarget).trigger(e)
                        }
                        break;
                    case 13:
                        e.type = "click";
                        T(e.currentTarget).trigger(e);
                        break;
                    case 37:
                        e.preventDefault();
                        if (this.is_open(e.currentTarget)) {
                            this.close_node(e.currentTarget)
                        } else {
                            t = this.get_parent(e.currentTarget);
                            if (t && t.id !== "#") {
                                this.get_node(t, true).children(".jstree-anchor").focus()
                            }
                        }
                        break;
                    case 38:
                        e.preventDefault();
                        t = this.get_prev_dom(e.currentTarget);
                        if (t && t.length) {
                            t.children(".jstree-anchor").focus()
                        }
                        break;
                    case 39:
                        e.preventDefault();
                        if (this.is_closed(e.currentTarget)) {
                            this.open_node(e.currentTarget, function (e) {
                                this.get_node(e, true).children(".jstree-anchor").focus()
                            })
                        } else if (this.is_open(e.currentTarget)) {
                            t = this.get_node(e.currentTarget, true).children(".jstree-children")[0];
                            if (t) {
                                T(this._firstChild(t)).children(".jstree-anchor").focus()
                            }
                        }
                        break;
                    case 40:
                        e.preventDefault();
                        t = this.get_next_dom(e.currentTarget);
                        if (t && t.length) {
                            t.children(".jstree-anchor").focus()
                        }
                        break;
                    case 106:
                        this.open_all();
                        break;
                    case 36:
                        e.preventDefault();
                        t = this._firstChild(this.get_container_ul()[0]);
                        if (t) {
                            T(t).children(".jstree-anchor").filter(":visible").focus()
                        }
                        break;
                    case 35:
                        e.preventDefault();
                        this.element.find(".jstree-anchor").filter(":visible").last().focus();
                        break
                }
            }, this)).on("load_node.jstree", T.proxy(function (e, t) {
                if (t.status) {
                    if (t.node.id === "#" && !this._data.core.loaded) {
                        this._data.core.loaded = true;
                        if (this._firstChild(this.get_container_ul()[0])) {
                            this.element.attr("aria-activedescendant", this._firstChild(this.get_container_ul()[0]).id)
                        }
                        this.trigger("loaded")
                    }
                    if (!this._data.core.ready) {
                        setTimeout(T.proxy(function () {
                            if (this.element && !this.get_container_ul().find(".jstree-loading").length) {
                                this._data.core.ready = true;
                                if (this._data.core.selected.length) {
                                    if (this.settings.core.expand_selected_onload) {
                                        var e = [],
                                            t, n;
                                        for (t = 0,
                                            n = this._data.core.selected.length; t < n; t++) {
                                            e = e.concat(this._model.data[this._data.core.selected[t]].parents)
                                        }
                                        e = T.vakata.array_unique(e);
                                        for (t = 0,
                                            n = e.length; t < n; t++) {
                                            this.open_node(e[t], false, 0)
                                        }
                                    }
                                    this.trigger("changed", {
                                        action: "ready",
                                        selected: this._data.core.selected
                                    })
                                }
                                this.trigger("ready")
                            }
                        }, this), 0)
                    }
                }
            }, this)).on("keypress.jstree", T.proxy(function (e) {
                if (e.target.tagName === "INPUT") {
                    return true
                }
                if (a) {
                    clearTimeout(a)
                }
                a = setTimeout(function () {
                    o = ""
                }, 500);
                var n = String.fromCharCode(e.which).toLowerCase(),
                    t = this.element.find(".jstree-anchor").filter(":visible"),
                    i = t.index(m.activeElement) || 0,
                    r = false;
                o += n;
                if (o.length > 1) {
                    t.slice(i).each(T.proxy(function (e, t) {
                        if (T(t).text().toLowerCase().indexOf(o) === 0) {
                            T(t).focus();
                            r = true;
                            return false
                        }
                    }, this));
                    if (r) {
                        return
                    }
                    t.slice(0, i).each(T.proxy(function (e, t) {
                        if (T(t).text().toLowerCase().indexOf(o) === 0) {
                            T(t).focus();
                            r = true;
                            return false
                        }
                    }, this));
                    if (r) {
                        return
                    }
                }
                if (new RegExp("^" + n + "+$").test(o)) {
                    t.slice(i + 1).each(T.proxy(function (e, t) {
                        if (T(t).text().toLowerCase().charAt(0) === n) {
                            T(t).focus();
                            r = true;
                            return false
                        }
                    }, this));
                    if (r) {
                        return
                    }
                    t.slice(0, i + 1).each(T.proxy(function (e, t) {
                        if (T(t).text().toLowerCase().charAt(0) === n) {
                            T(t).focus();
                            r = true;
                            return false
                        }
                    }, this));
                    if (r) {
                        return
                    }
                }
            }, this)).on("init.jstree", T.proxy(function () {
                var e = this.settings.core.themes;
                this._data.core.themes.dots = e.dots;
                this._data.core.themes.stripes = e.stripes;
                this._data.core.themes.icons = e.icons;
                this.set_theme(e.name || "default", e.url);
                this.set_theme_variant(e.variant)
            }, this)).on("loading.jstree", T.proxy(function () {
                this[this._data.core.themes.dots ? "show_dots" : "hide_dots"]();
                this[this._data.core.themes.icons ? "show_icons" : "hide_icons"]();
                this[this._data.core.themes.stripes ? "show_stripes" : "hide_stripes"]()
            }, this)).on("blur.jstree", ".jstree-anchor", T.proxy(function (e) {
                this._data.core.focused = null;
                T(e.currentTarget).filter(".jstree-hovered").mouseleave();
                this.element.attr("tabindex", "0")
            }, this)).on("focus.jstree", ".jstree-anchor", T.proxy(function (e) {
                var t = this.get_node(e.currentTarget);
                if (t && t.id) {
                    this._data.core.focused = t.id
                }
                this.element.find(".jstree-hovered").not(e.currentTarget).mouseleave();
                T(e.currentTarget).mouseenter();
                this.element.attr("tabindex", "-1")
            }, this)).on("focus.jstree", T.proxy(function () {
                if (+new Date - t > 500 && !this._data.core.focused) {
                    t = 0;
                    var e = this.get_node(this.element.attr("aria-activedescendant"), true);
                    if (e) {
                        e.find("> .jstree-anchor").focus()
                    }
                }
            }, this)).on("mouseenter.jstree", ".jstree-anchor", T.proxy(function (e) {
                this.hover_node(e.currentTarget)
            }, this)).on("mouseleave.jstree", ".jstree-anchor", T.proxy(function (e) {
                this.dehover_node(e.currentTarget)
            }, this))
        },
        unbind: function () {
            this.element.off(".jstree");
            T(m).off(".jstree-" + this._id)
        },
        trigger: function (e, t) {
            if (!t) {
                t = {}
            }
            t.instance = this;
            this.element.triggerHandler(e.replace(".jstree", "") + ".jstree", t)
        },
        get_container: function () {
            return this.element
        },
        get_container_ul: function () {
            return this.element.children(".jstree-children").first()
        },
        get_string: function (e) {
            var t = this.settings.core.strings;
            if (T.isFunction(t)) {
                return t.call(this, e)
            }
            if (t && t[e]) {
                return t[e]
            }
            return e
        },
        _firstChild: function (e) {
            e = e ? e.firstChild : null;
            while (e !== null && e.nodeType !== 1) {
                e = e.nextSibling
            }
            return e
        },
        _nextSibling: function (e) {
            e = e ? e.nextSibling : null;
            while (e !== null && e.nodeType !== 1) {
                e = e.nextSibling
            }
            return e
        },
        _previousSibling: function (e) {
            e = e ? e.previousSibling : null;
            while (e !== null && e.nodeType !== 1) {
                e = e.previousSibling
            }
            return e
        },
        get_node: function (e, t) {
            if (e && e.id) {
                e = e.id
            }
            var n;
            try {
                if (this._model.data[e]) {
                    e = this._model.data[e]
                } else if (typeof e === "string" && this._model.data[e.replace(/^#/, "")]) {
                    e = this._model.data[e.replace(/^#/, "")]
                } else if (typeof e === "string" && (n = T("#" + e.replace(T.jstree.idregex, "\\$&"), this.element)).length && this._model.data[n.closest(".jstree-node").attr("id")]) {
                    e = this._model.data[n.closest(".jstree-node").attr("id")]
                } else if ((n = T(e, this.element)).length && this._model.data[n.closest(".jstree-node").attr("id")]) {
                    e = this._model.data[n.closest(".jstree-node").attr("id")]
                } else if ((n = T(e, this.element)).length && n.hasClass("jstree")) {
                    e = this._model.data["#"]
                } else {
                    return false
                }
                if (t) {
                    e = e.id === "#" ? this.element : T("#" + e.id.replace(T.jstree.idregex, "\\$&"), this.element)
                }
                return e
            } catch (e) {
                return false
            }
        },
        get_path: function (e, t, n) {
            e = e.parents ? e : this.get_node(e);
            if (!e || e.id === "#" || !e.parents) {
                return false
            }
            var i, r, o = [];
            o.push(n ? e.id : e.text);
            for (i = 0,
                r = e.parents.length; i < r; i++) {
                o.push(n ? e.parents[i] : this.get_text(e.parents[i]))
            }
            o = o.reverse().slice(1);
            return t ? o.join(t) : o
        },
        get_next_dom: function (e, t) {
            var n;
            e = this.get_node(e, true);
            if (e[0] === this.element[0]) {
                n = this._firstChild(this.get_container_ul()[0]);
                while (n && n.offsetHeight === 0) {
                    n = this._nextSibling(n)
                }
                return n ? T(n) : false
            }
            if (!e || !e.length) {
                return false
            }
            if (t) {
                n = e[0];
                do {
                    n = this._nextSibling(n)
                } while (n && n.offsetHeight === 0);
                return n ? T(n) : false
            }
            if (e.hasClass("jstree-open")) {
                n = this._firstChild(e.children(".jstree-children")[0]);
                while (n && n.offsetHeight === 0) {
                    n = this._nextSibling(n)
                }
                if (n !== null) {
                    return T(n)
                }
            }
            n = e[0];
            do {
                n = this._nextSibling(n)
            } while (n && n.offsetHeight === 0);
            if (n !== null) {
                return T(n)
            }
            return e.parentsUntil(".jstree", ".jstree-node").nextAll(".jstree-node:visible").first()
        },
        get_prev_dom: function (e, t) {
            var n;
            e = this.get_node(e, true);
            if (e[0] === this.element[0]) {
                n = this.get_container_ul()[0].lastChild;
                while (n && n.offsetHeight === 0) {
                    n = this._previousSibling(n)
                }
                return n ? T(n) : false
            }
            if (!e || !e.length) {
                return false
            }
            if (t) {
                n = e[0];
                do {
                    n = this._previousSibling(n)
                } while (n && n.offsetHeight === 0);
                return n ? T(n) : false
            }
            n = e[0];
            do {
                n = this._previousSibling(n)
            } while (n && n.offsetHeight === 0);
            if (n !== null) {
                e = T(n);
                while (e.hasClass("jstree-open")) {
                    e = e.children(".jstree-children").first().children(".jstree-node:visible:last")
                }
                return e
            }
            n = e[0].parentNode.parentNode;
            return n && n.className && n.className.indexOf("jstree-node") !== -1 ? T(n) : false
        },
        get_parent: function (e) {
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            return e.parent
        },
        get_children_dom: function (e) {
            e = this.get_node(e, true);
            if (e[0] === this.element[0]) {
                return this.get_container_ul().children(".jstree-node")
            }
            if (!e || !e.length) {
                return false
            }
            return e.children(".jstree-children").children(".jstree-node")
        },
        is_parent: function (e) {
            e = this.get_node(e);
            return e && (e.state.loaded === false || e.children.length > 0)
        },
        is_loaded: function (e) {
            e = this.get_node(e);
            return e && e.state.loaded
        },
        is_loading: function (e) {
            e = this.get_node(e);
            return e && e.state && e.state.loading
        },
        is_open: function (e) {
            e = this.get_node(e);
            return e && e.state.opened
        },
        is_closed: function (e) {
            e = this.get_node(e);
            return e && this.is_parent(e) && !e.state.opened
        },
        is_leaf: function (e) {
            return !this.is_parent(e)
        },
        load_node: function (n, i) {
            var e, t, r, o, a;
            if (T.isArray(n)) {
                this._load_nodes(n.slice(), i);
                return true
            }
            n = this.get_node(n);
            if (!n) {
                if (i) {
                    i.call(this, n, false)
                }
                return false
            }
            if (n.state.loaded) {
                n.state.loaded = false;
                for (e = 0,
                    t = n.children_d.length; e < t; e++) {
                    for (r = 0,
                        o = n.parents.length; r < o; r++) {
                        this._model.data[n.parents[r]].children_d = T.vakata.array_remove_item(this._model.data[n.parents[r]].children_d, n.children_d[e])
                    }
                    if (this._model.data[n.children_d[e]].state.selected) {
                        a = true;
                        this._data.core.selected = T.vakata.array_remove_item(this._data.core.selected, n.children_d[e])
                    }
                    delete this._model.data[n.children_d[e]]
                }
                n.children = [];
                n.children_d = [];
                if (a) {
                    this.trigger("changed", {
                        action: "load_node",
                        node: n,
                        selected: this._data.core.selected
                    })
                }
            }
            n.state.failed = false;
            n.state.loading = true;
            this.get_node(n, true).addClass("jstree-loading").attr("aria-busy", true);
            this._load_node(n, T.proxy(function (e) {
                n = this._model.data[n.id];
                n.state.loading = false;
                n.state.loaded = e;
                n.state.failed = !n.state.loaded;
                var t = this.get_node(n, true);
                if (n.state.loaded && !n.children.length && t && t.length && !t.hasClass("jstree-leaf")) {
                    t.removeClass("jstree-closed jstree-open").addClass("jstree-leaf")
                }
                t.removeClass("jstree-loading").attr("aria-busy", false);
                this.trigger("load_node", {
                    node: n,
                    status: e
                });
                if (i) {
                    i.call(this, n, e)
                }
            }, this));
            return true
        },
        _load_nodes: function (e, t, n) {
            var i = true,
                r = function () {
                    this._load_nodes(e, t, true)
                },
                o = this._model.data,
                a, s, l = [];
            for (a = 0,
                s = e.length; a < s; a++) {
                if (o[e[a]] && (!o[e[a]].state.loaded && !o[e[a]].state.failed || !n)) {
                    if (!this.is_loading(e[a])) {
                        this.load_node(e[a], r)
                    }
                    i = false
                }
            }
            if (i) {
                for (a = 0,
                    s = e.length; a < s; a++) {
                    if (o[e[a]] && o[e[a]].state.loaded) {
                        l.push(e[a])
                    }
                }
                if (t && !t.done) {
                    t.call(this, l);
                    t.done = true
                }
            }
        },
        load_all: function (e, t) {
            if (!e) {
                e = "#"
            }
            e = this.get_node(e);
            if (!e) {
                return false
            }
            var n = [],
                i = this._model.data,
                r = i[e.id].children_d,
                o, a;
            if (e.state && !e.state.loaded) {
                n.push(e.id)
            }
            for (o = 0,
                a = r.length; o < a; o++) {
                if (i[r[o]] && i[r[o]].state && !i[r[o]].state.loaded) {
                    n.push(r[o])
                }
            }
            if (n.length) {
                this._load_nodes(n, function () {
                    this.load_all(e, t)
                })
            } else {
                if (t) {
                    t.call(this, e)
                }
                this.trigger("load_all", {
                    node: e
                })
            }
        },
        _load_node: function (r, o) {
            var e = this.settings.core.data,
                t;
            if (!e) {
                if (r.id === "#") {
                    return this._append_html_data(r, this._data.core.original_container_html.clone(true), function (e) {
                        o.call(this, e)
                    })
                } else {
                    return o.call(this, false)
                }
            }
            if (T.isFunction(e)) {
                return e.call(this, r, T.proxy(function (e) {
                    if (e === false) {
                        o.call(this, false)
                    }
                    this[typeof e === "string" ? "_append_html_data" : "_append_json_data"](r, typeof e === "string" ? T(T.parseHTML(e)).filter(function () {
                        return this.nodeType !== 3
                    }) : e, function (e) {
                        o.call(this, e)
                    })
                }, this))
            }
            if (typeof e === "object") {
                if (e.url) {
                    e = T.extend(true, {}, e);
                    if (T.isFunction(e.url)) {
                        e.url = e.url.call(this, r)
                    }
                    if (T.isFunction(e.data)) {
                        e.data = e.data.call(this, r)
                    }
                    return T.ajax(e).done(T.proxy(function (e, t, n) {
                        var i = n.getResponseHeader("Content-Type");
                        if (i && i.indexOf("json") !== -1 || typeof e === "object") {
                            return this._append_json_data(r, e, function (e) {
                                o.call(this, e)
                            })
                        }
                        if (i && i.indexOf("html") !== -1 || typeof e === "string") {
                            return this._append_html_data(r, T(T.parseHTML(e)).filter(function () {
                                return this.nodeType !== 3
                            }), function (e) {
                                o.call(this, e)
                            })
                        }
                        this._data.core.last_error = {
                            error: "ajax",
                            plugin: "core",
                            id: "core_04",
                            reason: "Could not load node",
                            data: JSON.stringify({
                                id: r.id,
                                xhr: n
                            })
                        };
                        this.settings.core.error.call(this, this._data.core.last_error);
                        return o.call(this, false)
                    }, this)).fail(T.proxy(function (e) {
                        o.call(this, false);
                        this._data.core.last_error = {
                            error: "ajax",
                            plugin: "core",
                            id: "core_04",
                            reason: "Could not load node",
                            data: JSON.stringify({
                                id: r.id,
                                xhr: e
                            })
                        };
                        this.settings.core.error.call(this, this._data.core.last_error)
                    }, this))
                }
                t = T.isArray(e) || T.isPlainObject(e) ? JSON.parse(JSON.stringify(e)) : e;
                if (r.id === "#") {
                    return this._append_json_data(r, t, function (e) {
                        o.call(this, e)
                    })
                } else {
                    this._data.core.last_error = {
                        error: "nodata",
                        plugin: "core",
                        id: "core_05",
                        reason: "Could not load node",
                        data: JSON.stringify({
                            id: r.id
                        })
                    };
                    this.settings.core.error.call(this, this._data.core.last_error);
                    return o.call(this, false)
                }
            }
            if (typeof e === "string") {
                if (r.id === "#") {
                    return this._append_html_data(r, T(T.parseHTML(e)).filter(function () {
                        return this.nodeType !== 3
                    }), function (e) {
                        o.call(this, e)
                    })
                } else {
                    this._data.core.last_error = {
                        error: "nodata",
                        plugin: "core",
                        id: "core_06",
                        reason: "Could not load node",
                        data: JSON.stringify({
                            id: r.id
                        })
                    };
                    this.settings.core.error.call(this, this._data.core.last_error);
                    return o.call(this, false)
                }
            }
            return o.call(this, false)
        },
        _node_changed: function (e) {
            e = this.get_node(e);
            if (e) {
                this._model.changed.push(e.id)
            }
        },
        _append_html_data: function (e, t, n) {
            e = this.get_node(e);
            e.children = [];
            e.children_d = [];
            var i = t.is("ul") ? t.children() : t,
                r = e.id,
                o = [],
                a = [],
                s = this._model.data,
                l = s[r],
                u = this._data.core.selected.length,
                c, f, h;
            i.each(T.proxy(function (e, t) {
                c = this._parse_model_from_html(T(t), r, l.parents.concat());
                if (c) {
                    o.push(c);
                    a.push(c);
                    if (s[c].children_d.length) {
                        a = a.concat(s[c].children_d)
                    }
                }
            }, this));
            l.children = o;
            l.children_d = a;
            for (f = 0,
                h = l.parents.length; f < h; f++) {
                s[l.parents[f]].children_d = s[l.parents[f]].children_d.concat(a)
            }
            this.trigger("model", {
                nodes: a,
                parent: r
            });
            if (r !== "#") {
                this._node_changed(r);
                this.redraw()
            } else {
                this.get_container_ul().children(".jstree-initial-node").remove();
                this.redraw(true)
            }
            if (this._data.core.selected.length !== u) {
                this.trigger("changed", {
                    action: "model",
                    selected: this._data.core.selected
                })
            }
            n.call(this, true)
        },
        _append_json_data: function (e, t, l, n) {
            if (this.element === null) {
                return
            }
            e = this.get_node(e);
            e.children = [];
            e.children_d = [];
            if (t.d) {
                t = t.d;
                if (typeof t === "string") {
                    t = JSON.parse(t)
                }
            }
            if (!T.isArray(t)) {
                t = [t]
            }
            var i = null,
                r = {
                    df: this._model.default_state,
                    dat: t,
                    par: e.id,
                    m: this._model.data,
                    t_id: this._id,
                    t_cnt: this._cnt,
                    sel: this._data.core.selected
                },
                o = function (e, u) {
                    if (e.data) {
                        e = e.data
                    }
                    var t = e.dat,
                        n = e.par,
                        i = [],
                        r = [],
                        c = [],
                        f = e.df,
                        h = e.t_id,
                        d = e.t_cnt,
                        p = e.m,
                        o = p[n],
                        a = e.sel,
                        s, l, v, g, _ = function (e, t, n) {
                            if (!n) {
                                n = []
                            } else {
                                n = n.concat()
                            }
                            if (t) {
                                n.unshift(t)
                            }
                            var i = e.id.toString(),
                                r, o, a, s, l = {
                                    id: i,
                                    text: e.text || "",
                                    icon: e.icon !== u ? e.icon : true,
                                    parent: t,
                                    parents: n,
                                    children: e.children || [],
                                    children_d: e.children_d || [],
                                    data: e.data,
                                    state: {},
                                    li_attr: {
                                        id: false
                                    },
                                    a_attr: {
                                        href: "#"
                                    },
                                    original: false
                                };
                            for (r in f) {
                                if (f.hasOwnProperty(r)) {
                                    l.state[r] = f[r]
                                }
                            }
                            if (e && e.data && e.data.jstree && e.data.jstree.icon) {
                                l.icon = e.data.jstree.icon
                            }
                            if (l.icon === u || l.icon === null || l.icon === "") {
                                l.icon = true
                            }
                            if (e && e.data) {
                                l.data = e.data;
                                if (e.data.jstree) {
                                    for (r in e.data.jstree) {
                                        if (e.data.jstree.hasOwnProperty(r)) {
                                            l.state[r] = e.data.jstree[r]
                                        }
                                    }
                                }
                            }
                            if (e && typeof e.state === "object") {
                                for (r in e.state) {
                                    if (e.state.hasOwnProperty(r)) {
                                        l.state[r] = e.state[r]
                                    }
                                }
                            }
                            if (e && typeof e.li_attr === "object") {
                                for (r in e.li_attr) {
                                    if (e.li_attr.hasOwnProperty(r)) {
                                        l.li_attr[r] = e.li_attr[r]
                                    }
                                }
                            }
                            if (!l.li_attr.id) {
                                l.li_attr.id = i
                            }
                            if (e && typeof e.a_attr === "object") {
                                for (r in e.a_attr) {
                                    if (e.a_attr.hasOwnProperty(r)) {
                                        l.a_attr[r] = e.a_attr[r]
                                    }
                                }
                            }
                            if (e && e.children && e.children === true) {
                                l.state.loaded = false;
                                l.children = [];
                                l.children_d = []
                            }
                            p[l.id] = l;
                            for (r = 0,
                                o = l.children.length; r < o; r++) {
                                a = _(p[l.children[r]], l.id, n);
                                s = p[a];
                                l.children_d.push(a);
                                if (s.children_d.length) {
                                    l.children_d = l.children_d.concat(s.children_d)
                                }
                            }
                            delete e.data;
                            delete e.children;
                            p[l.id].original = e;
                            if (l.state.selected) {
                                c.push(l.id)
                            }
                            return l.id
                        },
                        y = function (e, t, n) {
                            if (!n) {
                                n = []
                            } else {
                                n = n.concat()
                            }
                            if (t) {
                                n.unshift(t)
                            }
                            var i = false,
                                r, o, a, s, l;
                            do {
                                i = "j" + h + "_" + ++d
                            } while (p[i]);
                            l = {
                                id: false,
                                text: typeof e === "string" ? e : "",
                                icon: typeof e === "object" && e.icon !== u ? e.icon : true,
                                parent: t,
                                parents: n,
                                children: [],
                                children_d: [],
                                data: null,
                                state: {},
                                li_attr: {
                                    id: false
                                },
                                a_attr: {
                                    href: "#"
                                },
                                original: false
                            };
                            for (r in f) {
                                if (f.hasOwnProperty(r)) {
                                    l.state[r] = f[r]
                                }
                            }
                            if (e && e.id) {
                                l.id = e.id.toString()
                            }
                            if (e && e.text) {
                                l.text = e.text
                            }
                            if (e && e.data && e.data.jstree && e.data.jstree.icon) {
                                l.icon = e.data.jstree.icon
                            }
                            if (l.icon === u || l.icon === null || l.icon === "") {
                                l.icon = true
                            }
                            if (e && e.data) {
                                l.data = e.data;
                                if (e.data.jstree) {
                                    for (r in e.data.jstree) {
                                        if (e.data.jstree.hasOwnProperty(r)) {
                                            l.state[r] = e.data.jstree[r]
                                        }
                                    }
                                }
                            }
                            if (e && typeof e.state === "object") {
                                for (r in e.state) {
                                    if (e.state.hasOwnProperty(r)) {
                                        l.state[r] = e.state[r]
                                    }
                                }
                            }
                            if (e && typeof e.li_attr === "object") {
                                for (r in e.li_attr) {
                                    if (e.li_attr.hasOwnProperty(r)) {
                                        l.li_attr[r] = e.li_attr[r]
                                    }
                                }
                            }
                            if (l.li_attr.id && !l.id) {
                                l.id = l.li_attr.id.toString()
                            }
                            if (!l.id) {
                                l.id = i
                            }
                            if (!l.li_attr.id) {
                                l.li_attr.id = l.id
                            }
                            if (e && typeof e.a_attr === "object") {
                                for (r in e.a_attr) {
                                    if (e.a_attr.hasOwnProperty(r)) {
                                        l.a_attr[r] = e.a_attr[r]
                                    }
                                }
                            }
                            if (e && e.children && e.children.length) {
                                for (r = 0,
                                    o = e.children.length; r < o; r++) {
                                    a = y(e.children[r], l.id, n);
                                    s = p[a];
                                    l.children.push(a);
                                    if (s.children_d.length) {
                                        l.children_d = l.children_d.concat(s.children_d)
                                    }
                                }
                                l.children_d = l.children_d.concat(l.children)
                            }
                            if (e && e.children && e.children === true) {
                                l.state.loaded = false;
                                l.children = [];
                                l.children_d = []
                            }
                            delete e.data;
                            delete e.children;
                            l.original = e;
                            p[l.id] = l;
                            if (l.state.selected) {
                                c.push(l.id)
                            }
                            return l.id
                        };
                    if (t.length && t[0].id !== u && t[0].parent !== u) {
                        for (l = 0,
                            v = t.length; l < v; l++) {
                            if (!t[l].children) {
                                t[l].children = []
                            }
                            p[t[l].id.toString()] = t[l]
                        }
                        for (l = 0,
                            v = t.length; l < v; l++) {
                            p[t[l].parent.toString()].children.push(t[l].id.toString());
                            o.children_d.push(t[l].id.toString())
                        }
                        for (l = 0,
                            v = o.children.length; l < v; l++) {
                            s = _(p[o.children[l]], n, o.parents.concat());
                            r.push(s);
                            if (p[s].children_d.length) {
                                r = r.concat(p[s].children_d)
                            }
                        }
                        for (l = 0,
                            v = o.parents.length; l < v; l++) {
                            p[o.parents[l]].children_d = p[o.parents[l]].children_d.concat(r)
                        }
                        g = {
                            cnt: d,
                            mod: p,
                            sel: a,
                            par: n,
                            dpc: r,
                            add: c
                        }
                    } else {
                        for (l = 0,
                            v = t.length; l < v; l++) {
                            s = y(t[l], n, o.parents.concat());
                            if (s) {
                                i.push(s);
                                r.push(s);
                                if (p[s].children_d.length) {
                                    r = r.concat(p[s].children_d)
                                }
                            }
                        }
                        o.children = i;
                        o.children_d = r;
                        for (l = 0,
                            v = o.parents.length; l < v; l++) {
                            p[o.parents[l]].children_d = p[o.parents[l]].children_d.concat(r)
                        }
                        g = {
                            cnt: d,
                            mod: p,
                            sel: a,
                            par: n,
                            dpc: r,
                            add: c
                        }
                    }
                    if (typeof window === "undefined" || typeof window.document === "undefined") {
                        postMessage(g)
                    } else {
                        return g
                    }
                },
                a = function (e, t) {
                    if (this.element === null) {
                        return
                    }
                    this._cnt = e.cnt;
                    this._model.data = e.mod;
                    if (t) {
                        var n, i, r = e.add,
                            o = e.sel,
                            a = this._data.core.selected.slice(),
                            s = this._model.data;
                        if (o.length !== a.length || T.vakata.array_unique(o.concat(a)).length !== o.length) {
                            for (n = 0,
                                i = o.length; n < i; n++) {
                                if (T.inArray(o[n], r) === -1 && T.inArray(o[n], a) === -1) {
                                    s[o[n]].state.selected = false
                                }
                            }
                            for (n = 0,
                                i = a.length; n < i; n++) {
                                if (T.inArray(a[n], o) === -1) {
                                    s[a[n]].state.selected = true
                                }
                            }
                        }
                    }
                    if (e.add.length) {
                        this._data.core.selected = this._data.core.selected.concat(e.add)
                    }
                    this.trigger("model", {
                        nodes: e.dpc,
                        parent: e.par
                    });
                    if (e.par !== "#") {
                        this._node_changed(e.par);
                        this.redraw()
                    } else {
                        this.redraw(true)
                    }
                    if (e.add.length) {
                        this.trigger("changed", {
                            action: "model",
                            selected: this._data.core.selected
                        })
                    }
                    l.call(this, true)
                };
            if (this.settings.core.worker && window.Blob && window.URL && window.Worker) {
                try {
                    if (this._wrk === null) {
                        this._wrk = window.URL.createObjectURL(new window.Blob(["self.onmessage = " + o.toString()], {
                            type: "text/javascript"
                        }))
                    }
                    if (!this._data.core.working || n) {
                        this._data.core.working = true;
                        i = new window.Worker(this._wrk);
                        i.onmessage = T.proxy(function (e) {
                            a.call(this, e.data, true);
                            try {
                                i.terminate();
                                i = null
                            } catch (e) {}
                            if (this._data.core.worker_queue.length) {
                                this._append_json_data.apply(this, this._data.core.worker_queue.shift())
                            } else {
                                this._data.core.working = false
                            }
                        }, this);
                        if (!r.par) {
                            if (this._data.core.worker_queue.length) {
                                this._append_json_data.apply(this, this._data.core.worker_queue.shift())
                            } else {
                                this._data.core.working = false
                            }
                        } else {
                            i.postMessage(r)
                        }
                    } else {
                        this._data.core.worker_queue.push([e, t, l, true])
                    }
                } catch (e) {
                    a.call(this, o(r), false);
                    if (this._data.core.worker_queue.length) {
                        this._append_json_data.apply(this, this._data.core.worker_queue.shift())
                    } else {
                        this._data.core.working = false
                    }
                }
            } else {
                a.call(this, o(r), false)
            }
        },
        _parse_model_from_html: function (e, t, n) {
            if (!n) {
                n = []
            } else {
                n = [].concat(n)
            }
            if (t) {
                n.unshift(t)
            }
            var i, r, o = this._model.data,
                a = {
                    id: false,
                    text: false,
                    icon: true,
                    parent: t,
                    parents: n,
                    children: [],
                    children_d: [],
                    data: null,
                    state: {},
                    li_attr: {
                        id: false
                    },
                    a_attr: {
                        href: "#"
                    },
                    original: false
                },
                s, l, u;
            for (s in this._model.default_state) {
                if (this._model.default_state.hasOwnProperty(s)) {
                    a.state[s] = this._model.default_state[s]
                }
            }
            l = T.vakata.attributes(e, true);
            T.each(l, function (e, t) {
                t = T.trim(t);
                if (!t.length) {
                    return true
                }
                a.li_attr[e] = t;
                if (e === "id") {
                    a.id = t.toString()
                }
            });
            l = e.children("a").first();
            if (l.length) {
                l = T.vakata.attributes(l, true);
                T.each(l, function (e, t) {
                    t = T.trim(t);
                    if (t.length) {
                        a.a_attr[e] = t
                    }
                })
            }
            l = e.children("a").first().length ? e.children("a").first().clone() : e.clone();
            l.children("ins, i, ul").remove();
            l = l.html();
            l = T("<div />").html(l);
            a.text = this.settings.core.force_text ? l.text() : l.html();
            l = e.data();
            a.data = l ? T.extend(true, {}, l) : null;
            a.state.opened = e.hasClass("jstree-open");
            a.state.selected = e.children("a").hasClass("jstree-clicked");
            a.state.disabled = e.children("a").hasClass("jstree-disabled");
            if (a.data && a.data.jstree) {
                for (s in a.data.jstree) {
                    if (a.data.jstree.hasOwnProperty(s)) {
                        a.state[s] = a.data.jstree[s]
                    }
                }
            }
            l = e.children("a").children(".jstree-themeicon");
            if (l.length) {
                a.icon = l.hasClass("jstree-themeicon-hidden") ? false : l.attr("rel")
            }
            if (a.state.icon !== w) {
                a.icon = a.state.icon
            }
            if (a.icon === w || a.icon === null || a.icon === "") {
                a.icon = true
            }
            l = e.children("ul").children("li");
            do {
                u = "j" + this._id + "_" + ++this._cnt
            } while (o[u]);
            a.id = a.li_attr.id ? a.li_attr.id.toString() : u;
            if (l.length) {
                l.each(T.proxy(function (e, t) {
                    i = this._parse_model_from_html(T(t), a.id, n);
                    r = this._model.data[i];
                    a.children.push(i);
                    if (r.children_d.length) {
                        a.children_d = a.children_d.concat(r.children_d)
                    }
                }, this));
                a.children_d = a.children_d.concat(a.children)
            } else {
                if (e.hasClass("jstree-closed")) {
                    a.state.loaded = false
                }
            }
            if (a.li_attr["class"]) {
                a.li_attr["class"] = a.li_attr["class"].replace("jstree-closed", "").replace("jstree-open", "")
            }
            if (a.a_attr["class"]) {
                a.a_attr["class"] = a.a_attr["class"].replace("jstree-clicked", "").replace("jstree-disabled", "")
            }
            o[a.id] = a;
            if (a.state.selected) {
                this._data.core.selected.push(a.id)
            }
            return a.id
        },
        _parse_model_from_flat_json: function (e, t, n) {
            if (!n) {
                n = []
            } else {
                n = n.concat()
            }
            if (t) {
                n.unshift(t)
            }
            var i = e.id.toString(),
                r = this._model.data,
                o = this._model.default_state,
                a, s, l, u, c = {
                    id: i,
                    text: e.text || "",
                    icon: e.icon !== w ? e.icon : true,
                    parent: t,
                    parents: n,
                    children: e.children || [],
                    children_d: e.children_d || [],
                    data: e.data,
                    state: {},
                    li_attr: {
                        id: false
                    },
                    a_attr: {
                        href: "#"
                    },
                    original: false
                };
            for (a in o) {
                if (o.hasOwnProperty(a)) {
                    c.state[a] = o[a]
                }
            }
            if (e && e.data && e.data.jstree && e.data.jstree.icon) {
                c.icon = e.data.jstree.icon
            }
            if (c.icon === w || c.icon === null || c.icon === "") {
                c.icon = true
            }
            if (e && e.data) {
                c.data = e.data;
                if (e.data.jstree) {
                    for (a in e.data.jstree) {
                        if (e.data.jstree.hasOwnProperty(a)) {
                            c.state[a] = e.data.jstree[a]
                        }
                    }
                }
            }
            if (e && typeof e.state === "object") {
                for (a in e.state) {
                    if (e.state.hasOwnProperty(a)) {
                        c.state[a] = e.state[a]
                    }
                }
            }
            if (e && typeof e.li_attr === "object") {
                for (a in e.li_attr) {
                    if (e.li_attr.hasOwnProperty(a)) {
                        c.li_attr[a] = e.li_attr[a]
                    }
                }
            }
            if (!c.li_attr.id) {
                c.li_attr.id = i
            }
            if (e && typeof e.a_attr === "object") {
                for (a in e.a_attr) {
                    if (e.a_attr.hasOwnProperty(a)) {
                        c.a_attr[a] = e.a_attr[a]
                    }
                }
            }
            if (e && e.children && e.children === true) {
                c.state.loaded = false;
                c.children = [];
                c.children_d = []
            }
            r[c.id] = c;
            for (a = 0,
                s = c.children.length; a < s; a++) {
                l = this._parse_model_from_flat_json(r[c.children[a]], c.id, n);
                u = r[l];
                c.children_d.push(l);
                if (u.children_d.length) {
                    c.children_d = c.children_d.concat(u.children_d)
                }
            }
            delete e.data;
            delete e.children;
            r[c.id].original = e;
            if (c.state.selected) {
                this._data.core.selected.push(c.id)
            }
            return c.id
        },
        _parse_model_from_json: function (e, t, n) {
            if (!n) {
                n = []
            } else {
                n = n.concat()
            }
            if (t) {
                n.unshift(t)
            }
            var i = false,
                r, o, a, s, l = this._model.data,
                u = this._model.default_state,
                c;
            do {
                i = "j" + this._id + "_" + ++this._cnt
            } while (l[i]);
            c = {
                id: false,
                text: typeof e === "string" ? e : "",
                icon: typeof e === "object" && e.icon !== w ? e.icon : true,
                parent: t,
                parents: n,
                children: [],
                children_d: [],
                data: null,
                state: {},
                li_attr: {
                    id: false
                },
                a_attr: {
                    href: "#"
                },
                original: false
            };
            for (r in u) {
                if (u.hasOwnProperty(r)) {
                    c.state[r] = u[r]
                }
            }
            if (e && e.id) {
                c.id = e.id.toString()
            }
            if (e && e.text) {
                c.text = e.text
            }
            if (e && e.data && e.data.jstree && e.data.jstree.icon) {
                c.icon = e.data.jstree.icon
            }
            if (c.icon === w || c.icon === null || c.icon === "") {
                c.icon = true
            }
            if (e && e.data) {
                c.data = e.data;
                if (e.data.jstree) {
                    for (r in e.data.jstree) {
                        if (e.data.jstree.hasOwnProperty(r)) {
                            c.state[r] = e.data.jstree[r]
                        }
                    }
                }
            }
            if (e && typeof e.state === "object") {
                for (r in e.state) {
                    if (e.state.hasOwnProperty(r)) {
                        c.state[r] = e.state[r]
                    }
                }
            }
            if (e && typeof e.li_attr === "object") {
                for (r in e.li_attr) {
                    if (e.li_attr.hasOwnProperty(r)) {
                        c.li_attr[r] = e.li_attr[r]
                    }
                }
            }
            if (c.li_attr.id && !c.id) {
                c.id = c.li_attr.id.toString()
            }
            if (!c.id) {
                c.id = i
            }
            if (!c.li_attr.id) {
                c.li_attr.id = c.id
            }
            if (e && typeof e.a_attr === "object") {
                for (r in e.a_attr) {
                    if (e.a_attr.hasOwnProperty(r)) {
                        c.a_attr[r] = e.a_attr[r]
                    }
                }
            }
            if (e && e.children && e.children.length) {
                for (r = 0,
                    o = e.children.length; r < o; r++) {
                    a = this._parse_model_from_json(e.children[r], c.id, n);
                    s = l[a];
                    c.children.push(a);
                    if (s.children_d.length) {
                        c.children_d = c.children_d.concat(s.children_d)
                    }
                }
                c.children_d = c.children_d.concat(c.children)
            }
            if (e && e.children && e.children === true) {
                c.state.loaded = false;
                c.children = [];
                c.children_d = []
            }
            delete e.data;
            delete e.children;
            c.original = e;
            l[c.id] = c;
            if (c.state.selected) {
                this._data.core.selected.push(c.id)
            }
            return c.id
        },
        _redraw: function () {
            var e = this._model.force_full_redraw ? this._model.data["#"].children.concat([]) : this._model.changed.concat([]),
                t = m.createElement("UL"),
                n, i, r, o = this._data.core.focused;
            for (i = 0,
                r = e.length; i < r; i++) {
                n = this.redraw_node(e[i], true, this._model.force_full_redraw);
                if (n && this._model.force_full_redraw) {
                    t.appendChild(n)
                }
            }
            if (this._model.force_full_redraw) {
                t.className = this.get_container_ul()[0].className;
                t.setAttribute("role", "group");
                this.element.empty().append(t)
            }
            if (o !== null) {
                n = this.get_node(o, true);
                if (n && n.length && n.children(".jstree-anchor")[0] !== m.activeElement) {
                    n.children(".jstree-anchor").focus()
                } else {
                    this._data.core.focused = null
                }
            }
            this._model.force_full_redraw = false;
            this._model.changed = [];
            this.trigger("redraw", {
                nodes: e
            })
        },
        redraw: function (e) {
            if (e) {
                this._model.force_full_redraw = true
            }
            this._redraw()
        },
        draw_children: function (e) {
            var t = this.get_node(e),
                n = false,
                i = false,
                r = false,
                o = m;
            if (!t) {
                return false
            }
            if (t.id === "#") {
                return this.redraw(true)
            }
            e = this.get_node(e, true);
            if (!e || !e.length) {
                return false
            }
            e.children(".jstree-children").remove();
            e = e[0];
            if (t.children.length && t.state.loaded) {
                r = o.createElement("UL");
                r.setAttribute("role", "group");
                r.className = "jstree-children";
                for (n = 0,
                    i = t.children.length; n < i; n++) {
                    r.appendChild(this.redraw_node(t.children[n], true, true))
                }
                e.appendChild(r)
            }
        },
        redraw_node: function (e, t, n, i) {
            var r = this.get_node(e),
                o = false,
                a = false,
                s = false,
                l = false,
                u = false,
                c = false,
                f = "",
                h = m,
                d = this._model.data,
                p = false,
                v = false,
                g = null,
                _ = 0,
                y = 0;
            if (!r) {
                return false
            }
            if (r.id === "#") {
                return this.redraw(true)
            }
            t = t || r.children.length === 0;
            e = !m.querySelector ? m.getElementById(r.id) : this.element[0].querySelector("#" + ("0123456789".indexOf(r.id[0]) !== -1 ? "\\3" + r.id[0] + " " + r.id.substr(1).replace(T.jstree.idregex, "\\$&") : r.id.replace(T.jstree.idregex, "\\$&")));
            if (!e) {
                t = true;
                if (!n) {
                    o = r.parent !== "#" ? T("#" + r.parent.replace(T.jstree.idregex, "\\$&"), this.element)[0] : null;
                    if (o !== null && (!o || !d[r.parent].state.opened)) {
                        return false
                    }
                    a = T.inArray(r.id, o === null ? d["#"].children : d[r.parent].children)
                }
            } else {
                e = T(e);
                if (!n) {
                    o = e.parent().parent()[0];
                    if (o === this.element[0]) {
                        o = null
                    }
                    a = e.index()
                }
                if (!t && r.children.length && !e.children(".jstree-children").length) {
                    t = true
                }
                if (!t) {
                    s = e.children(".jstree-children")[0]
                }
                p = e.children(".jstree-anchor")[0] === m.activeElement;
                e.remove()
            }
            e = b.cloneNode(true);
            f = "jstree-node ";
            for (l in r.li_attr) {
                if (r.li_attr.hasOwnProperty(l)) {
                    if (l === "id") {
                        continue
                    }
                    if (l !== "class") {
                        e.setAttribute(l, r.li_attr[l])
                    } else {
                        f += r.li_attr[l]
                    }
                }
            }
            if (!r.a_attr.id) {
                r.a_attr.id = r.id + "_anchor"
            }
            e.setAttribute("aria-selected", !!r.state.selected);
            e.setAttribute("aria-level", r.parents.length);
            e.setAttribute("aria-labelledby", r.a_attr.id);
            if (r.state.disabled) {
                e.setAttribute("aria-disabled", true)
            }
            if (r.state.loaded && !r.children.length) {
                f += " jstree-leaf"
            } else {
                f += r.state.opened && r.state.loaded ? " jstree-open" : " jstree-closed";
                e.setAttribute("aria-expanded", r.state.opened && r.state.loaded)
            }
            if (r.parent !== null && d[r.parent].children[d[r.parent].children.length - 1] === r.id) {
                f += " jstree-last"
            }
            e.id = r.id;
            e.className = f;
            f = (r.state.selected ? " jstree-clicked" : "") + (r.state.disabled ? " jstree-disabled" : "");
            for (u in r.a_attr) {
                if (r.a_attr.hasOwnProperty(u)) {
                    if (u === "href" && r.a_attr[u] === "#") {
                        continue
                    }
                    if (u !== "class") {
                        e.childNodes[1].setAttribute(u, r.a_attr[u])
                    } else {
                        f += " " + r.a_attr[u]
                    }
                }
            }
            if (f.length) {
                e.childNodes[1].className = "jstree-anchor " + f
            }
            if (r.icon && r.icon !== true || r.icon === false) {
                if (r.icon === false) {
                    e.childNodes[1].childNodes[0].className += " jstree-themeicon-hidden"
                } else if (r.icon.indexOf("/") === -1 && r.icon.indexOf(".") === -1) {
                    e.childNodes[1].childNodes[0].className += " " + r.icon + " jstree-themeicon-custom"
                } else {
                    e.childNodes[1].childNodes[0].style.backgroundImage = "url(" + r.icon + ")";
                    e.childNodes[1].childNodes[0].style.backgroundPosition = "center center";
                    e.childNodes[1].childNodes[0].style.backgroundSize = "auto";
                    e.childNodes[1].childNodes[0].className += " jstree-themeicon-custom"
                }
            }
            if (this.settings.core.force_text) {
                e.childNodes[1].appendChild(h.createTextNode(r.text))
            } else {
                e.childNodes[1].innerHTML += r.text
            }
            if (t && r.children.length && (r.state.opened || i) && r.state.loaded) {
                c = h.createElement("UL");
                c.setAttribute("role", "group");
                c.className = "jstree-children";
                for (l = 0,
                    u = r.children.length; l < u; l++) {
                    c.appendChild(this.redraw_node(r.children[l], t, true))
                }
                e.appendChild(c)
            }
            if (s) {
                e.appendChild(s)
            }
            if (!n) {
                if (!o) {
                    o = this.element[0]
                }
                for (l = 0,
                    u = o.childNodes.length; l < u; l++) {
                    if (o.childNodes[l] && o.childNodes[l].className && o.childNodes[l].className.indexOf("jstree-children") !== -1) {
                        g = o.childNodes[l];
                        break
                    }
                }
                if (!g) {
                    g = h.createElement("UL");
                    g.setAttribute("role", "group");
                    g.className = "jstree-children";
                    o.appendChild(g)
                }
                o = g;
                if (a < o.childNodes.length) {
                    o.insertBefore(e, o.childNodes[a])
                } else {
                    o.appendChild(e)
                }
                if (p) {
                    _ = this.element[0].scrollTop;
                    y = this.element[0].scrollLeft;
                    e.childNodes[1].focus();
                    this.element[0].scrollTop = _;
                    this.element[0].scrollLeft = y
                }
            }
            if (r.state.opened && !r.state.loaded) {
                r.state.opened = false;
                setTimeout(T.proxy(function () {
                    this.open_node(r.id, false, 0)
                }, this), 0)
            }
            return e
        },
        open_node: function (e, n, i) {
            var t, r, o, a;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    r = e.length; t < r; t++) {
                    this.open_node(e[t], n, i)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            i = i === w ? this.settings.core.animation : i;
            if (!this.is_closed(e)) {
                if (n) {
                    n.call(this, e, false)
                }
                return false
            }
            if (!this.is_loaded(e)) {
                if (this.is_loading(e)) {
                    return setTimeout(T.proxy(function () {
                        this.open_node(e, n, i)
                    }, this), 500)
                }
                this.load_node(e, function (e, t) {
                    return t ? this.open_node(e, n, i) : n ? n.call(this, e, false) : false
                })
            } else {
                o = this.get_node(e, true);
                a = this;
                if (o.length) {
                    if (i && o.children(".jstree-children").length) {
                        o.children(".jstree-children").stop(true, true)
                    }
                    if (e.children.length && !this._firstChild(o.children(".jstree-children")[0])) {
                        this.draw_children(e)
                    }
                    if (!i) {
                        this.trigger("before_open", {
                            node: e
                        });
                        o[0].className = o[0].className.replace("jstree-closed", "jstree-open");
                        o[0].setAttribute("aria-expanded", true)
                    } else {
                        this.trigger("before_open", {
                            node: e
                        });
                        o.children(".jstree-children").css("display", "none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded", true).children(".jstree-children").stop(true, true).slideDown(i, function () {
                            this.style.display = "";
                            a.trigger("after_open", {
                                node: e
                            })
                        })
                    }
                }
                e.state.opened = true;
                if (n) {
                    n.call(this, e, true)
                }
                if (!o.length) {
                    this.trigger("before_open", {
                        node: e
                    })
                }
                this.trigger("open_node", {
                    node: e
                });
                if (!i || !o.length) {
                    this.trigger("after_open", {
                        node: e
                    })
                }
            }
        },
        _open_to: function (e) {
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            var t, n, i = e.parents;
            for (t = 0,
                n = i.length; t < n; t += 1) {
                if (t !== "#") {
                    this.open_node(i[t], false, 0)
                }
            }
            return T("#" + e.id.replace(T.jstree.idregex, "\\$&"), this.element)
        },
        close_node: function (e, t) {
            var n, i, r, o;
            if (T.isArray(e)) {
                e = e.slice();
                for (n = 0,
                    i = e.length; n < i; n++) {
                    this.close_node(e[n], t)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            if (this.is_closed(e)) {
                return false
            }
            t = t === w ? this.settings.core.animation : t;
            r = this;
            o = this.get_node(e, true);
            if (o.length) {
                if (!t) {
                    o[0].className = o[0].className.replace("jstree-open", "jstree-closed");
                    o.attr("aria-expanded", false).children(".jstree-children").remove()
                } else {
                    o.children(".jstree-children").attr("style", "display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded", false).children(".jstree-children").stop(true, true).slideUp(t, function () {
                        this.style.display = "";
                        o.children(".jstree-children").remove();
                        r.trigger("after_close", {
                            node: e
                        })
                    })
                }
            }
            e.state.opened = false;
            this.trigger("close_node", {
                node: e
            });
            if (!t || !o.length) {
                this.trigger("after_close", {
                    node: e
                })
            }
        },
        toggle_node: function (e) {
            var t, n;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    n = e.length; t < n; t++) {
                    this.toggle_node(e[t])
                }
                return true
            }
            if (this.is_closed(e)) {
                return this.open_node(e)
            }
            if (this.is_open(e)) {
                return this.close_node(e)
            }
        },
        open_all: function (e, n, i) {
            if (!e) {
                e = "#"
            }
            e = this.get_node(e);
            if (!e) {
                return false
            }
            var t = e.id === "#" ? this.get_container_ul() : this.get_node(e, true),
                r, o, a;
            if (!t.length) {
                for (r = 0,
                    o = e.children_d.length; r < o; r++) {
                    if (this.is_closed(this._model.data[e.children_d[r]])) {
                        this._model.data[e.children_d[r]].state.opened = true
                    }
                }
                return this.trigger("open_all", {
                    node: e
                })
            }
            i = i || t;
            a = this;
            t = this.is_closed(e) ? t.find(".jstree-closed").addBack() : t.find(".jstree-closed");
            t.each(function () {
                a.open_node(this, function (e, t) {
                    if (t && this.is_parent(e)) {
                        this.open_all(e, n, i)
                    }
                }, n || 0)
            });
            if (i.find(".jstree-closed").length === 0) {
                this.trigger("open_all", {
                    node: this.get_node(i)
                })
            }
        },
        close_all: function (e, t) {
            if (!e) {
                e = "#"
            }
            e = this.get_node(e);
            if (!e) {
                return false
            }
            var n = e.id === "#" ? this.get_container_ul() : this.get_node(e, true),
                i = this,
                r, o;
            if (!n.length) {
                for (r = 0,
                    o = e.children_d.length; r < o; r++) {
                    this._model.data[e.children_d[r]].state.opened = false
                }
                return this.trigger("close_all", {
                    node: e
                })
            }
            n = this.is_open(e) ? n.find(".jstree-open").addBack() : n.find(".jstree-open");
            T(n.get().reverse()).each(function () {
                i.close_node(this, t || 0)
            });
            this.trigger("close_all", {
                node: e
            })
        },
        is_disabled: function (e) {
            e = this.get_node(e);
            return e && e.state && e.state.disabled
        },
        enable_node: function (e) {
            var t, n;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    n = e.length; t < n; t++) {
                    this.enable_node(e[t])
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            e.state.disabled = false;
            this.get_node(e, true).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled", false);
            this.trigger("enable_node", {
                node: e
            })
        },
        disable_node: function (e) {
            var t, n;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    n = e.length; t < n; t++) {
                    this.disable_node(e[t])
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            e.state.disabled = true;
            this.get_node(e, true).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled", true);
            this.trigger("disable_node", {
                node: e
            })
        },
        activate_node: function (e, t) {
            if (this.is_disabled(e)) {
                return false
            }
            this._data.core.last_clicked = this._data.core.last_clicked && this._data.core.last_clicked.id !== w ? this.get_node(this._data.core.last_clicked.id) : null;
            if (this._data.core.last_clicked && !this._data.core.last_clicked.state.selected) {
                this._data.core.last_clicked = null
            }
            if (!this._data.core.last_clicked && this._data.core.selected.length) {
                this._data.core.last_clicked = this.get_node(this._data.core.selected[this._data.core.selected.length - 1])
            }
            if (!this.settings.core.multiple || !t.metaKey && !t.ctrlKey && !t.shiftKey || t.shiftKey && (!this._data.core.last_clicked || !this.get_parent(e) || this.get_parent(e) !== this._data.core.last_clicked.parent)) {
                if (!this.settings.core.multiple && (t.metaKey || t.ctrlKey || t.shiftKey) && this.is_selected(e)) {
                    this.deselect_node(e, false, t)
                } else {
                    this.deselect_all(true);
                    this.select_node(e, false, false, t);
                    this._data.core.last_clicked = this.get_node(e)
                }
            } else {
                if (t.shiftKey) {
                    var n = this.get_node(e).id,
                        i = this._data.core.last_clicked.id,
                        r = this.get_node(this._data.core.last_clicked.parent).children,
                        o = false,
                        a, s;
                    for (a = 0,
                        s = r.length; a < s; a += 1) {
                        if (r[a] === n) {
                            o = !o
                        }
                        if (r[a] === i) {
                            o = !o
                        }
                        if (!this.is_disabled(r[a]) && (o || r[a] === n || r[a] === i)) {
                            this.select_node(r[a], true, false, t)
                        } else {
                            this.deselect_node(r[a], true, t)
                        }
                    }
                    this.trigger("changed", {
                        action: "select_node",
                        node: this.get_node(e),
                        selected: this._data.core.selected,
                        event: t
                    })
                } else {
                    if (!this.is_selected(e)) {
                        this.select_node(e, false, false, t)
                    } else {
                        this.deselect_node(e, false, t)
                    }
                }
            }
            this.trigger("activate_node", {
                node: this.get_node(e)
            })
        },
        hover_node: function (e) {
            e = this.get_node(e, true);
            if (!e || !e.length || e.children(".jstree-hovered").length) {
                return false
            }
            var t = this.element.find(".jstree-hovered"),
                n = this.element;
            if (t && t.length) {
                this.dehover_node(t)
            }
            e.children(".jstree-anchor").addClass("jstree-hovered");
            this.trigger("hover_node", {
                node: this.get_node(e)
            });
            setTimeout(function () {
                n.attr("aria-activedescendant", e[0].id)
            }, 0)
        },
        dehover_node: function (e) {
            e = this.get_node(e, true);
            if (!e || !e.length || !e.children(".jstree-hovered").length) {
                return false
            }
            e.children(".jstree-anchor").removeClass("jstree-hovered");
            this.trigger("dehover_node", {
                node: this.get_node(e)
            })
        },
        select_node: function (e, t, n, i) {
            var r, o, a, s;
            if (T.isArray(e)) {
                e = e.slice();
                for (o = 0,
                    a = e.length; o < a; o++) {
                    this.select_node(e[o], t, n, i)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            r = this.get_node(e, true);
            if (!e.state.selected) {
                e.state.selected = true;
                this._data.core.selected.push(e.id);
                if (!n) {
                    r = this._open_to(e)
                }
                if (r && r.length) {
                    r.attr("aria-selected", true).children(".jstree-anchor").addClass("jstree-clicked")
                }
                this.trigger("select_node", {
                    node: e,
                    selected: this._data.core.selected,
                    event: i
                });
                if (!t) {
                    this.trigger("changed", {
                        action: "select_node",
                        node: e,
                        selected: this._data.core.selected,
                        event: i
                    })
                }
            }
        },
        deselect_node: function (e, t, n) {
            var i, r, o;
            if (T.isArray(e)) {
                e = e.slice();
                for (i = 0,
                    r = e.length; i < r; i++) {
                    this.deselect_node(e[i], t, n)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            o = this.get_node(e, true);
            if (e.state.selected) {
                e.state.selected = false;
                this._data.core.selected = T.vakata.array_remove_item(this._data.core.selected, e.id);
                if (o.length) {
                    o.attr("aria-selected", false).children(".jstree-anchor").removeClass("jstree-clicked")
                }
                this.trigger("deselect_node", {
                    node: e,
                    selected: this._data.core.selected,
                    event: n
                });
                if (!t) {
                    this.trigger("changed", {
                        action: "deselect_node",
                        node: e,
                        selected: this._data.core.selected,
                        event: n
                    })
                }
            }
        },
        select_all: function (e) {
            var t = this._data.core.selected.concat([]),
                n, i;
            this._data.core.selected = this._model.data["#"].children_d.concat();
            for (n = 0,
                i = this._data.core.selected.length; n < i; n++) {
                if (this._model.data[this._data.core.selected[n]]) {
                    this._model.data[this._data.core.selected[n]].state.selected = true
                }
            }
            this.redraw(true);
            this.trigger("select_all", {
                selected: this._data.core.selected
            });
            if (!e) {
                this.trigger("changed", {
                    action: "select_all",
                    selected: this._data.core.selected,
                    old_selection: t
                })
            }
        },
        deselect_all: function (e) {
            var t = this._data.core.selected.concat([]),
                n, i;
            for (n = 0,
                i = this._data.core.selected.length; n < i; n++) {
                if (this._model.data[this._data.core.selected[n]]) {
                    this._model.data[this._data.core.selected[n]].state.selected = false
                }
            }
            this._data.core.selected = [];
            this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected", false);
            this.trigger("deselect_all", {
                selected: this._data.core.selected,
                node: t
            });
            if (!e) {
                this.trigger("changed", {
                    action: "deselect_all",
                    selected: this._data.core.selected,
                    old_selection: t
                })
            }
        },
        is_selected: function (e) {
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            return e.state.selected
        },
        get_selected: function (e) {
            return e ? T.map(this._data.core.selected, T.proxy(function (e) {
                return this.get_node(e)
            }, this)) : this._data.core.selected.slice()
        },
        get_top_selected: function (e) {
            var t = this.get_selected(true),
                n = {},
                i, r, o, a;
            for (i = 0,
                r = t.length; i < r; i++) {
                n[t[i].id] = t[i]
            }
            for (i = 0,
                r = t.length; i < r; i++) {
                for (o = 0,
                    a = t[i].children_d.length; o < a; o++) {
                    if (n[t[i].children_d[o]]) {
                        delete n[t[i].children_d[o]]
                    }
                }
            }
            t = [];
            for (i in n) {
                if (n.hasOwnProperty(i)) {
                    t.push(i)
                }
            }
            return e ? T.map(t, T.proxy(function (e) {
                return this.get_node(e)
            }, this)) : t
        },
        get_bottom_selected: function (e) {
            var t = this.get_selected(true),
                n = [],
                i, r;
            for (i = 0,
                r = t.length; i < r; i++) {
                if (!t[i].children.length) {
                    n.push(t[i].id)
                }
            }
            return e ? T.map(n, T.proxy(function (e) {
                return this.get_node(e)
            }, this)) : n
        },
        get_state: function () {
            var e = {
                    core: {
                        open: [],
                        scroll: {
                            left: this.element.scrollLeft(),
                            top: this.element.scrollTop()
                        },
                        selected: []
                    }
                },
                t;
            for (t in this._model.data) {
                if (this._model.data.hasOwnProperty(t)) {
                    if (t !== "#") {
                        if (this._model.data[t].state.opened) {
                            e.core.open.push(t)
                        }
                        if (this._model.data[t].state.selected) {
                            e.core.selected.push(t)
                        }
                    }
                }
            }
            return e
        },
        set_state: function (t, n) {
            if (t) {
                if (t.core) {
                    var e, i, r, o, a;
                    if (t.core.open) {
                        if (!T.isArray(t.core.open) || !t.core.open.length) {
                            delete t.core.open;
                            this.set_state(t, n)
                        } else {
                            this._load_nodes(t.core.open, function (e) {
                                this.open_node(e, false, 0);
                                delete t.core.open;
                                this.set_state(t, n)
                            }, true)
                        }
                        return false
                    }
                    if (t.core.scroll) {
                        if (t.core.scroll && t.core.scroll.left !== w) {
                            this.element.scrollLeft(t.core.scroll.left)
                        }
                        if (t.core.scroll && t.core.scroll.top !== w) {
                            this.element.scrollTop(t.core.scroll.top)
                        }
                        delete t.core.scroll;
                        this.set_state(t, n);
                        return false
                    }
                    if (t.core.selected) {
                        o = this;
                        this.deselect_all();
                        T.each(t.core.selected, function (e, t) {
                            o.select_node(t, false, true)
                        });
                        delete t.core.selected;
                        this.set_state(t, n);
                        return false
                    }
                    for (a in t) {
                        if (t.hasOwnProperty(a) && a !== "core" && T.inArray(a, this.settings.plugins) === -1) {
                            delete t[a]
                        }
                    }
                    if (T.isEmptyObject(t.core)) {
                        delete t.core;
                        this.set_state(t, n);
                        return false
                    }
                }
                if (T.isEmptyObject(t)) {
                    t = null;
                    if (n) {
                        n.call(this)
                    }
                    this.trigger("set_state");
                    return false
                }
                return true
            }
            return false
        },
        refresh: function (e, t) {
            this._data.core.state = t === true ? {} : this.get_state();
            if (t && T.isFunction(t)) {
                this._data.core.state = t.call(this, this._data.core.state)
            }
            this._cnt = 0;
            this._model.data = {
                "#": {
                    id: "#",
                    parent: null,
                    parents: [],
                    children: [],
                    children_d: [],
                    state: {
                        loaded: false
                    }
                }
            };
            var n = this.get_container_ul()[0].className;
            if (!e) {
                this.element.html("<" + "ul class='" + n + "' role='group'><" + "li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j" + this._id + "_loading'><i class='jstree-icon jstree-ocl'></i><" + "a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>" + this.get_string("Loading ...") + "</a></li></ul>");
                this.element.attr("aria-activedescendant", "j" + this._id + "_loading")
            }
            this.load_node("#", function (e, t) {
                if (t) {
                    this.get_container_ul()[0].className = n;
                    if (this._firstChild(this.get_container_ul()[0])) {
                        this.element.attr("aria-activedescendant", this._firstChild(this.get_container_ul()[0]).id)
                    }
                    this.set_state(T.extend(true, {}, this._data.core.state), function () {
                        this.trigger("refresh")
                    })
                }
                this._data.core.state = null
            })
        },
        refresh_node: function (t) {
            t = this.get_node(t);
            if (!t || t.id === "#") {
                return false
            }
            var n = [],
                e = [],
                i = this._data.core.selected.concat([]);
            e.push(t.id);
            if (t.state.opened === true) {
                n.push(t.id)
            }
            this.get_node(t, true).find(".jstree-open").each(function () {
                n.push(this.id)
            });
            this._load_nodes(e, T.proxy(function (e) {
                this.open_node(n, false, 0);
                this.select_node(this._data.core.selected);
                this.trigger("refresh_node", {
                    node: t,
                    nodes: e
                })
            }, this))
        },
        set_id: function (e, t) {
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            var n, i, r = this._model.data;
            t = t.toString();
            r[e.parent].children[T.inArray(e.id, r[e.parent].children)] = t;
            for (n = 0,
                i = e.parents.length; n < i; n++) {
                r[e.parents[n]].children_d[T.inArray(e.id, r[e.parents[n]].children_d)] = t
            }
            for (n = 0,
                i = e.children.length; n < i; n++) {
                r[e.children[n]].parent = t
            }
            for (n = 0,
                i = e.children_d.length; n < i; n++) {
                r[e.children_d[n]].parents[T.inArray(e.id, r[e.children_d[n]].parents)] = t
            }
            n = T.inArray(e.id, this._data.core.selected);
            if (n !== -1) {
                this._data.core.selected[n] = t
            }
            n = this.get_node(e.id, true);
            if (n) {
                n.attr("id", t).children(".jstree-anchor").attr("id", t + "_anchor").end().attr("aria-labelledby", t + "_anchor");
                if (this.element.attr("aria-activedescendant") === e.id) {
                    this.element.attr("aria-activedescendant", t)
                }
            }
            delete r[e.id];
            e.id = t;
            e.li_attr.id = t;
            r[t] = e;
            return true
        },
        get_text: function (e) {
            e = this.get_node(e);
            return !e || e.id === "#" ? false : e.text
        },
        set_text: function (e, t) {
            var n, i;
            if (T.isArray(e)) {
                e = e.slice();
                for (n = 0,
                    i = e.length; n < i; n++) {
                    this.set_text(e[n], t)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            e.text = t;
            if (this.get_node(e, true).length) {
                this.redraw_node(e.id)
            }
            this.trigger("set_text", {
                obj: e,
                text: t
            });
            return true
        },
        get_json: function (e, t, n) {
            e = this.get_node(e || "#");
            if (!e) {
                return false
            }
            if (t && t.flat && !n) {
                n = []
            }
            var i = {
                    id: e.id,
                    text: e.text,
                    icon: this.get_icon(e),
                    li_attr: T.extend(true, {}, e.li_attr),
                    a_attr: T.extend(true, {}, e.a_attr),
                    state: {},
                    data: t && t.no_data ? false : T.extend(true, {}, e.data)
                },
                r, o;
            if (t && t.flat) {
                i.parent = e.parent
            } else {
                i.children = []
            }
            if (!t || !t.no_state) {
                for (r in e.state) {
                    if (e.state.hasOwnProperty(r)) {
                        i.state[r] = e.state[r]
                    }
                }
            }
            if (t && t.no_id) {
                delete i.id;
                if (i.li_attr && i.li_attr.id) {
                    delete i.li_attr.id
                }
                if (i.a_attr && i.a_attr.id) {
                    delete i.a_attr.id
                }
            }
            if (t && t.flat && e.id !== "#") {
                n.push(i)
            }
            if (!t || !t.no_children) {
                for (r = 0,
                    o = e.children.length; r < o; r++) {
                    if (t && t.flat) {
                        this.get_json(e.children[r], t, n)
                    } else {
                        i.children.push(this.get_json(e.children[r], t))
                    }
                }
            }
            return t && t.flat ? n : e.id === "#" ? i.children : i
        },
        create_node: function (e, t, n, i, r) {
            if (e === null) {
                e = "#"
            }
            e = this.get_node(e);
            if (!e) {
                return false
            }
            n = n === w ? "last" : n;
            if (!n.toString().match(/^(before|after)$/) && !r && !this.is_loaded(e)) {
                return this.load_node(e, function () {
                    this.create_node(e, t, n, i, true)
                })
            }
            if (!t) {
                t = {
                    text: this.get_string("New node")
                }
            }
            if (typeof t === "string") {
                t = {
                    text: t
                }
            }
            if (t.text === w) {
                t.text = this.get_string("New node")
            }
            var o, a, s, l;
            if (e.id === "#") {
                if (n === "before") {
                    n = "first"
                }
                if (n === "after") {
                    n = "last"
                }
            }
            switch (n) {
                case "before":
                    o = this.get_node(e.parent);
                    n = T.inArray(e.id, o.children);
                    e = o;
                    break;
                case "after":
                    o = this.get_node(e.parent);
                    n = T.inArray(e.id, o.children) + 1;
                    e = o;
                    break;
                case "inside":
                case "first":
                    n = 0;
                    break;
                case "last":
                    n = e.children.length;
                    break;
                default:
                    if (!n) {
                        n = 0
                    }
                    break
            }
            if (n > e.children.length) {
                n = e.children.length
            }
            if (!t.id) {
                t.id = true
            }
            if (!this.check("create_node", t, e, n)) {
                this.settings.core.error.call(this, this._data.core.last_error);
                return false
            }
            if (t.id === true) {
                delete t.id
            }
            t = this._parse_model_from_json(t, e.id, e.parents.concat());
            if (!t) {
                return false
            }
            o = this.get_node(t);
            a = [];
            a.push(t);
            a = a.concat(o.children_d);
            this.trigger("model", {
                nodes: a,
                parent: e.id
            });
            e.children_d = e.children_d.concat(a);
            for (s = 0,
                l = e.parents.length; s < l; s++) {
                this._model.data[e.parents[s]].children_d = this._model.data[e.parents[s]].children_d.concat(a)
            }
            t = o;
            o = [];
            for (s = 0,
                l = e.children.length; s < l; s++) {
                o[s >= n ? s + 1 : s] = e.children[s]
            }
            o[n] = t.id;
            e.children = o;
            this.redraw_node(e, true);
            if (i) {
                i.call(this, this.get_node(t))
            }
            this.trigger("create_node", {
                node: this.get_node(t),
                parent: e.id,
                position: n
            });
            return t.id
        },
        rename_node: function (e, t) {
            var n, i, r;
            if (T.isArray(e)) {
                e = e.slice();
                for (n = 0,
                    i = e.length; n < i; n++) {
                    this.rename_node(e[n], t)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            r = e.text;
            if (!this.check("rename_node", e, this.get_parent(e), t)) {
                this.settings.core.error.call(this, this._data.core.last_error);
                return false
            }
            this.set_text(e, t);
            this.trigger("rename_node", {
                node: e,
                text: t,
                old: r
            });
            return true
        },
        delete_node: function (e) {
            var t, n, i, r, o, a, s, l, u, c;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    n = e.length; t < n; t++) {
                    this.delete_node(e[t])
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            i = this.get_node(e.parent);
            r = T.inArray(e.id, i.children);
            c = false;
            if (!this.check("delete_node", e, i, r)) {
                this.settings.core.error.call(this, this._data.core.last_error);
                return false
            }
            if (r !== -1) {
                i.children = T.vakata.array_remove(i.children, r)
            }
            o = e.children_d.concat([]);
            o.push(e.id);
            for (l = 0,
                u = o.length; l < u; l++) {
                for (a = 0,
                    s = e.parents.length; a < s; a++) {
                    r = T.inArray(o[l], this._model.data[e.parents[a]].children_d);
                    if (r !== -1) {
                        this._model.data[e.parents[a]].children_d = T.vakata.array_remove(this._model.data[e.parents[a]].children_d, r)
                    }
                }
                if (this._model.data[o[l]].state.selected) {
                    c = true;
                    r = T.inArray(o[l], this._data.core.selected);
                    if (r !== -1) {
                        this._data.core.selected = T.vakata.array_remove(this._data.core.selected, r)
                    }
                }
            }
            this.trigger("delete_node", {
                node: e,
                parent: i.id
            });
            if (c) {
                this.trigger("changed", {
                    action: "delete_node",
                    node: e,
                    selected: this._data.core.selected,
                    parent: i.id
                })
            }
            for (l = 0,
                u = o.length; l < u; l++) {
                delete this._model.data[o[l]]
            }
            this.redraw_node(i, true);
            return true
        },
        check: function (e, t, n, i, r) {
            t = t && t.id ? t : this.get_node(t);
            n = n && n.id ? n : this.get_node(n);
            var o = e.match(/^move_node|copy_node|create_node$/i) ? n : t,
                a = this.settings.core.check_callback;
            if (e === "move_node" || e === "copy_node") {
                if ((!r || !r.is_multi) && (t.id === n.id || T.inArray(t.id, n.children) === i || T.inArray(n.id, t.children_d) !== -1)) {
                    this._data.core.last_error = {
                        error: "check",
                        plugin: "core",
                        id: "core_01",
                        reason: "Moving parent inside child",
                        data: JSON.stringify({
                            chk: e,
                            pos: i,
                            obj: t && t.id ? t.id : false,
                            par: n && n.id ? n.id : false
                        })
                    };
                    return false
                }
            }
            if (o && o.data) {
                o = o.data
            }
            if (o && o.functions && (o.functions[e] === false || o.functions[e] === true)) {
                if (o.functions[e] === false) {
                    this._data.core.last_error = {
                        error: "check",
                        plugin: "core",
                        id: "core_02",
                        reason: "Node data prevents function: " + e,
                        data: JSON.stringify({
                            chk: e,
                            pos: i,
                            obj: t && t.id ? t.id : false,
                            par: n && n.id ? n.id : false
                        })
                    }
                }
                return o.functions[e]
            }
            if (a === false || T.isFunction(a) && a.call(this, e, t, n, i, r) === false || a && a[e] === false) {
                this._data.core.last_error = {
                    error: "check",
                    plugin: "core",
                    id: "core_03",
                    reason: "User config for core.check_callback prevents function: " + e,
                    data: JSON.stringify({
                        chk: e,
                        pos: i,
                        obj: t && t.id ? t.id : false,
                        par: n && n.id ? n.id : false
                    })
                };
                return false
            }
            return true
        },
        last_error: function () {
            return this._data.core.last_error
        },
        move_node: function (e, t, n, i, r, o, a) {
            var s, l, u, c, f, h, d, p, v, g, _, y, m, b;
            t = this.get_node(t);
            n = n === w ? 0 : n;
            if (!t) {
                return false
            }
            if (!n.toString().match(/^(before|after)$/) && !r && !this.is_loaded(t)) {
                return this.load_node(t, function () {
                    this.move_node(e, t, n, i, true, false, a)
                })
            }
            if (T.isArray(e)) {
                if (e.length === 1) {
                    e = e[0]
                } else {
                    for (s = 0,
                        l = e.length; s < l; s++) {
                        if (v = this.move_node(e[s], t, n, i, r, false, a)) {
                            t = v;
                            n = "after"
                        }
                    }
                    this.redraw();
                    return true
                }
            }
            e = e && e.id ? e : this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            u = (e.parent || "#").toString();
            f = !n.toString().match(/^(before|after)$/) || t.id === "#" ? t : this.get_node(t.parent);
            h = a ? a : this._model.data[e.id] ? this : T.jstree.reference(e.id);
            d = !h || !h._id || this._id !== h._id;
            c = h && h._id && u && h._model.data[u] && h._model.data[u].children ? T.inArray(e.id, h._model.data[u].children) : -1;
            if (h && h._id) {
                e = h._model.data[e.id]
            }
            if (d) {
                if (v = this.copy_node(e, t, n, i, r, false, a)) {
                    if (h) {
                        h.delete_node(e)
                    }
                    return v
                }
                return false
            }
            if (t.id === "#") {
                if (n === "before") {
                    n = "first"
                }
                if (n === "after") {
                    n = "last"
                }
            }
            switch (n) {
                case "before":
                    n = T.inArray(t.id, f.children);
                    break;
                case "after":
                    n = T.inArray(t.id, f.children) + 1;
                    break;
                case "inside":
                case "first":
                    n = 0;
                    break;
                case "last":
                    n = f.children.length;
                    break;
                default:
                    if (!n) {
                        n = 0
                    }
                    break
            }
            if (n > f.children.length) {
                n = f.children.length
            }
            if (!this.check("move_node", e, f, n, {
                    core: true,
                    origin: a,
                    is_multi: h && h._id && h._id !== this._id,
                    is_foreign: !h || !h._id
                })) {
                this.settings.core.error.call(this, this._data.core.last_error);
                return false
            }
            if (e.parent === f.id) {
                p = f.children.concat();
                v = T.inArray(e.id, p);
                if (v !== -1) {
                    p = T.vakata.array_remove(p, v);
                    if (n > v) {
                        n--
                    }
                }
                v = [];
                for (g = 0,
                    _ = p.length; g < _; g++) {
                    v[g >= n ? g + 1 : g] = p[g]
                }
                v[n] = e.id;
                f.children = v;
                this._node_changed(f.id);
                this.redraw(f.id === "#")
            } else {
                v = e.children_d.concat();
                v.push(e.id);
                for (g = 0,
                    _ = e.parents.length; g < _; g++) {
                    p = [];
                    b = h._model.data[e.parents[g]].children_d;
                    for (y = 0,
                        m = b.length; y < m; y++) {
                        if (T.inArray(b[y], v) === -1) {
                            p.push(b[y])
                        }
                    }
                    h._model.data[e.parents[g]].children_d = p
                }
                h._model.data[u].children = T.vakata.array_remove_item(h._model.data[u].children, e.id);
                for (g = 0,
                    _ = f.parents.length; g < _; g++) {
                    this._model.data[f.parents[g]].children_d = this._model.data[f.parents[g]].children_d.concat(v)
                }
                p = [];
                for (g = 0,
                    _ = f.children.length; g < _; g++) {
                    p[g >= n ? g + 1 : g] = f.children[g]
                }
                p[n] = e.id;
                f.children = p;
                f.children_d.push(e.id);
                f.children_d = f.children_d.concat(e.children_d);
                e.parent = f.id;
                v = f.parents.concat();
                v.unshift(f.id);
                b = e.parents.length;
                e.parents = v;
                v = v.concat();
                for (g = 0,
                    _ = e.children_d.length; g < _; g++) {
                    this._model.data[e.children_d[g]].parents = this._model.data[e.children_d[g]].parents.slice(0, b * -1);
                    Array.prototype.push.apply(this._model.data[e.children_d[g]].parents, v)
                }
                if (u === "#" || f.id === "#") {
                    this._model.force_full_redraw = true
                }
                if (!this._model.force_full_redraw) {
                    this._node_changed(u);
                    this._node_changed(f.id)
                }
                if (!o) {
                    this.redraw()
                }
            }
            if (i) {
                i.call(this, e, f, n)
            }
            this.trigger("move_node", {
                node: e,
                parent: f.id,
                position: n,
                old_parent: u,
                old_position: c,
                is_multi: h && h._id && h._id !== this._id,
                is_foreign: !h || !h._id,
                old_instance: h,
                new_instance: this
            });
            return e.id
        },
        copy_node: function (e, t, n, i, r, o, a) {
            var s, l, u, c, f, h, d, p, v, g, _;
            t = this.get_node(t);
            n = n === w ? 0 : n;
            if (!t) {
                return false
            }
            if (!n.toString().match(/^(before|after)$/) && !r && !this.is_loaded(t)) {
                return this.load_node(t, function () {
                    this.copy_node(e, t, n, i, true, false, a)
                })
            }
            if (T.isArray(e)) {
                if (e.length === 1) {
                    e = e[0]
                } else {
                    for (s = 0,
                        l = e.length; s < l; s++) {
                        if (c = this.copy_node(e[s], t, n, i, r, true, a)) {
                            t = c;
                            n = "after"
                        }
                    }
                    this.redraw();
                    return true
                }
            }
            e = e && e.id ? e : this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            p = (e.parent || "#").toString();
            v = !n.toString().match(/^(before|after)$/) || t.id === "#" ? t : this.get_node(t.parent);
            g = a ? a : this._model.data[e.id] ? this : T.jstree.reference(e.id);
            _ = !g || !g._id || this._id !== g._id;
            if (g && g._id) {
                e = g._model.data[e.id]
            }
            if (t.id === "#") {
                if (n === "before") {
                    n = "first"
                }
                if (n === "after") {
                    n = "last"
                }
            }
            switch (n) {
                case "before":
                    n = T.inArray(t.id, v.children);
                    break;
                case "after":
                    n = T.inArray(t.id, v.children) + 1;
                    break;
                case "inside":
                case "first":
                    n = 0;
                    break;
                case "last":
                    n = v.children.length;
                    break;
                default:
                    if (!n) {
                        n = 0
                    }
                    break
            }
            if (n > v.children.length) {
                n = v.children.length
            }
            if (!this.check("copy_node", e, v, n, {
                    core: true,
                    origin: a,
                    is_multi: g && g._id && g._id !== this._id,
                    is_foreign: !g || !g._id
                })) {
                this.settings.core.error.call(this, this._data.core.last_error);
                return false
            }
            d = g ? g.get_json(e, {
                no_id: true,
                no_data: true,
                no_state: true
            }) : e;
            if (!d) {
                return false
            }
            if (d.id === true) {
                delete d.id
            }
            d = this._parse_model_from_json(d, v.id, v.parents.concat());
            if (!d) {
                return false
            }
            c = this.get_node(d);
            if (e && e.state && e.state.loaded === false) {
                c.state.loaded = false
            }
            u = [];
            u.push(d);
            u = u.concat(c.children_d);
            this.trigger("model", {
                nodes: u,
                parent: v.id
            });
            for (f = 0,
                h = v.parents.length; f < h; f++) {
                this._model.data[v.parents[f]].children_d = this._model.data[v.parents[f]].children_d.concat(u)
            }
            u = [];
            for (f = 0,
                h = v.children.length; f < h; f++) {
                u[f >= n ? f + 1 : f] = v.children[f]
            }
            u[n] = c.id;
            v.children = u;
            v.children_d.push(c.id);
            v.children_d = v.children_d.concat(c.children_d);
            if (v.id === "#") {
                this._model.force_full_redraw = true
            }
            if (!this._model.force_full_redraw) {
                this._node_changed(v.id)
            }
            if (!o) {
                this.redraw(v.id === "#")
            }
            if (i) {
                i.call(this, c, v, n)
            }
            this.trigger("copy_node", {
                node: c,
                original: e,
                parent: v.id,
                position: n,
                old_parent: p,
                old_position: g && g._id && p && g._model.data[p] && g._model.data[p].children ? T.inArray(e.id, g._model.data[p].children) : -1,
                is_multi: g && g._id && g._id !== this._id,
                is_foreign: !g || !g._id,
                old_instance: g,
                new_instance: this
            });
            return c.id
        },
        cut: function (e) {
            if (!e) {
                e = this._data.core.selected.concat()
            }
            if (!T.isArray(e)) {
                e = [e]
            }
            if (!e.length) {
                return false
            }
            var t = [],
                n, i, r;
            for (i = 0,
                r = e.length; i < r; i++) {
                n = this.get_node(e[i]);
                if (n && n.id && n.id !== "#") {
                    t.push(n)
                }
            }
            if (!t.length) {
                return false
            }
            o = t;
            s = this;
            a = "move_node";
            this.trigger("cut", {
                node: e
            })
        },
        copy: function (e) {
            if (!e) {
                e = this._data.core.selected.concat()
            }
            if (!T.isArray(e)) {
                e = [e]
            }
            if (!e.length) {
                return false
            }
            var t = [],
                n, i, r;
            for (i = 0,
                r = e.length; i < r; i++) {
                n = this.get_node(e[i]);
                if (n && n.id && n.id !== "#") {
                    t.push(n)
                }
            }
            if (!t.length) {
                return false
            }
            o = t;
            s = this;
            a = "copy_node";
            this.trigger("copy", {
                node: e
            })
        },
        get_buffer: function () {
            return {
                mode: a,
                node: o,
                inst: s
            }
        },
        can_paste: function () {
            return a !== false && o !== false
        },
        paste: function (e, t) {
            e = this.get_node(e);
            if (!e || !a || !a.match(/^(copy_node|move_node)$/) || !o) {
                return false
            }
            if (this[a](o, e, t, false, false, false, s)) {
                this.trigger("paste", {
                    parent: e.id,
                    node: o,
                    mode: a
                })
            }
            o = false;
            a = false;
            s = false
        },
        clear_buffer: function () {
            o = false;
            a = false;
            s = false;
            this.trigger("clear_buffer")
        },
        edit: function (r, e, o) {
            var t, n, a, s, l, u, i, c, f;
            r = this.get_node(r);
            if (!r) {
                return false
            }
            if (this.settings.core.check_callback === false) {
                this._data.core.last_error = {
                    error: "check",
                    plugin: "core",
                    id: "core_07",
                    reason: "Could not edit node because of check_callback"
                };
                this.settings.core.error.call(this, this._data.core.last_error);
                return false
            }
            f = r;
            e = typeof e === "string" ? e : r.text;
            this.set_text(r, "");
            r = this._open_to(r);
            f.text = e;
            t = this._data.core.rtl;
            n = this.element.width();
            a = r.children(".jstree-anchor");
            s = T("<span>");
            l = e;
            u = T("<" + "div />", {
                css: {
                    position: "absolute",
                    top: "-200px",
                    left: t ? "0px" : "-1000px",
                    visibility: "hidden"
                }
            }).appendTo("body");
            i = T("<" + "input />", {
                value: l,
                class: "jstree-rename-input",
                css: {
                    padding: "0",
                    border: "1px solid silver",
                    "box-sizing": "border-box",
                    display: "inline-block",
                    height: this._data.core.li_height + "px",
                    lineHeight: this._data.core.li_height + "px",
                    width: "150px"
                },
                blur: T.proxy(function () {
                    var e = s.children(".jstree-rename-input"),
                        t = e.val(),
                        n = this.settings.core.force_text,
                        i;
                    if (t === "") {
                        t = l
                    }
                    u.remove();
                    s.replaceWith(a);
                    s.remove();
                    l = n ? l : T("<div></div>").append(T.parseHTML(l)).html();
                    this.set_text(r, l);
                    i = !!this.rename_node(r, n ? T("<div></div>").text(t).text() : T("<div></div>").append(T.parseHTML(t)).html());
                    if (!i) {
                        this.set_text(r, l)
                    }
                    if (o) {
                        o.call(this, f, i)
                    }
                }, this),
                keydown: function (e) {
                    var t = e.which;
                    if (t === 27) {
                        this.value = l
                    }
                    if (t === 27 || t === 13 || t === 37 || t === 38 || t === 39 || t === 40 || t === 32) {
                        e.stopImmediatePropagation()
                    }
                    if (t === 27 || t === 13) {
                        e.preventDefault();
                        this.blur()
                    }
                },
                click: function (e) {
                    e.stopImmediatePropagation()
                },
                mousedown: function (e) {
                    e.stopImmediatePropagation()
                },
                keyup: function (e) {
                    i.width(Math.min(u.text("pW" + this.value).width(), n))
                },
                keypress: function (e) {
                    if (e.which === 13) {
                        return false
                    }
                }
            });
            c = {
                fontFamily: a.css("fontFamily") || "",
                fontSize: a.css("fontSize") || "",
                fontWeight: a.css("fontWeight") || "",
                fontStyle: a.css("fontStyle") || "",
                fontStretch: a.css("fontStretch") || "",
                fontVariant: a.css("fontVariant") || "",
                letterSpacing: a.css("letterSpacing") || "",
                wordSpacing: a.css("wordSpacing") || ""
            };
            s.attr("class", a.attr("class")).append(a.contents().clone()).append(i);
            a.replaceWith(s);
            u.css(c);
            i.css(c).width(Math.min(u.text("pW" + i[0].value).width(), n))[0].select()
        },
        set_theme: function (e, t) {
            if (!e) {
                return false
            }
            if (t === true) {
                var n = this.settings.core.themes.dir;
                if (!n) {
                    n = T.jstree.path + "/themes"
                }
                t = n + "/" + e + "/style.css"
            }
            if (t && T.inArray(t, i) === -1) {
                T("head").append("<" + 'link rel="stylesheet" href="' + t + '" type="text/css" />');
                i.push(t)
            }
            if (this._data.core.themes.name) {
                this.element.removeClass("jstree-" + this._data.core.themes.name)
            }
            this._data.core.themes.name = e;
            this.element.addClass("jstree-" + e);
            this.element[this.settings.core.themes.responsive ? "addClass" : "removeClass"]("jstree-" + e + "-responsive");
            this.trigger("set_theme", {
                theme: e
            })
        },
        get_theme: function () {
            return this._data.core.themes.name
        },
        set_theme_variant: function (e) {
            if (this._data.core.themes.variant) {
                this.element.removeClass("jstree-" + this._data.core.themes.name + "-" + this._data.core.themes.variant)
            }
            this._data.core.themes.variant = e;
            if (e) {
                this.element.addClass("jstree-" + this._data.core.themes.name + "-" + this._data.core.themes.variant)
            }
        },
        get_theme_variant: function () {
            return this._data.core.themes.variant
        },
        show_stripes: function () {
            this._data.core.themes.stripes = true;
            this.get_container_ul().addClass("jstree-striped")
        },
        hide_stripes: function () {
            this._data.core.themes.stripes = false;
            this.get_container_ul().removeClass("jstree-striped")
        },
        toggle_stripes: function () {
            if (this._data.core.themes.stripes) {
                this.hide_stripes()
            } else {
                this.show_stripes()
            }
        },
        show_dots: function () {
            this._data.core.themes.dots = true;
            this.get_container_ul().removeClass("jstree-no-dots")
        },
        hide_dots: function () {
            this._data.core.themes.dots = false;
            this.get_container_ul().addClass("jstree-no-dots")
        },
        toggle_dots: function () {
            if (this._data.core.themes.dots) {
                this.hide_dots()
            } else {
                this.show_dots()
            }
        },
        show_icons: function () {
            this._data.core.themes.icons = true;
            this.get_container_ul().removeClass("jstree-no-icons")
        },
        hide_icons: function () {
            this._data.core.themes.icons = false;
            this.get_container_ul().addClass("jstree-no-icons")
        },
        toggle_icons: function () {
            if (this._data.core.themes.icons) {
                this.hide_icons()
            } else {
                this.show_icons()
            }
        },
        set_icon: function (e, t) {
            var n, i, r, o;
            if (T.isArray(e)) {
                e = e.slice();
                for (n = 0,
                    i = e.length; n < i; n++) {
                    this.set_icon(e[n], t)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            o = e.icon;
            e.icon = t === true || t === null || t === w || t === "" ? true : t;
            r = this.get_node(e, true).children(".jstree-anchor").children(".jstree-themeicon");
            if (t === false) {
                this.hide_icon(e)
            } else if (t === true || t === null || t === w || t === "") {
                r.removeClass("jstree-themeicon-custom " + o).css("background", "").removeAttr("rel");
                if (o === false) {
                    this.show_icon(e)
                }
            } else if (t.indexOf("/") === -1 && t.indexOf(".") === -1) {
                r.removeClass(o).css("background", "");
                r.addClass(t + " jstree-themeicon-custom").attr("rel", t);
                if (o === false) {
                    this.show_icon(e)
                }
            } else {
                r.removeClass(o).css("background", "");
                r.addClass("jstree-themeicon-custom").css("background", "url('" + t + "') center center no-repeat").attr("rel", t);
                if (o === false) {
                    this.show_icon(e)
                }
            }
            return true
        },
        get_icon: function (e) {
            e = this.get_node(e);
            return !e || e.id === "#" ? false : e.icon
        },
        hide_icon: function (e) {
            var t, n;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    n = e.length; t < n; t++) {
                    this.hide_icon(e[t])
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e === "#") {
                return false
            }
            e.icon = false;
            this.get_node(e, true).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");
            return true
        },
        show_icon: function (e) {
            var t, n, i;
            if (T.isArray(e)) {
                e = e.slice();
                for (t = 0,
                    n = e.length; t < n; t++) {
                    this.show_icon(e[t])
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e === "#") {
                return false
            }
            i = this.get_node(e, true);
            e.icon = i.length ? i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel") : true;
            if (!e.icon) {
                e.icon = true
            }
            i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");
            return true
        }
    };
    T.vakata = {};
    T.vakata.attributes = function (e, n) {
        e = T(e)[0];
        var i = n ? {} : [];
        if (e && e.attributes) {
            T.each(e.attributes, function (e, t) {
                if (T.inArray(t.name.toLowerCase(), ["style", "contenteditable", "hasfocus", "tabindex"]) !== -1) {
                    return
                }
                if (t.value !== null && T.trim(t.value) !== "") {
                    if (n) {
                        i[t.name] = t.value
                    } else {
                        i.push(t.name)
                    }
                }
            })
        }
        return i
    };
    T.vakata.array_unique = function (e) {
        var t = [],
            n, i, r, o = {};
        for (n = 0,
            r = e.length; n < r; n++) {
            if (o[e[n]] === w) {
                t.push(e[n]);
                o[e[n]] = true
            }
        }
        return t
    };
    T.vakata.array_remove = function (e, t, n) {
        var i = e.slice((n || t) + 1 || e.length);
        e.length = t < 0 ? e.length + t : t;
        e.push.apply(e, i);
        return e
    };
    T.vakata.array_remove_item = function (e, t) {
        var n = T.inArray(t, e);
        return n !== -1 ? T.vakata.array_remove(e, n) : e
    };
    var u = m.createElement("I");
    u.className = "jstree-icon jstree-checkbox";
    u.setAttribute("role", "presentation");
    T.jstree.defaults.checkbox = {
        visible: true,
        three_state: true,
        whole_node: true,
        keep_selected_style: true,
        cascade: "",
        tie_selection: true
    };
    T.jstree.plugins.checkbox = function (e, l) {
        this.bind = function () {
            l.bind.call(this);
            this._data.checkbox.uto = false;
            this._data.checkbox.selected = [];
            if (this.settings.checkbox.three_state) {
                this.settings.checkbox.cascade = "up+down+undetermined"
            }
            this.element.on("init.jstree", T.proxy(function () {
                this._data.checkbox.visible = this.settings.checkbox.visible;
                if (!this.settings.checkbox.keep_selected_style) {
                    this.element.addClass("jstree-checkbox-no-clicked")
                }
                if (this.settings.checkbox.tie_selection) {
                    this.element.addClass("jstree-checkbox-selection")
                }
            }, this)).on("loading.jstree", T.proxy(function () {
                this[this._data.checkbox.visible ? "show_checkboxes" : "hide_checkboxes"]()
            }, this));
            if (this.settings.checkbox.cascade.indexOf("undetermined") !== -1) {
                this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree", T.proxy(function () {
                    if (this._data.checkbox.uto) {
                        clearTimeout(this._data.checkbox.uto)
                    }
                    this._data.checkbox.uto = setTimeout(T.proxy(this._undetermined, this), 50)
                }, this))
            }
            if (!this.settings.checkbox.tie_selection) {
                this.element.on("model.jstree", T.proxy(function (e, t) {
                    var n = this._model.data,
                        i = n[t.parent],
                        r = t.nodes,
                        o, a;
                    for (o = 0,
                        a = r.length; o < a; o++) {
                        n[r[o]].state.checked = n[r[o]].original && n[r[o]].original.state && n[r[o]].original.state.checked;
                        if (n[r[o]].state.checked) {
                            this._data.checkbox.selected.push(r[o])
                        }
                    }
                }, this))
            }
            if (this.settings.checkbox.cascade.indexOf("up") !== -1 || this.settings.checkbox.cascade.indexOf("down") !== -1) {
                this.element.on("model.jstree", T.proxy(function (e, t) {
                    var n = this._model.data,
                        i = n[t.parent],
                        r = t.nodes,
                        o = [],
                        a, s, l, u, c, f, h = this.settings.checkbox.cascade,
                        d = this.settings.checkbox.tie_selection;
                    if (h.indexOf("down") !== -1) {
                        if (i.state[d ? "selected" : "checked"]) {
                            for (s = 0,
                                l = r.length; s < l; s++) {
                                n[r[s]].state[d ? "selected" : "checked"] = true
                            }
                            this._data[d ? "core" : "checkbox"].selected = this._data[d ? "core" : "checkbox"].selected.concat(r)
                        } else {
                            for (s = 0,
                                l = r.length; s < l; s++) {
                                if (n[r[s]].state[d ? "selected" : "checked"]) {
                                    for (u = 0,
                                        c = n[r[s]].children_d.length; u < c; u++) {
                                        n[n[r[s]].children_d[u]].state[d ? "selected" : "checked"] = true
                                    }
                                    this._data[d ? "core" : "checkbox"].selected = this._data[d ? "core" : "checkbox"].selected.concat(n[r[s]].children_d)
                                }
                            }
                        }
                    }
                    if (h.indexOf("up") !== -1) {
                        for (s = 0,
                            l = i.children_d.length; s < l; s++) {
                            if (!n[i.children_d[s]].children.length) {
                                o.push(n[i.children_d[s]].parent)
                            }
                        }
                        o = T.vakata.array_unique(o);
                        for (u = 0,
                            c = o.length; u < c; u++) {
                            i = n[o[u]];
                            while (i && i.id !== "#") {
                                a = 0;
                                for (s = 0,
                                    l = i.children.length; s < l; s++) {
                                    a += n[i.children[s]].state[d ? "selected" : "checked"]
                                }
                                if (a === l) {
                                    i.state[d ? "selected" : "checked"] = true;
                                    this._data[d ? "core" : "checkbox"].selected.push(i.id);
                                    f = this.get_node(i, true);
                                    if (f && f.length) {
                                        f.attr("aria-selected", true).children(".jstree-anchor").addClass(d ? "jstree-clicked" : "jstree-checked")
                                    }
                                } else {
                                    break
                                }
                                i = this.get_node(i.parent)
                            }
                        }
                    }
                    this._data[d ? "core" : "checkbox"].selected = T.vakata.array_unique(this._data[d ? "core" : "checkbox"].selected)
                }, this)).on(this.settings.checkbox.tie_selection ? "select_node.jstree" : "check_node.jstree", T.proxy(function (e, t) {
                    var n = t.node,
                        i = this._model.data,
                        r = this.get_node(n.parent),
                        o = this.get_node(n, true),
                        a, s, l, u, c = this.settings.checkbox.cascade,
                        f = this.settings.checkbox.tie_selection;
                    if (c.indexOf("down") !== -1) {
                        this._data[f ? "core" : "checkbox"].selected = T.vakata.array_unique(this._data[f ? "core" : "checkbox"].selected.concat(n.children_d));
                        for (a = 0,
                            s = n.children_d.length; a < s; a++) {
                            u = i[n.children_d[a]];
                            u.state[f ? "selected" : "checked"] = true;
                            if (u && u.original && u.original.state && u.original.state.undetermined) {
                                u.original.state.undetermined = false
                            }
                        }
                    }
                    if (c.indexOf("up") !== -1) {
                        while (r && r.id !== "#") {
                            l = 0;
                            for (a = 0,
                                s = r.children.length; a < s; a++) {
                                l += i[r.children[a]].state[f ? "selected" : "checked"]
                            }
                            if (l === s) {
                                r.state[f ? "selected" : "checked"] = true;
                                this._data[f ? "core" : "checkbox"].selected.push(r.id);
                                u = this.get_node(r, true);
                                if (u && u.length) {
                                    u.attr("aria-selected", true).children(".jstree-anchor").addClass(f ? "jstree-clicked" : "jstree-checked")
                                }
                            } else {
                                break
                            }
                            r = this.get_node(r.parent)
                        }
                    }
                    if (c.indexOf("down") !== -1 && o.length) {
                        o.find(".jstree-anchor").addClass(f ? "jstree-clicked" : "jstree-checked").parent().attr("aria-selected", true)
                    }
                }, this)).on(this.settings.checkbox.tie_selection ? "deselect_all.jstree" : "uncheck_all.jstree", T.proxy(function (e, t) {
                    var n = this.get_node("#"),
                        i = this._model.data,
                        r, o, a;
                    for (r = 0,
                        o = n.children_d.length; r < o; r++) {
                        a = i[n.children_d[r]];
                        if (a && a.original && a.original.state && a.original.state.undetermined) {
                            a.original.state.undetermined = false
                        }
                    }
                }, this)).on(this.settings.checkbox.tie_selection ? "deselect_node.jstree" : "uncheck_node.jstree", T.proxy(function (e, t) {
                    var n = t.node,
                        i = this.get_node(n, true),
                        r, o, a, s = this.settings.checkbox.cascade,
                        l = this.settings.checkbox.tie_selection;
                    if (n && n.original && n.original.state && n.original.state.undetermined) {
                        n.original.state.undetermined = false
                    }
                    if (s.indexOf("down") !== -1) {
                        for (r = 0,
                            o = n.children_d.length; r < o; r++) {
                            a = this._model.data[n.children_d[r]];
                            a.state[l ? "selected" : "checked"] = false;
                            if (a && a.original && a.original.state && a.original.state.undetermined) {
                                a.original.state.undetermined = false
                            }
                        }
                    }
                    if (s.indexOf("up") !== -1) {
                        for (r = 0,
                            o = n.parents.length; r < o; r++) {
                            a = this._model.data[n.parents[r]];
                            a.state[l ? "selected" : "checked"] = false;
                            if (a && a.original && a.original.state && a.original.state.undetermined) {
                                a.original.state.undetermined = false
                            }
                            a = this.get_node(n.parents[r], true);
                            if (a && a.length) {
                                a.attr("aria-selected", false).children(".jstree-anchor").removeClass(l ? "jstree-clicked" : "jstree-checked")
                            }
                        }
                    }
                    a = [];
                    for (r = 0,
                        o = this._data[l ? "core" : "checkbox"].selected.length; r < o; r++) {
                        if ((s.indexOf("down") === -1 || T.inArray(this._data[l ? "core" : "checkbox"].selected[r], n.children_d) === -1) && (s.indexOf("up") === -1 || T.inArray(this._data[l ? "core" : "checkbox"].selected[r], n.parents) === -1)) {
                            a.push(this._data[l ? "core" : "checkbox"].selected[r])
                        }
                    }
                    this._data[l ? "core" : "checkbox"].selected = T.vakata.array_unique(a);
                    if (s.indexOf("down") !== -1 && i.length) {
                        i.find(".jstree-anchor").removeClass(l ? "jstree-clicked" : "jstree-checked").parent().attr("aria-selected", false)
                    }
                }, this))
            }
            if (this.settings.checkbox.cascade.indexOf("up") !== -1) {
                this.element.on("delete_node.jstree", T.proxy(function (e, t) {
                    var n = this.get_node(t.parent),
                        i = this._model.data,
                        r, o, a, s, l = this.settings.checkbox.tie_selection;
                    while (n && n.id !== "#") {
                        a = 0;
                        for (r = 0,
                            o = n.children.length; r < o; r++) {
                            a += i[n.children[r]].state[l ? "selected" : "checked"]
                        }
                        if (a === o) {
                            n.state[l ? "selected" : "checked"] = true;
                            this._data[l ? "core" : "checkbox"].selected.push(n.id);
                            s = this.get_node(n, true);
                            if (s && s.length) {
                                s.attr("aria-selected", true).children(".jstree-anchor").addClass(l ? "jstree-clicked" : "jstree-checked")
                            }
                        } else {
                            break
                        }
                        n = this.get_node(n.parent)
                    }
                }, this)).on("move_node.jstree", T.proxy(function (e, t) {
                    var n = t.is_multi,
                        i = t.old_parent,
                        r = this.get_node(t.parent),
                        o = this._model.data,
                        a, s, l, u, c, f = this.settings.checkbox.tie_selection;
                    if (!n) {
                        a = this.get_node(i);
                        while (a && a.id !== "#") {
                            s = 0;
                            for (l = 0,
                                u = a.children.length; l < u; l++) {
                                s += o[a.children[l]].state[f ? "selected" : "checked"]
                            }
                            if (s === u) {
                                a.state[f ? "selected" : "checked"] = true;
                                this._data[f ? "core" : "checkbox"].selected.push(a.id);
                                c = this.get_node(a, true);
                                if (c && c.length) {
                                    c.attr("aria-selected", true).children(".jstree-anchor").addClass(f ? "jstree-clicked" : "jstree-checked")
                                }
                            } else {
                                break
                            }
                            a = this.get_node(a.parent)
                        }
                    }
                    a = r;
                    while (a && a.id !== "#") {
                        s = 0;
                        for (l = 0,
                            u = a.children.length; l < u; l++) {
                            s += o[a.children[l]].state[f ? "selected" : "checked"]
                        }
                        if (s === u) {
                            if (!a.state[f ? "selected" : "checked"]) {
                                a.state[f ? "selected" : "checked"] = true;
                                this._data[f ? "core" : "checkbox"].selected.push(a.id);
                                c = this.get_node(a, true);
                                if (c && c.length) {
                                    c.attr("aria-selected", true).children(".jstree-anchor").addClass(f ? "jstree-clicked" : "jstree-checked")
                                }
                            }
                        } else {
                            if (a.state[f ? "selected" : "checked"]) {
                                a.state[f ? "selected" : "checked"] = false;
                                this._data[f ? "core" : "checkbox"].selected = T.vakata.array_remove_item(this._data[f ? "core" : "checkbox"].selected, a.id);
                                c = this.get_node(a, true);
                                if (c && c.length) {
                                    c.attr("aria-selected", false).children(".jstree-anchor").removeClass(f ? "jstree-clicked" : "jstree-checked")
                                }
                            } else {
                                break
                            }
                        }
                        a = this.get_node(a.parent)
                    }
                }, this))
            }
        };
        this._undetermined = function () {
            if (this.element === null) {
                return
            }
            var n, i, r, o, a = {},
                s = this._model.data,
                e = this.settings.checkbox.tie_selection,
                t = this._data[e ? "core" : "checkbox"].selected,
                l = [],
                u = this;
            for (n = 0,
                i = t.length; n < i; n++) {
                if (s[t[n]] && s[t[n]].parents) {
                    for (r = 0,
                        o = s[t[n]].parents.length; r < o; r++) {
                        if (a[s[t[n]].parents[r]] === w && s[t[n]].parents[r] !== "#") {
                            a[s[t[n]].parents[r]] = true;
                            l.push(s[t[n]].parents[r])
                        }
                    }
                }
            }
            this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function () {
                var e = u.get_node(this),
                    t;
                if (!e.state.loaded) {
                    if (e.original && e.original.state && e.original.state.undetermined && e.original.state.undetermined === true) {
                        if (a[e.id] === w && e.id !== "#") {
                            a[e.id] = true;
                            l.push(e.id)
                        }
                        for (r = 0,
                            o = e.parents.length; r < o; r++) {
                            if (a[e.parents[r]] === w && e.parents[r] !== "#") {
                                a[e.parents[r]] = true;
                                l.push(e.parents[r])
                            }
                        }
                    }
                } else {
                    for (n = 0,
                        i = e.children_d.length; n < i; n++) {
                        t = s[e.children_d[n]];
                        if (!t.state.loaded && t.original && t.original.state && t.original.state.undetermined && t.original.state.undetermined === true) {
                            if (a[t.id] === w && t.id !== "#") {
                                a[t.id] = true;
                                l.push(t.id)
                            }
                            for (r = 0,
                                o = t.parents.length; r < o; r++) {
                                if (a[t.parents[r]] === w && t.parents[r] !== "#") {
                                    a[t.parents[r]] = true;
                                    l.push(t.parents[r])
                                }
                            }
                        }
                    }
                }
            });
            this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");
            for (n = 0,
                i = l.length; n < i; n++) {
                if (!s[l[n]].state[e ? "selected" : "checked"]) {
                    t = this.get_node(l[n], true);
                    if (t && t.length) {
                        t.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")
                    }
                }
            }
        };
        this.redraw_node = function (e, t, n, i) {
            e = l.redraw_node.apply(this, arguments);
            if (e) {
                var r, o, a = null;
                for (r = 0,
                    o = e.childNodes.length; r < o; r++) {
                    if (e.childNodes[r] && e.childNodes[r].className && e.childNodes[r].className.indexOf("jstree-anchor") !== -1) {
                        a = e.childNodes[r];
                        break
                    }
                }
                if (a) {
                    if (!this.settings.checkbox.tie_selection && this._model.data[e.id].state.checked) {
                        a.className += " jstree-checked"
                    }
                    a.insertBefore(u.cloneNode(false), a.childNodes[0])
                }
            }
            if (!n && this.settings.checkbox.cascade.indexOf("undetermined") !== -1) {
                if (this._data.checkbox.uto) {
                    clearTimeout(this._data.checkbox.uto)
                }
                this._data.checkbox.uto = setTimeout(T.proxy(this._undetermined, this), 50)
            }
            return e
        };
        this.show_checkboxes = function () {
            this._data.core.themes.checkboxes = true;
            this.get_container_ul().removeClass("jstree-no-checkboxes")
        };
        this.hide_checkboxes = function () {
            this._data.core.themes.checkboxes = false;
            this.get_container_ul().addClass("jstree-no-checkboxes")
        };
        this.toggle_checkboxes = function () {
            if (this._data.core.themes.checkboxes) {
                this.hide_checkboxes()
            } else {
                this.show_checkboxes()
            }
        };
        this.is_undetermined = function (e) {
            e = this.get_node(e);
            var t = this.settings.checkbox.cascade,
                n, i, r = this.settings.checkbox.tie_selection,
                o = this._data[r ? "core" : "checkbox"].selected,
                a = this._model.data;
            if (!e || e.state[r ? "selected" : "checked"] === true || t.indexOf("undetermined") === -1 || t.indexOf("down") === -1 && t.indexOf("up") === -1) {
                return false
            }
            if (!e.state.loaded && e.original.state.undetermined === true) {
                return true
            }
            for (n = 0,
                i = e.children_d.length; n < i; n++) {
                if (T.inArray(e.children_d[n], o) !== -1 || !a[e.children_d[n]].state.loaded && a[e.children_d[n]].original.state.undetermined) {
                    return true
                }
            }
            return false
        };
        this.activate_node = function (e, t) {
            if (this.settings.checkbox.tie_selection && (this.settings.checkbox.whole_node || T(t.target).hasClass("jstree-checkbox"))) {
                t.ctrlKey = true
            }
            if (this.settings.checkbox.tie_selection || !this.settings.checkbox.whole_node && !T(t.target).hasClass("jstree-checkbox")) {
                return l.activate_node.call(this, e, t)
            }
            if (this.is_disabled(e)) {
                return false
            }
            if (this.is_checked(e)) {
                this.uncheck_node(e, t)
            } else {
                this.check_node(e, t)
            }
            this.trigger("activate_node", {
                node: this.get_node(e)
            })
        };
        this.check_node = function (e, t) {
            if (this.settings.checkbox.tie_selection) {
                return this.select_node(e, false, true, t)
            }
            var n, i, r, o;
            if (T.isArray(e)) {
                e = e.slice();
                for (i = 0,
                    r = e.length; i < r; i++) {
                    this.check_node(e[i], t)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            n = this.get_node(e, true);
            if (!e.state.checked) {
                e.state.checked = true;
                this._data.checkbox.selected.push(e.id);
                if (n && n.length) {
                    n.children(".jstree-anchor").addClass("jstree-checked")
                }
                this.trigger("check_node", {
                    node: e,
                    selected: this._data.checkbox.selected,
                    event: t
                })
            }
        };
        this.uncheck_node = function (e, t) {
            if (this.settings.checkbox.tie_selection) {
                return this.deselect_node(e, false, t)
            }
            var n, i, r;
            if (T.isArray(e)) {
                e = e.slice();
                for (n = 0,
                    i = e.length; n < i; n++) {
                    this.uncheck_node(e[n], t)
                }
                return true
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            r = this.get_node(e, true);
            if (e.state.checked) {
                e.state.checked = false;
                this._data.checkbox.selected = T.vakata.array_remove_item(this._data.checkbox.selected, e.id);
                if (r.length) {
                    r.children(".jstree-anchor").removeClass("jstree-checked")
                }
                this.trigger("uncheck_node", {
                    node: e,
                    selected: this._data.checkbox.selected,
                    event: t
                })
            }
        };
        this.check_all = function () {
            if (this.settings.checkbox.tie_selection) {
                return this.select_all()
            }
            var e = this._data.checkbox.selected.concat([]),
                t, n;
            this._data.checkbox.selected = this._model.data["#"].children_d.concat();
            for (t = 0,
                n = this._data.checkbox.selected.length; t < n; t++) {
                if (this._model.data[this._data.checkbox.selected[t]]) {
                    this._model.data[this._data.checkbox.selected[t]].state.checked = true
                }
            }
            this.redraw(true);
            this.trigger("check_all", {
                selected: this._data.checkbox.selected
            })
        };
        this.uncheck_all = function () {
            if (this.settings.checkbox.tie_selection) {
                return this.deselect_all()
            }
            var e = this._data.checkbox.selected.concat([]),
                t, n;
            for (t = 0,
                n = this._data.checkbox.selected.length; t < n; t++) {
                if (this._model.data[this._data.checkbox.selected[t]]) {
                    this._model.data[this._data.checkbox.selected[t]].state.checked = false
                }
            }
            this._data.checkbox.selected = [];
            this.element.find(".jstree-checked").removeClass("jstree-checked");
            this.trigger("uncheck_all", {
                selected: this._data.checkbox.selected,
                node: e
            })
        };
        this.is_checked = function (e) {
            if (this.settings.checkbox.tie_selection) {
                return this.is_selected(e)
            }
            e = this.get_node(e);
            if (!e || e.id === "#") {
                return false
            }
            return e.state.checked
        };
        this.get_checked = function (e) {
            if (this.settings.checkbox.tie_selection) {
                return this.get_selected(e)
            }
            return e ? T.map(this._data.checkbox.selected, T.proxy(function (e) {
                return this.get_node(e)
            }, this)) : this._data.checkbox.selected
        };
        this.get_top_checked = function (e) {
            if (this.settings.checkbox.tie_selection) {
                return this.get_top_selected(e)
            }
            var t = this.get_checked(true),
                n = {},
                i, r, o, a;
            for (i = 0,
                r = t.length; i < r; i++) {
                n[t[i].id] = t[i]
            }
            for (i = 0,
                r = t.length; i < r; i++) {
                for (o = 0,
                    a = t[i].children_d.length; o < a; o++) {
                    if (n[t[i].children_d[o]]) {
                        delete n[t[i].children_d[o]]
                    }
                }
            }
            t = [];
            for (i in n) {
                if (n.hasOwnProperty(i)) {
                    t.push(i)
                }
            }
            return e ? T.map(t, T.proxy(function (e) {
                return this.get_node(e)
            }, this)) : t
        };
        this.get_bottom_checked = function (e) {
            if (this.settings.checkbox.tie_selection) {
                return this.get_bottom_selected(e)
            }
            var t = this.get_checked(true),
                n = [],
                i, r;
            for (i = 0,
                r = t.length; i < r; i++) {
                if (!t[i].children.length) {
                    n.push(t[i].id)
                }
            }
            return e ? T.map(n, T.proxy(function (e) {
                return this.get_node(e)
            }, this)) : n
        };
        this.load_node = function (e, t) {
            var n, i, r, o, a, s;
            if (!T.isArray(e) && !this.settings.checkbox.tie_selection) {
                s = this.get_node(e);
                if (s && s.state.loaded) {
                    for (n = 0,
                        i = s.children_d.length; n < i; n++) {
                        if (this._model.data[s.children_d[n]].state.checked) {
                            a = true;
                            this._data.checkbox.selected = T.vakata.array_remove_item(this._data.checkbox.selected, s.children_d[n])
                        }
                    }
                }
            }
            return l.load_node.apply(this, arguments)
        };
        this.get_state = function () {
            var e = l.get_state.apply(this, arguments);
            if (this.settings.checkbox.tie_selection) {
                return e
            }
            e.checkbox = this._data.checkbox.selected.slice();
            return e
        };
        this.set_state = function (e, t) {
            var n = l.set_state.apply(this, arguments);
            if (n && e.checkbox) {
                if (!this.settings.checkbox.tie_selection) {
                    this.uncheck_all();
                    var i = this;
                    T.each(e.checkbox, function (e, t) {
                        i.check_node(t)
                    })
                }
                delete e.checkbox;
                this.set_state(e, t);
                return false
            }
            return n
        }
    };
    T.jstree.defaults.contextmenu = {
        select_node: true,
        show_at_node: true,
        items: function (e, t) {
            return {
                create: {
                    separator_before: false,
                    separator_after: true,
                    _disabled: false,
                    label: "Create",
                    action: function (e) {
                        var t = T.jstree.reference(e.reference),
                            n = t.get_node(e.reference);
                        t.create_node(n, {}, "last", function (e) {
                            setTimeout(function () {
                                t.edit(e)
                            }, 0)
                        })
                    }
                },
                rename: {
                    separator_before: false,
                    separator_after: false,
                    _disabled: false,
                    label: "Rename",
                    action: function (e) {
                        var t = T.jstree.reference(e.reference),
                            n = t.get_node(e.reference);
                        t.edit(n)
                    }
                },
                remove: {
                    separator_before: false,
                    icon: false,
                    separator_after: false,
                    _disabled: false,
                    label: "Delete",
                    action: function (e) {
                        var t = T.jstree.reference(e.reference),
                            n = t.get_node(e.reference);
                        if (t.is_selected(n)) {
                            t.delete_node(t.get_selected())
                        } else {
                            t.delete_node(n)
                        }
                    }
                },
                ccp: {
                    separator_before: true,
                    icon: false,
                    separator_after: false,
                    label: "Edit",
                    action: false,
                    submenu: {
                        cut: {
                            separator_before: false,
                            separator_after: false,
                            label: "Cut",
                            action: function (e) {
                                var t = T.jstree.reference(e.reference),
                                    n = t.get_node(e.reference);
                                if (t.is_selected(n)) {
                                    t.cut(t.get_top_selected())
                                } else {
                                    t.cut(n)
                                }
                            }
                        },
                        copy: {
                            separator_before: false,
                            icon: false,
                            separator_after: false,
                            label: "Copy",
                            action: function (e) {
                                var t = T.jstree.reference(e.reference),
                                    n = t.get_node(e.reference);
                                if (t.is_selected(n)) {
                                    t.copy(t.get_top_selected())
                                } else {
                                    t.copy(n)
                                }
                            }
                        },
                        paste: {
                            separator_before: false,
                            icon: false,
                            _disabled: function (e) {
                                return !T.jstree.reference(e.reference).can_paste()
                            },
                            separator_after: false,
                            label: "Paste",
                            action: function (e) {
                                var t = T.jstree.reference(e.reference),
                                    n = t.get_node(e.reference);
                                t.paste(n)
                            }
                        }
                    }
                }
            }
        }
    };
    T.jstree.plugins.contextmenu = function (e, o) {
        this.bind = function () {
            o.bind.call(this);
            var n = 0,
                i = null,
                t, r;
            this.element.on("contextmenu.jstree", ".jstree-anchor", T.proxy(function (e, t) {
                e.preventDefault();
                n = e.ctrlKey ? +new Date : 0;
                if (t || i) {
                    n = +new Date + 1e4
                }
                if (i) {
                    clearTimeout(i)
                }
                if (!this.is_loading(e.currentTarget)) {
                    this.show_contextmenu(e.currentTarget, e.pageX, e.pageY, e)
                }
            }, this)).on("click.jstree", ".jstree-anchor", T.proxy(function (e) {
                if (this._data.contextmenu.visible && (!n || +new Date - n > 250)) {
                    T.vakata.context.hide()
                }
                n = 0
            }, this)).on("touchstart.jstree", ".jstree-anchor", function (e) {
                if (!e.originalEvent || !e.originalEvent.changedTouches || !e.originalEvent.changedTouches[0]) {
                    return
                }
                t = e.pageX;
                r = e.pageY;
                i = setTimeout(function () {
                    T(e.currentTarget).trigger("contextmenu", true)
                }, 750)
            }).on("touchmove.vakata.jstree", function (e) {
                if (i && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0] && (Math.abs(t - e.pageX) > 50 || Math.abs(r - e.pageY) > 50)) {
                    clearTimeout(i)
                }
            }).on("touchend.vakata.jstree", function (e) {
                if (i) {
                    clearTimeout(i)
                }
            });
            T(m).on("context_hide.vakata.jstree", T.proxy(function () {
                this._data.contextmenu.visible = false
            }, this))
        };
        this.teardown = function () {
            if (this._data.contextmenu.visible) {
                T.vakata.context.hide()
            }
            o.teardown.call(this)
        };
        this.show_contextmenu = function (t, n, i, e) {
            t = this.get_node(t);
            if (!t || t.id === "#") {
                return false
            }
            var r = this.settings.contextmenu,
                o = this.get_node(t, true),
                a = o.children(".jstree-anchor"),
                s = false,
                l = false;
            if (r.show_at_node || n === w || i === w) {
                s = a.offset();
                n = s.left;
                i = s.top + this._data.core.li_height
            }
            if (this.settings.contextmenu.select_node && !this.is_selected(t)) {
                this.activate_node(t, e)
            }
            l = r.items;
            if (T.isFunction(l)) {
                l = l.call(this, t, T.proxy(function (e) {
                    this._show_contextmenu(t, n, i, e)
                }, this))
            }
            if (T.isPlainObject(l)) {
                this._show_contextmenu(t, n, i, l)
            }
        };
        this._show_contextmenu = function (e, t, n, i) {
            var r = this.get_node(e, true),
                o = r.children(".jstree-anchor");
            T(m).one("context_show.vakata.jstree", T.proxy(function (e, t) {
                var n = "jstree-contextmenu jstree-" + this.get_theme() + "-contextmenu";
                T(t.element).addClass(n)
            }, this));
            this._data.contextmenu.visible = true;
            T.vakata.context.show(o, {
                x: t,
                y: n
            }, i);
            this.trigger("show_contextmenu", {
                node: e,
                x: t,
                y: n
            })
        }
    };
    (function (h) {
        var d = false,
            p = {
                element: false,
                reference: false,
                position_x: 0,
                position_y: 0,
                items: [],
                html: "",
                is_visible: false
            };
        h.vakata.context = {
            settings: {
                hide_onmouseleave: 0,
                icons: true
            },
            _trigger: function (e) {
                h(m).triggerHandler("context_" + e + ".vakata", {
                    reference: p.reference,
                    element: p.element,
                    position: {
                        x: p.position_x,
                        y: p.position_y
                    }
                })
            },
            _execute: function (e) {
                e = p.items[e];
                return e && (!e._disabled || h.isFunction(e._disabled) && !e._disabled({
                    item: e,
                    reference: p.reference,
                    element: p.element
                })) && e.action ? e.action.call(null, {
                    item: e,
                    reference: p.reference,
                    element: p.element,
                    position: {
                        x: p.position_x,
                        y: p.position_y
                    }
                }) : false
            },
            _parse: function (e, t) {
                if (!e) {
                    return false
                }
                if (!t) {
                    p.html = "";
                    p.items = []
                }
                var n = "",
                    i = false,
                    r;
                if (t) {
                    n += "<" + "ul>"
                }
                h.each(e, function (e, t) {
                    if (!t) {
                        return true
                    }
                    p.items.push(t);
                    if (!i && t.separator_before) {
                        n += "<" + "li class='vakata-context-separator'><" + "a href='#' " + (h.vakata.context.settings.icons ? "" : 'style="margin-left:0px;"') + ">&#160;<" + "/a><" + "/li>"
                    }
                    i = false;
                    n += "<" + "li class='" + (t._class || "") + (t._disabled === true || h.isFunction(t._disabled) && t._disabled({
                        item: t,
                        reference: p.reference,
                        element: p.element
                    }) ? " vakata-contextmenu-disabled " : "") + "' " + (t.shortcut ? " data-shortcut='" + t.shortcut + "' " : "") + ">";
                    n += "<" + "a href='#' rel='" + (p.items.length - 1) + "'>";
                    if (h.vakata.context.settings.icons) {
                        n += "<" + "i ";
                        if (t.icon) {
                            if (t.icon.indexOf("/") !== -1 || t.icon.indexOf(".") !== -1) {
                                n += " style='background:url(\"" + t.icon + "\") center center no-repeat' "
                            } else {
                                n += " class='" + t.icon + "' "
                            }
                        }
                        n += "><" + "/i><" + "span class='vakata-contextmenu-sep'>&#160;<" + "/span>"
                    }
                    n += (h.isFunction(t.label) ? t.label({
                        item: e,
                        reference: p.reference,
                        element: p.element
                    }) : t.label) + (t.shortcut ? ' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-' + t.shortcut + '">' + (t.shortcut_label || "") + "</span>" : "") + "<" + "/a>";
                    if (t.submenu) {
                        r = h.vakata.context._parse(t.submenu, true);
                        if (r) {
                            n += r
                        }
                    }
                    n += "<" + "/li>";
                    if (t.separator_after) {
                        n += "<" + "li class='vakata-context-separator'><" + "a href='#' " + (h.vakata.context.settings.icons ? "" : 'style="margin-left:0px;"') + ">&#160;<" + "/a><" + "/li>";
                        i = true
                    }
                });
                n = n.replace(/<li class\='vakata-context-separator'\><\/li\>$/, "");
                if (t) {
                    n += "</ul>"
                }
                if (!t) {
                    p.html = n;
                    h.vakata.context._trigger("parse")
                }
                return n.length > 10 ? n : false
            },
            _show_submenu: function (e) {
                e = h(e);
                if (!e.length || !e.children("ul").length) {
                    return
                }
                var t = e.children("ul"),
                    n = e.offset().left + e.outerWidth(),
                    i = e.offset().top,
                    r = t.width(),
                    o = t.height(),
                    a = h(window).width() + h(window).scrollLeft(),
                    s = h(window).height() + h(window).scrollTop();
                if (d) {
                    e[n - (r + 10 + e.outerWidth()) < 0 ? "addClass" : "removeClass"]("vakata-context-left")
                } else {
                    e[n + r + 10 > a ? "addClass" : "removeClass"]("vakata-context-right")
                }
                if (i + o + 10 > s) {
                    t.css("bottom", "-1px")
                }
                t.show()
            },
            show: function (e, t, n) {
                var i, r, o, a, s, l, u, c, f = true;
                if (p.element && p.element.length) {
                    p.element.width("")
                }
                switch (f) {
                    case !t && !e:
                        return false;
                    case !!t && !!e:
                        p.reference = e;
                        p.position_x = t.x;
                        p.position_y = t.y;
                        break;
                    case !t && !!e:
                        p.reference = e;
                        i = e.offset();
                        p.position_x = i.left + e.outerHeight();
                        p.position_y = i.top;
                        break;
                    case !!t && !e:
                        p.position_x = t.x;
                        p.position_y = t.y;
                        break
                }
                if (!!e && !n && h(e).data("vakata_contextmenu")) {
                    n = h(e).data("vakata_contextmenu")
                }
                if (h.vakata.context._parse(n)) {
                    p.element.html(p.html)
                }
                if (p.items.length) {
                    p.element.appendTo("body");
                    r = p.element;
                    o = p.position_x;
                    a = p.position_y;
                    s = r.width();
                    l = r.height();
                    u = h(window).width() + h(window).scrollLeft();
                    c = h(window).height() + h(window).scrollTop();
                    if (d) {
                        o -= r.outerWidth() - h(e).outerWidth();
                        if (o < h(window).scrollLeft() + 20) {
                            o = h(window).scrollLeft() + 20
                        }
                    }
                    if (o + s + 20 > u) {
                        o = u - (s + 20)
                    }
                    if (a + l + 20 > c) {
                        a = c - (l + 20)
                    }
                    p.element.css({
                        left: o,
                        top: a
                    }).show().find("a").first().focus().parent().addClass("vakata-context-hover");
                    p.is_visible = true;
                    h.vakata.context._trigger("show")
                }
            },
            hide: function () {
                if (p.is_visible) {
                    p.element.hide().find("ul").hide().end().find(":focus").blur().end().detach();
                    p.is_visible = false;
                    h.vakata.context._trigger("hide")
                }
            }
        };
        h(function () {
            d = h("body").css("direction") === "rtl";
            var t = false;
            p.element = h("<ul class='vakata-context'></ul>");
            p.element.on("mouseenter", "li", function (e) {
                e.stopImmediatePropagation();
                if (h.contains(this, e.relatedTarget)) {
                    return
                }
                if (t) {
                    clearTimeout(t)
                }
                p.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();
                h(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context", "li").addBack().addClass("vakata-context-hover");
                h.vakata.context._show_submenu(this)
            }).on("mouseleave", "li", function (e) {
                if (h.contains(this, e.relatedTarget)) {
                    return
                }
                h(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")
            }).on("mouseleave", function (e) {
                h(this).find(".vakata-context-hover").removeClass("vakata-context-hover");
                if (h.vakata.context.settings.hide_onmouseleave) {
                    t = setTimeout(function (e) {
                        return function () {
                            h.vakata.context.hide()
                        }
                    }(this), h.vakata.context.settings.hide_onmouseleave)
                }
            }).on("click", "a", function (e) {
                e.preventDefault();
                if (!h(this).blur().parent().hasClass("vakata-context-disabled") && h.vakata.context._execute(h(this).attr("rel")) !== false) {
                    h.vakata.context.hide()
                }
            }).on("keydown", "a", function (e) {
                var t = null;
                switch (e.which) {
                    case 13:
                    case 32:
                        e.type = "mouseup";
                        e.preventDefault();
                        h(e.currentTarget).trigger(e);
                        break;
                    case 37:
                        if (p.is_visible) {
                            p.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus();
                            e.stopImmediatePropagation();
                            e.preventDefault()
                        }
                        break;
                    case 38:
                        if (p.is_visible) {
                            t = p.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();
                            if (!t.length) {
                                t = p.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()
                            }
                            t.addClass("vakata-context-hover").children("a").focus();
                            e.stopImmediatePropagation();
                            e.preventDefault()
                        }
                        break;
                    case 39:
                        if (p.is_visible) {
                            p.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus();
                            e.stopImmediatePropagation();
                            e.preventDefault()
                        }
                        break;
                    case 40:
                        if (p.is_visible) {
                            t = p.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();
                            if (!t.length) {
                                t = p.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()
                            }
                            t.addClass("vakata-context-hover").children("a").focus();
                            e.stopImmediatePropagation();
                            e.preventDefault()
                        }
                        break;
                    case 27:
                        h.vakata.context.hide();
                        e.preventDefault();
                        break;
                    default:
                        break
                }
            }).on("keydown", function (e) {
                e.preventDefault();
                var t = p.element.find(".vakata-contextmenu-shortcut-" + e.which).parent();
                if (t.parent().not(".vakata-context-disabled")) {
                    t.click()
                }
            });
            h(m).on("mousedown.vakata.jstree", function (e) {
                if (p.is_visible && !h.contains(p.element[0], e.target)) {
                    h.vakata.context.hide()
                }
            }).on("context_show.vakata.jstree", function (e, t) {
                p.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");
                if (d) {
                    p.element.addClass("vakata-context-rtl").css("direction", "rtl")
                }
                p.element.find("ul").hide().end()
            })
        })
    })(T);
    T.jstree.defaults.dnd = {
        copy: true,
        open_timeout: 500,
        is_draggable: true,
        check_while_dragging: true,
        always_copy: false,
        inside_pos: 0,
        drag_selection: true,
        touch: true,
        large_drop_target: false,
        large_drag_target: false
    };
    T.jstree.plugins.dnd = function (e, t) {
        this.bind = function () {
            t.bind.call(this);
            this.element.on("mousedown.jstree touchstart.jstree", this.settings.dnd.large_drag_target ? ".jstree-node" : ".jstree-anchor", T.proxy(function (e) {
                if (this.settings.dnd.large_drag_target && T(e.target).closest(".jstree-node")[0] !== e.currentTarget) {
                    return true
                }
                if (e.type === "touchstart" && (!this.settings.dnd.touch || this.settings.dnd.touch === "selected" && !T(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked"))) {
                    return true
                }
                var t = this.get_node(e.target),
                    n = this.is_selected(t) && this.settings.dnd.drag_selection ? this.get_top_selected().length : 1,
                    i = n > 1 ? n + " " + this.get_string("nodes") : this.get_text(e.currentTarget);
                if (this.settings.core.force_text) {
                    i = T.vakata.html.escape(i)
                }
                if (t && t.id && t.id !== "#" && (e.which === 1 || e.type === "touchstart") && (this.settings.dnd.is_draggable === true || T.isFunction(this.settings.dnd.is_draggable) && this.settings.dnd.is_draggable.call(this, n > 1 ? this.get_top_selected(true) : [t]))) {
                    this.element.trigger("mousedown.jstree");
                    return T.vakata.dnd.start(e, {
                        jstree: true,
                        origin: this,
                        obj: this.get_node(t, true),
                        nodes: n > 1 ? this.get_top_selected() : [t.id]
                    }, '<div id="jstree-dnd" class="jstree-' + this.get_theme() + " jstree-" + this.get_theme() + "-" + this.get_theme_variant() + " " + (this.settings.core.themes.responsive ? " jstree-dnd-responsive" : "") + '"><i class="jstree-icon jstree-er"></i>' + i + '<ins class="jstree-copy" style="display:none;">+</ins></div>')
                }
            }, this))
        }
    };
    T(function () {
        var w = false,
            x = false,
            E = false,
            k = T('<div id="jstree-marker">&#160;</div>').hide();
        T(m).on("dnd_start.vakata.jstree", function (e, t) {
            w = false;
            if (!t || !t.data || !t.data.jstree) {
                return
            }
            k.appendTo("body")
        }).on("dnd_move.vakata.jstree", function (e, n) {
            if (E) {
                clearTimeout(E)
            }
            if (!n || !n.data || !n.data.jstree) {
                return
            }
            if (n.event.target.id && n.event.target.id === "jstree-marker") {
                return
            }
            var i = T.jstree.reference(n.event.target),
                r = false,
                o = false,
                t = false,
                a, s, l, u, c, f, h, d, p, v, g, _, y, m, b;
            if (i && i._data && i._data.dnd) {
                k.attr("class", "jstree-" + i.get_theme() + (i.settings.core.themes.responsive ? " jstree-dnd-responsive" : ""));
                n.helper.children().attr("class", "jstree-" + i.get_theme() + " jstree-" + i.get_theme() + "-" + i.get_theme_variant() + " " + (i.settings.core.themes.responsive ? " jstree-dnd-responsive" : "")).find(".jstree-copy").first()[n.data.origin && (n.data.origin.settings.dnd.always_copy || n.data.origin.settings.dnd.copy && (n.event.metaKey || n.event.ctrlKey)) ? "show" : "hide"]();
                if ((n.event.target === i.element[0] || n.event.target === i.get_container_ul()[0]) && i.get_container_ul().children().length === 0) {
                    d = true;
                    for (p = 0,
                        v = n.data.nodes.length; p < v; p++) {
                        d = d && i.check(n.data.origin && (n.data.origin.settings.dnd.always_copy || n.data.origin.settings.dnd.copy && (n.event.metaKey || n.event.ctrlKey)) ? "copy_node" : "move_node", n.data.origin && n.data.origin !== i ? n.data.origin.get_node(n.data.nodes[p]) : n.data.nodes[p], "#", "last", {
                            dnd: true,
                            ref: i.get_node("#"),
                            pos: "i",
                            origin: n.data.origin,
                            is_multi: n.data.origin && n.data.origin !== i,
                            is_foreign: !n.data.origin
                        });
                        if (!d) {
                            break
                        }
                    }
                    if (d) {
                        w = {
                            ins: i,
                            par: "#",
                            pos: "last"
                        };
                        k.hide();
                        n.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");
                        return
                    }
                } else {
                    r = i.settings.dnd.large_drop_target ? T(n.event.target).closest(".jstree-node").children(".jstree-anchor") : T(n.event.target).closest(".jstree-anchor");
                    if (r && r.length && r.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")) {
                        o = r.offset();
                        t = n.event.pageY - o.top;
                        u = r.outerHeight();
                        if (t < u / 3) {
                            h = ["b", "i", "a"]
                        } else if (t > u - u / 3) {
                            h = ["a", "i", "b"]
                        } else {
                            h = t > u / 2 ? ["i", "a", "b"] : ["i", "b", "a"]
                        }
                        T.each(h, function (e, t) {
                            switch (t) {
                                case "b":
                                    s = o.left - 6;
                                    l = o.top;
                                    c = i.get_parent(r);
                                    f = r.parent().index();
                                    break;
                                case "i":
                                    m = i.settings.dnd.inside_pos;
                                    b = i.get_node(r.parent());
                                    s = o.left - 2;
                                    l = o.top + u / 2 + 1;
                                    c = b.id;
                                    f = m === "first" ? 0 : m === "last" ? b.children.length : Math.min(m, b.children.length);
                                    break;
                                case "a":
                                    s = o.left - 6;
                                    l = o.top + u;
                                    c = i.get_parent(r);
                                    f = r.parent().index() + 1;
                                    break
                            }
                            d = true;
                            for (p = 0,
                                v = n.data.nodes.length; p < v; p++) {
                                g = n.data.origin && (n.data.origin.settings.dnd.always_copy || n.data.origin.settings.dnd.copy && (n.event.metaKey || n.event.ctrlKey)) ? "copy_node" : "move_node";
                                _ = f;
                                if (g === "move_node" && t === "a" && (n.data.origin && n.data.origin === i) && c === i.get_parent(n.data.nodes[p])) {
                                    y = i.get_node(c);
                                    if (_ > T.inArray(n.data.nodes[p], y.children)) {
                                        _ -= 1
                                    }
                                }
                                d = d && (i && i.settings && i.settings.dnd && i.settings.dnd.check_while_dragging === false || i.check(g, n.data.origin && n.data.origin !== i ? n.data.origin.get_node(n.data.nodes[p]) : n.data.nodes[p], c, _, {
                                    dnd: true,
                                    ref: i.get_node(r.parent()),
                                    pos: t,
                                    origin: n.data.origin,
                                    is_multi: n.data.origin && n.data.origin !== i,
                                    is_foreign: !n.data.origin
                                }));
                                if (!d) {
                                    if (i && i.last_error) {
                                        x = i.last_error()
                                    }
                                    break
                                }
                            }
                            if (t === "i" && r.parent().is(".jstree-closed") && i.settings.dnd.open_timeout) {
                                E = setTimeout(function (e, t) {
                                    return function () {
                                        e.open_node(t)
                                    }
                                }(i, r), i.settings.dnd.open_timeout)
                            }
                            if (d) {
                                w = {
                                    ins: i,
                                    par: c,
                                    pos: t === "i" && m === "last" && f === 0 && !i.is_loaded(b) ? "last" : f
                                };
                                k.css({
                                    left: s + "px",
                                    top: l + "px"
                                }).show();
                                n.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok");
                                x = {};
                                h = true;
                                return false
                            }
                        });
                        if (h === true) {
                            return
                        }
                    }
                }
            }
            w = false;
            n.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");
            k.hide()
        }).on("dnd_scroll.vakata.jstree", function (e, t) {
            if (!t || !t.data || !t.data.jstree) {
                return
            }
            k.hide();
            w = false;
            t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er")
        }).on("dnd_stop.vakata.jstree", function (e, t) {
            if (E) {
                clearTimeout(E)
            }
            if (!t || !t.data || !t.data.jstree) {
                return
            }
            k.hide().detach();
            var n, i, r = [];
            if (w) {
                for (n = 0,
                    i = t.data.nodes.length; n < i; n++) {
                    r[n] = t.data.origin ? t.data.origin.get_node(t.data.nodes[n]) : t.data.nodes[n]
                }
                w.ins[t.data.origin && (t.data.origin.settings.dnd.always_copy || t.data.origin.settings.dnd.copy && (t.event.metaKey || t.event.ctrlKey)) ? "copy_node" : "move_node"](r, w.par, w.pos, false, false, false, t.data.origin)
            } else {
                n = T(t.event.target).closest(".jstree");
                if (n.length && x && x.error && x.error === "check") {
                    n = n.jstree(true);
                    if (n) {
                        n.settings.core.error.call(this, x)
                    }
                }
            }
        }).on("keyup.jstree keydown.jstree", function (e, t) {
            t = T.vakata.dnd._get();
            if (t && t.data && t.data.jstree) {
                t.helper.find(".jstree-copy").first()[t.data.origin && (t.data.origin.settings.dnd.always_copy || t.data.origin.settings.dnd.copy && (e.metaKey || e.ctrlKey)) ? "show" : "hide"]()
            }
        })
    });
    (function (f) {
        f.vakata.html = {
            div: f("<div />"),
            escape: function (e) {
                return f.vakata.html.div.text(e).html()
            },
            strip: function (e) {
                return f.vakata.html.div.empty().append(f.parseHTML(e)).text()
            }
        };
        var h = {
            element: false,
            target: false,
            is_down: false,
            is_drag: false,
            helper: false,
            helper_w: 0,
            data: false,
            init_x: 0,
            init_y: 0,
            scroll_l: 0,
            scroll_t: 0,
            scroll_e: false,
            scroll_i: false,
            is_touch: false
        };
        f.vakata.dnd = {
            settings: {
                scroll_speed: 10,
                scroll_proximity: 20,
                helper_left: 5,
                helper_top: 10,
                threshold: 5,
                threshold_touch: 50
            },
            _trigger: function (e, t) {
                var n = f.vakata.dnd._get();
                n.event = t;
                f(m).triggerHandler("dnd_" + e + ".vakata", n)
            },
            _get: function () {
                return {
                    data: h.data,
                    element: h.element,
                    helper: h.helper
                }
            },
            _clean: function () {
                if (h.helper) {
                    h.helper.remove()
                }
                if (h.scroll_i) {
                    clearInterval(h.scroll_i);
                    h.scroll_i = false
                }
                h = {
                    element: false,
                    target: false,
                    is_down: false,
                    is_drag: false,
                    helper: false,
                    helper_w: 0,
                    data: false,
                    init_x: 0,
                    init_y: 0,
                    scroll_l: 0,
                    scroll_t: 0,
                    scroll_e: false,
                    scroll_i: false,
                    is_touch: false
                };
                f(m).off("mousemove.vakata.jstree touchmove.vakata.jstree", f.vakata.dnd.drag);
                f(m).off("mouseup.vakata.jstree touchend.vakata.jstree", f.vakata.dnd.stop)
            },
            _scroll: function (e) {
                if (!h.scroll_e || !h.scroll_l && !h.scroll_t) {
                    if (h.scroll_i) {
                        clearInterval(h.scroll_i);
                        h.scroll_i = false
                    }
                    return false
                }
                if (!h.scroll_i) {
                    h.scroll_i = setInterval(f.vakata.dnd._scroll, 100);
                    return false
                }
                if (e === true) {
                    return false
                }
                var t = h.scroll_e.scrollTop(),
                    n = h.scroll_e.scrollLeft();
                h.scroll_e.scrollTop(t + h.scroll_t * f.vakata.dnd.settings.scroll_speed);
                h.scroll_e.scrollLeft(n + h.scroll_l * f.vakata.dnd.settings.scroll_speed);
                if (t !== h.scroll_e.scrollTop() || n !== h.scroll_e.scrollLeft()) {
                    f.vakata.dnd._trigger("scroll", h.scroll_e)
                }
            },
            start: function (e, t, n) {
                if (e.type === "touchstart" && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0]) {
                    e.pageX = e.originalEvent.changedTouches[0].pageX;
                    e.pageY = e.originalEvent.changedTouches[0].pageY;
                    e.target = m.elementFromPoint(e.originalEvent.changedTouches[0].pageX - window.pageXOffset, e.originalEvent.changedTouches[0].pageY - window.pageYOffset)
                }
                if (h.is_drag) {
                    f.vakata.dnd.stop({})
                }
                try {
                    e.currentTarget.unselectable = "on";
                    e.currentTarget.onselectstart = function () {
                        return false
                    };
                    if (e.currentTarget.style) {
                        e.currentTarget.style.MozUserSelect = "none"
                    }
                } catch (e) {}
                h.init_x = e.pageX;
                h.init_y = e.pageY;
                h.data = t;
                h.is_down = true;
                h.element = e.currentTarget;
                h.target = e.target;
                h.is_touch = e.type === "touchstart";
                if (n !== false) {
                    h.helper = f("<div id='vakata-dnd'></div>").html(n).css({
                        display: "block",
                        margin: "0",
                        padding: "0",
                        position: "absolute",
                        top: "-2000px",
                        lineHeight: "16px",
                        zIndex: "10000"
                    })
                }
                f(m).on("mousemove.vakata.jstree touchmove.vakata.jstree", f.vakata.dnd.drag);
                f(m).on("mouseup.vakata.jstree touchend.vakata.jstree", f.vakata.dnd.stop);
                return false
            },
            drag: function (n) {
                if (n.type === "touchmove" && n.originalEvent && n.originalEvent.changedTouches && n.originalEvent.changedTouches[0]) {
                    n.pageX = n.originalEvent.changedTouches[0].pageX;
                    n.pageY = n.originalEvent.changedTouches[0].pageY;
                    n.target = m.elementFromPoint(n.originalEvent.changedTouches[0].pageX - window.pageXOffset, n.originalEvent.changedTouches[0].pageY - window.pageYOffset)
                }
                if (!h.is_down) {
                    return
                }
                if (!h.is_drag) {
                    if (Math.abs(n.pageX - h.init_x) > (h.is_touch ? f.vakata.dnd.settings.threshold_touch : f.vakata.dnd.settings.threshold) || Math.abs(n.pageY - h.init_y) > (h.is_touch ? f.vakata.dnd.settings.threshold_touch : f.vakata.dnd.settings.threshold)) {
                        if (h.helper) {
                            h.helper.appendTo("body");
                            h.helper_w = h.helper.outerWidth()
                        }
                        h.is_drag = true;
                        f.vakata.dnd._trigger("start", n)
                    } else {
                        return
                    }
                }
                var e = false,
                    t = false,
                    i = false,
                    r = false,
                    o = false,
                    a = false,
                    s = false,
                    l = false,
                    u = false,
                    c = false;
                h.scroll_t = 0;
                h.scroll_l = 0;
                h.scroll_e = false;
                f(f(n.target).parentsUntil("body").addBack().get().reverse()).filter(function () {
                    return /^auto|scroll$/.test(f(this).css("overflow")) && (this.scrollHeight > this.offsetHeight || this.scrollWidth > this.offsetWidth)
                }).each(function () {
                    var e = f(this),
                        t = e.offset();
                    if (this.scrollHeight > this.offsetHeight) {
                        if (t.top + e.height() - n.pageY < f.vakata.dnd.settings.scroll_proximity) {
                            h.scroll_t = 1
                        }
                        if (n.pageY - t.top < f.vakata.dnd.settings.scroll_proximity) {
                            h.scroll_t = -1
                        }
                    }
                    if (this.scrollWidth > this.offsetWidth) {
                        if (t.left + e.width() - n.pageX < f.vakata.dnd.settings.scroll_proximity) {
                            h.scroll_l = 1
                        }
                        if (n.pageX - t.left < f.vakata.dnd.settings.scroll_proximity) {
                            h.scroll_l = -1
                        }
                    }
                    if (h.scroll_t || h.scroll_l) {
                        h.scroll_e = f(this);
                        return false
                    }
                });
                if (!h.scroll_e) {
                    e = f(m);
                    t = f(window);
                    i = e.height();
                    r = t.height();
                    o = e.width();
                    a = t.width();
                    s = e.scrollTop();
                    l = e.scrollLeft();
                    if (i > r && n.pageY - s < f.vakata.dnd.settings.scroll_proximity) {
                        h.scroll_t = -1
                    }
                    if (i > r && r - (n.pageY - s) < f.vakata.dnd.settings.scroll_proximity) {
                        h.scroll_t = 1
                    }
                    if (o > a && n.pageX - l < f.vakata.dnd.settings.scroll_proximity) {
                        h.scroll_l = -1
                    }
                    if (o > a && a - (n.pageX - l) < f.vakata.dnd.settings.scroll_proximity) {
                        h.scroll_l = 1
                    }
                    if (h.scroll_t || h.scroll_l) {
                        h.scroll_e = e
                    }
                }
                if (h.scroll_e) {
                    f.vakata.dnd._scroll(true)
                }
                if (h.helper) {
                    u = parseInt(n.pageY + f.vakata.dnd.settings.helper_top, 10);
                    c = parseInt(n.pageX + f.vakata.dnd.settings.helper_left, 10);
                    if (i && u + 25 > i) {
                        u = i - 50
                    }
                    if (o && c + h.helper_w > o) {
                        c = o - (h.helper_w + 2)
                    }
                    h.helper.css({
                        left: c + "px",
                        top: u + "px"
                    })
                }
                f.vakata.dnd._trigger("move", n);
                return false
            },
            stop: function (e) {
                if (e.type === "touchend" && e.originalEvent && e.originalEvent.changedTouches && e.originalEvent.changedTouches[0]) {
                    e.pageX = e.originalEvent.changedTouches[0].pageX;
                    e.pageY = e.originalEvent.changedTouches[0].pageY;
                    e.target = m.elementFromPoint(e.originalEvent.changedTouches[0].pageX - window.pageXOffset, e.originalEvent.changedTouches[0].pageY - window.pageYOffset)
                }
                if (h.is_drag) {
                    f.vakata.dnd._trigger("stop", e)
                } else {
                    if (e.type === "touchend" && e.target === h.target) {
                        var t = setTimeout(function () {
                            f(e.target).click()
                        }, 100);
                        f(e.target).one("click", function () {
                            if (t) {
                                clearTimeout(t)
                            }
                        })
                    }
                }
                f.vakata.dnd._clean();
                return false
            }
        }
    })(T);
    T.jstree.defaults.massload = null;
    T.jstree.plugins.massload = function (e, s) {
        this.init = function (e, t) {
            s.init.call(this, e, t);
            this._data.massload = {}
        };
        this._load_nodes = function (r, o, a) {
            var e = this.settings.massload;
            if (a && !T.isEmptyObject(this._data.massload)) {
                return s._load_nodes.call(this, r, o, a)
            }
            if (T.isFunction(e)) {
                return e.call(this, r, T.proxy(function (e) {
                    if (e) {
                        for (var t in e) {
                            if (e.hasOwnProperty(t)) {
                                this._data.massload[t] = e[t]
                            }
                        }
                    }
                    s._load_nodes.call(this, r, o, a)
                }, this))
            }
            if (typeof e === "object" && e && e.url) {
                e = T.extend(true, {}, e);
                if (T.isFunction(e.url)) {
                    e.url = e.url.call(this, r)
                }
                if (T.isFunction(e.data)) {
                    e.data = e.data.call(this, r)
                }
                return T.ajax(e).done(T.proxy(function (e, t, n) {
                    if (e) {
                        for (var i in e) {
                            if (e.hasOwnProperty(i)) {
                                this._data.massload[i] = e[i]
                            }
                        }
                    }
                    s._load_nodes.call(this, r, o, a)
                }, this)).fail(T.proxy(function (e) {
                    s._load_nodes.call(this, r, o, a)
                }, this))
            }
            return s._load_nodes.call(this, r, o, a)
        };
        this._load_node = function (t, n) {
            var e = this._data.massload[t.id];
            if (e) {
                return this[typeof e === "string" ? "_append_html_data" : "_append_json_data"](t, typeof e === "string" ? T(T.parseHTML(e)).filter(function () {
                    return this.nodeType !== 3
                }) : e, function (e) {
                    n.call(this, e);
                    delete this._data.massload[t.id]
                })
            }
            return s._load_node.call(this, t, n)
        }
    };
    T.jstree.defaults.search = {
        ajax: false,
        fuzzy: false,
        case_sensitive: false,
        show_only_matches: false,
        show_only_matches_children: false,
        close_opened_onclear: true,
        search_leaves_only: false,
        search_callback: false
    };
    T.jstree.plugins.search = function (e, t) {
        this.bind = function () {
            t.bind.call(this);
            this._data.search.str = "";
            this._data.search.dom = T();
            this._data.search.res = [];
            this._data.search.opn = [];
            this._data.search.som = false;
            this._data.search.smc = false;
            this.element.on("before_open.jstree", T.proxy(function (e, t) {
                var n, i, r, o = this._data.search.res,
                    a = [],
                    s = T();
                if (o && o.length) {
                    this._data.search.dom = T(this.element[0].querySelectorAll("#" + T.map(o, function (e) {
                        return "0123456789".indexOf(e[0]) !== -1 ? "\\3" + e[0] + " " + e.substr(1).replace(T.jstree.idregex, "\\$&") : e.replace(T.jstree.idregex, "\\$&")
                    }).join(", #")));
                    this._data.search.dom.children(".jstree-anchor").addClass("jstree-search");
                    if (this._data.search.som && this._data.search.res.length) {
                        for (n = 0,
                            i = o.length; n < i; n++) {
                            a = a.concat(this.get_node(o[n]).parents)
                        }
                        a = T.vakata.array_remove_item(T.vakata.array_unique(a), "#");
                        s = a.length ? T(this.element[0].querySelectorAll("#" + T.map(a, function (e) {
                            return "0123456789".indexOf(e[0]) !== -1 ? "\\3" + e[0] + " " + e.substr(1).replace(T.jstree.idregex, "\\$&") : e.replace(T.jstree.idregex, "\\$&")
                        }).join(", #"))) : T();
                        this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function () {
                            return this.nextSibling
                        }).removeClass("jstree-last");
                        s = s.add(this._data.search.dom);
                        if (this._data.search.smc) {
                            this._data.search.dom.children(".jstree-children").find(".jstree-node").show()
                        }
                        s.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function () {
                            T(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")
                        })
                    }
                }
            }, this)).on("search.jstree", T.proxy(function (e, t) {
                if (this._data.search.som) {
                    if (t.nodes.length) {
                        this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function () {
                            return this.nextSibling
                        }).removeClass("jstree-last");
                        if (this._data.search.smc) {
                            t.nodes.children(".jstree-children").find(".jstree-node").show()
                        }
                        t.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function () {
                            T(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")
                        })
                    }
                }
            }, this)).on("clear_search.jstree", T.proxy(function (e, t) {
                if (this._data.search.som && t.nodes.length) {
                    this.element.find(".jstree-node").css("display", "").filter(".jstree-last").filter(function () {
                        return this.nextSibling
                    }).removeClass("jstree-last")
                }
            }, this))
        };
        this.search = function (i, e, t, n, r, o) {
            if (i === false || T.trim(i.toString()) === "") {
                return this.clear_search()
            }
            n = this.get_node(n);
            n = n && n.id ? n.id : null;
            i = i.toString();
            var a = this.settings.search,
                s = a.ajax ? a.ajax : false,
                l = this._model.data,
                u = null,
                c = [],
                f = [],
                h, d;
            if (this._data.search.res.length && !r) {
                this.clear_search()
            }
            if (t === w) {
                t = a.show_only_matches
            }
            if (o === w) {
                o = a.show_only_matches_children
            }
            if (!e && s !== false) {
                if (T.isFunction(s)) {
                    return s.call(this, i, T.proxy(function (e) {
                        if (e && e.d) {
                            e = e.d
                        }
                        this._load_nodes(!T.isArray(e) ? [] : T.vakata.array_unique(e), function () {
                            this.search(i, true, t, n, r)
                        }, true)
                    }, this), n)
                } else {
                    s = T.extend({}, s);
                    if (!s.data) {
                        s.data = {}
                    }
                    s.data.str = i;
                    if (n) {
                        s.data.inside = n
                    }
                    return T.ajax(s).fail(T.proxy(function () {
                        this._data.core.last_error = {
                            error: "ajax",
                            plugin: "search",
                            id: "search_01",
                            reason: "Could not load search parents",
                            data: JSON.stringify(s)
                        };
                        this.settings.core.error.call(this, this._data.core.last_error)
                    }, this)).done(T.proxy(function (e) {
                        if (e && e.d) {
                            e = e.d
                        }
                        this._load_nodes(!T.isArray(e) ? [] : T.vakata.array_unique(e), function () {
                            this.search(i, true, t, n, r)
                        }, true)
                    }, this))
                }
            }
            if (!r) {
                this._data.search.str = i;
                this._data.search.dom = T();
                this._data.search.res = [];
                this._data.search.opn = [];
                this._data.search.som = t;
                this._data.search.smc = o
            }
            u = new T.vakata.search(i, true, {
                caseSensitive: a.case_sensitive,
                fuzzy: a.fuzzy
            });
            T.each(l[n ? n : "#"].children_d, function (e, t) {
                var n = l[t];
                if (n.text && (a.search_callback && a.search_callback.call(this, i, n) || !a.search_callback && u.search(n.text).isMatch) && (!a.search_leaves_only || n.state.loaded && n.children.length === 0)) {
                    c.push(t);
                    f = f.concat(n.parents)
                }
            });
            if (c.length) {
                f = T.vakata.array_unique(f);
                this._search_open(f);
                if (!r) {
                    this._data.search.dom = T(this.element[0].querySelectorAll("#" + T.map(c, function (e) {
                        return "0123456789".indexOf(e[0]) !== -1 ? "\\3" + e[0] + " " + e.substr(1).replace(T.jstree.idregex, "\\$&") : e.replace(T.jstree.idregex, "\\$&")
                    }).join(", #")));
                    this._data.search.res = c
                } else {
                    this._data.search.dom = this._data.search.dom.add(T(this.element[0].querySelectorAll("#" + T.map(c, function (e) {
                        return "0123456789".indexOf(e[0]) !== -1 ? "\\3" + e[0] + " " + e.substr(1).replace(T.jstree.idregex, "\\$&") : e.replace(T.jstree.idregex, "\\$&")
                    }).join(", #"))));
                    this._data.search.res = T.vakata.array_unique(this._data.search.res.concat(c))
                }
                this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")
            }
            this.trigger("search", {
                nodes: this._data.search.dom,
                str: i,
                res: this._data.search.res,
                show_only_matches: t
            })
        };
        this.clear_search = function () {
            this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search");
            if (this.settings.search.close_opened_onclear) {
                this.close_node(this._data.search.opn, 0)
            }
            this.trigger("clear_search", {
                nodes: this._data.search.dom,
                str: this._data.search.str,
                res: this._data.search.res
            });
            this._data.search.str = "";
            this._data.search.res = [];
            this._data.search.opn = [];
            this._data.search.dom = T()
        };
        this._search_open = function (n) {
            var i = this;
            T.each(n.concat([]), function (e, t) {
                if (t === "#") {
                    return true
                }
                try {
                    t = T("#" + t.replace(T.jstree.idregex, "\\$&"), i.element)
                } catch (e) {}
                if (t && t.length) {
                    if (i.is_closed(t)) {
                        i._data.search.opn.push(t[0].id);
                        i.open_node(t, function () {
                            i._search_open(n)
                        }, 0)
                    }
                }
            })
        }
    };
    (function (n) {
        n.vakata.search = function (g, e, _) {
            _ = _ || {};
            _ = n.extend({}, n.vakata.search.defaults, _);
            if (_.fuzzy !== false) {
                _.fuzzy = true
            }
            g = _.caseSensitive ? g : g.toLowerCase();
            var y = _.location,
                r = _.distance,
                m = _.threshold,
                b = g.length,
                w, x, E, t;
            if (b > 32) {
                _.fuzzy = false
            }
            if (_.fuzzy) {
                w = 1 << b - 1;
                x = function () {
                    var e = {},
                        t = 0;
                    for (t = 0; t < b; t++) {
                        e[g.charAt(t)] = 0
                    }
                    for (t = 0; t < b; t++) {
                        e[g.charAt(t)] |= 1 << b - t - 1
                    }
                    return e
                }();
                E = function (e, t) {
                    var n = e / b,
                        i = Math.abs(y - t);
                    if (!r) {
                        return i ? 1 : n
                    }
                    return n + i / r
                }
            }
            t = function (e) {
                e = _.caseSensitive ? e : e.toLowerCase();
                if (g === e || e.indexOf(g) !== -1) {
                    return {
                        isMatch: true,
                        score: 0
                    }
                }
                if (!_.fuzzy) {
                    return {
                        isMatch: false,
                        score: 1
                    }
                }
                var t, n, i = e.length,
                    r = m,
                    o = e.indexOf(g, y),
                    a, s, l = b + i,
                    u, c, f, h, d, p = 1,
                    v = [];
                if (o !== -1) {
                    r = Math.min(E(0, o), r);
                    o = e.lastIndexOf(g, y + b);
                    if (o !== -1) {
                        r = Math.min(E(0, o), r)
                    }
                }
                o = -1;
                for (t = 0; t < b; t++) {
                    a = 0;
                    s = l;
                    while (a < s) {
                        if (E(t, y + s) <= r) {
                            a = s
                        } else {
                            l = s
                        }
                        s = Math.floor((l - a) / 2 + a)
                    }
                    l = s;
                    c = Math.max(1, y - s + 1);
                    f = Math.min(y + s, i) + b;
                    h = new Array(f + 2);
                    h[f + 1] = (1 << t) - 1;
                    for (n = f; n >= c; n--) {
                        d = x[e.charAt(n - 1)];
                        if (t === 0) {
                            h[n] = (h[n + 1] << 1 | 1) & d
                        } else {
                            h[n] = (h[n + 1] << 1 | 1) & d | ((u[n + 1] | u[n]) << 1 | 1) | u[n + 1]
                        }
                        if (h[n] & w) {
                            p = E(t, n - 1);
                            if (p <= r) {
                                r = p;
                                o = n - 1;
                                v.push(o);
                                if (o > y) {
                                    c = Math.max(1, 2 * y - o)
                                } else {
                                    break
                                }
                            }
                        }
                    }
                    if (E(t + 1, y) > r) {
                        break
                    }
                    u = h
                }
                return {
                    isMatch: o >= 0,
                    score: p
                }
            };
            return e === true ? {
                search: t
            } : t(e)
        };
        n.vakata.search.defaults = {
            location: 0,
            distance: 100,
            threshold: .6,
            fuzzy: false,
            caseSensitive: false
        }
    })(T);
    T.jstree.defaults.sort = function (e, t) {
        return this.get_text(e) > this.get_text(t) ? 1 : -1
    };
    T.jstree.plugins.sort = function (e, t) {
        this.bind = function () {
            t.bind.call(this);
            this.element.on("model.jstree", T.proxy(function (e, t) {
                this.sort(t.parent, true)
            }, this)).on("rename_node.jstree create_node.jstree", T.proxy(function (e, t) {
                this.sort(t.parent || t.node.parent, false);
                this.redraw_node(t.parent || t.node.parent, true)
            }, this)).on("move_node.jstree copy_node.jstree", T.proxy(function (e, t) {
                this.sort(t.parent, false);
                this.redraw_node(t.parent, true)
            }, this))
        };
        this.sort = function (e, t) {
            var n, i;
            e = this.get_node(e);
            if (e && e.children && e.children.length) {
                e.children.sort(T.proxy(this.settings.sort, this));
                if (t) {
                    for (n = 0,
                        i = e.children_d.length; n < i; n++) {
                        this.sort(e.children_d[n], false)
                    }
                }
            }
        }
    };
    var l = false;
    T.jstree.defaults.state = {
        key: "jstree",
        events: "changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",
        ttl: false,
        filter: false
    };
    T.jstree.plugins.state = function (e, t) {
        this.bind = function () {
            t.bind.call(this);
            var n = T.proxy(function () {
                this.element.on(this.settings.state.events, T.proxy(function () {
                    if (l) {
                        clearTimeout(l)
                    }
                    l = setTimeout(T.proxy(function () {
                        this.save_state()
                    }, this), 100)
                }, this));
                this.trigger("state_ready")
            }, this);
            this.element.on("ready.jstree", T.proxy(function (e, t) {
                this.element.one("restore_state.jstree", n);
                if (!this.restore_state()) {
                    n()
                }
            }, this))
        };
        this.save_state = function () {
            var e = {
                state: this.get_state(),
                ttl: this.settings.state.ttl,
                sec: +new Date
            };
            T.vakata.storage.set(this.settings.state.key, JSON.stringify(e))
        };
        this.restore_state = function () {
            var n = T.vakata.storage.get(this.settings.state.key);
            if (!!n) {
                try {
                    n = JSON.parse(n)
                } catch (e) {
                    return false
                }
            }
            if (!!n && n.ttl && n.sec && +new Date - n.sec > n.ttl) {
                return false
            }
            if (!!n && n.state) {
                n = n.state
            }
            if (!!n && T.isFunction(this.settings.state.filter)) {
                n = this.settings.state.filter.call(this, n)
            }
            if (!!n) {
                this.element.one("set_state.jstree", function (e, t) {
                    t.instance.trigger("restore_state", {
                        state: T.extend(true, {}, n)
                    })
                });
                this.set_state(n);
                return true
            }
            return false
        };
        this.clear_state = function () {
            return T.vakata.storage.del(this.settings.state.key)
        }
    };
    (function (e, t) {
        e.vakata.storage = {
            set: function (e, t) {
                return window.localStorage.setItem(e, t)
            },
            get: function (e) {
                return window.localStorage.getItem(e)
            },
            del: function (e) {
                return window.localStorage.removeItem(e)
            }
        }
    })(T);
    T.jstree.defaults.types = {
        "#": {},
        default: {}
    };
    T.jstree.plugins.types = function (e, c) {
        this.init = function (e, t) {
            var n, i;
            if (t && t.types && t.types["default"]) {
                for (n in t.types) {
                    if (n !== "default" && n !== "#" && t.types.hasOwnProperty(n)) {
                        for (i in t.types["default"]) {
                            if (t.types["default"].hasOwnProperty(i) && t.types[n][i] === w) {
                                t.types[n][i] = t.types["default"][i]
                            }
                        }
                    }
                }
            }
            c.init.call(this, e, t);
            this._model.data["#"].type = "#"
        };
        this.refresh = function (e, t) {
            c.refresh.call(this, e, t);
            this._model.data["#"].type = "#"
        };
        this.bind = function () {
            this.element.on("model.jstree", T.proxy(function (e, t) {
                var n = this._model.data,
                    i = t.nodes,
                    r = this.settings.types,
                    o, a, s = "default";
                for (o = 0,
                    a = i.length; o < a; o++) {
                    s = "default";
                    if (n[i[o]].original && n[i[o]].original.type && r[n[i[o]].original.type]) {
                        s = n[i[o]].original.type
                    }
                    if (n[i[o]].data && n[i[o]].data.jstree && n[i[o]].data.jstree.type && r[n[i[o]].data.jstree.type]) {
                        s = n[i[o]].data.jstree.type
                    }
                    n[i[o]].type = s;
                    if (n[i[o]].icon === true && r[s].icon !== w) {
                        n[i[o]].icon = r[s].icon
                    }
                }
                n["#"].type = "#"
            }, this));
            c.bind.call(this)
        };
        this.get_json = function (e, t, n) {
            var i, r, o = this._model.data,
                a = t ? T.extend(true, {}, t, {
                    no_id: false
                }) : {},
                s = c.get_json.call(this, e, a, n);
            if (s === false) {
                return false
            }
            if (T.isArray(s)) {
                for (i = 0,
                    r = s.length; i < r; i++) {
                    s[i].type = s[i].id && o[s[i].id] && o[s[i].id].type ? o[s[i].id].type : "default";
                    if (t && t.no_id) {
                        delete s[i].id;
                        if (s[i].li_attr && s[i].li_attr.id) {
                            delete s[i].li_attr.id
                        }
                        if (s[i].a_attr && s[i].a_attr.id) {
                            delete s[i].a_attr.id
                        }
                    }
                }
            } else {
                s.type = s.id && o[s.id] && o[s.id].type ? o[s.id].type : "default";
                if (t && t.no_id) {
                    s = this._delete_ids(s)
                }
            }
            return s
        };
        this._delete_ids = function (e) {
            if (T.isArray(e)) {
                for (var t = 0, n = e.length; t < n; t++) {
                    e[t] = this._delete_ids(e[t])
                }
                return e
            }
            delete e.id;
            if (e.li_attr && e.li_attr.id) {
                delete e.li_attr.id
            }
            if (e.a_attr && e.a_attr.id) {
                delete e.a_attr.id
            }
            if (e.children && T.isArray(e.children)) {
                e.children = this._delete_ids(e.children)
            }
            return e
        };
        this.check = function (e, t, n, i, r) {
            if (c.check.call(this, e, t, n, i, r) === false) {
                return false
            }
            t = t && t.id ? t : this.get_node(t);
            n = n && n.id ? n : this.get_node(n);
            var o = t && t.id ? r && r.origin ? r.origin : T.jstree.reference(t.id) : null,
                a, s, l, u;
            o = o && o._model && o._model.data ? o._model.data : null;
            switch (e) {
                case "create_node":
                case "move_node":
                case "copy_node":
                    if (e !== "move_node" || T.inArray(t.id, n.children) === -1) {
                        a = this.get_rules(n);
                        if (a.max_children !== w && a.max_children !== -1 && a.max_children === n.children.length) {
                            this._data.core.last_error = {
                                error: "check",
                                plugin: "types",
                                id: "types_01",
                                reason: "max_children prevents function: " + e,
                                data: JSON.stringify({
                                    chk: e,
                                    pos: i,
                                    obj: t && t.id ? t.id : false,
                                    par: n && n.id ? n.id : false
                                })
                            };
                            return false
                        }
                        if (a.valid_children !== w && a.valid_children !== -1 && T.inArray(t.type || "default", a.valid_children) === -1) {
                            this._data.core.last_error = {
                                error: "check",
                                plugin: "types",
                                id: "types_02",
                                reason: "valid_children prevents function: " + e,
                                data: JSON.stringify({
                                    chk: e,
                                    pos: i,
                                    obj: t && t.id ? t.id : false,
                                    par: n && n.id ? n.id : false
                                })
                            };
                            return false
                        }
                        if (o && t.children_d && t.parents) {
                            s = 0;
                            for (l = 0,
                                u = t.children_d.length; l < u; l++) {
                                s = Math.max(s, o[t.children_d[l]].parents.length)
                            }
                            s = s - t.parents.length + 1
                        }
                        if (s <= 0 || s === w) {
                            s = 1
                        }
                        do {
                            if (a.max_depth !== w && a.max_depth !== -1 && a.max_depth < s) {
                                this._data.core.last_error = {
                                    error: "check",
                                    plugin: "types",
                                    id: "types_03",
                                    reason: "max_depth prevents function: " + e,
                                    data: JSON.stringify({
                                        chk: e,
                                        pos: i,
                                        obj: t && t.id ? t.id : false,
                                        par: n && n.id ? n.id : false
                                    })
                                };
                                return false
                            }
                            n = this.get_node(n.parent);
                            a = this.get_rules(n);
                            s++
                        } while (n)
                    }
                    break
            }
            return true
        };
        this.get_rules = function (e) {
            e = this.get_node(e);
            if (!e) {
                return false
            }
            var t = this.get_type(e, true);
            if (t.max_depth === w) {
                t.max_depth = -1
            }
            if (t.max_children === w) {
                t.max_children = -1
            }
            if (t.valid_children === w) {
                t.valid_children = -1
            }
            return t
        };
        this.get_type = function (e, t) {
            e = this.get_node(e);
            return !e ? false : t ? T.extend({
                type: e.type
            }, this.settings.types[e.type]) : e.type
        };
        this.set_type = function (e, t) {
            var n, i, r, o, a;
            if (T.isArray(e)) {
                e = e.slice();
                for (i = 0,
                    r = e.length; i < r; i++) {
                    this.set_type(e[i], t)
                }
                return true
            }
            n = this.settings.types;
            e = this.get_node(e);
            if (!n[t] || !e) {
                return false
            }
            o = e.type;
            a = this.get_icon(e);
            e.type = t;
            if (a === true || n[o] && n[o].icon !== w && a === n[o].icon) {
                this.set_icon(e, n[t].icon !== w ? n[t].icon : true)
            }
            return true
        }
    };
    T.jstree.defaults.unique = {
        case_sensitive: false,
        duplicate: function (e, t) {
            return e + " (" + t + ")"
        }
    };
    T.jstree.plugins.unique = function (e, d) {
        this.check = function (e, t, n, i, r) {
            if (d.check.call(this, e, t, n, i, r) === false) {
                return false
            }
            t = t && t.id ? t : this.get_node(t);
            n = n && n.id ? n : this.get_node(n);
            if (!n || !n.children) {
                return true
            }
            var o = e === "rename_node" ? i : t.text,
                a = [],
                s = this.settings.unique.case_sensitive,
                l = this._model.data,
                u, c;
            for (u = 0,
                c = n.children.length; u < c; u++) {
                a.push(s ? l[n.children[u]].text : l[n.children[u]].text.toLowerCase())
            }
            if (!s) {
                o = o.toLowerCase()
            }
            switch (e) {
                case "delete_node":
                    return true;
                case "rename_node":
                    u = T.inArray(o, a) === -1 || t.text && t.text[s ? "toString" : "toLowerCase"]() === o;
                    if (!u) {
                        this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_01",
                            reason: "Child with name " + o + " already exists. Preventing: " + e,
                            data: JSON.stringify({
                                chk: e,
                                pos: i,
                                obj: t && t.id ? t.id : false,
                                par: n && n.id ? n.id : false
                            })
                        }
                    }
                    return u;
                case "create_node":
                    u = T.inArray(o, a) === -1;
                    if (!u) {
                        this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_04",
                            reason: "Child with name " + o + " already exists. Preventing: " + e,
                            data: JSON.stringify({
                                chk: e,
                                pos: i,
                                obj: t && t.id ? t.id : false,
                                par: n && n.id ? n.id : false
                            })
                        }
                    }
                    return u;
                case "copy_node":
                    u = T.inArray(o, a) === -1;
                    if (!u) {
                        this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_02",
                            reason: "Child with name " + o + " already exists. Preventing: " + e,
                            data: JSON.stringify({
                                chk: e,
                                pos: i,
                                obj: t && t.id ? t.id : false,
                                par: n && n.id ? n.id : false
                            })
                        }
                    }
                    return u;
                case "move_node":
                    u = t.parent === n.id && (!r || !r.is_multi) || T.inArray(o, a) === -1;
                    if (!u) {
                        this._data.core.last_error = {
                            error: "check",
                            plugin: "unique",
                            id: "unique_03",
                            reason: "Child with name " + o + " already exists. Preventing: " + e,
                            data: JSON.stringify({
                                chk: e,
                                pos: i,
                                obj: t && t.id ? t.id : false,
                                par: n && n.id ? n.id : false
                            })
                        }
                    }
                    return u
            }
            return true
        };
        this.create_node = function (e, t, n, i, r) {
            if (!t || t.text === w) {
                if (e === null) {
                    e = "#"
                }
                e = this.get_node(e);
                if (!e) {
                    return d.create_node.call(this, e, t, n, i, r)
                }
                n = n === w ? "last" : n;
                if (!n.toString().match(/^(before|after)$/) && !r && !this.is_loaded(e)) {
                    return d.create_node.call(this, e, t, n, i, r)
                }
                if (!t) {
                    t = {}
                }
                var o, a, s, l, u, c = this._model.data,
                    f = this.settings.unique.case_sensitive,
                    h = this.settings.unique.duplicate;
                a = o = this.get_string("New node");
                s = [];
                for (l = 0,
                    u = e.children.length; l < u; l++) {
                    s.push(f ? c[e.children[l]].text : c[e.children[l]].text.toLowerCase())
                }
                l = 1;
                while (T.inArray(f ? a : a.toLowerCase(), s) !== -1) {
                    a = h.call(this, o, ++l).toString()
                }
                t.text = a
            }
            return d.create_node.call(this, e, t, n, i, r)
        }
    };
    var c = m.createElement("DIV");
    c.setAttribute("unselectable", "on");
    c.setAttribute("role", "presentation");
    c.className = "jstree-wholerow";
    c.innerHTML = "&#160;";
    T.jstree.plugins.wholerow = function (e, o) {
        this.bind = function () {
            o.bind.call(this);
            this.element.on("ready.jstree set_state.jstree", T.proxy(function () {
                this.hide_dots()
            }, this)).on("init.jstree loading.jstree ready.jstree", T.proxy(function () {
                this.get_container_ul().addClass("jstree-wholerow-ul")
            }, this)).on("deselect_all.jstree", T.proxy(function (e, t) {
                this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")
            }, this)).on("changed.jstree", T.proxy(function (e, t) {
                this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");
                var n = false,
                    i, r;
                for (i = 0,
                    r = t.selected.length; i < r; i++) {
                    n = this.get_node(t.selected[i], true);
                    if (n && n.length) {
                        n.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")
                    }
                }
            }, this)).on("open_node.jstree", T.proxy(function (e, t) {
                this.get_node(t.node, true).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")
            }, this)).on("hover_node.jstree dehover_node.jstree", T.proxy(function (e, t) {
                if (e.type === "hover_node" && this.is_disabled(t.node)) {
                    return
                }
                this.get_node(t.node, true).children(".jstree-wholerow")[e.type === "hover_node" ? "addClass" : "removeClass"]("jstree-wholerow-hovered")
            }, this)).on("contextmenu.jstree", ".jstree-wholerow", T.proxy(function (e) {
                e.preventDefault();
                var t = T.Event("contextmenu", {
                    metaKey: e.metaKey,
                    ctrlKey: e.ctrlKey,
                    altKey: e.altKey,
                    shiftKey: e.shiftKey,
                    pageX: e.pageX,
                    pageY: e.pageY
                });
                T(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t)
            }, this)).on("click.jstree", ".jstree-wholerow", function (e) {
                e.stopImmediatePropagation();
                var t = T.Event("click", {
                    metaKey: e.metaKey,
                    ctrlKey: e.ctrlKey,
                    altKey: e.altKey,
                    shiftKey: e.shiftKey
                });
                T(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()
            }).on("click.jstree", ".jstree-leaf > .jstree-ocl", T.proxy(function (e) {
                e.stopImmediatePropagation();
                var t = T.Event("click", {
                    metaKey: e.metaKey,
                    ctrlKey: e.ctrlKey,
                    altKey: e.altKey,
                    shiftKey: e.shiftKey
                });
                T(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()
            }, this)).on("mouseover.jstree", ".jstree-wholerow, .jstree-icon", T.proxy(function (e) {
                e.stopImmediatePropagation();
                if (!this.is_disabled(e.currentTarget)) {
                    this.hover_node(e.currentTarget)
                }
                return false
            }, this)).on("mouseleave.jstree", ".jstree-node", T.proxy(function (e) {
                this.dehover_node(e.currentTarget)
            }, this))
        };
        this.teardown = function () {
            if (this.settings.wholerow) {
                this.element.find(".jstree-wholerow").remove()
            }
            o.teardown.call(this)
        };
        this.redraw_node = function (e, t, n, i) {
            e = o.redraw_node.apply(this, arguments);
            if (e) {
                var r = c.cloneNode(true);
                if (T.inArray(e.id, this._data.core.selected) !== -1) {
                    r.className += " jstree-wholerow-clicked"
                }
                if (this._data.core.focused && this._data.core.focused === e.id) {
                    r.className += " jstree-wholerow-hovered"
                }
                e.insertBefore(r, e.childNodes[0])
            }
            return e
        }
    };
    if (m.registerElement && Object && Object.create) {
        var f = Object.create(HTMLElement.prototype);
        f.createdCallback = function () {
            var e = {
                    core: {},
                    plugins: []
                },
                t;
            for (t in T.jstree.plugins) {
                if (T.jstree.plugins.hasOwnProperty(t) && this.attributes[t]) {
                    e.plugins.push(t);
                    if (this.getAttribute(t) && JSON.parse(this.getAttribute(t))) {
                        e[t] = JSON.parse(this.getAttribute(t))
                    }
                }
            }
            for (t in T.jstree.defaults.core) {
                if (T.jstree.defaults.core.hasOwnProperty(t) && this.attributes[t]) {
                    e.core[t] = JSON.parse(this.getAttribute(t)) || this.getAttribute(t)
                }
            }
            T(this).jstree(e)
        };
        try {
            m.registerElement("vakata-jstree", {
                prototype: f
            })
        } catch (e) {}
    }
});
(function e(t, n) {
    if (typeof exports === "object" && typeof module === "object")
        module.exports = n();
    else if (typeof define === "function" && define.amd)
        define([], n);
    else if (typeof exports === "object")
        exports["Quill"] = n();
    else
        t["Quill"] = n()
})(this, function () {
    return function (n) {
        var i = {};

        function r(e) {
            if (i[e]) {
                return i[e].exports
            }
            var t = i[e] = {
                i: e,
                l: false,
                exports: {}
            };
            n[e].call(t.exports, t, t.exports, r);
            t.l = true;
            return t.exports
        }
        r.m = n;
        r.c = i;
        r.d = function (e, t, n) {
            if (!r.o(e, t)) {
                Object.defineProperty(e, t, {
                    configurable: false,
                    enumerable: true,
                    get: n
                })
            }
        };
        r.n = function (t) {
            var e = t && t.__esModule ? function e() {
                    return t["default"]
                } :
                function e() {
                    return t
                };
            r.d(e, "a", e);
            return e
        };
        r.o = function (e, t) {
            return Object.prototype.hasOwnProperty.call(e, t)
        };
        r.p = "";
        return r(r.s = 109)
    }([function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(17);
        var r = n(18);
        var o = n(19);
        var a = n(45);
        var s = n(46);
        var l = n(47);
        var u = n(48);
        var c = n(49);
        var f = n(12);
        var h = n(32);
        var d = n(33);
        var p = n(31);
        var v = n(1);
        var g = {
            Scope: v.Scope,
            create: v.create,
            find: v.find,
            query: v.query,
            register: v.register,
            Container: i.default,
            Format: r.default,
            Leaf: o.default,
            Embed: u.default,
            Scroll: a.default,
            Block: l.default,
            Inline: s.default,
            Text: c.default,
            Attributor: {
                Attribute: f.default,
                Class: h.default,
                Style: d.default,
                Store: p.default
            }
        };
        t.default = g
    }, function (e, n, t) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(n, "__esModule", {
            value: true
        });
        var o = function (n) {
            i(e, n);

            function e(e) {
                var t = this;
                e = "[Parchment] " + e;
                t = n.call(this, e) || this;
                t.message = e;
                t.name = t.constructor.name;
                return t
            }
            return e
        }(Error);
        n.ParchmentError = o;
        var a = {};
        var s = {};
        var l = {};
        var u = {};
        n.DATA_KEY = "__blot";
        var c;
        (function (e) {
            e[e["TYPE"] = 3] = "TYPE";
            e[e["LEVEL"] = 12] = "LEVEL";
            e[e["ATTRIBUTE"] = 13] = "ATTRIBUTE";
            e[e["BLOT"] = 14] = "BLOT";
            e[e["INLINE"] = 7] = "INLINE";
            e[e["BLOCK"] = 11] = "BLOCK";
            e[e["BLOCK_BLOT"] = 10] = "BLOCK_BLOT";
            e[e["INLINE_BLOT"] = 6] = "INLINE_BLOT";
            e[e["BLOCK_ATTRIBUTE"] = 9] = "BLOCK_ATTRIBUTE";
            e[e["INLINE_ATTRIBUTE"] = 5] = "INLINE_ATTRIBUTE";
            e[e["ANY"] = 15] = "ANY"
        })(c = n.Scope || (n.Scope = {}));

        function r(e, t) {
            var n = h(e);
            if (n == null) {
                throw new o("Unable to create " + e + " blot")
            }
            var i = n;
            var r = e instanceof Node || e["nodeType"] === Node.TEXT_NODE ? e : i.create(t);
            return new i(r, t)
        }
        n.create = r;

        function f(e, t) {
            if (t === void 0) {
                t = false
            }
            if (e == null)
                return null;
            if (e[n.DATA_KEY] != null)
                return e[n.DATA_KEY].blot;
            if (t)
                return f(e.parentNode, t);
            return null
        }
        n.find = f;

        function h(e, t) {
            if (t === void 0) {
                t = c.ANY
            }
            var n;
            if (typeof e === "string") {
                n = u[e] || a[e]
            } else if (e instanceof Text || e["nodeType"] === Node.TEXT_NODE) {
                n = u["text"]
            } else if (typeof e === "number") {
                if (e & c.LEVEL & c.BLOCK) {
                    n = u["block"]
                } else if (e & c.LEVEL & c.INLINE) {
                    n = u["inline"]
                }
            } else if (e instanceof HTMLElement) {
                var i = (e.getAttribute("class") || "").split(/\s+/);
                for (var r in i) {
                    n = s[i[r]];
                    if (n)
                        break
                }
                n = n || l[e.tagName]
            }
            if (n == null)
                return null;
            if (t & c.LEVEL & n.scope && t & c.TYPE & n.scope)
                return n;
            return null
        }
        n.query = h;

        function d() {
            var e = [];
            for (var t = 0; t < arguments.length; t++) {
                e[t] = arguments[t]
            }
            if (e.length > 1) {
                return e.map(function (e) {
                    return d(e)
                })
            }
            var n = e[0];
            if (typeof n.blotName !== "string" && typeof n.attrName !== "string") {
                throw new o("Invalid definition")
            } else if (n.blotName === "abstract") {
                throw new o("Cannot register abstract class")
            }
            u[n.blotName || n.attrName] = n;
            if (typeof n.keyName === "string") {
                a[n.keyName] = n
            } else {
                if (n.className != null) {
                    s[n.className] = n
                }
                if (n.tagName != null) {
                    if (Array.isArray(n.tagName)) {
                        n.tagName = n.tagName.map(function (e) {
                            return e.toUpperCase()
                        })
                    } else {
                        n.tagName = n.tagName.toUpperCase()
                    }
                    var i = Array.isArray(n.tagName) ? n.tagName : [n.tagName];
                    i.forEach(function (e) {
                        if (l[e] == null || n.className == null) {
                            l[e] = n
                        }
                    })
                }
            }
            return n
        }
        n.register = d
    }, function (e, t, n) {
        var l = n(51);
        var u = n(11);
        var i = n(3);
        var c = n(20);
        var r = String.fromCharCode(0);
        var f = function (e) {
            if (Array.isArray(e)) {
                this.ops = e
            } else if (e != null && Array.isArray(e.ops)) {
                this.ops = e.ops
            } else {
                this.ops = []
            }
        };
        f.prototype.insert = function (e, t) {
            var n = {};
            if (e.length === 0)
                return this;
            n.insert = e;
            if (t != null && typeof t === "object" && Object.keys(t).length > 0) {
                n.attributes = t
            }
            return this.push(n)
        };
        f.prototype["delete"] = function (e) {
            if (e <= 0)
                return this;
            return this.push({
                delete: e
            })
        };
        f.prototype.retain = function (e, t) {
            if (e <= 0)
                return this;
            var n = {
                retain: e
            };
            if (t != null && typeof t === "object" && Object.keys(t).length > 0) {
                n.attributes = t
            }
            return this.push(n)
        };
        f.prototype.push = function (e) {
            var t = this.ops.length;
            var n = this.ops[t - 1];
            e = i(true, {}, e);
            if (typeof n === "object") {
                if (typeof e["delete"] === "number" && typeof n["delete"] === "number") {
                    this.ops[t - 1] = {
                        delete: n["delete"] + e["delete"]
                    };
                    return this
                }
                if (typeof n["delete"] === "number" && e.insert != null) {
                    t -= 1;
                    n = this.ops[t - 1];
                    if (typeof n !== "object") {
                        this.ops.unshift(e);
                        return this
                    }
                }
                if (u(e.attributes, n.attributes)) {
                    if (typeof e.insert === "string" && typeof n.insert === "string") {
                        this.ops[t - 1] = {
                            insert: n.insert + e.insert
                        };
                        if (typeof e.attributes === "object")
                            this.ops[t - 1].attributes = e.attributes;
                        return this
                    } else if (typeof e.retain === "number" && typeof n.retain === "number") {
                        this.ops[t - 1] = {
                            retain: n.retain + e.retain
                        };
                        if (typeof e.attributes === "object")
                            this.ops[t - 1].attributes = e.attributes;
                        return this
                    }
                }
            }
            if (t === this.ops.length) {
                this.ops.push(e)
            } else {
                this.ops.splice(t, 0, e)
            }
            return this
        };
        f.prototype.chop = function () {
            var e = this.ops[this.ops.length - 1];
            if (e && e.retain && !e.attributes) {
                this.ops.pop()
            }
            return this
        };
        f.prototype.filter = function (e) {
            return this.ops.filter(e)
        };
        f.prototype.forEach = function (e) {
            this.ops.forEach(e)
        };
        f.prototype.map = function (e) {
            return this.ops.map(e)
        };
        f.prototype.partition = function (n) {
            var i = [],
                r = [];
            this.forEach(function (e) {
                var t = n(e) ? i : r;
                t.push(e)
            });
            return [i, r]
        };
        f.prototype.reduce = function (e, t) {
            return this.ops.reduce(e, t)
        };
        f.prototype.changeLength = function () {
            return this.reduce(function (e, t) {
                if (t.insert) {
                    return e + c.length(t)
                } else if (t.delete) {
                    return e - t.delete
                }
                return e
            }, 0)
        };
        f.prototype.length = function () {
            return this.reduce(function (e, t) {
                return e + c.length(t)
            }, 0)
        };
        f.prototype.slice = function (e, t) {
            e = e || 0;
            if (typeof t !== "number")
                t = Infinity;
            var n = [];
            var i = c.iterator(this.ops);
            var r = 0;
            while (r < t && i.hasNext()) {
                var o;
                if (r < e) {
                    o = i.next(e - r)
                } else {
                    o = i.next(t - r);
                    n.push(o)
                }
                r += c.length(o)
            }
            return new f(n)
        };
        f.prototype.compose = function (e) {
            var t = c.iterator(this.ops);
            var n = c.iterator(e.ops);
            var i = new f;
            while (t.hasNext() || n.hasNext()) {
                if (n.peekType() === "insert") {
                    i.push(n.next())
                } else if (t.peekType() === "delete") {
                    i.push(t.next())
                } else {
                    var r = Math.min(t.peekLength(), n.peekLength());
                    var o = t.next(r);
                    var a = n.next(r);
                    if (typeof a.retain === "number") {
                        var s = {};
                        if (typeof o.retain === "number") {
                            s.retain = r
                        } else {
                            s.insert = o.insert
                        }
                        var l = c.attributes.compose(o.attributes, a.attributes, typeof o.retain === "number");
                        if (l)
                            s.attributes = l;
                        i.push(s)
                    } else if (typeof a["delete"] === "number" && typeof o.retain === "number") {
                        i.push(a)
                    }
                }
            }
            return i.chop()
        };
        f.prototype.concat = function (e) {
            var t = new f(this.ops.slice());
            if (e.ops.length > 0) {
                t.push(e.ops[0]);
                t.ops = t.ops.concat(e.ops.slice(1))
            }
            return t
        };
        f.prototype.diff = function (i, e) {
            if (this.ops === i.ops) {
                return new f
            }
            var t = [this, i].map(function (n) {
                return n.map(function (e) {
                    if (e.insert != null) {
                        return typeof e.insert === "string" ? e.insert : r
                    }
                    var t = n === i ? "on" : "with";
                    throw new Error("diff() called " + t + " non-document")
                }).join("")
            });
            var o = new f;
            var n = l(t[0], t[1], e);
            var a = c.iterator(this.ops);
            var s = c.iterator(i.ops);
            n.forEach(function (e) {
                var t = e[1].length;
                while (t > 0) {
                    var n = 0;
                    switch (e[0]) {
                        case l.INSERT:
                            n = Math.min(s.peekLength(), t);
                            o.push(s.next(n));
                            break;
                        case l.DELETE:
                            n = Math.min(t, a.peekLength());
                            a.next(n);
                            o["delete"](n);
                            break;
                        case l.EQUAL:
                            n = Math.min(a.peekLength(), s.peekLength(), t);
                            var i = a.next(n);
                            var r = s.next(n);
                            if (u(i.insert, r.insert)) {
                                o.retain(n, c.attributes.diff(i.attributes, r.attributes))
                            } else {
                                o.push(r)["delete"](n)
                            }
                            break
                    }
                    t -= n
                }
            });
            return o.chop()
        };
        f.prototype.eachLine = function (e, t) {
            t = t || "\n";
            var n = c.iterator(this.ops);
            var i = new f;
            var r = 0;
            while (n.hasNext()) {
                if (n.peekType() !== "insert")
                    return;
                var o = n.peek();
                var a = c.length(o) - n.peekLength();
                var s = typeof o.insert === "string" ? o.insert.indexOf(t, a) - a : -1;
                if (s < 0) {
                    i.push(n.next())
                } else if (s > 0) {
                    i.push(n.next(s))
                } else {
                    if (e(i, n.next(1).attributes || {}, r) === false) {
                        return
                    }
                    r += 1;
                    i = new f
                }
            }
            if (i.length() > 0) {
                e(i, {}, r)
            }
        };
        f.prototype.transform = function (e, t) {
            t = !!t;
            if (typeof e === "number") {
                return this.transformPosition(e, t)
            }
            var n = c.iterator(this.ops);
            var i = c.iterator(e.ops);
            var r = new f;
            while (n.hasNext() || i.hasNext()) {
                if (n.peekType() === "insert" && (t || i.peekType() !== "insert")) {
                    r.retain(c.length(n.next()))
                } else if (i.peekType() === "insert") {
                    r.push(i.next())
                } else {
                    var o = Math.min(n.peekLength(), i.peekLength());
                    var a = n.next(o);
                    var s = i.next(o);
                    if (a["delete"]) {
                        continue
                    } else if (s["delete"]) {
                        r.push(s)
                    } else {
                        r.retain(o, c.attributes.transform(a.attributes, s.attributes, t))
                    }
                }
            }
            return r.chop()
        };
        f.prototype.transformPosition = function (e, t) {
            t = !!t;
            var n = c.iterator(this.ops);
            var i = 0;
            while (n.hasNext() && i <= e) {
                var r = n.peekLength();
                var o = n.peekType();
                n.next();
                if (o === "delete") {
                    e -= Math.min(r, e - i);
                    continue
                } else if (o === "insert" && (i < e || !t)) {
                    e += r
                }
                i += r
            }
            return e
        };
        e.exports = f
    }, function (e, t) {
        "use strict";
        var o = Object.prototype.hasOwnProperty;
        var a = Object.prototype.toString;
        var f = function e(t) {
            if (typeof Array.isArray === "function") {
                return Array.isArray(t)
            }
            return a.call(t) === "[object Array]"
        };
        var h = function e(t) {
            if (!t || a.call(t) !== "[object Object]") {
                return false
            }
            var n = o.call(t, "constructor");
            var i = t.constructor && t.constructor.prototype && o.call(t.constructor.prototype, "isPrototypeOf");
            if (t.constructor && !n && !i) {
                return false
            }
            var r;
            for (r in t) {}
            return typeof r === "undefined" || o.call(t, r)
        };
        e.exports = function e() {
            var t, n, i, r, o, a;
            var s = arguments[0];
            var l = 1;
            var u = arguments.length;
            var c = false;
            if (typeof s === "boolean") {
                c = s;
                s = arguments[1] || {};
                l = 2
            }
            if (s == null || typeof s !== "object" && typeof s !== "function") {
                s = {}
            }
            for (; l < u; ++l) {
                t = arguments[l];
                if (t != null) {
                    for (n in t) {
                        i = s[n];
                        r = t[n];
                        if (s !== r) {
                            if (c && r && (h(r) || (o = f(r)))) {
                                if (o) {
                                    o = false;
                                    a = i && f(i) ? i : []
                                } else {
                                    a = i && h(i) ? i : {}
                                }
                                s[n] = e(c, a, r)
                            } else if (typeof r !== "undefined") {
                                s[n] = r
                            }
                        }
                    }
                }
            }
            return s
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.BlockEmbed = t.bubbleFormats = undefined;
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var l = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(3);
        var a = _(r);
        var o = n(2);
        var u = _(o);
        var s = n(0);
        var c = _(s);
        var f = n(16);
        var h = _(f);
        var d = n(6);
        var p = _(d);
        var v = n(7);
        var g = _(v);

        function _(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function y(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function m(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function b(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var w = 1;
        var x = function (e) {
            b(o, e);

            function o() {
                y(this, o);
                return m(this, (o.__proto__ || Object.getPrototypeOf(o)).apply(this, arguments))
            }
            i(o, [{
                key: "attach",
                value: function e() {
                    l(o.prototype.__proto__ || Object.getPrototypeOf(o.prototype), "attach", this).call(this);
                    this.attributes = new c.default.Attributor.Store(this.domNode)
                }
            }, {
                key: "delta",
                value: function e() {
                    return (new u.default).insert(this.value(), (0,
                        a.default)(this.formats(), this.attributes.values()))
                }
            }, {
                key: "format",
                value: function e(t, n) {
                    var i = c.default.query(t, c.default.Scope.BLOCK_ATTRIBUTE);
                    if (i != null) {
                        this.attributes.attribute(i, n)
                    }
                }
            }, {
                key: "formatAt",
                value: function e(t, n, i, r) {
                    this.format(i, r)
                }
            }, {
                key: "insertAt",
                value: function e(t, n, i) {
                    if (typeof n === "string" && n.endsWith("\n")) {
                        var r = c.default.create(E.blotName);
                        this.parent.insertBefore(r, t === 0 ? this : this.next);
                        r.insertAt(0, n.slice(0, -1))
                    } else {
                        l(o.prototype.__proto__ || Object.getPrototypeOf(o.prototype), "insertAt", this).call(this, t, n, i)
                    }
                }
            }]);
            return o
        }(c.default.Embed);
        x.scope = c.default.Scope.BLOCK_BLOT;
        var E = function (e) {
            b(s, e);

            function s(e) {
                y(this, s);
                var t = m(this, (s.__proto__ || Object.getPrototypeOf(s)).call(this, e));
                t.cache = {};
                return t
            }
            i(s, [{
                key: "delta",
                value: function e() {
                    if (this.cache.delta == null) {
                        this.cache.delta = this.descendants(c.default.Leaf).reduce(function (e, t) {
                            if (t.length() === 0) {
                                return e
                            } else {
                                return e.insert(t.value(), k(t))
                            }
                        }, new u.default).insert("\n", k(this))
                    }
                    return this.cache.delta
                }
            }, {
                key: "deleteAt",
                value: function e(t, n) {
                    l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "deleteAt", this).call(this, t, n);
                    this.cache = {}
                }
            }, {
                key: "formatAt",
                value: function e(t, n, i, r) {
                    if (n <= 0)
                        return;
                    if (c.default.query(i, c.default.Scope.BLOCK)) {
                        if (t + n === this.length()) {
                            this.format(i, r)
                        }
                    } else {
                        l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "formatAt", this).call(this, t, Math.min(n, this.length() - t - 1), i, r)
                    }
                    this.cache = {}
                }
            }, {
                key: "insertAt",
                value: function e(t, n, i) {
                    if (i != null)
                        return l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "insertAt", this).call(this, t, n, i);
                    if (n.length === 0)
                        return;
                    var r = n.split("\n");
                    var o = r.shift();
                    if (o.length > 0) {
                        if (t < this.length() - 1 || this.children.tail == null) {
                            l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "insertAt", this).call(this, Math.min(t, this.length() - 1), o)
                        } else {
                            this.children.tail.insertAt(this.children.tail.length(), o)
                        }
                        this.cache = {}
                    }
                    var a = this;
                    r.reduce(function (e, t) {
                        a = a.split(e, true);
                        a.insertAt(0, t);
                        return t.length
                    }, t + o.length)
                }
            }, {
                key: "insertBefore",
                value: function e(t, n) {
                    var i = this.children.head;
                    l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "insertBefore", this).call(this, t, n);
                    if (i instanceof h.default) {
                        i.remove()
                    }
                    this.cache = {}
                }
            }, {
                key: "length",
                value: function e() {
                    if (this.cache.length == null) {
                        this.cache.length = l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "length", this).call(this) + w
                    }
                    return this.cache.length
                }
            }, {
                key: "moveChildren",
                value: function e(t, n) {
                    l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "moveChildren", this).call(this, t, n);
                    this.cache = {}
                }
            }, {
                key: "optimize",
                value: function e(t) {
                    l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "optimize", this).call(this, t);
                    this.cache = {}
                }
            }, {
                key: "path",
                value: function e(t) {
                    return l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "path", this).call(this, t, true)
                }
            }, {
                key: "removeChild",
                value: function e(t) {
                    l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "removeChild", this).call(this, t);
                    this.cache = {}
                }
            }, {
                key: "split",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
                    if (n && (t === 0 || t >= this.length() - w)) {
                        var i = this.clone();
                        if (t === 0) {
                            this.parent.insertBefore(i, this);
                            return this
                        } else {
                            this.parent.insertBefore(i, this.next);
                            return i
                        }
                    } else {
                        var r = l(s.prototype.__proto__ || Object.getPrototypeOf(s.prototype), "split", this).call(this, t, n);
                        this.cache = {};
                        return r
                    }
                }
            }]);
            return s
        }(c.default.Block);
        E.blotName = "block";
        E.tagName = "P";
        E.defaultChild = "break";
        E.allowedChildren = [p.default, c.default.Embed, g.default];

        function k(e) {
            var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
            if (e == null)
                return t;
            if (typeof e.formats === "function") {
                t = (0,
                    a.default)(t, e.formats())
            }
            if (e.parent == null || e.parent.blotName == "scroll" || e.parent.statics.scope !== e.statics.scope) {
                return t
            }
            return k(e.parent, t)
        }
        t.bubbleFormats = k;
        t.BlockEmbed = x;
        t.default = E
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.overload = t.expandConfig = undefined;
        var a = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (e) {
                return typeof e
            } :
            function (e) {
                return e && typeof Symbol === "function" && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };
        var c = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        n(50);
        var r = n(2);
        var f = k(r);
        var o = n(14);
        var s = k(o);
        var l = n(8);
        var h = k(l);
        var u = n(9);
        var d = k(u);
        var p = n(0);
        var v = k(p);
        var g = n(15);
        var _ = k(g);
        var y = n(3);
        var m = k(y);
        var b = n(10);
        var w = k(b);
        var x = n(34);
        var E = k(x);

        function k(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function T(e, t, n) {
            if (t in e) {
                Object.defineProperty(e, t, {
                    value: n,
                    enumerable: true,
                    configurable: true,
                    writable: true
                })
            } else {
                e[t] = n
            }
            return e
        }

        function O(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var S = (0,
            w.default)("quill");
        var C = function () {
            i(a, null, [{
                key: "debug",
                value: function e(t) {
                    if (t === true) {
                        t = "log"
                    }
                    w.default.level(t)
                }
            }, {
                key: "find",
                value: function e(t) {
                    return t.__quill || v.default.find(t)
                }
            }, {
                key: "import",
                value: function e(t) {
                    if (this.imports[t] == null) {
                        S.error("Cannot import " + t + ". Are you sure it was registered?")
                    }
                    return this.imports[t]
                }
            }, {
                key: "register",
                value: function e(t, n) {
                    var i = this;
                    var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
                    if (typeof t !== "string") {
                        var o = t.attrName || t.blotName;
                        if (typeof o === "string") {
                            this.register("formats/" + o, t, n)
                        } else {
                            Object.keys(t).forEach(function (e) {
                                i.register(e, t[e], n)
                            })
                        }
                    } else {
                        if (this.imports[t] != null && !r) {
                            S.warn("Overwriting " + t + " with", n)
                        }
                        this.imports[t] = n;
                        if ((t.startsWith("blots/") || t.startsWith("formats/")) && n.blotName !== "abstract") {
                            v.default.register(n)
                        } else if (t.startsWith("modules") && typeof n.register === "function") {
                            n.register()
                        }
                    }
                }
            }]);

            function a(e) {
                var r = this;
                var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                O(this, a);
                this.options = A(e, t);
                this.container = this.options.container;
                if (this.container == null) {
                    return S.error("Invalid Quill container", e)
                }
                if (this.options.debug) {
                    a.debug(this.options.debug)
                }
                var n = this.container.innerHTML.trim();
                this.container.classList.add("ql-container");
                this.container.innerHTML = "";
                this.container.__quill = this;
                this.root = this.addContainer("ql-editor");
                this.root.classList.add("ql-blank");
                this.root.setAttribute("data-gramm", false);
                this.scrollingContainer = this.options.scrollingContainer || this.root;
                this.emitter = new h.default;
                this.scroll = v.default.create(this.root, {
                    emitter: this.emitter,
                    whitelist: this.options.formats
                });
                this.editor = new s.default(this.scroll);
                this.selection = new _.default(this.scroll, this.emitter);
                this.theme = new this.options.theme(this, this.options);
                this.keyboard = this.theme.addModule("keyboard");
                this.clipboard = this.theme.addModule("clipboard");
                this.history = this.theme.addModule("history");
                this.theme.init();
                this.emitter.on(h.default.events.EDITOR_CHANGE, function (e) {
                    if (e === h.default.events.TEXT_CHANGE) {
                        r.root.classList.toggle("ql-blank", r.editor.isBlank())
                    }
                });
                this.emitter.on(h.default.events.SCROLL_UPDATE, function (e, t) {
                    var n = r.selection.lastRange;
                    var i = n && n.length === 0 ? n.index : undefined;
                    j.call(r, function () {
                        return r.editor.update(null, t, i)
                    }, e)
                });
                var i = this.clipboard.convert("<div class='ql-editor' style=\"white-space: normal;\">" + n + "<p><br></p></div>");
                this.setContents(i);
                this.history.clear();
                if (this.options.placeholder) {
                    this.root.setAttribute("data-placeholder", this.options.placeholder)
                }
                if (this.options.readOnly) {
                    this.disable()
                }
            }
            i(a, [{
                key: "addContainer",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
                    if (typeof t === "string") {
                        var i = t;
                        t = document.createElement("div");
                        t.classList.add(i)
                    }
                    this.container.insertBefore(t, n);
                    return t
                }
            }, {
                key: "blur",
                value: function e() {
                    this.selection.setRange(null)
                }
            }, {
                key: "deleteText",
                value: function e(t, n, i) {
                    var r = this;
                    var o = P(t, n, i);
                    var a = c(o, 4);
                    t = a[0];
                    n = a[1];
                    i = a[3];
                    return j.call(this, function () {
                        return r.editor.deleteText(t, n)
                    }, i, t, -1 * n)
                }
            }, {
                key: "disable",
                value: function e() {
                    this.enable(false)
                }
            }, {
                key: "enable",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
                    this.scroll.enable(t);
                    this.container.classList.toggle("ql-disabled", !t)
                }
            }, {
                key: "focus",
                value: function e() {
                    var t = this.scrollingContainer.scrollTop;
                    this.selection.focus();
                    this.scrollingContainer.scrollTop = t;
                    this.scrollIntoView()
                }
            }, {
                key: "format",
                value: function e(n, i) {
                    var r = this;
                    var t = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : h.default.sources.API;
                    return j.call(this, function () {
                        var e = r.getSelection(true);
                        var t = new f.default;
                        if (e == null) {
                            return t
                        } else if (v.default.query(n, v.default.Scope.BLOCK)) {
                            t = r.editor.formatLine(e.index, e.length, T({}, n, i))
                        } else if (e.length === 0) {
                            r.selection.format(n, i);
                            return t
                        } else {
                            t = r.editor.formatText(e.index, e.length, T({}, n, i))
                        }
                        r.setSelection(e, h.default.sources.SILENT);
                        return t
                    }, t)
                }
            }, {
                key: "formatLine",
                value: function e(t, n, i, r, o) {
                    var a = this;
                    var s = void 0;
                    var l = P(t, n, i, r, o);
                    var u = c(l, 4);
                    t = u[0];
                    n = u[1];
                    s = u[2];
                    o = u[3];
                    return j.call(this, function () {
                        return a.editor.formatLine(t, n, s)
                    }, o, t, 0)
                }
            }, {
                key: "formatText",
                value: function e(t, n, i, r, o) {
                    var a = this;
                    var s = void 0;
                    var l = P(t, n, i, r, o);
                    var u = c(l, 4);
                    t = u[0];
                    n = u[1];
                    s = u[2];
                    o = u[3];
                    return j.call(this, function () {
                        return a.editor.formatText(t, n, s)
                    }, o, t, 0)
                }
            }, {
                key: "getBounds",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
                    var i = void 0;
                    if (typeof t === "number") {
                        i = this.selection.getBounds(t, n)
                    } else {
                        i = this.selection.getBounds(t.index, t.length)
                    }
                    var r = this.container.getBoundingClientRect();
                    return {
                        bottom: i.bottom - r.top,
                        height: i.height,
                        left: i.left - r.left,
                        right: i.right - r.left,
                        top: i.top - r.top,
                        width: i.width
                    }
                }
            }, {
                key: "getContents",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getLength() - t;
                    var i = P(t, n);
                    var r = c(i, 2);
                    t = r[0];
                    n = r[1];
                    return this.editor.getContents(t, n)
                }
            }, {
                key: "getFormat",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.getSelection(true);
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
                    if (typeof t === "number") {
                        return this.editor.getFormat(t, n)
                    } else {
                        return this.editor.getFormat(t.index, t.length)
                    }
                }
            }, {
                key: "getIndex",
                value: function e(t) {
                    return t.offset(this.scroll)
                }
            }, {
                key: "getLength",
                value: function e() {
                    return this.scroll.length()
                }
            }, {
                key: "getLeaf",
                value: function e(t) {
                    return this.scroll.leaf(t)
                }
            }, {
                key: "getLine",
                value: function e(t) {
                    return this.scroll.line(t)
                }
            }, {
                key: "getLines",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.MAX_VALUE;
                    if (typeof t !== "number") {
                        return this.scroll.lines(t.index, t.length)
                    } else {
                        return this.scroll.lines(t, n)
                    }
                }
            }, {
                key: "getModule",
                value: function e(t) {
                    return this.theme.modules[t]
                }
            }, {
                key: "getSelection",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;
                    if (t)
                        this.focus();
                    this.update();
                    return this.selection.getRange()[0]
                }
            }, {
                key: "getText",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this.getLength() - t;
                    var i = P(t, n);
                    var r = c(i, 2);
                    t = r[0];
                    n = r[1];
                    return this.editor.getText(t, n)
                }
            }, {
                key: "hasFocus",
                value: function e() {
                    return this.selection.hasFocus()
                }
            }, {
                key: "insertEmbed",
                value: function e(t, n, i) {
                    var r = this;
                    var o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : a.sources.API;
                    return j.call(this, function () {
                        return r.editor.insertEmbed(t, n, i)
                    }, o, t)
                }
            }, {
                key: "insertText",
                value: function e(t, n, i, r, o) {
                    var a = this;
                    var s = void 0;
                    var l = P(t, 0, i, r, o);
                    var u = c(l, 4);
                    t = u[0];
                    s = u[2];
                    o = u[3];
                    return j.call(this, function () {
                        return a.editor.insertText(t, n, s)
                    }, o, t, n.length)
                }
            }, {
                key: "isEnabled",
                value: function e() {
                    return !this.container.classList.contains("ql-disabled")
                }
            }, {
                key: "off",
                value: function e() {
                    return this.emitter.off.apply(this.emitter, arguments)
                }
            }, {
                key: "on",
                value: function e() {
                    return this.emitter.on.apply(this.emitter, arguments)
                }
            }, {
                key: "once",
                value: function e() {
                    return this.emitter.once.apply(this.emitter, arguments)
                }
            }, {
                key: "pasteHTML",
                value: function e(t, n, i) {
                    this.clipboard.dangerouslyPasteHTML(t, n, i)
                }
            }, {
                key: "removeFormat",
                value: function e(t, n, i) {
                    var r = this;
                    var o = P(t, n, i);
                    var a = c(o, 4);
                    t = a[0];
                    n = a[1];
                    i = a[3];
                    return j.call(this, function () {
                        return r.editor.removeFormat(t, n)
                    }, i, t)
                }
            }, {
                key: "scrollIntoView",
                value: function e() {
                    this.selection.scrollIntoView(this.scrollingContainer)
                }
            }, {
                key: "setContents",
                value: function e(o) {
                    var a = this;
                    var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : h.default.sources.API;
                    return j.call(this, function () {
                        o = new f.default(o);
                        var e = a.getLength();
                        var t = a.editor.deleteText(0, e);
                        var n = a.editor.applyDelta(o);
                        var i = n.ops[n.ops.length - 1];
                        if (i != null && typeof i.insert === "string" && i.insert[i.insert.length - 1] === "\n") {
                            a.editor.deleteText(a.getLength() - 1, 1);
                            n.delete(1)
                        }
                        var r = t.compose(n);
                        return r
                    }, t)
                }
            }, {
                key: "setSelection",
                value: function e(t, n, i) {
                    if (t == null) {
                        this.selection.setRange(null, n || a.sources.API)
                    } else {
                        var r = P(t, n, i);
                        var o = c(r, 4);
                        t = o[0];
                        n = o[1];
                        i = o[3];
                        this.selection.setRange(new g.Range(t, n), i);
                        if (i !== h.default.sources.SILENT) {
                            this.selection.scrollIntoView(this.scrollingContainer)
                        }
                    }
                }
            }, {
                key: "setText",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : h.default.sources.API;
                    var i = (new f.default).insert(t);
                    return this.setContents(i, n)
                }
            }, {
                key: "update",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : h.default.sources.USER;
                    var n = this.scroll.update(t);
                    this.selection.update(t);
                    return n
                }
            }, {
                key: "updateContents",
                value: function e(t) {
                    var n = this;
                    var i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : h.default.sources.API;
                    return j.call(this, function () {
                        t = new f.default(t);
                        return n.editor.applyDelta(t, i)
                    }, i, true)
                }
            }]);
            return a
        }();
        C.DEFAULTS = {
            bounds: null,
            formats: null,
            modules: {},
            placeholder: "",
            readOnly: false,
            scrollingContainer: null,
            strict: true,
            theme: "default"
        };
        C.events = h.default.events;
        C.sources = h.default.sources;
        C.version = false ? "dev" : "1.3.4";
        C.imports = {
            delta: f.default,
            parchment: v.default,
            "core/module": d.default,
            "core/theme": E.default
        };

        function A(e, n) {
            n = (0,
                m.default)(true, {
                container: e,
                modules: {
                    clipboard: true,
                    keyboard: true,
                    history: true
                }
            }, n);
            if (!n.theme || n.theme === C.DEFAULTS.theme) {
                n.theme = E.default
            } else {
                n.theme = C.import("themes/" + n.theme);
                if (n.theme == null) {
                    throw new Error("Invalid theme " + n.theme + ". Did you register it?")
                }
            }
            var t = (0,
                m.default)(true, {}, n.theme.DEFAULTS);
            [t, n].forEach(function (t) {
                t.modules = t.modules || {};
                Object.keys(t.modules).forEach(function (e) {
                    if (t.modules[e] === true) {
                        t.modules[e] = {}
                    }
                })
            });
            var i = Object.keys(t.modules).concat(Object.keys(n.modules));
            var r = i.reduce(function (e, t) {
                var n = C.import("modules/" + t);
                if (n == null) {
                    S.error("Cannot load " + t + " module. Are you sure you registered it?")
                } else {
                    e[t] = n.DEFAULTS || {}
                }
                return e
            }, {});
            if (n.modules != null && n.modules.toolbar && n.modules.toolbar.constructor !== Object) {
                n.modules.toolbar = {
                    container: n.modules.toolbar
                }
            }
            n = (0,
                m.default)(true, {}, C.DEFAULTS, {
                modules: r
            }, t, n);
            ["bounds", "container", "scrollingContainer"].forEach(function (e) {
                if (typeof n[e] === "string") {
                    n[e] = document.querySelector(n[e])
                }
            });
            n.modules = Object.keys(n.modules).reduce(function (e, t) {
                if (n.modules[t]) {
                    e[t] = n.modules[t]
                }
                return e
            }, {});
            return n
        }

        function j(e, t, n, i) {
            if (this.options.strict && !this.isEnabled() && t === h.default.sources.USER) {
                return new f.default
            }
            var r = n == null ? null : this.getSelection();
            var o = this.editor.delta;
            var a = e();
            if (r != null) {
                if (n === true)
                    n = r.index;
                if (i == null) {
                    r = D(r, a, t)
                } else if (i !== 0) {
                    r = D(r, n, i, t)
                }
                this.setSelection(r, h.default.sources.SILENT)
            }
            if (a.length() > 0) {
                var s;
                var l = [h.default.events.TEXT_CHANGE, a, o, t];
                (s = this.emitter).emit.apply(s, [h.default.events.EDITOR_CHANGE].concat(l));
                if (t !== h.default.sources.SILENT) {
                    var u;
                    (u = this.emitter).emit.apply(u, l)
                }
            }
            return a
        }

        function P(e, t, n, i, r) {
            var o = {};
            if (typeof e.index === "number" && typeof e.length === "number") {
                if (typeof t !== "number") {
                    r = i,
                        i = n,
                        n = t,
                        t = e.length,
                        e = e.index
                } else {
                    t = e.length,
                        e = e.index
                }
            } else if (typeof t !== "number") {
                r = i,
                    i = n,
                    n = t,
                    t = 0
            }
            if ((typeof n === "undefined" ? "undefined" : a(n)) === "object") {
                o = n;
                r = i
            } else if (typeof n === "string") {
                if (i != null) {
                    o[n] = i
                } else {
                    r = n
                }
            }
            r = r || h.default.sources.API;
            return [e, t, o, r]
        }

        function D(e, t, n, i) {
            if (e == null)
                return null;
            var r = void 0,
                o = void 0;
            if (t instanceof f.default) {
                var a = [e.index, e.index + e.length].map(function (e) {
                    return t.transformPosition(e, i !== h.default.sources.USER)
                });
                var s = c(a, 2);
                r = s[0];
                o = s[1]
            } else {
                var l = [e.index, e.index + e.length].map(function (e) {
                    if (e < t || e === t && i === h.default.sources.USER)
                        return e;
                    if (n >= 0) {
                        return e + n
                    } else {
                        return Math.max(t, e + n)
                    }
                });
                var u = c(l, 2);
                r = u[0];
                o = u[1]
            }
            return new g.Range(r, o - r)
        }
        t.expandConfig = A;
        t.overload = P;
        t.default = C
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var s = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(7);
        var o = u(r);
        var a = n(0);
        var l = u(a);

        function u(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function c(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function f(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function h(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var d = function (e) {
            h(a, e);

            function a() {
                c(this, a);
                return f(this, (a.__proto__ || Object.getPrototypeOf(a)).apply(this, arguments))
            }
            i(a, [{
                key: "formatAt",
                value: function e(t, n, i, r) {
                    if (a.compare(this.statics.blotName, i) < 0 && l.default.query(i, l.default.Scope.BLOT)) {
                        var o = this.isolate(t, n);
                        if (r) {
                            o.wrap(i, r)
                        }
                    } else {
                        s(a.prototype.__proto__ || Object.getPrototypeOf(a.prototype), "formatAt", this).call(this, t, n, i, r)
                    }
                }
            }, {
                key: "optimize",
                value: function e(t) {
                    s(a.prototype.__proto__ || Object.getPrototypeOf(a.prototype), "optimize", this).call(this, t);
                    if (this.parent instanceof a && a.compare(this.statics.blotName, this.parent.statics.blotName) > 0) {
                        var n = this.parent.isolate(this.offset(), this.length());
                        this.moveChildren(n);
                        n.wrap(this)
                    }
                }
            }], [{
                key: "compare",
                value: function e(t, n) {
                    var i = a.order.indexOf(t);
                    var r = a.order.indexOf(n);
                    if (i >= 0 || r >= 0) {
                        return i - r
                    } else if (t === n) {
                        return 0
                    } else if (t < n) {
                        return -1
                    } else {
                        return 1
                    }
                }
            }]);
            return a
        }(l.default.Inline);
        d.allowedChildren = [d, l.default.Embed, o.default];
        d.order = ["cursor", "inline", "underline", "strike", "italic", "bold", "script", "link", "code"];
        t.default = d
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(0);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function a(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function s(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function l(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var u = function (e) {
            l(t, e);

            function t() {
                a(this, t);
                return s(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(r.default.Text);
        t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = n(54);
        var a = u(o);
        var s = n(10);
        var l = u(s);

        function u(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function c(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function f(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function h(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var d = (0,
            l.default)("quill:events");
        var p = ["selectionchange", "mousedown", "mouseup", "click"];
        p.forEach(function (e) {
            document.addEventListener(e, function () {
                for (var e = arguments.length, n = Array(e), t = 0; t < e; t++) {
                    n[t] = arguments[t]
                }
                [].slice.call(document.querySelectorAll(".ql-container")).forEach(function (e) {
                    if (e.__quill && e.__quill.emitter) {
                        var t;
                        (t = e.__quill.emitter).handleDOM.apply(t, n)
                    }
                })
            })
        });
        var v = function (e) {
            h(t, e);

            function t() {
                c(this, t);
                var e = f(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
                e.listeners = {};
                e.on("error", d.error);
                return e
            }
            i(t, [{
                key: "emit",
                value: function e() {
                    d.log.apply(d, arguments);
                    r(t.prototype.__proto__ || Object.getPrototypeOf(t.prototype), "emit", this).apply(this, arguments)
                }
            }, {
                key: "handleDOM",
                value: function e(i) {
                    for (var t = arguments.length, r = Array(t > 1 ? t - 1 : 0), n = 1; n < t; n++) {
                        r[n - 1] = arguments[n]
                    }
                    (this.listeners[i.type] || []).forEach(function (e) {
                        var t = e.node,
                            n = e.handler;
                        if (i.target === t || t.contains(i.target)) {
                            n.apply(undefined, [i].concat(r))
                        }
                    })
                }
            }, {
                key: "listenDOM",
                value: function e(t, n, i) {
                    if (!this.listeners[t]) {
                        this.listeners[t] = []
                    }
                    this.listeners[t].push({
                        node: n,
                        handler: i
                    })
                }
            }]);
            return t
        }(a.default);
        v.events = {
            EDITOR_CHANGE: "editor-change",
            SCROLL_BEFORE_UPDATE: "scroll-before-update",
            SCROLL_OPTIMIZE: "scroll-optimize",
            SCROLL_UPDATE: "scroll-update",
            SELECTION_CHANGE: "selection-change",
            TEXT_CHANGE: "text-change"
        };
        v.sources = {
            API: "api",
            SILENT: "silent",
            USER: "user"
        };
        t.default = v
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });

        function i(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var r = function e(t) {
            var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
            i(this, e);
            this.quill = t;
            this.options = n
        };
        r.DEFAULTS = {};
        t.default = r
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var o = ["error", "warn", "log", "info"];
        var a = "warn";

        function i(e) {
            if (o.indexOf(e) <= o.indexOf(a)) {
                var t;
                for (var n = arguments.length, i = Array(n > 1 ? n - 1 : 0), r = 1; r < n; r++) {
                    i[r - 1] = arguments[r]
                }
                (t = console)[e].apply(t, i)
            }
        }

        function r(n) {
            return o.reduce(function (e, t) {
                e[t] = i.bind(console, t, n);
                return e
            }, {})
        }
        i.level = r.level = function (e) {
            a = e
        };
        t.default = r
    }, function (e, t, n) {
        var s = Array.prototype.slice;
        var l = n(52);
        var u = n(53);
        var c = e.exports = function (e, t, n) {
            if (!n)
                n = {};
            if (e === t) {
                return true
            } else if (e instanceof Date && t instanceof Date) {
                return e.getTime() === t.getTime()
            } else if (!e || !t || typeof e != "object" && typeof t != "object") {
                return n.strict ? e === t : e == t
            } else {
                return i(e, t, n)
            }
        };

        function f(e) {
            return e === null || e === undefined
        }

        function h(e) {
            if (!e || typeof e !== "object" || typeof e.length !== "number")
                return false;
            if (typeof e.copy !== "function" || typeof e.slice !== "function") {
                return false
            }
            if (e.length > 0 && typeof e[0] !== "number")
                return false;
            return true
        }

        function i(e, t, n) {
            var i, r;
            if (f(e) || f(t))
                return false;
            if (e.prototype !== t.prototype)
                return false;
            if (u(e)) {
                if (!u(t)) {
                    return false
                }
                e = s.call(e);
                t = s.call(t);
                return c(e, t, n)
            }
            if (h(e)) {
                if (!h(t)) {
                    return false
                }
                if (e.length !== t.length)
                    return false;
                for (i = 0; i < e.length; i++) {
                    if (e[i] !== t[i])
                        return false
                }
                return true
            }
            try {
                var o = l(e),
                    a = l(t)
            } catch (e) {
                return false
            }
            if (o.length != a.length)
                return false;
            o.sort();
            a.sort();
            for (i = o.length - 1; i >= 0; i--) {
                if (o[i] != a[i])
                    return false
            }
            for (i = o.length - 1; i >= 0; i--) {
                r = o[i];
                if (!c(e[r], t[r], n))
                    return false
            }
            return typeof e === typeof t
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(1);
        var i = function () {
            function e(e, t, n) {
                if (n === void 0) {
                    n = {}
                }
                this.attrName = e;
                this.keyName = t;
                var i = r.Scope.TYPE & r.Scope.ATTRIBUTE;
                if (n.scope != null) {
                    this.scope = n.scope & r.Scope.LEVEL | i
                } else {
                    this.scope = r.Scope.ATTRIBUTE
                }
                if (n.whitelist != null)
                    this.whitelist = n.whitelist
            }
            e.keys = function (e) {
                return [].map.call(e.attributes, function (e) {
                    return e.name
                })
            };
            e.prototype.add = function (e, t) {
                if (!this.canAdd(e, t))
                    return false;
                e.setAttribute(this.keyName, t);
                return true
            };
            e.prototype.canAdd = function (e, t) {
                var n = r.query(e, r.Scope.BLOT & (this.scope | r.Scope.TYPE));
                if (n != null && (this.whitelist == null || this.whitelist.indexOf(t) > -1)) {
                    return true
                }
                return false
            };
            e.prototype.remove = function (e) {
                e.removeAttribute(this.keyName)
            };
            e.prototype.value = function (e) {
                var t = e.getAttribute(this.keyName);
                return this.canAdd(e, t) ? t : ""
            };
            return e
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.Code = undefined;
        var l = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var a = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(2);
        var o = g(r);
        var s = n(0);
        var f = g(s);
        var u = n(4);
        var c = g(u);
        var h = n(6);
        var d = g(h);
        var p = n(7);
        var v = g(p);

        function g(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function _(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function y(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function m(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var b = function (e) {
            m(t, e);

            function t() {
                _(this, t);
                return y(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(d.default);
        b.blotName = "code";
        b.tagName = "CODE";
        var w = function (e) {
            m(c, e);

            function c() {
                _(this, c);
                return y(this, (c.__proto__ || Object.getPrototypeOf(c)).apply(this, arguments))
            }
            i(c, [{
                key: "delta",
                value: function e() {
                    var n = this;
                    var t = this.domNode.textContent;
                    if (t.endsWith("\n")) {
                        t = t.slice(0, -1)
                    }
                    return t.split("\n").reduce(function (e, t) {
                        return e.insert(t).insert("\n", n.formats())
                    }, new o.default)
                }
            }, {
                key: "format",
                value: function e(t, n) {
                    if (t === this.statics.blotName && n)
                        return;
                    var i = this.descendant(v.default, this.length() - 1),
                        r = l(i, 1),
                        o = r[0];
                    if (o != null) {
                        o.deleteAt(o.length() - 1, 1)
                    }
                    a(c.prototype.__proto__ || Object.getPrototypeOf(c.prototype), "format", this).call(this, t, n)
                }
            }, {
                key: "formatAt",
                value: function e(t, n, i, r) {
                    if (n === 0)
                        return;
                    if (f.default.query(i, f.default.Scope.BLOCK) == null || i === this.statics.blotName && r === this.statics.formats(this.domNode)) {
                        return
                    }
                    var o = this.newlineIndex(t);
                    if (o < 0 || o >= t + n)
                        return;
                    var a = this.newlineIndex(t, true) + 1;
                    var s = o - a + 1;
                    var l = this.isolate(a, s);
                    var u = l.next;
                    l.format(i, r);
                    if (u instanceof c) {
                        u.formatAt(0, t - a + n - s, i, r)
                    }
                }
            }, {
                key: "insertAt",
                value: function e(t, n, i) {
                    if (i != null)
                        return;
                    var r = this.descendant(v.default, t),
                        o = l(r, 2),
                        a = o[0],
                        s = o[1];
                    a.insertAt(s, n)
                }
            }, {
                key: "length",
                value: function e() {
                    var e = this.domNode.textContent.length;
                    if (!this.domNode.textContent.endsWith("\n")) {
                        return e + 1
                    }
                    return e
                }
            }, {
                key: "newlineIndex",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
                    if (!n) {
                        var i = this.domNode.textContent.slice(t).indexOf("\n");
                        return i > -1 ? t + i : -1
                    } else {
                        return this.domNode.textContent.slice(0, t).lastIndexOf("\n")
                    }
                }
            }, {
                key: "optimize",
                value: function e(t) {
                    if (!this.domNode.textContent.endsWith("\n")) {
                        this.appendChild(f.default.create("text", "\n"))
                    }
                    a(c.prototype.__proto__ || Object.getPrototypeOf(c.prototype), "optimize", this).call(this, t);
                    var n = this.next;
                    if (n != null && n.prev === this && n.statics.blotName === this.statics.blotName && this.statics.formats(this.domNode) === n.statics.formats(n.domNode)) {
                        n.optimize(t);
                        n.moveChildren(this);
                        n.remove()
                    }
                }
            }, {
                key: "replace",
                value: function e(t) {
                    a(c.prototype.__proto__ || Object.getPrototypeOf(c.prototype), "replace", this).call(this, t);
                    [].slice.call(this.domNode.querySelectorAll("*")).forEach(function (e) {
                        var t = f.default.find(e);
                        if (t == null) {
                            e.parentNode.removeChild(e)
                        } else if (t instanceof f.default.Embed) {
                            t.remove()
                        } else {
                            t.unwrap()
                        }
                    })
                }
            }], [{
                key: "create",
                value: function e(t) {
                    var n = a(c.__proto__ || Object.getPrototypeOf(c), "create", this).call(this, t);
                    n.setAttribute("spellcheck", false);
                    return n
                }
            }, {
                key: "formats",
                value: function e() {
                    return true
                }
            }]);
            return c
        }(c.default);
        w.blotName = "code-block";
        w.tagName = "PRE";
        w.TAB = "  ";
        t.Code = b;
        t.default = w
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var _ = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (e) {
                return typeof e
            } :
            function (e) {
                return e && typeof Symbol === "function" && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };
        var y = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(2);
        var d = O(r);
        var o = n(20);
        var m = O(o);
        var a = n(0);
        var b = O(a);
        var s = n(13);
        var p = O(s);
        var l = n(23);
        var h = O(l);
        var w = n(4);
        var x = O(w);
        var u = n(16);
        var c = O(u);
        var f = n(21);
        var v = O(f);
        var g = n(11);
        var E = O(g);
        var k = n(3);
        var T = O(k);

        function O(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function S(e, t, n) {
            if (t in e) {
                Object.defineProperty(e, t, {
                    value: n,
                    enumerable: true,
                    configurable: true,
                    writable: true
                })
            } else {
                e[t] = n
            }
            return e
        }

        function C(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var A = /^[ -~]*$/;
        var j = function () {
            function t(e) {
                C(this, t);
                this.scroll = e;
                this.delta = this.getDelta()
            }
            i(t, [{
                key: "applyDelta",
                value: function e(t) {
                    var p = this;
                    var v = false;
                    this.scroll.update();
                    var g = this.scroll.length();
                    this.scroll.batchStart();
                    t = D(t);
                    t.reduce(function (t, e) {
                        var n = e.retain || e.delete || e.insert.length || 1;
                        var i = e.attributes || {};
                        if (e.insert != null) {
                            if (typeof e.insert === "string") {
                                var r = e.insert;
                                if (r.endsWith("\n") && v) {
                                    v = false;
                                    r = r.slice(0, -1)
                                }
                                if (t >= g && !r.endsWith("\n")) {
                                    v = true
                                }
                                p.scroll.insertAt(t, r);
                                var o = p.scroll.line(t),
                                    a = y(o, 2),
                                    s = a[0],
                                    l = a[1];
                                var u = (0,
                                    T.default)({}, (0,
                                    w.bubbleFormats)(s));
                                if (s instanceof x.default) {
                                    var c = s.descendant(b.default.Leaf, l),
                                        f = y(c, 1),
                                        h = f[0];
                                    u = (0,
                                        T.default)(u, (0,
                                        w.bubbleFormats)(h))
                                }
                                i = m.default.attributes.diff(u, i) || {}
                            } else if (_(e.insert) === "object") {
                                var d = Object.keys(e.insert)[0];
                                if (d == null)
                                    return t;
                                p.scroll.insertAt(t, d, e.insert[d])
                            }
                            g += n
                        }
                        Object.keys(i).forEach(function (e) {
                            p.scroll.formatAt(t, n, e, i[e])
                        });
                        return t + n
                    }, 0);
                    t.reduce(function (e, t) {
                        if (typeof t.delete === "number") {
                            p.scroll.deleteAt(e, t.delete);
                            return e
                        }
                        return e + (t.retain || t.insert.length || 1)
                    }, 0);
                    this.scroll.batchEnd();
                    return this.update(t)
                }
            }, {
                key: "deleteText",
                value: function e(t, n) {
                    this.scroll.deleteAt(t, n);
                    return this.update((new d.default).retain(t).delete(n))
                }
            }, {
                key: "formatLine",
                value: function e(a, t) {
                    var s = this;
                    var l = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
                    this.scroll.update();
                    Object.keys(l).forEach(function (r) {
                        if (s.scroll.whitelist != null && !s.scroll.whitelist[r])
                            return;
                        var e = s.scroll.lines(a, Math.max(t, 1));
                        var o = t;
                        e.forEach(function (e) {
                            var t = e.length();
                            if (!(e instanceof p.default)) {
                                e.format(r, l[r])
                            } else {
                                var n = a - e.offset(s.scroll);
                                var i = e.newlineIndex(n + o) - n + 1;
                                e.formatAt(n, i, r, l[r])
                            }
                            o -= t
                        })
                    });
                    this.scroll.optimize();
                    return this.update((new d.default).retain(a).retain(t, (0,
                        v.default)(l)))
                }
            }, {
                key: "formatText",
                value: function e(t, n) {
                    var i = this;
                    var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
                    Object.keys(r).forEach(function (e) {
                        i.scroll.formatAt(t, n, e, r[e])
                    });
                    return this.update((new d.default).retain(t).retain(n, (0,
                        v.default)(r)))
                }
            }, {
                key: "getContents",
                value: function e(t, n) {
                    return this.delta.slice(t, t + n)
                }
            }, {
                key: "getDelta",
                value: function e() {
                    return this.scroll.lines().reduce(function (e, t) {
                        return e.concat(t.delta())
                    }, new d.default)
                }
            }, {
                key: "getFormat",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
                    var i = [],
                        r = [];
                    if (n === 0) {
                        this.scroll.path(t).forEach(function (e) {
                            var t = y(e, 1),
                                n = t[0];
                            if (n instanceof x.default) {
                                i.push(n)
                            } else if (n instanceof b.default.Leaf) {
                                r.push(n)
                            }
                        })
                    } else {
                        i = this.scroll.lines(t, n);
                        r = this.scroll.descendants(b.default.Leaf, t, n)
                    }
                    var o = [i, r].map(function (e) {
                        if (e.length === 0)
                            return {};
                        var t = (0,
                            w.bubbleFormats)(e.shift());
                        while (Object.keys(t).length > 0) {
                            var n = e.shift();
                            if (n == null)
                                return t;
                            t = P((0,
                                w.bubbleFormats)(n), t)
                        }
                        return t
                    });
                    return T.default.apply(T.default, o)
                }
            }, {
                key: "getText",
                value: function e(t, n) {
                    return this.getContents(t, n).filter(function (e) {
                        return typeof e.insert === "string"
                    }).map(function (e) {
                        return e.insert
                    }).join("")
                }
            }, {
                key: "insertEmbed",
                value: function e(t, n, i) {
                    this.scroll.insertAt(t, n, i);
                    return this.update((new d.default).retain(t).insert(S({}, n, i)))
                }
            }, {
                key: "insertText",
                value: function e(t, n) {
                    var i = this;
                    var r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
                    n = n.replace(/\r\n/g, "\n").replace(/\r/g, "\n");
                    this.scroll.insertAt(t, n);
                    Object.keys(r).forEach(function (e) {
                        i.scroll.formatAt(t, n.length, e, r[e])
                    });
                    return this.update((new d.default).retain(t).insert(n, (0,
                        v.default)(r)))
                }
            }, {
                key: "isBlank",
                value: function e() {
                    if (this.scroll.children.length == 0)
                        return true;
                    if (this.scroll.children.length > 1)
                        return false;
                    var t = this.scroll.children.head;
                    if (t.statics.blotName !== x.default.blotName)
                        return false;
                    if (t.children.length > 1)
                        return false;
                    return t.children.head instanceof c.default
                }
            }, {
                key: "removeFormat",
                value: function e(t, n) {
                    var i = this.getText(t, n);
                    var r = this.scroll.line(t + n),
                        o = y(r, 2),
                        a = o[0],
                        s = o[1];
                    var l = 0,
                        u = new d.default;
                    if (a != null) {
                        if (!(a instanceof p.default)) {
                            l = a.length() - s
                        } else {
                            l = a.newlineIndex(s) - s + 1
                        }
                        u = a.delta().slice(s, s + l - 1).insert("\n")
                    }
                    var c = this.getContents(t, n + l);
                    var f = c.diff((new d.default).insert(i).concat(u));
                    var h = (new d.default).retain(t).concat(f);
                    return this.applyDelta(h)
                }
            }, {
                key: "update",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];
                    var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
                    var r = this.delta;
                    if (n.length === 1 && n[0].type === "characterData" && n[0].target.data.match(A) && b.default.find(n[0].target)) {
                        var o = b.default.find(n[0].target);
                        var a = (0,
                            w.bubbleFormats)(o);
                        var s = o.offset(this.scroll);
                        var l = n[0].oldValue.replace(h.default.CONTENTS, "");
                        var u = (new d.default).insert(l);
                        var c = (new d.default).insert(o.value());
                        var f = (new d.default).retain(s).concat(u.diff(c, i));
                        t = f.reduce(function (e, t) {
                            if (t.insert) {
                                return e.insert(t.insert, a)
                            } else {
                                return e.push(t)
                            }
                        }, new d.default);
                        this.delta = r.compose(t)
                    } else {
                        this.delta = this.getDelta();
                        if (!t || !(0,
                                E.default)(r.compose(t), this.delta)) {
                            t = r.diff(this.delta, i)
                        }
                    }
                    return t
                }
            }]);
            return t
        }();

        function P(n, i) {
            return Object.keys(i).reduce(function (e, t) {
                if (n[t] == null)
                    return e;
                if (i[t] === n[t]) {
                    e[t] = i[t]
                } else if (Array.isArray(i[t])) {
                    if (i[t].indexOf(n[t]) < 0) {
                        e[t] = i[t].concat([n[t]])
                    }
                } else {
                    e[t] = [i[t], n[t]]
                }
                return e
            }, {})
        }

        function D(e) {
            return e.reduce(function (e, t) {
                if (t.insert === 1) {
                    var n = (0,
                        v.default)(t.attributes);
                    delete n["image"];
                    return e.insert({
                        image: t.attributes.image
                    }, n)
                }
                if (t.attributes != null && (t.attributes.list === true || t.attributes.bullet === true)) {
                    t = (0,
                        v.default)(t);
                    if (t.attributes.list) {
                        t.attributes.list = "ordered"
                    } else {
                        t.attributes.list = "bullet";
                        delete t.attributes.bullet
                    }
                }
                if (typeof t.insert === "string") {
                    var i = t.insert.replace(/\r\n/g, "\n").replace(/\r/g, "\n");
                    return e.insert(i, t.attributes)
                }
                return e.push(t)
            }, new d.default)
        }
        t.default = j
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.Range = undefined;
        var y = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(0);
        var l = p(r);
        var o = n(21);
        var c = p(o);
        var a = n(11);
        var f = p(a);
        var s = n(8);
        var h = p(s);
        var u = n(10);
        var d = p(u);

        function p(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function v(e) {
            if (Array.isArray(e)) {
                for (var t = 0, n = Array(e.length); t < e.length; t++) {
                    n[t] = e[t]
                }
                return n
            } else {
                return Array.from(e)
            }
        }

        function g(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var _ = (0,
            d.default)("quill:selection");
        var m = function e(t) {
            var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
            g(this, e);
            this.index = t;
            this.length = n
        };
        var b = function () {
            function n(e, t) {
                var s = this;
                g(this, n);
                this.emitter = t;
                this.scroll = e;
                this.composing = false;
                this.mouseDown = false;
                this.root = this.scroll.domNode;
                this.cursor = l.default.create("cursor", this);
                this.lastRange = this.savedRange = new m(0, 0);
                this.handleComposition();
                this.handleDragging();
                this.emitter.listenDOM("selectionchange", document, function () {
                    if (!s.mouseDown) {
                        setTimeout(s.update.bind(s, h.default.sources.USER), 1)
                    }
                });
                this.emitter.on(h.default.events.EDITOR_CHANGE, function (e, t) {
                    if (e === h.default.events.TEXT_CHANGE && t.length() > 0) {
                        s.update(h.default.sources.SILENT)
                    }
                });
                this.emitter.on(h.default.events.SCROLL_BEFORE_UPDATE, function () {
                    if (!s.hasFocus())
                        return;
                    var e = s.getNativeRange();
                    if (e == null)
                        return;
                    if (e.start.node === s.cursor.textNode)
                        return;
                    s.emitter.once(h.default.events.SCROLL_UPDATE, function () {
                        try {
                            s.setNativeRange(e.start.node, e.start.offset, e.end.node, e.end.offset)
                        } catch (e) {}
                    })
                });
                this.emitter.on(h.default.events.SCROLL_OPTIMIZE, function (e, t) {
                    if (t.range) {
                        var n = t.range,
                            i = n.startNode,
                            r = n.startOffset,
                            o = n.endNode,
                            a = n.endOffset;
                        s.setNativeRange(i, r, o, a)
                    }
                });
                this.update(h.default.sources.SILENT)
            }
            i(n, [{
                key: "handleComposition",
                value: function e() {
                    var t = this;
                    this.root.addEventListener("compositionstart", function () {
                        t.composing = true
                    });
                    this.root.addEventListener("compositionend", function () {
                        t.composing = false;
                        if (t.cursor.parent) {
                            var e = t.cursor.restore();
                            if (!e)
                                return;
                            setTimeout(function () {
                                t.setNativeRange(e.startNode, e.startOffset, e.endNode, e.endOffset)
                            }, 1)
                        }
                    })
                }
            }, {
                key: "handleDragging",
                value: function e() {
                    var t = this;
                    this.emitter.listenDOM("mousedown", document.body, function () {
                        t.mouseDown = true
                    });
                    this.emitter.listenDOM("mouseup", document.body, function () {
                        t.mouseDown = false;
                        t.update(h.default.sources.USER)
                    })
                }
            }, {
                key: "focus",
                value: function e() {
                    if (this.hasFocus())
                        return;
                    this.root.focus();
                    this.setRange(this.savedRange)
                }
            }, {
                key: "format",
                value: function e(t, n) {
                    if (this.scroll.whitelist != null && !this.scroll.whitelist[t])
                        return;
                    this.scroll.update();
                    var i = this.getNativeRange();
                    if (i == null || !i.native.collapsed || l.default.query(t, l.default.Scope.BLOCK))
                        return;
                    if (i.start.node !== this.cursor.textNode) {
                        var r = l.default.find(i.start.node, false);
                        if (r == null)
                            return;
                        if (r instanceof l.default.Leaf) {
                            var o = r.split(i.start.offset);
                            r.parent.insertBefore(this.cursor, o)
                        } else {
                            r.insertBefore(this.cursor, i.start.node)
                        }
                        this.cursor.attach()
                    }
                    this.cursor.format(t, n);
                    this.scroll.optimize();
                    this.setNativeRange(this.cursor.textNode, this.cursor.textNode.data.length);
                    this.update()
                }
            }, {
                key: "getBounds",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
                    var i = this.scroll.length();
                    t = Math.min(t, i - 1);
                    n = Math.min(t + n, i - 1) - t;
                    var r = void 0,
                        o = this.scroll.leaf(t),
                        a = y(o, 2),
                        s = a[0],
                        l = a[1];
                    if (s == null)
                        return null;
                    var u = s.position(l, true);
                    var c = y(u, 2);
                    r = c[0];
                    l = c[1];
                    var f = document.createRange();
                    if (n > 0) {
                        f.setStart(r, l);
                        var h = this.scroll.leaf(t + n);
                        var d = y(h, 2);
                        s = d[0];
                        l = d[1];
                        if (s == null)
                            return null;
                        var p = s.position(l, true);
                        var v = y(p, 2);
                        r = v[0];
                        l = v[1];
                        f.setEnd(r, l);
                        return f.getBoundingClientRect()
                    } else {
                        var g = "left";
                        var _ = void 0;
                        if (r instanceof Text) {
                            if (l < r.data.length) {
                                f.setStart(r, l);
                                f.setEnd(r, l + 1)
                            } else {
                                f.setStart(r, l - 1);
                                f.setEnd(r, l);
                                g = "right"
                            }
                            _ = f.getBoundingClientRect()
                        } else {
                            _ = s.domNode.getBoundingClientRect();
                            if (l > 0)
                                g = "right"
                        }
                        return {
                            bottom: _.top + _.height,
                            height: _.height,
                            left: _[g],
                            right: _[g],
                            top: _.top,
                            width: 0
                        }
                    }
                }
            }, {
                key: "getNativeRange",
                value: function e() {
                    var t = document.getSelection();
                    if (t == null || t.rangeCount <= 0)
                        return null;
                    var n = t.getRangeAt(0);
                    if (n == null)
                        return null;
                    var i = this.normalizeNative(n);
                    _.info("getNativeRange", i);
                    return i
                }
            }, {
                key: "getRange",
                value: function e() {
                    var t = this.getNativeRange();
                    if (t == null)
                        return [null, null];
                    var n = this.normalizedToRange(t);
                    return [n, t]
                }
            }, {
                key: "hasFocus",
                value: function e() {
                    return document.activeElement === this.root
                }
            }, {
                key: "normalizedToRange",
                value: function e(t) {
                    var a = this;
                    var n = [
                        [t.start.node, t.start.offset]
                    ];
                    if (!t.native.collapsed) {
                        n.push([t.end.node, t.end.offset])
                    }
                    var i = n.map(function (e) {
                        var t = y(e, 2),
                            n = t[0],
                            i = t[1];
                        var r = l.default.find(n, true);
                        var o = r.offset(a.scroll);
                        if (i === 0) {
                            return o
                        } else if (r instanceof l.default.Container) {
                            return o + r.length()
                        } else {
                            return o + r.index(n, i)
                        }
                    });
                    var r = Math.min(Math.max.apply(Math, v(i)), this.scroll.length() - 1);
                    var o = Math.min.apply(Math, [r].concat(v(i)));
                    return new m(o, r - o)
                }
            }, {
                key: "normalizeNative",
                value: function e(t) {
                    if (!w(this.root, t.startContainer) || !t.collapsed && !w(this.root, t.endContainer)) {
                        return null
                    }
                    var n = {
                        start: {
                            node: t.startContainer,
                            offset: t.startOffset
                        },
                        end: {
                            node: t.endContainer,
                            offset: t.endOffset
                        },
                        native: t
                    };
                    [n.start, n.end].forEach(function (e) {
                        var t = e.node,
                            n = e.offset;
                        while (!(t instanceof Text) && t.childNodes.length > 0) {
                            if (t.childNodes.length > n) {
                                t = t.childNodes[n];
                                n = 0
                            } else if (t.childNodes.length === n) {
                                t = t.lastChild;
                                n = t instanceof Text ? t.data.length : t.childNodes.length + 1
                            } else {
                                break
                            }
                        }
                        e.node = t,
                            e.offset = n
                    });
                    return n
                }
            }, {
                key: "rangeToNative",
                value: function e(t) {
                    var u = this;
                    var n = t.collapsed ? [t.index] : [t.index, t.index + t.length];
                    var c = [];
                    var f = this.scroll.length();
                    n.forEach(function (e, t) {
                        e = Math.min(f - 1, e);
                        var n = void 0,
                            i = u.scroll.leaf(e),
                            r = y(i, 2),
                            o = r[0],
                            a = r[1];
                        var s = o.position(a, t !== 0);
                        var l = y(s, 2);
                        n = l[0];
                        a = l[1];
                        c.push(n, a)
                    });
                    if (c.length < 2) {
                        c = c.concat(c)
                    }
                    return c
                }
            }, {
                key: "scrollIntoView",
                value: function e(t) {
                    var n = this.lastRange;
                    if (n == null)
                        return;
                    var i = this.getBounds(n.index, n.length);
                    if (i == null)
                        return;
                    var r = this.scroll.length() - 1;
                    var o = this.scroll.line(Math.min(n.index, r)),
                        a = y(o, 1),
                        s = a[0];
                    var l = s;
                    if (n.length > 0) {
                        var u = this.scroll.line(Math.min(n.index + n.length, r));
                        var c = y(u, 1);
                        l = c[0]
                    }
                    if (s == null || l == null)
                        return;
                    var f = t.getBoundingClientRect();
                    if (i.top < f.top) {
                        t.scrollTop -= f.top - i.top
                    } else if (i.bottom > f.bottom) {
                        t.scrollTop += i.bottom - f.bottom
                    }
                }
            }, {
                key: "setNativeRange",
                value: function e(t, n) {
                    var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : t;
                    var r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : n;
                    var o = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;
                    _.info("setNativeRange", t, n, i, r);
                    if (t != null && (this.root.parentNode == null || t.parentNode == null || i.parentNode == null)) {
                        return
                    }
                    var a = document.getSelection();
                    if (a == null)
                        return;
                    if (t != null) {
                        if (!this.hasFocus())
                            this.root.focus();
                        var s = (this.getNativeRange() || {}).native;
                        if (s == null || o || t !== s.startContainer || n !== s.startOffset || i !== s.endContainer || r !== s.endOffset) {
                            if (t.tagName == "BR") {
                                n = [].indexOf.call(t.parentNode.childNodes, t);
                                t = t.parentNode
                            }
                            if (i.tagName == "BR") {
                                r = [].indexOf.call(i.parentNode.childNodes, i);
                                i = i.parentNode
                            }
                            var l = document.createRange();
                            l.setStart(t, n);
                            l.setEnd(i, r);
                            a.removeAllRanges();
                            a.addRange(l)
                        }
                    } else {
                        a.removeAllRanges();
                        this.root.blur();
                        document.body.focus()
                    }
                }
            }, {
                key: "setRange",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
                    var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : h.default.sources.API;
                    if (typeof n === "string") {
                        i = n;
                        n = false
                    }
                    _.info("setRange", t);
                    if (t != null) {
                        var r = this.rangeToNative(t);
                        this.setNativeRange.apply(this, v(r).concat([n]))
                    } else {
                        this.setNativeRange(null)
                    }
                    this.update(i)
                }
            }, {
                key: "update",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : h.default.sources.USER;
                    var n = this.lastRange;
                    var i = this.getRange(),
                        r = y(i, 2),
                        o = r[0],
                        a = r[1];
                    this.lastRange = o;
                    if (this.lastRange != null) {
                        this.savedRange = this.lastRange
                    }
                    if (!(0,
                            f.default)(n, this.lastRange)) {
                        var s;
                        if (!this.composing && a != null && a.native.collapsed && a.start.node !== this.cursor.textNode) {
                            this.cursor.restore()
                        }
                        var l = [h.default.events.SELECTION_CHANGE, (0,
                            c.default)(this.lastRange), (0,
                            c.default)(n), t];
                        (s = this.emitter).emit.apply(s, [h.default.events.EDITOR_CHANGE].concat(l));
                        if (t !== h.default.sources.SILENT) {
                            var u;
                            (u = this.emitter).emit.apply(u, l)
                        }
                    }
                }
            }]);
            return n
        }();

        function w(e, t) {
            try {
                t.parentNode
            } catch (e) {
                return false
            }
            if (t instanceof Text) {
                t = t.parentNode
            }
            return e.contains(t)
        }
        t.Range = m;
        t.default = b
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(0);
        var a = s(i);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(i, e);

            function i() {
                l(this, i);
                return u(this, (i.__proto__ || Object.getPrototypeOf(i)).apply(this, arguments))
            }
            r(i, [{
                key: "insertInto",
                value: function e(t, n) {
                    if (t.children.length === 0) {
                        o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "insertInto", this).call(this, t, n)
                    } else {
                        this.remove()
                    }
                }
            }, {
                key: "length",
                value: function e() {
                    return 0
                }
            }, {
                key: "value",
                value: function e() {
                    return ""
                }
            }], [{
                key: "value",
                value: function e() {
                    return undefined
                }
            }]);
            return i
        }(a.default.Embed);
        f.blotName = "break";
        f.tagName = "BR";
        t.default = f
    }, function (e, t, n) {
        "use strict";
        var r = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var o = n(44);
        var i = n(30);
        var s = n(1);
        var a = function (i) {
            r(a, i);

            function a() {
                return i !== null && i.apply(this, arguments) || this
            }
            a.prototype.appendChild = function (e) {
                this.insertBefore(e)
            };
            a.prototype.attach = function () {
                var n = this;
                i.prototype.attach.call(this);
                this.children = new o.default;
                [].slice.call(this.domNode.childNodes).reverse().forEach(function (e) {
                    try {
                        var t = l(e);
                        n.insertBefore(t, n.children.head)
                    } catch (e) {
                        if (e instanceof s.ParchmentError)
                            return;
                        else
                            throw e
                    }
                })
            };
            a.prototype.deleteAt = function (e, t) {
                if (e === 0 && t === this.length()) {
                    return this.remove()
                }
                this.children.forEachAt(e, t, function (e, t, n) {
                    e.deleteAt(t, n)
                })
            };
            a.prototype.descendant = function (e, t) {
                var n = this.children.find(t),
                    i = n[0],
                    r = n[1];
                if (e.blotName == null && e(i) || e.blotName != null && i instanceof e) {
                    return [i, r]
                } else if (i instanceof a) {
                    return i.descendant(e, r)
                } else {
                    return [null, -1]
                }
            };
            a.prototype.descendants = function (i, e, t) {
                if (e === void 0) {
                    e = 0
                }
                if (t === void 0) {
                    t = Number.MAX_VALUE
                }
                var r = [],
                    o = t;
                this.children.forEachAt(e, t, function (e, t, n) {
                    if (i.blotName == null && i(e) || i.blotName != null && e instanceof i) {
                        r.push(e)
                    }
                    if (e instanceof a) {
                        r = r.concat(e.descendants(i, t, o))
                    }
                    o -= n
                });
                return r
            };
            a.prototype.detach = function () {
                this.children.forEach(function (e) {
                    e.detach()
                });
                i.prototype.detach.call(this)
            };
            a.prototype.formatAt = function (e, t, i, r) {
                this.children.forEachAt(e, t, function (e, t, n) {
                    e.formatAt(t, n, i, r)
                })
            };
            a.prototype.insertAt = function (e, t, n) {
                var i = this.children.find(e),
                    r = i[0],
                    o = i[1];
                if (r) {
                    r.insertAt(o, t, n)
                } else {
                    var a = n == null ? s.create("text", t) : s.create(t, n);
                    this.appendChild(a)
                }
            };
            a.prototype.insertBefore = function (t, e) {
                if (this.statics.allowedChildren != null && !this.statics.allowedChildren.some(function (e) {
                        return t instanceof e
                    })) {
                    throw new s.ParchmentError("Cannot insert " + t.statics.blotName + " into " + this.statics.blotName)
                }
                t.insertInto(this, e)
            };
            a.prototype.length = function () {
                return this.children.reduce(function (e, t) {
                    return e + t.length()
                }, 0)
            };
            a.prototype.moveChildren = function (t, n) {
                this.children.forEach(function (e) {
                    t.insertBefore(e, n)
                })
            };
            a.prototype.optimize = function (e) {
                i.prototype.optimize.call(this, e);
                if (this.children.length === 0) {
                    if (this.statics.defaultChild != null) {
                        var t = s.create(this.statics.defaultChild);
                        this.appendChild(t);
                        t.optimize(e)
                    } else {
                        this.remove()
                    }
                }
            };
            a.prototype.path = function (e, t) {
                if (t === void 0) {
                    t = false
                }
                var n = this.children.find(e, t),
                    i = n[0],
                    r = n[1];
                var o = [
                    [this, e]
                ];
                if (i instanceof a) {
                    return o.concat(i.path(r, t))
                } else if (i != null) {
                    o.push([i, r])
                }
                return o
            };
            a.prototype.removeChild = function (e) {
                this.children.remove(e)
            };
            a.prototype.replace = function (e) {
                if (e instanceof a) {
                    e.moveChildren(this)
                }
                i.prototype.replace.call(this, e)
            };
            a.prototype.split = function (e, i) {
                if (i === void 0) {
                    i = false
                }
                if (!i) {
                    if (e === 0)
                        return this;
                    if (e === this.length())
                        return this.next
                }
                var r = this.clone();
                this.parent.insertBefore(r, this.next);
                this.children.forEachAt(e, this.length(), function (e, t, n) {
                    e = e.split(t, i);
                    r.appendChild(e)
                });
                return r
            };
            a.prototype.unwrap = function () {
                this.moveChildren(this.parent, this.next);
                this.remove()
            };
            a.prototype.update = function (e, t) {
                var i = this;
                var n = [],
                    r = [];
                e.forEach(function (e) {
                    if (e.target === i.domNode && e.type === "childList") {
                        n.push.apply(n, e.addedNodes);
                        r.push.apply(r, e.removedNodes)
                    }
                });
                r.forEach(function (e) {
                    if (e.parentNode != null && e.tagName !== "IFRAME" && document.body.compareDocumentPosition(e) & Node.DOCUMENT_POSITION_CONTAINED_BY) {
                        return
                    }
                    var t = s.find(e);
                    if (t == null)
                        return;
                    if (t.domNode.parentNode == null || t.domNode.parentNode === i.domNode) {
                        t.detach()
                    }
                });
                n.filter(function (e) {
                    return e.parentNode == i.domNode
                }).sort(function (e, t) {
                    if (e === t)
                        return 0;
                    if (e.compareDocumentPosition(t) & Node.DOCUMENT_POSITION_FOLLOWING) {
                        return 1
                    }
                    return -1
                }).forEach(function (e) {
                    var t = null;
                    if (e.nextSibling != null) {
                        t = s.find(e.nextSibling)
                    }
                    var n = l(e);
                    if (n.next != t || n.next == null) {
                        if (n.parent != null) {
                            n.parent.removeChild(i)
                        }
                        i.insertBefore(n, t)
                    }
                })
            };
            return a
        }(i.default);

        function l(t) {
            var n = s.find(t);
            if (n == null) {
                try {
                    n = s.create(t)
                } catch (e) {
                    n = s.create(s.Scope.INLINE);
                    [].slice.call(t.childNodes).forEach(function (e) {
                        n.domNode.appendChild(e)
                    });
                    t.parentNode.replaceChild(n.domNode, t);
                    n.attach()
                }
            }
            return n
        }
        t.default = a
    }, function (e, t, n) {
        "use strict";
        var o = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var a = n(12);
        var s = n(31);
        var i = n(17);
        var l = n(1);
        var r = function (i) {
            o(r, i);

            function r() {
                return i !== null && i.apply(this, arguments) || this
            }
            r.formats = function (e) {
                if (typeof this.tagName === "string") {
                    return true
                } else if (Array.isArray(this.tagName)) {
                    return e.tagName.toLowerCase()
                }
                return undefined
            };
            r.prototype.attach = function () {
                i.prototype.attach.call(this);
                this.attributes = new s.default(this.domNode)
            };
            r.prototype.format = function (e, t) {
                var n = l.query(e);
                if (n instanceof a.default) {
                    this.attributes.attribute(n, t)
                } else if (t) {
                    if (n != null && (e !== this.statics.blotName || this.formats()[e] !== t)) {
                        this.replaceWith(e, t)
                    }
                }
            };
            r.prototype.formats = function () {
                var e = this.attributes.values();
                var t = this.statics.formats(this.domNode);
                if (t != null) {
                    e[this.statics.blotName] = t
                }
                return e
            };
            r.prototype.replaceWith = function (e, t) {
                var n = i.prototype.replaceWith.call(this, e, t);
                this.attributes.copy(n);
                return n
            };
            r.prototype.update = function (e, t) {
                var n = this;
                i.prototype.update.call(this, e, t);
                if (e.some(function (e) {
                        return e.target === n.domNode && e.type === "attributes"
                    })) {
                    this.attributes.build()
                }
            };
            r.prototype.wrap = function (e, t) {
                var n = i.prototype.wrap.call(this, e, t);
                if (n instanceof r && n.statics.scope === this.statics.scope) {
                    this.attributes.move(n)
                }
                return n
            };
            return r
        }(i.default);
        t.default = r
    }, function (e, t, n) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(30);
        var o = n(1);
        var a = function (e) {
            i(t, e);

            function t() {
                return e !== null && e.apply(this, arguments) || this
            }
            t.value = function (e) {
                return true
            };
            t.prototype.index = function (e, t) {
                if (this.domNode === e || this.domNode.compareDocumentPosition(e) & Node.DOCUMENT_POSITION_CONTAINED_BY) {
                    return Math.min(t, 1)
                }
                return -1
            };
            t.prototype.position = function (e, t) {
                var n = [].indexOf.call(this.parent.domNode.childNodes, this.domNode);
                if (e > 0)
                    n += 1;
                return [this.parent.domNode, n]
            };
            t.prototype.value = function () {
                return e = {},
                    e[this.statics.blotName] = this.statics.value(this.domNode) || true,
                    e;
                var e
            };
            t.scope = o.Scope.INLINE_BLOT;
            return t
        }(r.default);
        t.default = a
    }, function (e, t, n) {
        var r = n(11);
        var o = n(3);
        var a = {
            attributes: {
                compose: function (e, t, n) {
                    if (typeof e !== "object")
                        e = {};
                    if (typeof t !== "object")
                        t = {};
                    var i = o(true, {}, t);
                    if (!n) {
                        i = Object.keys(i).reduce(function (e, t) {
                            if (i[t] != null) {
                                e[t] = i[t]
                            }
                            return e
                        }, {})
                    }
                    for (var r in e) {
                        if (e[r] !== undefined && t[r] === undefined) {
                            i[r] = e[r]
                        }
                    }
                    return Object.keys(i).length > 0 ? i : undefined
                },
                diff: function (n, i) {
                    if (typeof n !== "object")
                        n = {};
                    if (typeof i !== "object")
                        i = {};
                    var e = Object.keys(n).concat(Object.keys(i)).reduce(function (e, t) {
                        if (!r(n[t], i[t])) {
                            e[t] = i[t] === undefined ? null : i[t]
                        }
                        return e
                    }, {});
                    return Object.keys(e).length > 0 ? e : undefined
                },
                transform: function (n, i, e) {
                    if (typeof n !== "object")
                        return i;
                    if (typeof i !== "object")
                        return undefined;
                    if (!e)
                        return i;
                    var t = Object.keys(i).reduce(function (e, t) {
                        if (n[t] === undefined)
                            e[t] = i[t];
                        return e
                    }, {});
                    return Object.keys(t).length > 0 ? t : undefined
                }
            },
            iterator: function (e) {
                return new i(e)
            },
            length: function (e) {
                if (typeof e["delete"] === "number") {
                    return e["delete"]
                } else if (typeof e.retain === "number") {
                    return e.retain
                } else {
                    return typeof e.insert === "string" ? e.insert.length : 1
                }
            }
        };

        function i(e) {
            this.ops = e;
            this.index = 0;
            this.offset = 0
        }
        i.prototype.hasNext = function () {
            return this.peekLength() < Infinity
        };
        i.prototype.next = function (e) {
            if (!e)
                e = Infinity;
            var t = this.ops[this.index];
            if (t) {
                var n = this.offset;
                var i = a.length(t);
                if (e >= i - n) {
                    e = i - n;
                    this.index += 1;
                    this.offset = 0
                } else {
                    this.offset += e
                }
                if (typeof t["delete"] === "number") {
                    return {
                        delete: e
                    }
                } else {
                    var r = {};
                    if (t.attributes) {
                        r.attributes = t.attributes
                    }
                    if (typeof t.retain === "number") {
                        r.retain = e
                    } else if (typeof t.insert === "string") {
                        r.insert = t.insert.substr(n, e)
                    } else {
                        r.insert = t.insert
                    }
                    return r
                }
            } else {
                return {
                    retain: Infinity
                }
            }
        };
        i.prototype.peek = function () {
            return this.ops[this.index]
        };
        i.prototype.peekLength = function () {
            if (this.ops[this.index]) {
                return a.length(this.ops[this.index]) - this.offset
            } else {
                return Infinity
            }
        };
        i.prototype.peekType = function () {
            if (this.ops[this.index]) {
                if (typeof this.ops[this.index]["delete"] === "number") {
                    return "delete"
                } else if (typeof this.ops[this.index].retain === "number") {
                    return "retain"
                } else {
                    return "insert"
                }
            }
            return "retain"
        };
        e.exports = a
    }, function (e, t) {
        var n = function () {
            "use strict";

            function m(e, t) {
                return t != null && e instanceof t
            }
            var b;
            try {
                b = Map
            } catch (e) {
                b = function () {}
            }
            var w;
            try {
                w = Set
            } catch (e) {
                w = function () {}
            }
            var x;
            try {
                x = Promise
            } catch (e) {
                x = function () {}
            }

            function E(e, h, t, d, p) {
                if (typeof h === "object") {
                    t = h.depth;
                    d = h.prototype;
                    p = h.includeNonEnumerable;
                    h = h.circular
                }
                var v = [];
                var g = [];
                var _ = typeof Buffer != "undefined";
                if (typeof h == "undefined")
                    h = true;
                if (typeof t == "undefined")
                    t = Infinity;

                function y(e, r) {
                    if (e === null)
                        return null;
                    if (r === 0)
                        return e;
                    var o;
                    var t;
                    if (typeof e != "object") {
                        return e
                    }
                    if (m(e, b)) {
                        o = new b
                    } else if (m(e, w)) {
                        o = new w
                    } else if (m(e, x)) {
                        o = new x(function (t, n) {
                            e.then(function (e) {
                                t(y(e, r - 1))
                            }, function (e) {
                                n(y(e, r - 1))
                            })
                        })
                    } else if (E.__isArray(e)) {
                        o = []
                    } else if (E.__isRegExp(e)) {
                        o = new RegExp(e.source, k(e));
                        if (e.lastIndex)
                            o.lastIndex = e.lastIndex
                    } else if (E.__isDate(e)) {
                        o = new Date(e.getTime())
                    } else if (_ && Buffer.isBuffer(e)) {
                        o = new Buffer(e.length);
                        e.copy(o);
                        return o
                    } else if (m(e, Error)) {
                        o = Object.create(e)
                    } else {
                        if (typeof d == "undefined") {
                            t = Object.getPrototypeOf(e);
                            o = Object.create(t)
                        } else {
                            o = Object.create(d);
                            t = d
                        }
                    }
                    if (h) {
                        var n = v.indexOf(e);
                        if (n != -1) {
                            return g[n]
                        }
                        v.push(e);
                        g.push(o)
                    }
                    if (m(e, b)) {
                        e.forEach(function (e, t) {
                            var n = y(t, r - 1);
                            var i = y(e, r - 1);
                            o.set(n, i)
                        })
                    }
                    if (m(e, w)) {
                        e.forEach(function (e) {
                            var t = y(e, r - 1);
                            o.add(t)
                        })
                    }
                    for (var i in e) {
                        var a;
                        if (t) {
                            a = Object.getOwnPropertyDescriptor(t, i)
                        }
                        if (a && a.set == null) {
                            continue
                        }
                        o[i] = y(e[i], r - 1)
                    }
                    if (Object.getOwnPropertySymbols) {
                        var s = Object.getOwnPropertySymbols(e);
                        for (var i = 0; i < s.length; i++) {
                            var l = s[i];
                            var u = Object.getOwnPropertyDescriptor(e, l);
                            if (u && !u.enumerable && !p) {
                                continue
                            }
                            o[l] = y(e[l], r - 1);
                            if (!u.enumerable) {
                                Object.defineProperty(o, l, {
                                    enumerable: false
                                })
                            }
                        }
                    }
                    if (p) {
                        var c = Object.getOwnPropertyNames(e);
                        for (var i = 0; i < c.length; i++) {
                            var f = c[i];
                            var u = Object.getOwnPropertyDescriptor(e, f);
                            if (u && u.enumerable) {
                                continue
                            }
                            o[f] = y(e[f], r - 1);
                            Object.defineProperty(o, f, {
                                enumerable: false
                            })
                        }
                    }
                    return o
                }
                return y(e, t)
            }
            E.clonePrototype = function e(t) {
                if (t === null)
                    return null;
                var n = function () {};
                n.prototype = t;
                return new n
            };

            function t(e) {
                return Object.prototype.toString.call(e)
            }
            E.__objToStr = t;

            function e(e) {
                return typeof e === "object" && t(e) === "[object Date]"
            }
            E.__isDate = e;

            function n(e) {
                return typeof e === "object" && t(e) === "[object Array]"
            }
            E.__isArray = n;

            function i(e) {
                return typeof e === "object" && t(e) === "[object RegExp]"
            }
            E.__isRegExp = i;

            function k(e) {
                var t = "";
                if (e.global)
                    t += "g";
                if (e.ignoreCase)
                    t += "i";
                if (e.multiline)
                    t += "m";
                return t
            }
            E.__getRegExpFlags = k;
            return E
        }();
        if (typeof e === "object" && e.exports) {
            e.exports = n
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var p = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var v = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(0);
        var a = d(r);
        var o = n(8);
        var s = d(o);
        var g = n(4);
        var l = d(g);
        var u = n(16);
        var _ = d(u);
        var c = n(13);
        var y = d(c);
        var f = n(24);
        var h = d(f);

        function d(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function m(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function b(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function w(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }

        function x(e) {
            return e instanceof l.default || e instanceof g.BlockEmbed
        }
        var E = function (e) {
            w(d, e);

            function d(e, t) {
                m(this, d);
                var n = b(this, (d.__proto__ || Object.getPrototypeOf(d)).call(this, e));
                n.emitter = t.emitter;
                if (Array.isArray(t.whitelist)) {
                    n.whitelist = t.whitelist.reduce(function (e, t) {
                        e[t] = true;
                        return e
                    }, {})
                }
                n.domNode.addEventListener("DOMNodeInserted", function () {});
                n.optimize();
                n.enable();
                return n
            }
            i(d, [{
                key: "batchStart",
                value: function e() {
                    this.batch = true
                }
            }, {
                key: "batchEnd",
                value: function e() {
                    this.batch = false;
                    this.optimize()
                }
            }, {
                key: "deleteAt",
                value: function e(t, n) {
                    var i = this.line(t),
                        r = p(i, 2),
                        o = r[0],
                        a = r[1];
                    var s = this.line(t + n),
                        l = p(s, 1),
                        u = l[0];
                    v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "deleteAt", this).call(this, t, n);
                    if (u != null && o !== u && a > 0) {
                        if (o instanceof g.BlockEmbed || u instanceof g.BlockEmbed) {
                            this.optimize();
                            return
                        }
                        if (o instanceof y.default) {
                            var c = o.newlineIndex(o.length(), true);
                            if (c > -1) {
                                o = o.split(c + 1);
                                if (o === u) {
                                    this.optimize();
                                    return
                                }
                            }
                        } else if (u instanceof y.default) {
                            var f = u.newlineIndex(0);
                            if (f > -1) {
                                u.split(f + 1)
                            }
                        }
                        var h = u.children.head instanceof _.default ? null : u.children.head;
                        o.moveChildren(u, h);
                        o.remove()
                    }
                    this.optimize()
                }
            }, {
                key: "enable",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
                    this.domNode.setAttribute("contenteditable", t)
                }
            }, {
                key: "formatAt",
                value: function e(t, n, i, r) {
                    if (this.whitelist != null && !this.whitelist[i])
                        return;
                    v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "formatAt", this).call(this, t, n, i, r);
                    this.optimize()
                }
            }, {
                key: "insertAt",
                value: function e(t, n, i) {
                    if (i != null && this.whitelist != null && !this.whitelist[n])
                        return;
                    if (t >= this.length()) {
                        if (i == null || a.default.query(n, a.default.Scope.BLOCK) == null) {
                            var r = a.default.create(this.statics.defaultChild);
                            this.appendChild(r);
                            if (i == null && n.endsWith("\n")) {
                                n = n.slice(0, -1)
                            }
                            r.insertAt(0, n, i)
                        } else {
                            var o = a.default.create(n, i);
                            this.appendChild(o)
                        }
                    } else {
                        v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "insertAt", this).call(this, t, n, i)
                    }
                    this.optimize()
                }
            }, {
                key: "insertBefore",
                value: function e(t, n) {
                    if (t.statics.scope === a.default.Scope.INLINE_BLOT) {
                        var i = a.default.create(this.statics.defaultChild);
                        i.appendChild(t);
                        t = i
                    }
                    v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "insertBefore", this).call(this, t, n)
                }
            }, {
                key: "leaf",
                value: function e(t) {
                    return this.path(t).pop() || [null, -1]
                }
            }, {
                key: "line",
                value: function e(t) {
                    if (t === this.length()) {
                        return this.line(t - 1)
                    }
                    return this.descendant(x, t)
                }
            }, {
                key: "lines",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.MAX_VALUE;
                    var i = function i(e, t, n) {
                        var r = [],
                            o = n;
                        e.children.forEachAt(t, n, function (e, t, n) {
                            if (x(e)) {
                                r.push(e)
                            } else if (e instanceof a.default.Container) {
                                r = r.concat(i(e, t, o))
                            }
                            o -= n
                        });
                        return r
                    };
                    return i(this, t, n)
                }
            }, {
                key: "optimize",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                    if (this.batch === true)
                        return;
                    v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "optimize", this).call(this, t, n);
                    if (t.length > 0) {
                        this.emitter.emit(s.default.events.SCROLL_OPTIMIZE, t, n)
                    }
                }
            }, {
                key: "path",
                value: function e(t) {
                    return v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "path", this).call(this, t).slice(1)
                }
            }, {
                key: "update",
                value: function e(t) {
                    if (this.batch === true)
                        return;
                    var n = s.default.sources.USER;
                    if (typeof t === "string") {
                        n = t
                    }
                    if (!Array.isArray(t)) {
                        t = this.observer.takeRecords()
                    }
                    if (t.length > 0) {
                        this.emitter.emit(s.default.events.SCROLL_BEFORE_UPDATE, n, t)
                    }
                    v(d.prototype.__proto__ || Object.getPrototypeOf(d.prototype), "update", this).call(this, t.concat([]));
                    if (t.length > 0) {
                        this.emitter.emit(s.default.events.SCROLL_UPDATE, n, t)
                    }
                }
            }]);
            return d
        }(a.default.Scroll);
        E.blotName = "scroll";
        E.className = "ql-editor";
        E.tagName = "DIV";
        E.defaultChild = "block";
        E.allowedChildren = [l.default, g.BlockEmbed, h.default];
        t.default = E
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var f = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(0);
        var h = s(r);
        var a = n(7);
        var d = s(a);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function p(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var c = function (e) {
            p(c, e);
            i(c, null, [{
                key: "value",
                value: function e() {
                    return undefined
                }
            }]);

            function c(e, t) {
                l(this, c);
                var n = u(this, (c.__proto__ || Object.getPrototypeOf(c)).call(this, e));
                n.selection = t;
                n.textNode = document.createTextNode(c.CONTENTS);
                n.domNode.appendChild(n.textNode);
                n._length = 0;
                return n
            }
            i(c, [{
                key: "detach",
                value: function e() {
                    if (this.parent != null)
                        this.parent.removeChild(this)
                }
            }, {
                key: "format",
                value: function e(t, n) {
                    if (this._length !== 0) {
                        return o(c.prototype.__proto__ || Object.getPrototypeOf(c.prototype), "format", this).call(this, t, n)
                    }
                    var i = this,
                        r = 0;
                    while (i != null && i.statics.scope !== h.default.Scope.BLOCK_BLOT) {
                        r += i.offset(i.parent);
                        i = i.parent
                    }
                    if (i != null) {
                        this._length = c.CONTENTS.length;
                        i.optimize();
                        i.formatAt(r, c.CONTENTS.length, t, n);
                        this._length = 0
                    }
                }
            }, {
                key: "index",
                value: function e(t, n) {
                    if (t === this.textNode)
                        return 0;
                    return o(c.prototype.__proto__ || Object.getPrototypeOf(c.prototype), "index", this).call(this, t, n)
                }
            }, {
                key: "length",
                value: function e() {
                    return this._length
                }
            }, {
                key: "position",
                value: function e() {
                    return [this.textNode, this.textNode.data.length]
                }
            }, {
                key: "remove",
                value: function e() {
                    o(c.prototype.__proto__ || Object.getPrototypeOf(c.prototype), "remove", this).call(this);
                    this.parent = null
                }
            }, {
                key: "restore",
                value: function e() {
                    if (this.selection.composing || this.parent == null)
                        return;
                    var t = this.textNode;
                    var n = this.selection.getNativeRange();
                    var i = void 0,
                        r = void 0,
                        o = void 0;
                    if (n != null && n.start.node === t && n.end.node === t) {
                        var a = [t, n.start.offset, n.end.offset];
                        i = a[0];
                        r = a[1];
                        o = a[2]
                    }
                    while (this.domNode.lastChild != null && this.domNode.lastChild !== this.textNode) {
                        this.domNode.parentNode.insertBefore(this.domNode.lastChild, this.domNode)
                    }
                    if (this.textNode.data !== c.CONTENTS) {
                        var s = this.textNode.data.split(c.CONTENTS).join("");
                        if (this.next instanceof d.default) {
                            i = this.next.domNode;
                            this.next.insertAt(0, s);
                            this.textNode.data = c.CONTENTS
                        } else {
                            this.textNode.data = s;
                            this.parent.insertBefore(h.default.create(this.textNode), this);
                            this.textNode = document.createTextNode(c.CONTENTS);
                            this.domNode.appendChild(this.textNode)
                        }
                    }
                    this.remove();
                    if (r != null) {
                        var l = [r, o].map(function (e) {
                            return Math.max(0, Math.min(i.data.length, e - 1))
                        });
                        var u = f(l, 2);
                        r = u[0];
                        o = u[1];
                        return {
                            startNode: i,
                            startOffset: r,
                            endNode: i,
                            endOffset: o
                        }
                    }
                }
            }, {
                key: "update",
                value: function e(t, n) {
                    var i = this;
                    if (t.some(function (e) {
                            return e.type === "characterData" && e.target === i.textNode
                        })) {
                        var r = this.restore();
                        if (r)
                            n.range = r
                    }
                }
            }, {
                key: "value",
                value: function e() {
                    return ""
                }
            }]);
            return c
        }(h.default.Embed);
        c.blotName = "cursor";
        c.className = "ql-cursor";
        c.tagName = "span";
        c.CONTENTS = "\ufeff";
        t.default = c
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(0);
        var r = s(i);
        var o = n(4);
        var a = s(o);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(t, e);

            function t() {
                l(this, t);
                return u(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(r.default.Container);
        f.allowedChildren = [a.default, o.BlockEmbed, f];
        t.default = f
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(0);
        var a = u(i);
        var s = n(7);
        var l = u(s);

        function u(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function c(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function f(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function h(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var d = "\ufeff";
        var p = function (e) {
            h(i, e);

            function i(e) {
                c(this, i);
                var t = f(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e));
                t.contentNode = document.createElement("span");
                t.contentNode.setAttribute("contenteditable", false);
                [].slice.call(t.domNode.childNodes).forEach(function (e) {
                    t.contentNode.appendChild(e)
                });
                t.leftGuard = document.createTextNode(d);
                t.rightGuard = document.createTextNode(d);
                t.domNode.appendChild(t.leftGuard);
                t.domNode.appendChild(t.contentNode);
                t.domNode.appendChild(t.rightGuard);
                return t
            }
            r(i, [{
                key: "index",
                value: function e(t, n) {
                    if (t === this.leftGuard)
                        return 0;
                    if (t === this.rightGuard)
                        return 1;
                    return o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "index", this).call(this, t, n)
                }
            }, {
                key: "restore",
                value: function e(t) {
                    var n = void 0,
                        i = void 0;
                    var r = t.data.split(d).join("");
                    if (t === this.leftGuard) {
                        if (this.prev instanceof l.default) {
                            var o = this.prev.length();
                            this.prev.insertAt(o, r);
                            n = {
                                startNode: this.prev.domNode,
                                startOffset: o + r.length
                            }
                        } else {
                            i = document.createTextNode(r);
                            this.parent.insertBefore(a.default.create(i), this);
                            n = {
                                startNode: i,
                                startOffset: r.length
                            }
                        }
                    } else if (t === this.rightGuard) {
                        if (this.next instanceof l.default) {
                            this.next.insertAt(0, r);
                            n = {
                                startNode: this.next.domNode,
                                startOffset: r.length
                            }
                        } else {
                            i = document.createTextNode(r);
                            this.parent.insertBefore(a.default.create(i), this.next);
                            n = {
                                startNode: i,
                                startOffset: r.length
                            }
                        }
                    }
                    t.data = d;
                    return n
                }
            }, {
                key: "update",
                value: function e(t, n) {
                    var i = this;
                    t.forEach(function (e) {
                        if (e.type === "characterData" && (e.target === i.leftGuard || e.target === i.rightGuard)) {
                            var t = i.restore(e.target);
                            if (t)
                                n.range = t
                        }
                    })
                }
            }]);
            return i
        }(a.default.Embed);
        t.default = p
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.ColorStyle = t.ColorClass = t.ColorAttributor = undefined;
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = n(0);
        var a = s(o);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(n, e);

            function n() {
                l(this, n);
                return u(this, (n.__proto__ || Object.getPrototypeOf(n)).apply(this, arguments))
            }
            i(n, [{
                key: "value",
                value: function e(t) {
                    var e = r(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "value", this).call(this, t);
                    if (!e.startsWith("rgb("))
                        return e;
                    e = e.replace(/^[^\d]+/, "").replace(/[^\d]+$/, "");
                    return "#" + e.split(",").map(function (e) {
                        return ("00" + parseInt(e).toString(16)).slice(-2)
                    }).join("")
                }
            }]);
            return n
        }(a.default.Attributor.Style);
        var h = new a.default.Attributor.Class("color", "ql-color", {
            scope: a.default.Scope.INLINE
        });
        var d = new f("color", "color", {
            scope: a.default.Scope.INLINE
        });
        t.ColorAttributor = f;
        t.ColorClass = h;
        t.ColorStyle = d
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.sanitize = t.default = undefined;
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(6);
        var a = s(i);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(i, e);

            function i() {
                l(this, i);
                return u(this, (i.__proto__ || Object.getPrototypeOf(i)).apply(this, arguments))
            }
            r(i, [{
                key: "format",
                value: function e(t, n) {
                    if (t !== this.statics.blotName || !n)
                        return o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "format", this).call(this, t, n);
                    n = this.constructor.sanitize(n);
                    this.domNode.setAttribute("href", n)
                }
            }], [{
                key: "create",
                value: function e(t) {
                    var n = o(i.__proto__ || Object.getPrototypeOf(i), "create", this).call(this, t);
                    t = this.sanitize(t);
                    n.setAttribute("href", t);
                    n.setAttribute("target", "_blank");
                    return n
                }
            }, {
                key: "formats",
                value: function e(t) {
                    return t.getAttribute("href")
                }
            }, {
                key: "sanitize",
                value: function e(t) {
                    return h(t, this.PROTOCOL_WHITELIST) ? t : this.SANITIZED_URL
                }
            }]);
            return i
        }(a.default);
        f.blotName = "link";
        f.tagName = "A";
        f.SANITIZED_URL = "about:blank";
        f.PROTOCOL_WHITELIST = ["http", "https", "mailto", "tel"];

        function h(e, t) {
            var n = document.createElement("a");
            n.href = e;
            var i = n.href.slice(0, n.href.indexOf(":"));
            return t.indexOf(i) > -1
        }
        t.default = f;
        t.sanitize = h
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var o = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (e) {
                return typeof e
            } :
            function (e) {
                return e && typeof Symbol === "function" && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(107);
        var a = s(r);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var u = function () {
            function n(e) {
                var t = this;
                l(this, n);
                this.select = e;
                this.container = document.createElement("span");
                this.buildPicker();
                this.select.style.display = "none";
                this.select.parentNode.insertBefore(this.container, this.select);
                this.label.addEventListener("mousedown", function () {
                    t.container.classList.toggle("ql-expanded")
                });
                this.select.addEventListener("change", this.update.bind(this))
            }
            i(n, [{
                key: "buildItem",
                value: function e(t) {
                    var n = this;
                    var i = document.createElement("span");
                    i.classList.add("ql-picker-item");
                    if (t.hasAttribute("value")) {
                        i.setAttribute("data-value", t.getAttribute("value"))
                    }
                    if (t.textContent) {
                        i.setAttribute("data-label", t.textContent)
                    }
                    i.addEventListener("click", function () {
                        n.selectItem(i, true)
                    });
                    return i
                }
            }, {
                key: "buildLabel",
                value: function e() {
                    var t = document.createElement("span");
                    t.classList.add("ql-picker-label");
                    t.innerHTML = a.default;
                    this.container.appendChild(t);
                    return t
                }
            }, {
                key: "buildOptions",
                value: function e() {
                    var n = this;
                    var i = document.createElement("span");
                    i.classList.add("ql-picker-options");
                    [].slice.call(this.select.options).forEach(function (e) {
                        var t = n.buildItem(e);
                        i.appendChild(t);
                        if (e.selected === true) {
                            n.selectItem(t)
                        }
                    });
                    this.container.appendChild(i)
                }
            }, {
                key: "buildPicker",
                value: function e() {
                    var t = this;
                    [].slice.call(this.select.attributes).forEach(function (e) {
                        t.container.setAttribute(e.name, e.value)
                    });
                    this.container.classList.add("ql-picker");
                    this.label = this.buildLabel();
                    this.buildOptions()
                }
            }, {
                key: "close",
                value: function e() {
                    this.container.classList.remove("ql-expanded")
                }
            }, {
                key: "selectItem",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
                    var i = this.container.querySelector(".ql-selected");
                    if (t === i)
                        return;
                    if (i != null) {
                        i.classList.remove("ql-selected")
                    }
                    if (t == null)
                        return;
                    t.classList.add("ql-selected");
                    this.select.selectedIndex = [].indexOf.call(t.parentNode.children, t);
                    if (t.hasAttribute("data-value")) {
                        this.label.setAttribute("data-value", t.getAttribute("data-value"))
                    } else {
                        this.label.removeAttribute("data-value")
                    }
                    if (t.hasAttribute("data-label")) {
                        this.label.setAttribute("data-label", t.getAttribute("data-label"))
                    } else {
                        this.label.removeAttribute("data-label")
                    }
                    if (n) {
                        if (typeof Event === "function") {
                            this.select.dispatchEvent(new Event("change"))
                        } else if ((typeof Event === "undefined" ? "undefined" : o(Event)) === "object") {
                            var r = document.createEvent("Event");
                            r.initEvent("change", true, true);
                            this.select.dispatchEvent(r)
                        }
                        this.close()
                    }
                }
            }, {
                key: "update",
                value: function e() {
                    var t = void 0;
                    if (this.select.selectedIndex > -1) {
                        var n = this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];
                        t = this.select.options[this.select.selectedIndex];
                        this.selectItem(n)
                    } else {
                        this.selectItem(null)
                    }
                    var i = t != null && t !== this.select.querySelector("option[selected]");
                    this.label.classList.toggle("ql-active", i)
                }
            }]);
            return n
        }();
        t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(0);
        var r = A(i);
        var o = n(5);
        var a = A(o);
        var s = n(4);
        var l = A(s);
        var u = n(16);
        var c = A(u);
        var f = n(24);
        var h = A(f);
        var d = n(23);
        var p = A(d);
        var v = n(25);
        var g = A(v);
        var _ = n(6);
        var y = A(_);
        var m = n(22);
        var b = A(m);
        var w = n(7);
        var x = A(w);
        var E = n(55);
        var k = A(E);
        var T = n(42);
        var O = A(T);
        var S = n(35);
        var C = A(S);

        function A(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        a.default.register({
            "blots/block": l.default,
            "blots/block/embed": s.BlockEmbed,
            "blots/break": c.default,
            "blots/container": h.default,
            "blots/cursor": p.default,
            "blots/embed": g.default,
            "blots/inline": y.default,
            "blots/scroll": b.default,
            "blots/text": x.default,
            "modules/clipboard": k.default,
            "modules/history": O.default,
            "modules/keyboard": C.default
        });
        r.default.register(l.default, c.default, p.default, y.default, b.default, x.default);
        t.default = a.default
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var a = n(1);
        var i = function () {
            function e(e) {
                this.domNode = e;
                this.attach()
            }
            Object.defineProperty(e.prototype, "statics", {
                get: function () {
                    return this.constructor
                },
                enumerable: true,
                configurable: true
            });
            e.create = function (e) {
                if (this.tagName == null) {
                    throw new a.ParchmentError("Blot definition missing tagName")
                }
                var t;
                if (Array.isArray(this.tagName)) {
                    if (typeof e === "string") {
                        e = e.toUpperCase();
                        if (parseInt(e).toString() === e) {
                            e = parseInt(e)
                        }
                    }
                    if (typeof e === "number") {
                        t = document.createElement(this.tagName[e - 1])
                    } else if (this.tagName.indexOf(e) > -1) {
                        t = document.createElement(e)
                    } else {
                        t = document.createElement(this.tagName[0])
                    }
                } else {
                    t = document.createElement(this.tagName)
                }
                if (this.className) {
                    t.classList.add(this.className)
                }
                return t
            };
            e.prototype.attach = function () {
                this.domNode[a.DATA_KEY] = {
                    blot: this
                }
            };
            e.prototype.clone = function () {
                var e = this.domNode.cloneNode(false);
                return a.create(e)
            };
            e.prototype.detach = function () {
                if (this.parent != null)
                    this.parent.removeChild(this);
                delete this.domNode[a.DATA_KEY]
            };
            e.prototype.deleteAt = function (e, t) {
                var n = this.isolate(e, t);
                n.remove()
            };
            e.prototype.formatAt = function (e, t, n, i) {
                var r = this.isolate(e, t);
                if (a.query(n, a.Scope.BLOT) != null && i) {
                    r.wrap(n, i)
                } else if (a.query(n, a.Scope.ATTRIBUTE) != null) {
                    var o = a.create(this.statics.scope);
                    r.wrap(o);
                    o.format(n, i)
                }
            };
            e.prototype.insertAt = function (e, t, n) {
                var i = n == null ? a.create("text", t) : a.create(t, n);
                var r = this.split(e);
                this.parent.insertBefore(i, r)
            };
            e.prototype.insertInto = function (e, t) {
                if (this.parent != null) {
                    this.parent.children.remove(this)
                }
                e.children.insertBefore(this, t);
                if (t != null) {
                    var n = t.domNode
                }
                if (this.next == null || this.domNode.nextSibling != n) {
                    e.domNode.insertBefore(this.domNode, typeof n !== "undefined" ? n : null)
                }
                this.parent = e;
                this.scroll = e.scroll
            };
            e.prototype.isolate = function (e, t) {
                var n = this.split(e);
                n.split(t);
                return n
            };
            e.prototype.length = function () {
                return 1
            };
            e.prototype.offset = function (e) {
                if (e === void 0) {
                    e = this.parent
                }
                if (this.parent == null || this == e)
                    return 0;
                return this.parent.children.offset(this) + this.parent.offset(e)
            };
            e.prototype.optimize = function (e) {
                if (this.domNode[a.DATA_KEY] != null) {
                    delete this.domNode[a.DATA_KEY].mutations
                }
            };
            e.prototype.remove = function () {
                if (this.domNode.parentNode != null) {
                    this.domNode.parentNode.removeChild(this.domNode)
                }
                this.detach()
            };
            e.prototype.replace = function (e) {
                if (e.parent == null)
                    return;
                e.parent.insertBefore(this, e.next);
                e.remove()
            };
            e.prototype.replaceWith = function (e, t) {
                var n = typeof e === "string" ? a.create(e, t) : e;
                n.replace(this);
                return n
            };
            e.prototype.split = function (e, t) {
                return e === 0 ? this : this.next
            };
            e.prototype.update = function (e, t) {};
            e.prototype.wrap = function (e, t) {
                var n = typeof e === "string" ? a.create(e, t) : e;
                if (this.parent != null) {
                    this.parent.insertBefore(n, this.next)
                }
                n.appendChild(this);
                return n
            };
            e.blotName = "abstract";
            return e
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(12);
        var o = n(32);
        var a = n(33);
        var s = n(1);
        var i = function () {
            function e(e) {
                this.attributes = {};
                this.domNode = e;
                this.build()
            }
            e.prototype.attribute = function (e, t) {
                if (t) {
                    if (e.add(this.domNode, t)) {
                        if (e.value(this.domNode) != null) {
                            this.attributes[e.attrName] = e
                        } else {
                            delete this.attributes[e.attrName]
                        }
                    }
                } else {
                    e.remove(this.domNode);
                    delete this.attributes[e.attrName]
                }
            };
            e.prototype.build = function () {
                var n = this;
                this.attributes = {};
                var e = r.default.keys(this.domNode);
                var t = o.default.keys(this.domNode);
                var i = a.default.keys(this.domNode);
                e.concat(t).concat(i).forEach(function (e) {
                    var t = s.query(e, s.Scope.ATTRIBUTE);
                    if (t instanceof r.default) {
                        n.attributes[t.attrName] = t
                    }
                })
            };
            e.prototype.copy = function (n) {
                var i = this;
                Object.keys(this.attributes).forEach(function (e) {
                    var t = i.attributes[e].value(i.domNode);
                    n.format(e, t)
                })
            };
            e.prototype.move = function (e) {
                var t = this;
                this.copy(e);
                Object.keys(this.attributes).forEach(function (e) {
                    t.attributes[e].remove(t.domNode)
                });
                this.attributes = {}
            };
            e.prototype.values = function () {
                var n = this;
                return Object.keys(this.attributes).reduce(function (e, t) {
                    e[t] = n.attributes[t].value(n.domNode);
                    return e
                }, {})
            };
            return e
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(12);

        function o(e, t) {
            var n = e.getAttribute("class") || "";
            return n.split(/\s+/).filter(function (e) {
                return e.indexOf(t + "-") === 0
            })
        }
        var a = function (e) {
            i(t, e);

            function t() {
                return e !== null && e.apply(this, arguments) || this
            }
            t.keys = function (e) {
                return (e.getAttribute("class") || "").split(/\s+/).map(function (e) {
                    return e.split("-").slice(0, -1).join("-")
                })
            };
            t.prototype.add = function (e, t) {
                if (!this.canAdd(e, t))
                    return false;
                this.remove(e);
                e.classList.add(this.keyName + "-" + t);
                return true
            };
            t.prototype.remove = function (t) {
                var e = o(t, this.keyName);
                e.forEach(function (e) {
                    t.classList.remove(e)
                });
                if (t.classList.length === 0) {
                    t.removeAttribute("class")
                }
            };
            t.prototype.value = function (e) {
                var t = o(e, this.keyName)[0] || "";
                var n = t.slice(this.keyName.length + 1);
                return this.canAdd(e, n) ? n : ""
            };
            return t
        }(r.default);
        t.default = a
    }, function (e, t, n) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(12);

        function o(e) {
            var t = e.split("-");
            var n = t.slice(1).map(function (e) {
                return e[0].toUpperCase() + e.slice(1)
            }).join("");
            return t[0] + n
        }
        var a = function (e) {
            i(t, e);

            function t() {
                return e !== null && e.apply(this, arguments) || this
            }
            t.keys = function (e) {
                return (e.getAttribute("style") || "").split(";").map(function (e) {
                    var t = e.split(":");
                    return t[0].trim()
                })
            };
            t.prototype.add = function (e, t) {
                if (!this.canAdd(e, t))
                    return false;
                e.style[o(this.keyName)] = t;
                return true
            };
            t.prototype.remove = function (e) {
                e.style[o(this.keyName)] = "";
                if (!e.getAttribute("style")) {
                    e.removeAttribute("style")
                }
            };
            t.prototype.value = function (e) {
                var t = e.style[o(this.keyName)];
                return this.canAdd(e, t) ? t : ""
            };
            return t
        }(r.default);
        t.default = a
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();

        function r(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var o = function () {
            function n(e, t) {
                r(this, n);
                this.quill = e;
                this.options = t;
                this.modules = {}
            }
            i(n, [{
                key: "init",
                value: function e() {
                    var t = this;
                    Object.keys(this.options.modules).forEach(function (e) {
                        if (t.modules[e] == null) {
                            t.addModule(e)
                        }
                    })
                }
            }, {
                key: "addModule",
                value: function e(t) {
                    var n = this.quill.constructor.import("modules/" + t);
                    this.modules[t] = new n(this.quill, this.options.modules[t] || {});
                    return this.modules[t]
                }
            }]);
            return n
        }();
        o.DEFAULTS = {
            modules: {}
        };
        o.themes = {
            default: o
        };
        t.default = o
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.SHORTKEY = t.default = undefined;
        var x = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (e) {
                return typeof e
            } :
            function (e) {
                return e && typeof Symbol === "function" && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };
        var E = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(21);
        var o = O(r);
        var a = n(11);
        var k = O(a);
        var s = n(3);
        var l = O(s);
        var u = n(2);
        var c = O(u);
        var f = n(20);
        var d = O(f);
        var h = n(0);
        var T = O(h);
        var p = n(25);
        var v = O(p);
        var g = n(5);
        var _ = O(g);
        var y = n(10);
        var m = O(y);
        var b = n(9);
        var w = O(b);

        function O(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function S(e, t, n) {
            if (t in e) {
                Object.defineProperty(e, t, {
                    value: n,
                    enumerable: true,
                    configurable: true,
                    writable: true
                })
            } else {
                e[t] = n
            }
            return e
        }

        function C(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function A(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function j(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var P = (0,
            m.default)("quill:keyboard");
        var D = /Mac/i.test(navigator.platform) ? "metaKey" : "ctrlKey";
        var I = function (e) {
            j(w, e);
            i(w, null, [{
                key: "match",
                value: function e(t, n) {
                    n = U(n);
                    if (["altKey", "ctrlKey", "metaKey", "shiftKey"].some(function (e) {
                            return !!n[e] !== t[e] && n[e] !== null
                        })) {
                        return false
                    }
                    return n.key === (t.which || t.keyCode)
                }
            }]);

            function w(t, e) {
                C(this, w);
                var n = A(this, (w.__proto__ || Object.getPrototypeOf(w)).call(this, t, e));
                n.bindings = {};
                Object.keys(n.options.bindings).forEach(function (e) {
                    if (e === "list autofill" && t.scroll.whitelist != null && !t.scroll.whitelist["list"]) {
                        return
                    }
                    if (n.options.bindings[e]) {
                        n.addBinding(n.options.bindings[e])
                    }
                });
                n.addBinding({
                    key: w.keys.ENTER,
                    shiftKey: null
                }, B);
                n.addBinding({
                    key: w.keys.ENTER,
                    metaKey: null,
                    ctrlKey: null,
                    altKey: null
                }, function () {});
                if (/Firefox/i.test(navigator.userAgent)) {
                    n.addBinding({
                        key: w.keys.BACKSPACE
                    }, {
                        collapsed: true
                    }, L);
                    n.addBinding({
                        key: w.keys.DELETE
                    }, {
                        collapsed: true
                    }, R)
                } else {
                    n.addBinding({
                        key: w.keys.BACKSPACE
                    }, {
                        collapsed: true,
                        prefix: /^.?$/
                    }, L);
                    n.addBinding({
                        key: w.keys.DELETE
                    }, {
                        collapsed: true,
                        suffix: /^.?$/
                    }, R)
                }
                n.addBinding({
                    key: w.keys.BACKSPACE
                }, {
                    collapsed: false
                }, M);
                n.addBinding({
                    key: w.keys.DELETE
                }, {
                    collapsed: false
                }, M);
                n.addBinding({
                    key: w.keys.BACKSPACE,
                    altKey: null,
                    ctrlKey: null,
                    metaKey: null,
                    shiftKey: null
                }, {
                    collapsed: true,
                    offset: 0
                }, L);
                n.listen();
                return n
            }
            i(w, [{
                key: "addBinding",
                value: function e(t) {
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
                    var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
                    var r = U(t);
                    if (r == null || r.key == null) {
                        return P.warn("Attempted to add invalid keyboard binding", r)
                    }
                    if (typeof n === "function") {
                        n = {
                            handler: n
                        }
                    }
                    if (typeof i === "function") {
                        i = {
                            handler: i
                        }
                    }
                    r = (0,
                        l.default)(r, n, i);
                    this.bindings[r.key] = this.bindings[r.key] || [];
                    this.bindings[r.key].push(r)
                }
            }, {
                key: "listen",
                value: function e() {
                    var b = this;
                    this.quill.root.addEventListener("keydown", function (t) {
                        if (t.defaultPrevented)
                            return;
                        var e = t.which || t.keyCode;
                        var n = (b.bindings[e] || []).filter(function (e) {
                            return w.match(t, e)
                        });
                        if (n.length === 0)
                            return;
                        var i = b.quill.getSelection();
                        if (i == null || !b.quill.hasFocus())
                            return;
                        var r = b.quill.getLine(i.index),
                            o = E(r, 2),
                            a = o[0],
                            s = o[1];
                        var l = b.quill.getLeaf(i.index),
                            u = E(l, 2),
                            c = u[0],
                            f = u[1];
                        var h = i.length === 0 ? [c, f] : b.quill.getLeaf(i.index + i.length),
                            d = E(h, 2),
                            p = d[0],
                            v = d[1];
                        var g = c instanceof T.default.Text ? c.value().slice(0, f) : "";
                        var _ = p instanceof T.default.Text ? p.value().slice(v) : "";
                        var y = {
                            collapsed: i.length === 0,
                            empty: i.length === 0 && a.length() <= 1,
                            format: b.quill.getFormat(i),
                            offset: s,
                            prefix: g,
                            suffix: _
                        };
                        var m = n.some(function (t) {
                            if (t.collapsed != null && t.collapsed !== y.collapsed)
                                return false;
                            if (t.empty != null && t.empty !== y.empty)
                                return false;
                            if (t.offset != null && t.offset !== y.offset)
                                return false;
                            if (Array.isArray(t.format)) {
                                if (t.format.every(function (e) {
                                        return y.format[e] == null
                                    })) {
                                    return false
                                }
                            } else if (x(t.format) === "object") {
                                if (!Object.keys(t.format).every(function (e) {
                                        if (t.format[e] === true)
                                            return y.format[e] != null;
                                        if (t.format[e] === false)
                                            return y.format[e] == null;
                                        return (0,
                                            k.default)(t.format[e], y.format[e])
                                    })) {
                                    return false
                                }
                            }
                            if (t.prefix != null && !t.prefix.test(y.prefix))
                                return false;
                            if (t.suffix != null && !t.suffix.test(y.suffix))
                                return false;
                            return t.handler.call(b, i, y) !== true
                        });
                        if (m) {
                            t.preventDefault()
                        }
                    })
                }
            }]);
            return w
        }(w.default);
        I.keys = {
            BACKSPACE: 8,
            TAB: 9,
            ENTER: 13,
            ESCAPE: 27,
            LEFT: 37,
            UP: 38,
            RIGHT: 39,
            DOWN: 40,
            DELETE: 46
        };
        I.DEFAULTS = {
            bindings: {
                bold: $("bold"),
                italic: $("italic"),
                underline: $("underline"),
                indent: {
                    key: I.keys.TAB,
                    format: ["blockquote", "indent", "list"],
                    handler: function e(t, n) {
                        if (n.collapsed && n.offset !== 0)
                            return true;
                        this.quill.format("indent", "+1", _.default.sources.USER)
                    }
                },
                outdent: {
                    key: I.keys.TAB,
                    shiftKey: true,
                    format: ["blockquote", "indent", "list"],
                    handler: function e(t, n) {
                        if (n.collapsed && n.offset !== 0)
                            return true;
                        this.quill.format("indent", "-1", _.default.sources.USER)
                    }
                },
                "outdent backspace": {
                    key: I.keys.BACKSPACE,
                    collapsed: true,
                    shiftKey: null,
                    metaKey: null,
                    ctrlKey: null,
                    altKey: null,
                    format: ["indent", "list"],
                    offset: 0,
                    handler: function e(t, n) {
                        if (n.format.indent != null) {
                            this.quill.format("indent", "-1", _.default.sources.USER)
                        } else if (n.format.list != null) {
                            this.quill.format("list", false, _.default.sources.USER)
                        }
                    }
                },
                "indent code-block": q(true),
                "outdent code-block": q(false),
                "remove tab": {
                    key: I.keys.TAB,
                    shiftKey: true,
                    collapsed: true,
                    prefix: /\t$/,
                    handler: function e(t) {
                        this.quill.deleteText(t.index - 1, 1, _.default.sources.USER)
                    }
                },
                tab: {
                    key: I.keys.TAB,
                    handler: function e(t) {
                        this.quill.history.cutoff();
                        var n = (new c.default).retain(t.index).delete(t.length).insert("\t");
                        this.quill.updateContents(n, _.default.sources.USER);
                        this.quill.history.cutoff();
                        this.quill.setSelection(t.index + 1, _.default.sources.SILENT)
                    }
                },
                "list empty enter": {
                    key: I.keys.ENTER,
                    collapsed: true,
                    format: ["list"],
                    empty: true,
                    handler: function e(t, n) {
                        this.quill.format("list", false, _.default.sources.USER);
                        if (n.format.indent) {
                            this.quill.format("indent", false, _.default.sources.USER)
                        }
                    }
                },
                "checklist enter": {
                    key: I.keys.ENTER,
                    collapsed: true,
                    format: {
                        list: "checked"
                    },
                    handler: function e(t) {
                        var n = this.quill.getLine(t.index),
                            i = E(n, 2),
                            r = i[0],
                            o = i[1];
                        var a = (new c.default).retain(t.index).insert("\n", {
                            list: "checked"
                        }).retain(r.length() - o - 1).retain(1, {
                            list: "unchecked"
                        });
                        this.quill.updateContents(a, _.default.sources.USER);
                        this.quill.setSelection(t.index + 1, _.default.sources.SILENT);
                        this.quill.scrollIntoView()
                    }
                },
                "header enter": {
                    key: I.keys.ENTER,
                    collapsed: true,
                    format: ["header"],
                    suffix: /^$/,
                    handler: function e(t, n) {
                        var i = this.quill.getLine(t.index),
                            r = E(i, 2),
                            o = r[0],
                            a = r[1];
                        var s = (new c.default).retain(t.index).insert("\n", n.format).retain(o.length() - a - 1).retain(1, {
                            header: null
                        });
                        this.quill.updateContents(s, _.default.sources.USER);
                        this.quill.setSelection(t.index + 1, _.default.sources.SILENT);
                        this.quill.scrollIntoView()
                    }
                },
                "list autofill": {
                    key: " ",
                    collapsed: true,
                    format: {
                        list: false
                    },
                    prefix: /^\s*?(\d+\.|-|\[ ?\]|\[x\])$/,
                    handler: function e(t, n) {
                        var i = n.prefix.length;
                        var r = this.quill.getLine(t.index),
                            o = E(r, 2),
                            a = o[0],
                            s = o[1];
                        if (s > i)
                            return true;
                        var l = void 0;
                        switch (n.prefix.trim()) {
                            case "[]":
                            case "[ ]":
                                l = "unchecked";
                                break;
                            case "[x]":
                                l = "checked";
                                break;
                            case "-":
                                l = "bullet";
                                break;
                            default:
                                l = "ordered"
                        }
                        this.quill.insertText(t.index, " ", _.default.sources.USER);
                        this.quill.history.cutoff();
                        var u = (new c.default).retain(t.index - s).delete(i + 1).retain(a.length() - 2 - s).retain(1, {
                            list: l
                        });
                        this.quill.updateContents(u, _.default.sources.USER);
                        this.quill.history.cutoff();
                        this.quill.setSelection(t.index - i, _.default.sources.SILENT)
                    }
                },
                "code exit": {
                    key: I.keys.ENTER,
                    collapsed: true,
                    format: ["code-block"],
                    prefix: /\n\n$/,
                    suffix: /^\s+$/,
                    handler: function e(t) {
                        var n = this.quill.getLine(t.index),
                            i = E(n, 2),
                            r = i[0],
                            o = i[1];
                        var a = (new c.default).retain(t.index + r.length() - o - 2).retain(1, {
                            "code-block": null
                        }).delete(1);
                        this.quill.updateContents(a, _.default.sources.USER)
                    }
                },
                "embed left": N(I.keys.LEFT, false),
                "embed left shift": N(I.keys.LEFT, true),
                "embed right": N(I.keys.RIGHT, false),
                "embed right shift": N(I.keys.RIGHT, true)
            }
        };

        function N(a, s) {
            var e;
            var t = a === I.keys.LEFT ? "prefix" : "suffix";
            return e = {
                    key: a,
                    shiftKey: s
                },
                S(e, t, /^$/),
                S(e, "handler", function e(t) {
                    var n = t.index;
                    if (a === I.keys.RIGHT) {
                        n += t.length + 1
                    }
                    var i = this.quill.getLeaf(n),
                        r = E(i, 1),
                        o = r[0];
                    if (!(o instanceof v.default))
                        return true;
                    if (a === I.keys.LEFT) {
                        if (s) {
                            this.quill.setSelection(t.index - 1, t.length + 1, _.default.sources.USER)
                        } else {
                            this.quill.setSelection(t.index - 1, _.default.sources.USER)
                        }
                    } else {
                        if (s) {
                            this.quill.setSelection(t.index, t.length + 1, _.default.sources.USER)
                        } else {
                            this.quill.setSelection(t.index + t.length + 1, _.default.sources.USER)
                        }
                    }
                    return false
                }),
                e
        }

        function L(e, t) {
            if (e.index === 0 || this.quill.getLength() <= 1)
                return;
            var n = this.quill.getLine(e.index),
                i = E(n, 1),
                r = i[0];
            var o = {};
            if (t.offset === 0) {
                var a = this.quill.getLine(e.index - 1),
                    s = E(a, 1),
                    l = s[0];
                if (l != null && l.length() > 1) {
                    var u = r.formats();
                    var c = this.quill.getFormat(e.index - 1, 1);
                    o = d.default.attributes.diff(u, c) || {}
                }
            }
            var f = /[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix) ? 2 : 1;
            this.quill.deleteText(e.index - f, f, _.default.sources.USER);
            if (Object.keys(o).length > 0) {
                this.quill.formatLine(e.index - f, f, o, _.default.sources.USER)
            }
            this.quill.focus()
        }

        function R(e, t) {
            var n = /^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix) ? 2 : 1;
            if (e.index >= this.quill.getLength() - n)
                return;
            var i = {},
                r = 0;
            var o = this.quill.getLine(e.index),
                a = E(o, 1),
                s = a[0];
            if (t.offset >= s.length() - 1) {
                var l = this.quill.getLine(e.index + 1),
                    u = E(l, 1),
                    c = u[0];
                if (c) {
                    var f = s.formats();
                    var h = this.quill.getFormat(e.index, 1);
                    i = d.default.attributes.diff(f, h) || {};
                    r = c.length()
                }
            }
            this.quill.deleteText(e.index, n, _.default.sources.USER);
            if (Object.keys(i).length > 0) {
                this.quill.formatLine(e.index + r - 1, n, i, _.default.sources.USER)
            }
        }

        function M(e) {
            var t = this.quill.getLines(e);
            var n = {};
            if (t.length > 1) {
                var i = t[0].formats();
                var r = t[t.length - 1].formats();
                n = d.default.attributes.diff(r, i) || {}
            }
            this.quill.deleteText(e, _.default.sources.USER);
            if (Object.keys(n).length > 0) {
                this.quill.formatLine(e.index, 1, n, _.default.sources.USER)
            }
            this.quill.setSelection(e.index, _.default.sources.SILENT);
            this.quill.focus()
        }

        function B(e, n) {
            var t = this;
            if (e.length > 0) {
                this.quill.scroll.deleteAt(e.index, e.length)
            }
            var i = Object.keys(n.format).reduce(function (e, t) {
                if (T.default.query(t, T.default.Scope.BLOCK) && !Array.isArray(n.format[t])) {
                    e[t] = n.format[t]
                }
                return e
            }, {});
            this.quill.insertText(e.index, "\n", i, _.default.sources.USER);
            this.quill.setSelection(e.index + 1, _.default.sources.SILENT);
            this.quill.focus();
            Object.keys(n.format).forEach(function (e) {
                if (i[e] != null)
                    return;
                if (Array.isArray(n.format[e]))
                    return;
                if (e === "link")
                    return;
                t.quill.format(e, n.format[e], _.default.sources.USER)
            })
        }

        function q(d) {
            return {
                key: I.keys.TAB,
                shiftKey: !d,
                format: {
                    "code-block": true
                },
                handler: function e(t) {
                    var n = T.default.query("code-block");
                    var i = t.index,
                        r = t.length;
                    var o = this.quill.scroll.descendant(n, i),
                        a = E(o, 2),
                        s = a[0],
                        l = a[1];
                    if (s == null)
                        return;
                    var u = this.quill.getIndex(s);
                    var c = s.newlineIndex(l, true) + 1;
                    var f = s.newlineIndex(u + l + r);
                    var h = s.domNode.textContent.slice(c, f).split("\n");
                    l = 0;
                    h.forEach(function (e, t) {
                        if (d) {
                            s.insertAt(c + l, n.TAB);
                            l += n.TAB.length;
                            if (t === 0) {
                                i += n.TAB.length
                            } else {
                                r += n.TAB.length
                            }
                        } else if (e.startsWith(n.TAB)) {
                            s.deleteAt(c + l, n.TAB.length);
                            l -= n.TAB.length;
                            if (t === 0) {
                                i -= n.TAB.length
                            } else {
                                r -= n.TAB.length
                            }
                        }
                        l += e.length + 1
                    });
                    this.quill.update(_.default.sources.USER);
                    this.quill.setSelection(i, r, _.default.sources.SILENT)
                }
            }
        }

        function $(i) {
            return {
                key: i[0].toUpperCase(),
                shortKey: true,
                handler: function e(t, n) {
                    this.quill.format(i, !n.format[i], _.default.sources.USER)
                }
            }
        }

        function U(e) {
            if (typeof e === "string" || typeof e === "number") {
                return U({
                    key: e
                })
            }
            if ((typeof e === "undefined" ? "undefined" : x(e)) === "object") {
                e = (0,
                    o.default)(e, false)
            }
            if (typeof e.key === "string") {
                if (I.keys[e.key.toUpperCase()] != null) {
                    e.key = I.keys[e.key.toUpperCase()]
                } else if (e.key.length === 1) {
                    e.key = e.key.toUpperCase().charCodeAt(0)
                } else {
                    return null
                }
            }
            if (e.shortKey) {
                e[D] = e.shortKey;
                delete e.shortKey
            }
            return e
        }
        t.default = I;
        t.SHORTKEY = D
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.AlignStyle = t.AlignClass = t.AlignAttribute = undefined;
        var i = n(0);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        var a = {
            scope: r.default.Scope.BLOCK,
            whitelist: ["right", "center", "justify"]
        };
        var s = new r.default.Attributor.Attribute("align", "align", a);
        var l = new r.default.Attributor.Class("align", "ql-align", a);
        var u = new r.default.Attributor.Style("align", "text-align", a);
        t.AlignAttribute = s;
        t.AlignClass = l;
        t.AlignStyle = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.BackgroundStyle = t.BackgroundClass = undefined;
        var i = n(0);
        var r = a(i);
        var o = n(26);

        function a(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        var s = new r.default.Attributor.Class("background", "ql-bg", {
            scope: r.default.Scope.INLINE
        });
        var l = new o.ColorAttributor("background", "background-color", {
            scope: r.default.Scope.INLINE
        });
        t.BackgroundClass = s;
        t.BackgroundStyle = l
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.DirectionStyle = t.DirectionClass = t.DirectionAttribute = undefined;
        var i = n(0);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        var a = {
            scope: r.default.Scope.BLOCK,
            whitelist: ["rtl"]
        };
        var s = new r.default.Attributor.Attribute("direction", "dir", a);
        var l = new r.default.Attributor.Class("direction", "ql-direction", a);
        var u = new r.default.Attributor.Style("direction", "direction", a);
        t.DirectionAttribute = s;
        t.DirectionClass = l;
        t.DirectionStyle = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.FontClass = t.FontStyle = undefined;
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = n(0);
        var a = s(o);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = {
            scope: a.default.Scope.INLINE,
            whitelist: ["serif", "monospace"]
        };
        var h = new a.default.Attributor.Class("font", "ql-font", f);
        var d = function (e) {
            c(n, e);

            function n() {
                l(this, n);
                return u(this, (n.__proto__ || Object.getPrototypeOf(n)).apply(this, arguments))
            }
            i(n, [{
                key: "value",
                value: function e(t) {
                    return r(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "value", this).call(this, t).replace(/["']/g, "")
                }
            }]);
            return n
        }(a.default.Attributor.Style);
        var p = new d("font", "font-family", f);
        t.FontStyle = p;
        t.FontClass = h
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.SizeStyle = t.SizeClass = undefined;
        var i = n(0);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        var a = new r.default.Attributor.Class("size", "ql-size", {
            scope: r.default.Scope.INLINE,
            whitelist: ["small", "large", "huge"]
        });
        var s = new r.default.Attributor.Style("size", "font-size", {
            scope: r.default.Scope.INLINE,
            whitelist: ["10px", "18px", "32px"]
        });
        t.SizeClass = a;
        t.SizeStyle = s
    }, function (e, t, n) {
        "use strict";
        e.exports = {
            align: {
                "": n(76),
                center: n(77),
                right: n(78),
                justify: n(79)
            },
            background: n(80),
            blockquote: n(81),
            bold: n(82),
            clean: n(83),
            code: n(58),
            "code-block": n(58),
            color: n(84),
            direction: {
                "": n(85),
                rtl: n(86)
            },
            float: {
                center: n(87),
                full: n(88),
                left: n(89),
                right: n(90)
            },
            formula: n(91),
            header: {
                1: n(92),
                2: n(93)
            },
            italic: n(94),
            image: n(95),
            indent: {
                "+1": n(96),
                "-1": n(97)
            },
            link: n(98),
            list: {
                ordered: n(99),
                bullet: n(100),
                check: n(101)
            },
            script: {
                sub: n(102),
                super: n(103)
            },
            strike: n(104),
            underline: n(105),
            video: n(106)
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.getLastChangeIndex = t.default = undefined;
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(0);
        var o = c(r);
        var a = n(5);
        var s = c(a);
        var l = n(9);
        var u = c(l);

        function c(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function f(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function h(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function d(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var p = function (e) {
            d(n, e);

            function n(e, t) {
                f(this, n);
                var r = h(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t));
                r.lastRecorded = 0;
                r.ignoreChange = false;
                r.clear();
                r.quill.on(s.default.events.EDITOR_CHANGE, function (e, t, n, i) {
                    if (e !== s.default.events.TEXT_CHANGE || r.ignoreChange)
                        return;
                    if (!r.options.userOnly || i === s.default.sources.USER) {
                        r.record(t, n)
                    } else {
                        r.transform(t)
                    }
                });
                r.quill.keyboard.addBinding({
                    key: "Z",
                    shortKey: true
                }, r.undo.bind(r));
                r.quill.keyboard.addBinding({
                    key: "Z",
                    shortKey: true,
                    shiftKey: true
                }, r.redo.bind(r));
                if (/Win/i.test(navigator.platform)) {
                    r.quill.keyboard.addBinding({
                        key: "Y",
                        shortKey: true
                    }, r.redo.bind(r))
                }
                return r
            }
            i(n, [{
                key: "change",
                value: function e(t, n) {
                    if (this.stack[t].length === 0)
                        return;
                    var i = this.stack[t].pop();
                    this.lastRecorded = 0;
                    this.ignoreChange = true;
                    this.quill.updateContents(i[t], s.default.sources.USER);
                    this.ignoreChange = false;
                    var r = g(i[t]);
                    this.quill.setSelection(r);
                    this.stack[n].push(i)
                }
            }, {
                key: "clear",
                value: function e() {
                    this.stack = {
                        undo: [],
                        redo: []
                    }
                }
            }, {
                key: "cutoff",
                value: function e() {
                    this.lastRecorded = 0
                }
            }, {
                key: "record",
                value: function e(t, n) {
                    if (t.ops.length === 0)
                        return;
                    this.stack.redo = [];
                    var i = this.quill.getContents().diff(n);
                    var r = Date.now();
                    if (this.lastRecorded + this.options.delay > r && this.stack.undo.length > 0) {
                        var o = this.stack.undo.pop();
                        i = i.compose(o.undo);
                        t = o.redo.compose(t)
                    } else {
                        this.lastRecorded = r
                    }
                    this.stack.undo.push({
                        redo: t,
                        undo: i
                    });
                    if (this.stack.undo.length > this.options.maxStack) {
                        this.stack.undo.shift()
                    }
                }
            }, {
                key: "redo",
                value: function e() {
                    this.change("redo", "undo")
                }
            }, {
                key: "transform",
                value: function e(t) {
                    this.stack.undo.forEach(function (e) {
                        e.undo = t.transform(e.undo, true);
                        e.redo = t.transform(e.redo, true)
                    });
                    this.stack.redo.forEach(function (e) {
                        e.undo = t.transform(e.undo, true);
                        e.redo = t.transform(e.redo, true)
                    })
                }
            }, {
                key: "undo",
                value: function e() {
                    this.change("undo", "redo")
                }
            }]);
            return n
        }(u.default);
        p.DEFAULTS = {
            delay: 1e3,
            maxStack: 100,
            userOnly: false
        };

        function v(e) {
            var t = e.ops[e.ops.length - 1];
            if (t == null)
                return false;
            if (t.insert != null) {
                return typeof t.insert === "string" && t.insert.endsWith("\n")
            }
            if (t.attributes != null) {
                return Object.keys(t.attributes).some(function (e) {
                    return o.default.query(e, o.default.Scope.BLOCK) != null
                })
            }
            return false
        }

        function g(e) {
            var t = e.reduce(function (e, t) {
                e += t.delete || 0;
                return e
            }, 0);
            var n = e.length() - t;
            if (v(e)) {
                n -= 1
            }
            return n
        }
        t.default = p;
        t.getLastChangeIndex = g
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.BaseTooltip = undefined;
        var o = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var i = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(3);
        var a = E(r);
        var s = n(2);
        var l = E(s);
        var u = n(8);
        var c = E(u);
        var f = n(35);
        var h = E(f);
        var d = n(34);
        var p = E(d);
        var v = n(59);
        var g = E(v);
        var _ = n(60);
        var y = E(_);
        var m = n(28);
        var b = E(m);
        var w = n(61);
        var x = E(w);

        function E(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function k(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function T(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function O(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var S = [false, "center", "right", "justify"];
        var C = ["#000000", "#e60000", "#ff9900", "#ffff00", "#008a00", "#0066cc", "#9933ff", "#ffffff", "#facccc", "#ffebcc", "#ffffcc", "#cce8cc", "#cce0f5", "#ebd6ff", "#bbbbbb", "#f06666", "#ffc266", "#ffff66", "#66b966", "#66a3e0", "#c285ff", "#888888", "#a10000", "#b26b00", "#b2b200", "#006100", "#0047b2", "#6b24b2", "#444444", "#5c0000", "#663d00", "#666600", "#003700", "#002966", "#3d1466"];
        var A = [false, "serif", "monospace"];
        var j = ["1", "2", "3", false];
        var P = ["small", false, "large", "huge"];
        var D = function (e) {
            O(r, e);

            function r(n, e) {
                k(this, r);
                var i = T(this, (r.__proto__ || Object.getPrototypeOf(r)).call(this, n, e));
                var t = function e(t) {
                    if (!document.body.contains(n.root)) {
                        return document.body.removeEventListener("click", e)
                    }
                    if (i.tooltip != null && !i.tooltip.root.contains(t.target) && document.activeElement !== i.tooltip.textbox && !i.quill.hasFocus()) {
                        i.tooltip.hide()
                    }
                    if (i.pickers != null) {
                        i.pickers.forEach(function (e) {
                            if (!e.container.contains(t.target)) {
                                e.close()
                            }
                        })
                    }
                };
                n.emitter.listenDOM("click", document.body, t);
                return i
            }
            o(r, [{
                key: "addModule",
                value: function e(t) {
                    var n = i(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "addModule", this).call(this, t);
                    if (t === "toolbar") {
                        this.extendToolbar(n)
                    }
                    return n
                }
            }, {
                key: "buildButtons",
                value: function e(t, i) {
                    t.forEach(function (n) {
                        var e = n.getAttribute("class") || "";
                        e.split(/\s+/).forEach(function (e) {
                            if (!e.startsWith("ql-"))
                                return;
                            e = e.slice("ql-".length);
                            if (i[e] == null)
                                return;
                            if (e === "direction") {
                                n.innerHTML = i[e][""] + i[e]["rtl"]
                            } else if (typeof i[e] === "string") {
                                n.innerHTML = i[e]
                            } else {
                                var t = n.value || "";
                                if (t != null && i[e][t]) {
                                    n.innerHTML = i[e][t]
                                }
                            }
                        })
                    })
                }
            }, {
                key: "buildPickers",
                value: function e(t, n) {
                    var i = this;
                    this.pickers = t.map(function (e) {
                        if (e.classList.contains("ql-align")) {
                            if (e.querySelector("option") == null) {
                                L(e, S)
                            }
                            return new y.default(e, n.align)
                        } else if (e.classList.contains("ql-background") || e.classList.contains("ql-color")) {
                            var t = e.classList.contains("ql-background") ? "background" : "color";
                            if (e.querySelector("option") == null) {
                                L(e, C, t === "background" ? "#ffffff" : "#000000")
                            }
                            return new g.default(e, n[t])
                        } else {
                            if (e.querySelector("option") == null) {
                                if (e.classList.contains("ql-font")) {
                                    L(e, A)
                                } else if (e.classList.contains("ql-header")) {
                                    L(e, j)
                                } else if (e.classList.contains("ql-size")) {
                                    L(e, P)
                                }
                            }
                            return new b.default(e)
                        }
                    });
                    var r = function e() {
                        i.pickers.forEach(function (e) {
                            e.update()
                        })
                    };
                    this.quill.on(c.default.events.EDITOR_CHANGE, r)
                }
            }]);
            return r
        }(p.default);
        D.DEFAULTS = (0,
            a.default)(true, {}, p.default.DEFAULTS, {
            modules: {
                toolbar: {
                    handlers: {
                        formula: function e() {
                            this.quill.theme.tooltip.edit("formula")
                        },
                        image: function e() {
                            var n = this;
                            var i = this.container.querySelector("input.ql-image[type=file]");
                            if (i == null) {
                                i = document.createElement("input");
                                i.setAttribute("type", "file");
                                i.setAttribute("accept", "image/png, image/gif, image/jpeg, image/bmp, image/x-icon");
                                i.classList.add("ql-image");
                                i.addEventListener("change", function () {
                                    if (i.files != null && i.files[0] != null) {
                                        var e = new FileReader;
                                        e.onload = function (e) {
                                            var t = n.quill.getSelection(true);
                                            n.quill.updateContents((new l.default).retain(t.index).delete(t.length).insert({
                                                image: e.target.result
                                            }), c.default.sources.USER);
                                            n.quill.setSelection(t.index + 1, c.default.sources.SILENT);
                                            i.value = ""
                                        };
                                        e.readAsDataURL(i.files[0])
                                    }
                                });
                                this.container.appendChild(i)
                            }
                            i.click()
                        },
                        video: function e() {
                            this.quill.theme.tooltip.edit("video")
                        }
                    }
                }
            }
        });
        var I = function (e) {
            O(i, e);

            function i(e, t) {
                k(this, i);
                var n = T(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t));
                n.textbox = n.root.querySelector('input[type="text"]');
                n.listen();
                return n
            }
            o(i, [{
                key: "listen",
                value: function e() {
                    var t = this;
                    this.textbox.addEventListener("keydown", function (e) {
                        if (h.default.match(e, "enter")) {
                            t.save();
                            e.preventDefault()
                        } else if (h.default.match(e, "escape")) {
                            t.cancel();
                            e.preventDefault()
                        }
                    })
                }
            }, {
                key: "cancel",
                value: function e() {
                    this.hide()
                }
            }, {
                key: "edit",
                value: function e() {
                    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : "link";
                    var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
                    this.root.classList.remove("ql-hidden");
                    this.root.classList.add("ql-editing");
                    if (n != null) {
                        this.textbox.value = n
                    } else if (t !== this.root.getAttribute("data-mode")) {
                        this.textbox.value = ""
                    }
                    this.position(this.quill.getBounds(this.quill.selection.savedRange));
                    this.textbox.select();
                    this.textbox.setAttribute("placeholder", this.textbox.getAttribute("data-" + t) || "");
                    this.root.setAttribute("data-mode", t)
                }
            }, {
                key: "restoreFocus",
                value: function e() {
                    var t = this.quill.scrollingContainer.scrollTop;
                    this.quill.focus();
                    this.quill.scrollingContainer.scrollTop = t
                }
            }, {
                key: "save",
                value: function e() {
                    var t = this.textbox.value;
                    switch (this.root.getAttribute("data-mode")) {
                        case "link":
                            {
                                var n = this.quill.root.scrollTop;
                                if (this.linkRange) {
                                    this.quill.formatText(this.linkRange, "link", t, c.default.sources.USER);
                                    delete this.linkRange
                                } else {
                                    this.restoreFocus();
                                    this.quill.format("link", t, c.default.sources.USER)
                                }
                                this.quill.root.scrollTop = n;
                                break
                            }
                        case "video":
                            {
                                t = N(t)
                            }
                        case "formula":
                            {
                                if (!t)
                                    break;
                                var i = this.quill.getSelection(true);
                                if (i != null) {
                                    var r = i.index + i.length;
                                    this.quill.insertEmbed(r, this.root.getAttribute("data-mode"), t, c.default.sources.USER);
                                    if (this.root.getAttribute("data-mode") === "formula") {
                                        this.quill.insertText(r + 1, " ", c.default.sources.USER)
                                    }
                                    this.quill.setSelection(r + 2, c.default.sources.USER)
                                }
                                break
                            }
                        default:
                    }
                    this.textbox.value = "";
                    this.hide()
                }
            }]);
            return i
        }(x.default);

        function N(e) {
            var t = e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/) || e.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);
            if (t) {
                return (t[1] || "https") + "://www.youtube.com/embed/" + t[2] + "?showinfo=0"
            }
            if (t = e.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/)) {
                return (t[1] || "https") + "://player.vimeo.com/video/" + t[2] + "/"
            }
            return e
        }

        function L(n, e) {
            var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
            e.forEach(function (e) {
                var t = document.createElement("option");
                if (e === i) {
                    t.setAttribute("selected", "selected")
                } else {
                    t.setAttribute("value", e)
                }
                n.appendChild(t)
            })
        }
        t.BaseTooltip = I;
        t.default = D
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function e() {
                this.head = this.tail = undefined;
                this.length = 0
            }
            e.prototype.append = function () {
                var e = [];
                for (var t = 0; t < arguments.length; t++) {
                    e[t] = arguments[t]
                }
                this.insertBefore(e[0], undefined);
                if (e.length > 1) {
                    this.append.apply(this, e.slice(1))
                }
            };
            e.prototype.contains = function (e) {
                var t, n = this.iterator();
                while (t = n()) {
                    if (t === e)
                        return true
                }
                return false
            };
            e.prototype.insertBefore = function (e, t) {
                e.next = t;
                if (t != null) {
                    e.prev = t.prev;
                    if (t.prev != null) {
                        t.prev.next = e
                    }
                    t.prev = e;
                    if (t === this.head) {
                        this.head = e
                    }
                } else if (this.tail != null) {
                    this.tail.next = e;
                    e.prev = this.tail;
                    this.tail = e
                } else {
                    e.prev = undefined;
                    this.head = this.tail = e
                }
                this.length += 1
            };
            e.prototype.offset = function (e) {
                var t = 0,
                    n = this.head;
                while (n != null) {
                    if (n === e)
                        return t;
                    t += n.length();
                    n = n.next
                }
                return -1
            };
            e.prototype.remove = function (e) {
                if (!this.contains(e))
                    return;
                if (e.prev != null)
                    e.prev.next = e.next;
                if (e.next != null)
                    e.next.prev = e.prev;
                if (e === this.head)
                    this.head = e.next;
                if (e === this.tail)
                    this.tail = e.prev;
                this.length -= 1
            };
            e.prototype.iterator = function (t) {
                if (t === void 0) {
                    t = this.head
                }
                return function () {
                    var e = t;
                    if (t != null)
                        t = t.next;
                    return e
                }
            };
            e.prototype.find = function (e, t) {
                if (t === void 0) {
                    t = false
                }
                var n, i = this.iterator();
                while (n = i()) {
                    var r = n.length();
                    if (e < r || t && e === r && (n.next == null || n.next.length() !== 0)) {
                        return [n, e]
                    }
                    e -= r
                }
                return [null, 0]
            };
            e.prototype.forEach = function (e) {
                var t, n = this.iterator();
                while (t = n()) {
                    e(t)
                }
            };
            e.prototype.forEachAt = function (e, t, n) {
                if (t <= 0)
                    return;
                var i = this.find(e),
                    r = i[0],
                    o = i[1];
                var a, s = e - o,
                    l = this.iterator(r);
                while ((a = l()) && s < e + t) {
                    var u = a.length();
                    if (e > s) {
                        n(a, e - s, Math.min(t, s + u - e))
                    } else {
                        n(a, 0, Math.min(u, e + t - s))
                    }
                    s += u
                }
            };
            e.prototype.map = function (n) {
                return this.reduce(function (e, t) {
                    e.push(n(t));
                    return e
                }, [])
            };
            e.prototype.reduce = function (e, t) {
                var n, i = this.iterator();
                while (n = i()) {
                    t = e(t, n)
                }
                return t
            };
            return e
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var u = n(17);
        var c = n(1);
        var r = {
            attributes: true,
            characterData: true,
            characterDataOldValue: true,
            childList: true,
            subtree: true
        };
        var f = 100;
        var o = function (l) {
            i(e, l);

            function e(e) {
                var t = l.call(this, e) || this;
                t.parent = null;
                t.observer = new MutationObserver(function (e) {
                    t.update(e)
                });
                t.observer.observe(t.domNode, r);
                t.scroll = t;
                return t
            }
            e.prototype.detach = function () {
                l.prototype.detach.call(this);
                this.observer.disconnect()
            };
            e.prototype.deleteAt = function (e, t) {
                this.update();
                if (e === 0 && t === this.length()) {
                    this.children.forEach(function (e) {
                        e.remove()
                    })
                } else {
                    l.prototype.deleteAt.call(this, e, t)
                }
            };
            e.prototype.formatAt = function (e, t, n, i) {
                this.update();
                l.prototype.formatAt.call(this, e, t, n, i)
            };
            e.prototype.insertAt = function (e, t, n) {
                this.update();
                l.prototype.insertAt.call(this, e, t, n)
            };
            e.prototype.optimize = function (e, t) {
                var n = this;
                if (e === void 0) {
                    e = []
                }
                if (t === void 0) {
                    t = {}
                }
                l.prototype.optimize.call(this, t);
                var i = [].slice.call(this.observer.takeRecords());
                while (i.length > 0)
                    e.push(i.pop());
                var r = function (e, t) {
                    if (t === void 0) {
                        t = true
                    }
                    if (e == null || e === n)
                        return;
                    if (e.domNode.parentNode == null)
                        return;
                    if (e.domNode[c.DATA_KEY].mutations == null) {
                        e.domNode[c.DATA_KEY].mutations = []
                    }
                    if (t)
                        r(e.parent)
                };
                var o = function (e) {
                    if (e.domNode[c.DATA_KEY] == null || e.domNode[c.DATA_KEY].mutations == null) {
                        return
                    }
                    if (e instanceof u.default) {
                        e.children.forEach(o)
                    }
                    e.optimize(t)
                };
                var a = e;
                for (var s = 0; a.length > 0; s += 1) {
                    if (s >= f) {
                        throw new Error("[Parchment] Maximum optimize iterations reached")
                    }
                    a.forEach(function (e) {
                        var t = c.find(e.target, true);
                        if (t == null)
                            return;
                        if (t.domNode === e.target) {
                            if (e.type === "childList") {
                                r(c.find(e.previousSibling, false));
                                [].forEach.call(e.addedNodes, function (e) {
                                    var t = c.find(e, false);
                                    r(t, false);
                                    if (t instanceof u.default) {
                                        t.children.forEach(function (e) {
                                            r(e, false)
                                        })
                                    }
                                })
                            } else if (e.type === "attributes") {
                                r(t.prev)
                            }
                        }
                        r(t)
                    });
                    this.children.forEach(o);
                    a = [].slice.call(this.observer.takeRecords());
                    i = a.slice();
                    while (i.length > 0)
                        e.push(i.pop())
                }
            };
            e.prototype.update = function (e, t) {
                var n = this;
                if (t === void 0) {
                    t = {}
                }
                e = e || this.observer.takeRecords();
                e.map(function (e) {
                    var t = c.find(e.target, true);
                    if (t == null)
                        return;
                    if (t.domNode[c.DATA_KEY].mutations == null) {
                        t.domNode[c.DATA_KEY].mutations = [e];
                        return t
                    } else {
                        t.domNode[c.DATA_KEY].mutations.push(e);
                        return null
                    }
                }).forEach(function (e) {
                    if (e == null || e === n || e.domNode[c.DATA_KEY] == null)
                        return;
                    e.update(e.domNode[c.DATA_KEY].mutations || [], t)
                });
                if (this.domNode[c.DATA_KEY].mutations != null) {
                    l.prototype.update.call(this, this.domNode[c.DATA_KEY].mutations, t)
                }
                this.optimize(e, t)
            };
            e.blotName = "scroll";
            e.defaultChild = "block";
            e.scope = c.Scope.BLOCK_BLOT;
            e.tagName = "DIV";
            return e
        }(u.default);
        t.default = o
    }, function (e, t, n) {
        "use strict";
        var r = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var a = n(18);
        var s = n(1);

        function l(e, t) {
            if (Object.keys(e).length !== Object.keys(t).length)
                return false;
            for (var n in e) {
                if (e[n] !== t[n])
                    return false
            }
            return true
        }
        var i = function (o) {
            r(i, o);

            function i() {
                return o !== null && o.apply(this, arguments) || this
            }
            i.formats = function (e) {
                if (e.tagName === i.tagName)
                    return undefined;
                return o.formats.call(this, e)
            };
            i.prototype.format = function (e, t) {
                var n = this;
                if (e === this.statics.blotName && !t) {
                    this.children.forEach(function (e) {
                        if (!(e instanceof a.default)) {
                            e = e.wrap(i.blotName, true)
                        }
                        n.attributes.copy(e)
                    });
                    this.unwrap()
                } else {
                    o.prototype.format.call(this, e, t)
                }
            };
            i.prototype.formatAt = function (e, t, n, i) {
                if (this.formats()[n] != null || s.query(n, s.Scope.ATTRIBUTE)) {
                    var r = this.isolate(e, t);
                    r.format(n, i)
                } else {
                    o.prototype.formatAt.call(this, e, t, n, i)
                }
            };
            i.prototype.optimize = function (e) {
                o.prototype.optimize.call(this, e);
                var t = this.formats();
                if (Object.keys(t).length === 0) {
                    return this.unwrap()
                }
                var n = this.next;
                if (n instanceof i && n.prev === this && l(t, n.formats())) {
                    n.moveChildren(this);
                    n.remove()
                }
            };
            i.blotName = "inline";
            i.scope = s.Scope.INLINE_BLOT;
            i.tagName = "SPAN";
            return i
        }(a.default);
        t.default = i
    }, function (e, t, n) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(18);
        var a = n(1);
        var o = function (o) {
            i(n, o);

            function n() {
                return o !== null && o.apply(this, arguments) || this
            }
            n.formats = function (e) {
                var t = a.query(n.blotName).tagName;
                if (e.tagName === t)
                    return undefined;
                return o.formats.call(this, e)
            };
            n.prototype.format = function (e, t) {
                if (a.query(e, a.Scope.BLOCK) == null) {
                    return
                } else if (e === this.statics.blotName && !t) {
                    this.replaceWith(n.blotName)
                } else {
                    o.prototype.format.call(this, e, t)
                }
            };
            n.prototype.formatAt = function (e, t, n, i) {
                if (a.query(n, a.Scope.BLOCK) != null) {
                    this.format(n, i)
                } else {
                    o.prototype.formatAt.call(this, e, t, n, i)
                }
            };
            n.prototype.insertAt = function (e, t, n) {
                if (n == null || a.query(t, a.Scope.INLINE) != null) {
                    o.prototype.insertAt.call(this, e, t, n)
                } else {
                    var i = this.split(e);
                    var r = a.create(t, n);
                    i.parent.insertBefore(r, i)
                }
            };
            n.prototype.update = function (e, t) {
                if (navigator.userAgent.match(/Trident/)) {
                    this.attach()
                } else {
                    o.prototype.update.call(this, e, t)
                }
            };
            n.blotName = "block";
            n.scope = a.Scope.BLOCK_BLOT;
            n.tagName = "P";
            return n
        }(r.default);
        t.default = o
    }, function (e, t, n) {
        "use strict";
        var i = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = n(19);
        var o = function (r) {
            i(e, r);

            function e() {
                return r !== null && r.apply(this, arguments) || this
            }
            e.formats = function (e) {
                return undefined
            };
            e.prototype.format = function (e, t) {
                r.prototype.formatAt.call(this, 0, this.length(), e, t)
            };
            e.prototype.formatAt = function (e, t, n, i) {
                if (e === 0 && t === this.length()) {
                    this.format(n, i)
                } else {
                    r.prototype.formatAt.call(this, e, t, n, i)
                }
            };
            e.prototype.formats = function () {
                return this.statics.formats(this.domNode)
            };
            return e
        }(r.default);
        t.default = o
    }, function (e, t, n) {
        "use strict";
        var r = this && this.__extends || function () {
            var i = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function (e, t) {
                    e.__proto__ = t
                } ||
                function (e, t) {
                    for (var n in t)
                        if (t.hasOwnProperty(n))
                            e[n] = t[n]
                };
            return function (e, t) {
                i(e, t);

                function n() {
                    this.constructor = e
                }
                e.prototype = t === null ? Object.create(t) : (n.prototype = t.prototype,
                    new n)
            }
        }();
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(19);
        var o = n(1);
        var a = function (i) {
            r(t, i);

            function t(e) {
                var t = i.call(this, e) || this;
                t.text = t.statics.value(t.domNode);
                return t
            }
            t.create = function (e) {
                return document.createTextNode(e)
            };
            t.value = function (e) {
                var t = e.data;
                if (t["normalize"])
                    t = t["normalize"]();
                return t
            };
            t.prototype.deleteAt = function (e, t) {
                this.domNode.data = this.text = this.text.slice(0, e) + this.text.slice(e + t)
            };
            t.prototype.index = function (e, t) {
                if (this.domNode === e) {
                    return t
                }
                return -1
            };
            t.prototype.insertAt = function (e, t, n) {
                if (n == null) {
                    this.text = this.text.slice(0, e) + t + this.text.slice(e);
                    this.domNode.data = this.text
                } else {
                    i.prototype.insertAt.call(this, e, t, n)
                }
            };
            t.prototype.length = function () {
                return this.text.length
            };
            t.prototype.optimize = function (e) {
                i.prototype.optimize.call(this, e);
                this.text = this.statics.value(this.domNode);
                if (this.text.length === 0) {
                    this.remove()
                } else if (this.next instanceof t && this.next.prev === this) {
                    this.insertAt(this.length(), this.next.value());
                    this.next.remove()
                }
            };
            t.prototype.position = function (e, t) {
                if (t === void 0) {
                    t = false
                }
                return [this.domNode, e]
            };
            t.prototype.split = function (e, t) {
                if (t === void 0) {
                    t = false
                }
                if (!t) {
                    if (e === 0)
                        return this;
                    if (e === this.length())
                        return this.next
                }
                var n = o.create(this.domNode.splitText(e));
                this.parent.insertBefore(n, this.next);
                this.text = this.statics.value(this.domNode);
                return n
            };
            t.prototype.update = function (e, t) {
                var n = this;
                if (e.some(function (e) {
                        return e.type === "characterData" && e.target === n.domNode
                    })) {
                    this.text = this.statics.value(this.domNode)
                }
            };
            t.prototype.value = function () {
                return this.text
            };
            t.blotName = "text";
            t.scope = o.Scope.INLINE_BLOT;
            return t
        }(i.default);
        t.default = a
    }, function (e, t, n) {
        "use strict";
        var i = document.createElement("div");
        i.classList.toggle("test-class", false);
        if (i.classList.contains("test-class")) {
            var r = DOMTokenList.prototype.toggle;
            DOMTokenList.prototype.toggle = function (e, t) {
                if (arguments.length > 1 && !this.contains(e) === !t) {
                    return t
                } else {
                    return r.call(this, e)
                }
            }
        }
        if (!String.prototype.startsWith) {
            String.prototype.startsWith = function (e, t) {
                t = t || 0;
                return this.substr(t, e.length) === e
            }
        }
        if (!String.prototype.endsWith) {
            String.prototype.endsWith = function (e, t) {
                var n = this.toString();
                if (typeof t !== "number" || !isFinite(t) || Math.floor(t) !== t || t > n.length) {
                    t = n.length
                }
                t -= e.length;
                var i = n.indexOf(e, t);
                return i !== -1 && i === t
            }
        }
        if (!Array.prototype.find) {
            Object.defineProperty(Array.prototype, "find", {
                value: function e(t) {
                    if (this === null) {
                        throw new TypeError("Array.prototype.find called on null or undefined")
                    }
                    if (typeof t !== "function") {
                        throw new TypeError("predicate must be a function")
                    }
                    var n = Object(this);
                    var i = n.length >>> 0;
                    var r = arguments[1];
                    var e;
                    for (var o = 0; o < i; o++) {
                        e = n[o];
                        if (t.call(r, e, o, n)) {
                            return e
                        }
                    }
                    return undefined
                }
            })
        }
        document.addEventListener("DOMContentLoaded", function () {
            document.execCommand("enableObjectResizing", false, false);
            document.execCommand("autoUrlDetect", false, false)
        })
    }, function (e, t) {
        var T = -1;
        var O = 1;
        var p = 0;

        function v(e, t, n) {
            if (e == t) {
                if (e) {
                    return [
                        [p, e]
                    ]
                }
                return []
            }
            if (n < 0 || e.length < n) {
                n = null
            }
            var i = d(e, t);
            var r = e.substring(0, i);
            e = e.substring(i);
            t = t.substring(i);
            i = _(e, t);
            var o = e.substring(e.length - i);
            e = e.substring(0, e.length - i);
            t = t.substring(0, t.length - i);
            var a = s(e, t);
            if (r) {
                a.unshift([p, r])
            }
            if (o) {
                a.push([p, o])
            }
            l(a);
            if (n != null) {
                a = c(a, n)
            }
            a = f(a);
            return a
        }

        function s(e, t) {
            var n;
            if (!e) {
                return [
                    [O, t]
                ]
            }
            if (!t) {
                return [
                    [T, e]
                ]
            }
            var i = e.length > t.length ? e : t;
            var r = e.length > t.length ? t : e;
            var o = i.indexOf(r);
            if (o != -1) {
                n = [
                    [O, i.substring(0, o)],
                    [p, r],
                    [O, i.substring(o + r.length)]
                ];
                if (e.length > t.length) {
                    n[0][0] = n[2][0] = T
                }
                return n
            }
            if (r.length == 1) {
                return [
                    [T, e],
                    [O, t]
                ]
            }
            var a = y(e, t);
            if (a) {
                var s = a[0];
                var l = a[1];
                var u = a[2];
                var c = a[3];
                var f = a[4];
                var h = v(s, u);
                var d = v(l, c);
                return h.concat([
                    [p, f]
                ], d)
            }
            return g(e, t)
        }

        function g(e, t) {
            var n = e.length;
            var i = t.length;
            var r = Math.ceil((n + i) / 2);
            var o = r;
            var a = 2 * r;
            var s = new Array(a);
            var l = new Array(a);
            for (var u = 0; u < a; u++) {
                s[u] = -1;
                l[u] = -1
            }
            s[o + 1] = 0;
            l[o + 1] = 0;
            var c = n - i;
            var f = c % 2 != 0;
            var h = 0;
            var d = 0;
            var p = 0;
            var v = 0;
            for (var g = 0; g < r; g++) {
                for (var _ = -g + h; _ <= g - d; _ += 2) {
                    var y = o + _;
                    var m;
                    if (_ == -g || _ != g && s[y - 1] < s[y + 1]) {
                        m = s[y + 1]
                    } else {
                        m = s[y - 1] + 1
                    }
                    var b = m - _;
                    while (m < n && b < i && e.charAt(m) == t.charAt(b)) {
                        m++;
                        b++
                    }
                    s[y] = m;
                    if (m > n) {
                        d += 2
                    } else if (b > i) {
                        h += 2
                    } else if (f) {
                        var w = o + c - _;
                        if (w >= 0 && w < a && l[w] != -1) {
                            var x = n - l[w];
                            if (m >= x) {
                                return S(e, t, m, b)
                            }
                        }
                    }
                }
                for (var E = -g + p; E <= g - v; E += 2) {
                    var w = o + E;
                    var x;
                    if (E == -g || E != g && l[w - 1] < l[w + 1]) {
                        x = l[w + 1]
                    } else {
                        x = l[w - 1] + 1
                    }
                    var k = x - E;
                    while (x < n && k < i && e.charAt(n - x - 1) == t.charAt(i - k - 1)) {
                        x++;
                        k++
                    }
                    l[w] = x;
                    if (x > n) {
                        v += 2
                    } else if (k > i) {
                        p += 2
                    } else if (!f) {
                        var y = o + c - E;
                        if (y >= 0 && y < a && s[y] != -1) {
                            var m = s[y];
                            var b = o + m - y;
                            x = n - x;
                            if (m >= x) {
                                return S(e, t, m, b)
                            }
                        }
                    }
                }
            }
            return [
                [T, e],
                [O, t]
            ]
        }

        function S(e, t, n, i) {
            var r = e.substring(0, n);
            var o = t.substring(0, i);
            var a = e.substring(n);
            var s = t.substring(i);
            var l = v(r, o);
            var u = v(a, s);
            return l.concat(u)
        }

        function d(e, t) {
            if (!e || !t || e.charAt(0) != t.charAt(0)) {
                return 0
            }
            var n = 0;
            var i = Math.min(e.length, t.length);
            var r = i;
            var o = 0;
            while (n < r) {
                if (e.substring(o, r) == t.substring(o, r)) {
                    n = r;
                    o = n
                } else {
                    i = r
                }
                r = Math.floor((i - n) / 2 + n)
            }
            return r
        }

        function _(e, t) {
            if (!e || !t || e.charAt(e.length - 1) != t.charAt(t.length - 1)) {
                return 0
            }
            var n = 0;
            var i = Math.min(e.length, t.length);
            var r = i;
            var o = 0;
            while (n < r) {
                if (e.substring(e.length - r, e.length - o) == t.substring(t.length - r, t.length - o)) {
                    n = r;
                    o = n
                } else {
                    i = r
                }
                r = Math.floor((i - n) / 2 + n)
            }
            return r
        }

        function y(e, t) {
            var n = e.length > t.length ? e : t;
            var i = e.length > t.length ? t : e;
            if (n.length < 4 || i.length * 2 < n.length) {
                return null
            }

            function r(e, t, n) {
                var i = e.substring(n, n + Math.floor(e.length / 4));
                var r = -1;
                var o = "";
                var a, s, l, u;
                while ((r = t.indexOf(i, r + 1)) != -1) {
                    var c = d(e.substring(n), t.substring(r));
                    var f = _(e.substring(0, n), t.substring(0, r));
                    if (o.length < f + c) {
                        o = t.substring(r - f, r) + t.substring(r, r + c);
                        a = e.substring(0, n - f);
                        s = e.substring(n + c);
                        l = t.substring(0, r - f);
                        u = t.substring(r + c)
                    }
                }
                if (o.length * 2 >= e.length) {
                    return [a, s, l, u, o]
                } else {
                    return null
                }
            }
            var o = r(n, i, Math.ceil(n.length / 4));
            var a = r(n, i, Math.ceil(n.length / 2));
            var s;
            if (!o && !a) {
                return null
            } else if (!a) {
                s = o
            } else if (!o) {
                s = a
            } else {
                s = o[4].length > a[4].length ? o : a
            }
            var l, u, c, f;
            if (e.length > t.length) {
                l = s[0];
                u = s[1];
                c = s[2];
                f = s[3]
            } else {
                c = s[0];
                f = s[1];
                l = s[2];
                u = s[3]
            }
            var h = s[4];
            return [l, u, c, f, h]
        }

        function l(e) {
            e.push([p, ""]);
            var t = 0;
            var n = 0;
            var i = 0;
            var r = "";
            var o = "";
            var a;
            while (t < e.length) {
                switch (e[t][0]) {
                    case O:
                        i++;
                        o += e[t][1];
                        t++;
                        break;
                    case T:
                        n++;
                        r += e[t][1];
                        t++;
                        break;
                    case p:
                        if (n + i > 1) {
                            if (n !== 0 && i !== 0) {
                                a = d(o, r);
                                if (a !== 0) {
                                    if (t - n - i > 0 && e[t - n - i - 1][0] == p) {
                                        e[t - n - i - 1][1] += o.substring(0, a)
                                    } else {
                                        e.splice(0, 0, [p, o.substring(0, a)]);
                                        t++
                                    }
                                    o = o.substring(a);
                                    r = r.substring(a)
                                }
                                a = _(o, r);
                                if (a !== 0) {
                                    e[t][1] = o.substring(o.length - a) + e[t][1];
                                    o = o.substring(0, o.length - a);
                                    r = r.substring(0, r.length - a)
                                }
                            }
                            if (n === 0) {
                                e.splice(t - i, n + i, [O, o])
                            } else if (i === 0) {
                                e.splice(t - n, n + i, [T, r])
                            } else {
                                e.splice(t - n - i, n + i, [T, r], [O, o])
                            }
                            t = t - n - i + (n ? 1 : 0) + (i ? 1 : 0) + 1
                        } else if (t !== 0 && e[t - 1][0] == p) {
                            e[t - 1][1] += e[t][1];
                            e.splice(t, 1)
                        } else {
                            t++
                        }
                        i = 0;
                        n = 0;
                        r = "";
                        o = "";
                        break
                }
            }
            if (e[e.length - 1][1] === "") {
                e.pop()
            }
            var s = false;
            t = 1;
            while (t < e.length - 1) {
                if (e[t - 1][0] == p && e[t + 1][0] == p) {
                    if (e[t][1].substring(e[t][1].length - e[t - 1][1].length) == e[t - 1][1]) {
                        e[t][1] = e[t - 1][1] + e[t][1].substring(0, e[t][1].length - e[t - 1][1].length);
                        e[t + 1][1] = e[t - 1][1] + e[t + 1][1];
                        e.splice(t - 1, 1);
                        s = true
                    } else if (e[t][1].substring(0, e[t + 1][1].length) == e[t + 1][1]) {
                        e[t - 1][1] += e[t + 1][1];
                        e[t][1] = e[t][1].substring(e[t + 1][1].length) + e[t + 1][1];
                        e.splice(t + 1, 1);
                        s = true
                    }
                }
                t++
            }
            if (s) {
                l(e)
            }
        }
        var n = v;
        n.INSERT = O;
        n.DELETE = T;
        n.EQUAL = p;
        e.exports = n;

        function u(e, t) {
            if (t === 0) {
                return [p, e]
            }
            for (var n = 0, i = 0; i < e.length; i++) {
                var r = e[i];
                if (r[0] === T || r[0] === p) {
                    var o = n + r[1].length;
                    if (t === o) {
                        return [i + 1, e]
                    } else if (t < o) {
                        e = e.slice();
                        var a = t - n;
                        var s = [r[0], r[1].slice(0, a)];
                        var l = [r[0], r[1].slice(a)];
                        e.splice(i, 1, s, l);
                        return [i + 1, e]
                    } else {
                        n = o
                    }
                }
            }
            throw new Error("cursor_pos is out of bounds!")
        }

        function c(e, t) {
            var n = u(e, t);
            var i = n[1];
            var r = n[0];
            var o = i[r];
            var a = i[r + 1];
            if (o == null) {
                return e
            } else if (o[0] !== p) {
                return e
            } else {
                if (a != null && o[1] + a[1] === a[1] + o[1]) {
                    i.splice(r, 2, a, o);
                    return h(i, r, 2)
                } else if (a != null && a[1].indexOf(o[1]) === 0) {
                    i.splice(r, 2, [a[0], o[1]], [0, o[1]]);
                    var s = a[1].slice(o[1].length);
                    if (s.length > 0) {
                        i.splice(r + 2, 0, [a[0], s])
                    }
                    return h(i, r, 3)
                } else {
                    return e
                }
            }
        }

        function f(e) {
            var t = false;
            var n = function (e) {
                return e.charCodeAt(0) >= 56320 && e.charCodeAt(0) <= 57343
            };
            var i = function (e) {
                return e.charCodeAt(e.length - 1) >= 55296 && e.charCodeAt(e.length - 1) <= 56319
            };
            for (var r = 2; r < e.length; r += 1) {
                if (e[r - 2][0] === p && i(e[r - 2][1]) && e[r - 1][0] === T && n(e[r - 1][1]) && e[r][0] === O && n(e[r][1])) {
                    t = true;
                    e[r - 1][1] = e[r - 2][1].slice(-1) + e[r - 1][1];
                    e[r][1] = e[r - 2][1].slice(-1) + e[r][1];
                    e[r - 2][1] = e[r - 2][1].slice(0, -1)
                }
            }
            if (!t) {
                return e
            }
            var o = [];
            for (var r = 0; r < e.length; r += 1) {
                if (e[r][1].length > 0) {
                    o.push(e[r])
                }
            }
            return o
        }

        function h(e, t, n) {
            for (var i = t + n - 1; i >= 0 && i >= t - 1; i--) {
                if (i + 1 < e.length) {
                    var r = e[i];
                    var o = e[i + 1];
                    if (r[0] === o[1]) {
                        e.splice(i, 2, [r[0], r[1] + o[1]])
                    }
                }
            }
            return e
        }
    }, function (e, t) {
        t = e.exports = typeof Object.keys === "function" ? Object.keys : n;
        t.shim = n;

        function n(e) {
            var t = [];
            for (var n in e)
                t.push(n);
            return t
        }
    }, function (e, t) {
        var n = function () {
            return Object.prototype.toString.call(arguments)
        }() == "[object Arguments]";
        t = e.exports = n ? i : r;
        t.supported = i;

        function i(e) {
            return Object.prototype.toString.call(e) == "[object Arguments]"
        }
        t.unsupported = r;

        function r(e) {
            return e && typeof e == "object" && typeof e.length == "number" && Object.prototype.hasOwnProperty.call(e, "callee") && !Object.prototype.propertyIsEnumerable.call(e, "callee") || false
        }
    }, function (e, t) {
        "use strict";
        var r = Object.prototype.hasOwnProperty,
            p = "~";

        function c() {}
        if (Object.create) {
            c.prototype = Object.create(null);
            if (!(new c).__proto__)
                p = false
        }

        function a(e, t, n) {
            this.fn = e;
            this.context = t;
            this.once = n || false
        }

        function n() {
            this._events = new c;
            this._eventsCount = 0
        }
        n.prototype.eventNames = function e() {
            var t = [],
                n, i;
            if (this._eventsCount === 0)
                return t;
            for (i in n = this._events) {
                if (r.call(n, i))
                    t.push(p ? i.slice(1) : i)
            }
            if (Object.getOwnPropertySymbols) {
                return t.concat(Object.getOwnPropertySymbols(n))
            }
            return t
        };
        n.prototype.listeners = function e(t, n) {
            var i = p ? p + t : t,
                r = this._events[i];
            if (n)
                return !!r;
            if (!r)
                return [];
            if (r.fn)
                return [r.fn];
            for (var o = 0, a = r.length, s = new Array(a); o < a; o++) {
                s[o] = r[o].fn
            }
            return s
        };
        n.prototype.emit = function e(t, n, i, r, o, a) {
            var s = p ? p + t : t;
            if (!this._events[s])
                return false;
            var l = this._events[s],
                u = arguments.length,
                c, f;
            if (l.fn) {
                if (l.once)
                    this.removeListener(t, l.fn, undefined, true);
                switch (u) {
                    case 1:
                        return l.fn.call(l.context),
                            true;
                    case 2:
                        return l.fn.call(l.context, n),
                            true;
                    case 3:
                        return l.fn.call(l.context, n, i),
                            true;
                    case 4:
                        return l.fn.call(l.context, n, i, r),
                            true;
                    case 5:
                        return l.fn.call(l.context, n, i, r, o),
                            true;
                    case 6:
                        return l.fn.call(l.context, n, i, r, o, a),
                            true
                }
                for (f = 1,
                    c = new Array(u - 1); f < u; f++) {
                    c[f - 1] = arguments[f]
                }
                l.fn.apply(l.context, c)
            } else {
                var h = l.length,
                    d;
                for (f = 0; f < h; f++) {
                    if (l[f].once)
                        this.removeListener(t, l[f].fn, undefined, true);
                    switch (u) {
                        case 1:
                            l[f].fn.call(l[f].context);
                            break;
                        case 2:
                            l[f].fn.call(l[f].context, n);
                            break;
                        case 3:
                            l[f].fn.call(l[f].context, n, i);
                            break;
                        case 4:
                            l[f].fn.call(l[f].context, n, i, r);
                            break;
                        default:
                            if (!c)
                                for (d = 1,
                                    c = new Array(u - 1); d < u; d++) {
                                    c[d - 1] = arguments[d]
                                }
                            l[f].fn.apply(l[f].context, c)
                    }
                }
            }
            return true
        };
        n.prototype.on = function e(t, n, i) {
            var r = new a(n, i || this),
                o = p ? p + t : t;
            if (!this._events[o])
                this._events[o] = r,
                this._eventsCount++;
            else if (!this._events[o].fn)
                this._events[o].push(r);
            else
                this._events[o] = [this._events[o], r];
            return this
        };
        n.prototype.once = function e(t, n, i) {
            var r = new a(n, i || this, true),
                o = p ? p + t : t;
            if (!this._events[o])
                this._events[o] = r,
                this._eventsCount++;
            else if (!this._events[o].fn)
                this._events[o].push(r);
            else
                this._events[o] = [this._events[o], r];
            return this
        };
        n.prototype.removeListener = function e(t, n, i, r) {
            var o = p ? p + t : t;
            if (!this._events[o])
                return this;
            if (!n) {
                if (--this._eventsCount === 0)
                    this._events = new c;
                else
                    delete this._events[o];
                return this
            }
            var a = this._events[o];
            if (a.fn) {
                if (a.fn === n && (!r || a.once) && (!i || a.context === i)) {
                    if (--this._eventsCount === 0)
                        this._events = new c;
                    else
                        delete this._events[o]
                }
            } else {
                for (var s = 0, l = [], u = a.length; s < u; s++) {
                    if (a[s].fn !== n || r && !a[s].once || i && a[s].context !== i) {
                        l.push(a[s])
                    }
                }
                if (l.length)
                    this._events[o] = l.length === 1 ? l[0] : l;
                else if (--this._eventsCount === 0)
                    this._events = new c;
                else
                    delete this._events[o]
            }
            return this
        };
        n.prototype.removeAllListeners = function e(t) {
            var n;
            if (t) {
                n = p ? p + t : t;
                if (this._events[n]) {
                    if (--this._eventsCount === 0)
                        this._events = new c;
                    else
                        delete this._events[n]
                }
            } else {
                this._events = new c;
                this._eventsCount = 0
            }
            return this
        };
        n.prototype.off = n.prototype.removeListener;
        n.prototype.addListener = n.prototype.on;
        n.prototype.setMaxListeners = function e() {
            return this
        };
        n.prefixed = p;
        n.EventEmitter = n;
        if ("undefined" !== typeof e) {
            e.exports = n
        }
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.matchText = t.matchSpacing = t.matchNewline = t.matchBlot = t.matchAttributor = t.default = undefined;
        var r = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (e) {
                return typeof e
            } :
            function (e) {
                return e && typeof Symbol === "function" && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
            };
        var u = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = n(3);
        var a = O(o);
        var s = n(2);
        var c = O(s);
        var l = n(0);
        var f = O(l);
        var h = n(5);
        var d = O(h);
        var p = n(10);
        var v = O(p);
        var g = n(9);
        var _ = O(g);
        var y = n(36);
        var m = n(37);
        var b = n(13);
        var w = O(b);
        var x = n(26);
        var E = n(38);
        var k = n(39);
        var T = n(40);

        function O(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function S(e, t, n) {
            if (t in e) {
                Object.defineProperty(e, t, {
                    value: n,
                    enumerable: true,
                    configurable: true,
                    writable: true
                })
            } else {
                e[t] = n
            }
            return e
        }

        function C(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function A(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function j(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var P = (0,
            v.default)("quill:clipboard");
        var D = "__ql-matcher";
        var I = [
            [Node.TEXT_NODE, Z],
            [Node.TEXT_NODE, G],
            ["br", W],
            [Node.ELEMENT_NODE, G],
            [Node.ELEMENT_NODE, F],
            [Node.ELEMENT_NODE, K],
            [Node.ELEMENT_NODE, H],
            [Node.ELEMENT_NODE, X],
            ["li", Y],
            ["b", V.bind(V, "bold")],
            ["i", V.bind(V, "italic")],
            ["style", z]
        ];
        var N = [y.AlignAttribute, E.DirectionAttribute].reduce(function (e, t) {
            e[t.keyName] = t;
            return e
        }, {});
        var L = [y.AlignStyle, m.BackgroundStyle, x.ColorStyle, E.DirectionStyle, k.FontStyle, T.SizeStyle].reduce(function (e, t) {
            e[t.keyName] = t;
            return e
        }, {});
        var R = function (e) {
            j(t, e);

            function t(e, r) {
                C(this, t);
                var o = A(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this, e, r));
                o.quill.root.addEventListener("paste", o.onPaste.bind(o));
                o.container = o.quill.addContainer("ql-clipboard");
                o.container.setAttribute("contenteditable", true);
                o.container.setAttribute("tabindex", -1);
                o.matchers = [];
                I.concat(o.options.matchers).forEach(function (e) {
                    var t = u(e, 2),
                        n = t[0],
                        i = t[1];
                    if (!r.matchVisual && i === K)
                        return;
                    o.addMatcher(n, i)
                });
                return o
            }
            i(t, [{
                key: "addMatcher",
                value: function e(t, n) {
                    this.matchers.push([t, n])
                }
            }, {
                key: "convert",
                value: function e(t) {
                    if (typeof t === "string") {
                        this.container.innerHTML = t.replace(/\>\r?\n +\</g, "><");
                        return this.convert()
                    }
                    var n = this.quill.getFormat(this.quill.selection.savedRange.index);
                    if (n[w.default.blotName]) {
                        var i = this.container.innerText;
                        this.container.innerHTML = "";
                        return (new c.default).insert(i, S({}, w.default.blotName, n[w.default.blotName]))
                    }
                    var r = this.prepareMatching(),
                        o = u(r, 2),
                        a = o[0],
                        s = o[1];
                    var l = U(this.container, a, s);
                    if (q(l, "\n") && l.ops[l.ops.length - 1].attributes == null) {
                        l = l.compose((new c.default).retain(l.length() - 1).delete(1))
                    }
                    P.log("convert", this.container.innerHTML, l);
                    this.container.innerHTML = "";
                    return l
                }
            }, {
                key: "dangerouslyPasteHTML",
                value: function e(t, n) {
                    var i = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : d.default.sources.API;
                    if (typeof t === "string") {
                        return this.quill.setContents(this.convert(t), n)
                    } else {
                        var r = this.convert(n);
                        return this.quill.updateContents((new c.default).retain(t).concat(r), i)
                    }
                }
            }, {
                key: "onPaste",
                value: function e(t) {
                    var n = this;
                    if (t.defaultPrevented || !this.quill.isEnabled())
                        return;
                    var i = this.quill.getSelection();
                    var r = (new c.default).retain(i.index);
                    var o = this.quill.scrollingContainer.scrollTop;
                    this.container.focus();
                    this.quill.selection.update(d.default.sources.SILENT);
                    setTimeout(function () {
                        r = r.concat(n.convert()).delete(i.length);
                        n.quill.updateContents(r, d.default.sources.USER);
                        n.quill.setSelection(r.length() - i.length, d.default.sources.SILENT);
                        n.quill.scrollingContainer.scrollTop = o;
                        n.quill.focus()
                    }, 1)
                }
            }, {
                key: "prepareMatching",
                value: function e() {
                    var r = this;
                    var o = [],
                        a = [];
                    this.matchers.forEach(function (e) {
                        var t = u(e, 2),
                            n = t[0],
                            i = t[1];
                        switch (n) {
                            case Node.TEXT_NODE:
                                a.push(i);
                                break;
                            case Node.ELEMENT_NODE:
                                o.push(i);
                                break;
                            default:
                                [].forEach.call(r.container.querySelectorAll(n), function (e) {
                                    e[D] = e[D] || [];
                                    e[D].push(i)
                                });
                                break
                        }
                    });
                    return [o, a]
                }
            }]);
            return t
        }(_.default);
        R.DEFAULTS = {
            matchers: [],
            matchVisual: true
        };

        function M(e, n, i) {
            if ((typeof n === "undefined" ? "undefined" : r(n)) === "object") {
                return Object.keys(n).reduce(function (e, t) {
                    return M(e, t, n[t])
                }, e)
            } else {
                return e.reduce(function (e, t) {
                    if (t.attributes && t.attributes[n]) {
                        return e.push(t)
                    } else {
                        return e.insert(t.insert, (0,
                            a.default)({}, S({}, n, i), t.attributes))
                    }
                }, new c.default)
            }
        }

        function B(e) {
            if (e.nodeType !== Node.ELEMENT_NODE)
                return {};
            var t = "__ql-computed-style";
            return e[t] || (e[t] = window.getComputedStyle(e))
        }

        function q(e, t) {
            var n = "";
            for (var i = e.ops.length - 1; i >= 0 && n.length < t.length; --i) {
                var r = e.ops[i];
                if (typeof r.insert !== "string")
                    break;
                n = r.insert + n
            }
            return n.slice(-1 * t.length) === t
        }

        function $(e) {
            if (e.childNodes.length === 0)
                return false;
            var t = B(e);
            return ["block", "list-item"].indexOf(t.display) > -1
        }

        function U(i, r, o) {
            if (i.nodeType === i.TEXT_NODE) {
                return o.reduce(function (e, t) {
                    return t(i, e)
                }, new c.default)
            } else if (i.nodeType === i.ELEMENT_NODE) {
                return [].reduce.call(i.childNodes || [], function (e, n) {
                    var t = U(n, r, o);
                    if (n.nodeType === i.ELEMENT_NODE) {
                        t = r.reduce(function (e, t) {
                            return t(n, e)
                        }, t);
                        t = (n[D] || []).reduce(function (e, t) {
                            return t(n, e)
                        }, t)
                    }
                    return e.concat(t)
                }, new c.default)
            } else {
                return new c.default
            }
        }

        function V(e, t, n) {
            return M(n, e, true)
        }

        function H(n, e) {
            var t = f.default.Attributor.Attribute.keys(n);
            var i = f.default.Attributor.Class.keys(n);
            var r = f.default.Attributor.Style.keys(n);
            var o = {};
            t.concat(i).concat(r).forEach(function (e) {
                var t = f.default.query(e, f.default.Scope.ATTRIBUTE);
                if (t != null) {
                    o[t.attrName] = t.value(n);
                    if (o[t.attrName])
                        return
                }
                t = N[e];
                if (t != null && t.attrName === e) {
                    o[t.attrName] = t.value(n) || undefined
                }
                t = L[e];
                if (t != null && t.attrName === e) {
                    t = L[e];
                    o[t.attrName] = t.value(n) || undefined
                }
            });
            if (Object.keys(o).length > 0) {
                e = M(e, o)
            }
            return e
        }

        function F(e, t) {
            var n = f.default.query(e);
            if (n == null)
                return t;
            if (n.prototype instanceof f.default.Embed) {
                var i = {};
                var r = n.value(e);
                if (r != null) {
                    i[n.blotName] = r;
                    t = (new c.default).insert(i, n.formats(e))
                }
            } else if (typeof n.formats === "function") {
                t = M(t, n.blotName, n.formats(e))
            }
            return t
        }

        function W(e, t) {
            if (!q(t, "\n")) {
                t.insert("\n")
            }
            return t
        }

        function z() {
            return new c.default
        }

        function Y(e, t) {
            var n = f.default.query(e);
            if (n == null || n.blotName !== "list-item" || !q(t, "\n")) {
                return t
            }
            var i = -1,
                r = e.parentNode;
            while (!r.classList.contains("ql-clipboard")) {
                if ((f.default.query(r) || {}).blotName === "list") {
                    i += 1
                }
                r = r.parentNode
            }
            if (i <= 0)
                return t;
            return t.compose((new c.default).retain(t.length() - 1).retain(1, {
                indent: i
            }))
        }

        function G(e, t) {
            if (!q(t, "\n")) {
                if ($(e) || t.length() > 0 && e.nextSibling && $(e.nextSibling)) {
                    t.insert("\n")
                }
            }
            return t
        }

        function K(e, t) {
            if ($(e) && e.nextElementSibling != null && !q(t, "\n\n")) {
                var n = e.offsetHeight + parseFloat(B(e).marginTop) + parseFloat(B(e).marginBottom);
                if (e.nextElementSibling.offsetTop > e.offsetTop + n * 1.5) {
                    t.insert("\n")
                }
            }
            return t
        }

        function X(e, t) {
            var n = {};
            var i = e.style || {};
            if (i.fontStyle && B(e).fontStyle === "italic") {
                n.italic = true
            }
            if (i.fontWeight && (B(e).fontWeight.startsWith("bold") || parseInt(B(e).fontWeight) >= 700)) {
                n.bold = true
            }
            if (Object.keys(n).length > 0) {
                t = M(t, n)
            }
            if (parseFloat(i.textIndent || 0) > 0) {
                t = (new c.default).insert("\t").concat(t)
            }
            return t
        }

        function Z(e, t) {
            var n = e.data;
            if (e.parentNode.tagName === "O:P") {
                return t.insert(n.trim())
            }
            if (n.trim().length === 0 && e.parentNode.classList.contains("ql-clipboard")) {
                return t
            }
            if (!B(e.parentNode).whiteSpace.startsWith("pre")) {
                var i = function e(t, n) {
                    n = n.replace(/[^\u00a0]/g, "");
                    return n.length < 1 && t ? " " : n
                };
                n = n.replace(/\r\n/g, " ").replace(/\n/g, " ");
                n = n.replace(/\s\s+/g, i.bind(i, true));
                if (e.previousSibling == null && $(e.parentNode) || e.previousSibling != null && $(e.previousSibling)) {
                    n = n.replace(/^\s+/, i.bind(i, false))
                }
                if (e.nextSibling == null && $(e.parentNode) || e.nextSibling != null && $(e.nextSibling)) {
                    n = n.replace(/\s+$/, i.bind(i, false))
                }
            }
            return t.insert(n)
        }
        t.default = R;
        t.matchAttributor = H;
        t.matchBlot = F;
        t.matchNewline = G;
        t.matchSpacing = K;
        t.matchText = Z
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = n(6);
        var a = s(o);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(n, e);

            function n() {
                l(this, n);
                return u(this, (n.__proto__ || Object.getPrototypeOf(n)).apply(this, arguments))
            }
            i(n, [{
                key: "optimize",
                value: function e(t) {
                    r(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "optimize", this).call(this, t);
                    if (this.domNode.tagName !== this.statics.tagName[0]) {
                        this.replaceWith(this.statics.blotName)
                    }
                }
            }], [{
                key: "create",
                value: function e() {
                    return r(n.__proto__ || Object.getPrototypeOf(n), "create", this).call(this)
                }
            }, {
                key: "formats",
                value: function e() {
                    return true
                }
            }]);
            return n
        }(a.default);
        f.blotName = "bold";
        f.tagName = ["STRONG", "B"];
        t.default = f
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.addControls = t.default = undefined;
        var u = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(2);
        var c = v(r);
        var o = n(0);
        var f = v(o);
        var a = n(5);
        var h = v(a);
        var s = n(10);
        var l = v(s);
        var d = n(9);
        var p = v(d);

        function v(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function g(e, t, n) {
            if (t in e) {
                Object.defineProperty(e, t, {
                    value: n,
                    enumerable: true,
                    configurable: true,
                    writable: true
                })
            } else {
                e[t] = n
            }
            return e
        }

        function _(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function y(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function m(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var b = (0,
            l.default)("quill:toolbar");
        var w = function (e) {
            m(o, e);

            function o(e, t) {
                _(this, o);
                var i = y(this, (o.__proto__ || Object.getPrototypeOf(o)).call(this, e, t));
                if (Array.isArray(i.options.container)) {
                    var n = document.createElement("div");
                    E(n, i.options.container);
                    e.container.parentNode.insertBefore(n, e.container);
                    i.container = n
                } else if (typeof i.options.container === "string") {
                    i.container = document.querySelector(i.options.container)
                } else {
                    i.container = i.options.container
                }
                if (!(i.container instanceof HTMLElement)) {
                    var r;
                    return r = b.error("Container required for toolbar", i.options),
                        y(i, r)
                }
                i.container.classList.add("ql-toolbar");
                i.controls = [];
                i.handlers = {};
                Object.keys(i.options.handlers).forEach(function (e) {
                    i.addHandler(e, i.options.handlers[e])
                });
                [].forEach.call(i.container.querySelectorAll("button, select"), function (e) {
                    i.attach(e)
                });
                i.quill.on(h.default.events.EDITOR_CHANGE, function (e, t) {
                    if (e === h.default.events.SELECTION_CHANGE) {
                        i.update(t)
                    }
                });
                i.quill.on(h.default.events.SCROLL_OPTIMIZE, function () {
                    var e = i.quill.selection.getRange(),
                        t = u(e, 1),
                        n = t[0];
                    i.update(n)
                });
                return i
            }
            i(o, [{
                key: "addHandler",
                value: function e(t, n) {
                    this.handlers[t] = n
                }
            }, {
                key: "attach",
                value: function e(a) {
                    var s = this;
                    var l = [].find.call(a.classList, function (e) {
                        return e.indexOf("ql-") === 0
                    });
                    if (!l)
                        return;
                    l = l.slice("ql-".length);
                    if (a.tagName === "BUTTON") {
                        a.setAttribute("type", "button")
                    }
                    if (this.handlers[l] == null) {
                        if (this.quill.scroll.whitelist != null && this.quill.scroll.whitelist[l] == null) {
                            b.warn("ignoring attaching to disabled format", l, a);
                            return
                        }
                        if (f.default.query(l) == null) {
                            b.warn("ignoring attaching to nonexistent format", l, a);
                            return
                        }
                    }
                    var t = a.tagName === "SELECT" ? "change" : "click";
                    a.addEventListener(t, function (e) {
                        var t = void 0;
                        if (a.tagName === "SELECT") {
                            if (a.selectedIndex < 0)
                                return;
                            var n = a.options[a.selectedIndex];
                            if (n.hasAttribute("selected")) {
                                t = false
                            } else {
                                t = n.value || false
                            }
                        } else {
                            if (a.classList.contains("ql-active")) {
                                t = false
                            } else {
                                t = a.value || !a.hasAttribute("value")
                            }
                            e.preventDefault()
                        }
                        s.quill.focus();
                        var i = s.quill.selection.getRange(),
                            r = u(i, 1),
                            o = r[0];
                        if (s.handlers[l] != null) {
                            s.handlers[l].call(s, t)
                        } else if (f.default.query(l).prototype instanceof f.default.Embed) {
                            t = prompt("Enter " + l);
                            if (!t)
                                return;
                            s.quill.updateContents((new c.default).retain(o.index).delete(o.length).insert(g({}, l, t)), h.default.sources.USER)
                        } else {
                            s.quill.format(l, t, h.default.sources.USER)
                        }
                        s.update(o)
                    });
                    this.controls.push([l, a])
                }
            }, {
                key: "update",
                value: function e(s) {
                    var l = s == null ? {} : this.quill.getFormat(s);
                    this.controls.forEach(function (e) {
                        var t = u(e, 2),
                            n = t[0],
                            i = t[1];
                        if (i.tagName === "SELECT") {
                            var r = void 0;
                            if (s == null) {
                                r = null
                            } else if (l[n] == null) {
                                r = i.querySelector("option[selected]")
                            } else if (!Array.isArray(l[n])) {
                                var o = l[n];
                                if (typeof o === "string") {
                                    o = o.replace(/\"/g, '\\"')
                                }
                                r = i.querySelector('option[value="' + o + '"]')
                            }
                            if (r == null) {
                                i.value = "";
                                i.selectedIndex = -1
                            } else {
                                r.selected = true
                            }
                        } else {
                            if (s == null) {
                                i.classList.remove("ql-active")
                            } else if (i.hasAttribute("value")) {
                                var a = l[n] === i.getAttribute("value") || l[n] != null && l[n].toString() === i.getAttribute("value") || l[n] == null && !i.getAttribute("value");
                                i.classList.toggle("ql-active", a)
                            } else {
                                i.classList.toggle("ql-active", l[n] != null)
                            }
                        }
                    })
                }
            }]);
            return o
        }(p.default);
        w.DEFAULTS = {};

        function x(e, t, n) {
            var i = document.createElement("button");
            i.setAttribute("type", "button");
            i.classList.add("ql-" + t);
            if (n != null) {
                i.value = n
            }
            e.appendChild(i)
        }

        function E(t, e) {
            if (!Array.isArray(e[0])) {
                e = [e]
            }
            e.forEach(function (e) {
                var i = document.createElement("span");
                i.classList.add("ql-formats");
                e.forEach(function (e) {
                    if (typeof e === "string") {
                        x(i, e)
                    } else {
                        var t = Object.keys(e)[0];
                        var n = e[t];
                        if (Array.isArray(n)) {
                            k(i, t, n)
                        } else {
                            x(i, t, n)
                        }
                    }
                });
                t.appendChild(i)
            })
        }

        function k(e, t, n) {
            var i = document.createElement("select");
            i.classList.add("ql-" + t);
            n.forEach(function (e) {
                var t = document.createElement("option");
                if (e !== false) {
                    t.setAttribute("value", e)
                } else {
                    t.setAttribute("selected", "selected")
                }
                i.appendChild(t)
            });
            e.appendChild(i)
        }
        w.DEFAULTS = {
            container: null,
            handlers: {
                clean: function e() {
                    var t = this;
                    var n = this.quill.getSelection();
                    if (n == null)
                        return;
                    if (n.length == 0) {
                        var i = this.quill.getFormat();
                        Object.keys(i).forEach(function (e) {
                            if (f.default.query(e, f.default.Scope.INLINE) != null) {
                                t.quill.format(e, false)
                            }
                        })
                    } else {
                        this.quill.removeFormat(n, h.default.sources.USER)
                    }
                },
                direction: function e(t) {
                    var n = this.quill.getFormat()["align"];
                    if (t === "rtl" && n == null) {
                        this.quill.format("align", "right", h.default.sources.USER)
                    } else if (!t && n === "right") {
                        this.quill.format("align", false, h.default.sources.USER)
                    }
                    this.quill.format("direction", t, h.default.sources.USER)
                },
                indent: function e(t) {
                    var n = this.quill.getSelection();
                    var i = this.quill.getFormat(n);
                    var e = parseInt(i.indent || 0);
                    if (t === "+1" || t === "-1") {
                        var r = t === "+1" ? 1 : -1;
                        if (i.direction === "rtl")
                            r *= -1;
                        this.quill.format("indent", e + r, h.default.sources.USER)
                    }
                },
                link: function e(t) {
                    if (t === true) {
                        t = prompt("Enter link URL:")
                    }
                    this.quill.format("link", t, h.default.sources.USER)
                },
                list: function e(t) {
                    var n = this.quill.getSelection();
                    var i = this.quill.getFormat(n);
                    if (t === "check") {
                        if (i["list"] === "checked" || i["list"] === "unchecked") {
                            this.quill.format("list", false, h.default.sources.USER)
                        } else {
                            this.quill.format("list", "unchecked", h.default.sources.USER)
                        }
                    } else {
                        this.quill.format("list", t, h.default.sources.USER)
                    }
                }
            }
        };
        t.default = w;
        t.addControls = E
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var a = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(28);
        var o = s(r);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(o, e);

            function o(e, t) {
                l(this, o);
                var n = u(this, (o.__proto__ || Object.getPrototypeOf(o)).call(this, e));
                n.label.innerHTML = t;
                n.container.classList.add("ql-color-picker");
                [].slice.call(n.container.querySelectorAll(".ql-picker-item"), 0, 7).forEach(function (e) {
                    e.classList.add("ql-primary")
                });
                return n
            }
            i(o, [{
                key: "buildItem",
                value: function e(t) {
                    var n = a(o.prototype.__proto__ || Object.getPrototypeOf(o.prototype), "buildItem", this).call(this, t);
                    n.style.backgroundColor = t.getAttribute("value") || "";
                    return n
                }
            }, {
                key: "selectItem",
                value: function e(t, n) {
                    a(o.prototype.__proto__ || Object.getPrototypeOf(o.prototype), "selectItem", this).call(this, t, n);
                    var i = this.label.querySelector(".ql-color-label");
                    var r = t ? t.getAttribute("data-value") || "" : "";
                    if (i) {
                        if (i.tagName === "line") {
                            i.style.stroke = r
                        } else {
                            i.style.fill = r
                        }
                    }
                }
            }]);
            return o
        }(o.default);
        t.default = f
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(28);
        var a = s(i);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(i, e);

            function i(e, t) {
                l(this, i);
                var n = u(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e));
                n.container.classList.add("ql-icon-picker");
                [].forEach.call(n.container.querySelectorAll(".ql-picker-item"), function (e) {
                    e.innerHTML = t[e.getAttribute("data-value") || ""]
                });
                n.defaultItem = n.container.querySelector(".ql-selected");
                n.selectItem(n.defaultItem);
                return n
            }
            r(i, [{
                key: "selectItem",
                value: function e(t, n) {
                    o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "selectItem", this).call(this, t, n);
                    t = t || this.defaultItem;
                    this.label.innerHTML = t.innerHTML
                }
            }]);
            return i
        }(a.default);
        t.default = f
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();

        function o(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }
        var i = function () {
            function i(e, t) {
                var n = this;
                o(this, i);
                this.quill = e;
                this.boundsContainer = t || document.body;
                this.root = e.addContainer("ql-tooltip");
                this.root.innerHTML = this.constructor.TEMPLATE;
                if (this.quill.root === this.quill.scrollingContainer) {
                    this.quill.root.addEventListener("scroll", function () {
                        n.root.style.marginTop = -1 * n.quill.root.scrollTop + "px"
                    })
                }
                this.hide()
            }
            r(i, [{
                key: "hide",
                value: function e() {
                    this.root.classList.add("ql-hidden")
                }
            }, {
                key: "position",
                value: function e(t) {
                    var n = t.left + t.width / 2 - this.root.offsetWidth / 2;
                    var i = t.bottom + this.quill.root.scrollTop;
                    this.root.style.left = n + "px";
                    this.root.style.top = i + "px";
                    this.root.classList.remove("ql-flip");
                    var r = this.boundsContainer.getBoundingClientRect();
                    var o = this.root.getBoundingClientRect();
                    var a = 0;
                    if (o.right > r.right) {
                        a = r.right - o.right;
                        this.root.style.left = n + a + "px"
                    }
                    if (o.left < r.left) {
                        a = r.left - o.left;
                        this.root.style.left = n + a + "px"
                    }
                    if (o.bottom > r.bottom) {
                        var s = o.bottom - o.top;
                        var l = t.bottom - t.top + s;
                        this.root.style.top = i - l + "px";
                        this.root.classList.add("ql-flip")
                    }
                    return a
                }
            }, {
                key: "show",
                value: function e() {
                    this.root.classList.remove("ql-editing");
                    this.root.classList.remove("ql-hidden")
                }
            }]);
            return i
        }();
        t.default = i
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var u = function () {
            function n(e, t) {
                var n = [];
                var i = true;
                var r = false;
                var o = undefined;
                try {
                    for (var a = e[Symbol.iterator](), s; !(i = (s = a.next()).done); i = true) {
                        n.push(s.value);
                        if (t && n.length === t)
                            break
                    }
                } catch (e) {
                    r = true;
                    o = e
                } finally {
                    try {
                        if (!i && a["return"])
                            a["return"]()
                    } finally {
                        if (r)
                            throw o
                    }
                }
                return n
            }
            return function (e, t) {
                if (Array.isArray(e)) {
                    return e
                } else if (Symbol.iterator in Object(e)) {
                    return n(e, t)
                } else {
                    throw new TypeError("Invalid attempt to destructure non-iterable instance")
                }
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var i = n(3);
        var a = _(i);
        var s = n(8);
        var c = _(s);
        var l = n(43);
        var f = _(l);
        var h = n(27);
        var d = _(h);
        var p = n(15);
        var v = n(41);
        var g = _(v);

        function _(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function y(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function m(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function b(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var w = [
            [{
                header: ["1", "2", "3", false]
            }],
            ["bold", "italic", "underline", "link"],
            [{
                list: "ordered"
            }, {
                list: "bullet"
            }],
            ["clean"]
        ];
        var x = function (e) {
            b(i, e);

            function i(e, t) {
                y(this, i);
                if (t.modules.toolbar != null && t.modules.toolbar.container == null) {
                    t.modules.toolbar.container = w
                }
                var n = m(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t));
                n.quill.container.classList.add("ql-snow");
                return n
            }
            o(i, [{
                key: "extendToolbar",
                value: function e(n) {
                    n.container.classList.add("ql-snow");
                    this.buildButtons([].slice.call(n.container.querySelectorAll("button")), g.default);
                    this.buildPickers([].slice.call(n.container.querySelectorAll("select")), g.default);
                    this.tooltip = new E(this.quill, this.options.bounds);
                    if (n.container.querySelector(".ql-link")) {
                        this.quill.keyboard.addBinding({
                            key: "K",
                            shortKey: true
                        }, function (e, t) {
                            n.handlers["link"].call(n, !t.format.link)
                        })
                    }
                }
            }]);
            return i
        }(f.default);
        x.DEFAULTS = (0,
            a.default)(true, {}, f.default.DEFAULTS, {
            modules: {
                toolbar: {
                    handlers: {
                        link: function e(t) {
                            if (t) {
                                var n = this.quill.getSelection();
                                if (n == null || n.length == 0)
                                    return;
                                var i = this.quill.getText(n);
                                if (/^\S+@\S+\.\S+$/.test(i) && i.indexOf("mailto:") !== 0) {
                                    i = "mailto:" + i
                                }
                                var r = this.quill.theme.tooltip;
                                r.edit("link", i)
                            } else {
                                this.quill.format("link", false)
                            }
                        }
                    }
                }
            }
        });
        var E = function (e) {
            b(i, e);

            function i(e, t) {
                y(this, i);
                var n = m(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t));
                n.preview = n.root.querySelector("a.ql-preview");
                return n
            }
            o(i, [{
                key: "listen",
                value: function e() {
                    var l = this;
                    r(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "listen", this).call(this);
                    this.root.querySelector("a.ql-action").addEventListener("click", function (e) {
                        if (l.root.classList.contains("ql-editing")) {
                            l.save()
                        } else {
                            l.edit("link", l.preview.textContent)
                        }
                        e.preventDefault()
                    });
                    this.root.querySelector("a.ql-remove").addEventListener("click", function (e) {
                        if (l.linkRange != null) {
                            var t = l.linkRange;
                            l.restoreFocus();
                            l.quill.formatText(t, "link", false, c.default.sources.USER);
                            delete l.linkRange
                        }
                        e.preventDefault();
                        l.hide()
                    });
                    this.quill.on(c.default.events.SELECTION_CHANGE, function (e, t, n) {
                        if (e == null)
                            return;
                        if (e.length === 0 && n === c.default.sources.USER) {
                            var i = l.quill.scroll.descendant(d.default, e.index),
                                r = u(i, 2),
                                o = r[0],
                                a = r[1];
                            if (o != null) {
                                l.linkRange = new p.Range(e.index - a, o.length());
                                var s = d.default.formats(o.domNode);
                                l.preview.textContent = s;
                                l.preview.setAttribute("href", s);
                                l.show();
                                l.position(l.quill.getBounds(l.linkRange));
                                return
                            }
                        } else {
                            delete l.linkRange
                        }
                        l.hide()
                    })
                }
            }, {
                key: "show",
                value: function e() {
                    r(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "show", this).call(this);
                    this.root.removeAttribute("data-mode")
                }
            }]);
            return i
        }(l.BaseTooltip);
        E.TEMPLATE = ['<a class="ql-preview" target="_blank" href="about:blank"></a>', '<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">', '<a class="ql-action"></a>', '<a class="ql-remove"></a>'].join("");
        t.default = x
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(29);
        var r = ne(i);
        var o = n(36);
        var a = n(38);
        var s = n(64);
        var l = n(65);
        var u = ne(l);
        var c = n(66);
        var f = ne(c);
        var h = n(67);
        var d = ne(h);
        var p = n(37);
        var v = n(26);
        var g = n(39);
        var _ = n(40);
        var y = n(56);
        var m = ne(y);
        var b = n(68);
        var w = ne(b);
        var x = n(27);
        var E = ne(x);
        var k = n(69);
        var T = ne(k);
        var O = n(70);
        var S = ne(O);
        var C = n(71);
        var A = ne(C);
        var j = n(72);
        var P = ne(j);
        var D = n(73);
        var I = ne(D);
        var N = n(13);
        var L = ne(N);
        var R = n(74);
        var M = ne(R);
        var B = n(75);
        var q = ne(B);
        var $ = n(57);
        var U = ne($);
        var V = n(41);
        var H = ne(V);
        var F = n(28);
        var W = ne(F);
        var z = n(59);
        var Y = ne(z);
        var G = n(60);
        var K = ne(G);
        var X = n(61);
        var Z = ne(X);
        var Q = n(108);
        var J = ne(Q);
        var ee = n(62);
        var te = ne(ee);

        function ne(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }
        r.default.register({
            "attributors/attribute/direction": a.DirectionAttribute,
            "attributors/class/align": o.AlignClass,
            "attributors/class/background": p.BackgroundClass,
            "attributors/class/color": v.ColorClass,
            "attributors/class/direction": a.DirectionClass,
            "attributors/class/font": g.FontClass,
            "attributors/class/size": _.SizeClass,
            "attributors/style/align": o.AlignStyle,
            "attributors/style/background": p.BackgroundStyle,
            "attributors/style/color": v.ColorStyle,
            "attributors/style/direction": a.DirectionStyle,
            "attributors/style/font": g.FontStyle,
            "attributors/style/size": _.SizeStyle
        }, true);
        r.default.register({
            "formats/align": o.AlignClass,
            "formats/direction": a.DirectionClass,
            "formats/indent": s.IndentClass,
            "formats/background": p.BackgroundStyle,
            "formats/color": v.ColorStyle,
            "formats/font": g.FontClass,
            "formats/size": _.SizeClass,
            "formats/blockquote": u.default,
            "formats/code-block": L.default,
            "formats/header": f.default,
            "formats/list": d.default,
            "formats/bold": m.default,
            "formats/code": N.Code,
            "formats/italic": w.default,
            "formats/link": E.default,
            "formats/script": T.default,
            "formats/strike": S.default,
            "formats/underline": A.default,
            "formats/image": P.default,
            "formats/video": I.default,
            "formats/list/item": h.ListItem,
            "modules/formula": M.default,
            "modules/syntax": q.default,
            "modules/toolbar": U.default,
            "themes/bubble": J.default,
            "themes/snow": te.default,
            "ui/icons": H.default,
            "ui/picker": W.default,
            "ui/icon-picker": K.default,
            "ui/color-picker": Y.default,
            "ui/tooltip": Z.default
        }, true);
        t.default = r.default
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.IndentClass = undefined;
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var r = n(0);
        var a = s(r);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(r, e);

            function r() {
                l(this, r);
                return u(this, (r.__proto__ || Object.getPrototypeOf(r)).apply(this, arguments))
            }
            i(r, [{
                key: "add",
                value: function e(t, n) {
                    if (n === "+1" || n === "-1") {
                        var i = this.value(t) || 0;
                        n = n === "+1" ? i + 1 : i - 1
                    }
                    if (n === 0) {
                        this.remove(t);
                        return true
                    } else {
                        return o(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "add", this).call(this, t, n)
                    }
                }
            }, {
                key: "canAdd",
                value: function e(t, n) {
                    return o(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "canAdd", this).call(this, t, n) || o(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "canAdd", this).call(this, t, parseInt(n))
                }
            }, {
                key: "value",
                value: function e(t) {
                    return parseInt(o(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "value", this).call(this, t)) || undefined
                }
            }]);
            return r
        }(a.default.Attributor.Class);
        var h = new f("indent", "ql-indent", {
            scope: a.default.Scope.BLOCK,
            whitelist: [1, 2, 3, 4, 5, 6, 7, 8]
        });
        t.IndentClass = h
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(4);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function a(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function s(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function l(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var u = function (e) {
            l(t, e);

            function t() {
                a(this, t);
                return s(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(r.default);
        u.blotName = "blockquote";
        u.tagName = "blockquote";
        t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = n(4);
        var o = a(r);

        function a(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function s(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function l(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function u(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var c = function (e) {
            u(t, e);

            function t() {
                s(this, t);
                return l(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            i(t, null, [{
                key: "formats",
                value: function e(t) {
                    return this.tagName.indexOf(t.tagName) + 1
                }
            }]);
            return t
        }(o.default);
        c.blotName = "header";
        c.tagName = ["H1", "H2", "H3", "H4", "H5", "H6"];
        t.default = c
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.ListItem = undefined;
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(0);
        var s = f(i);
        var a = n(4);
        var l = f(a);
        var u = n(24);
        var c = f(u);

        function f(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function h(e, t, n) {
            if (t in e) {
                Object.defineProperty(e, t, {
                    value: n,
                    enumerable: true,
                    configurable: true,
                    writable: true
                })
            } else {
                e[t] = n
            }
            return e
        }

        function d(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function p(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function v(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var g = function (e) {
            v(i, e);

            function i() {
                d(this, i);
                return p(this, (i.__proto__ || Object.getPrototypeOf(i)).apply(this, arguments))
            }
            r(i, [{
                key: "format",
                value: function e(t, n) {
                    if (t === _.blotName && !n) {
                        this.replaceWith(s.default.create(this.statics.scope))
                    } else {
                        o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "format", this).call(this, t, n)
                    }
                }
            }, {
                key: "remove",
                value: function e() {
                    if (this.prev == null && this.next == null) {
                        this.parent.remove()
                    } else {
                        o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "remove", this).call(this)
                    }
                }
            }, {
                key: "replaceWith",
                value: function e(t, n) {
                    this.parent.isolate(this.offset(this.parent), this.length());
                    if (t === this.parent.statics.blotName) {
                        this.parent.replaceWith(t, n);
                        return this
                    } else {
                        this.parent.unwrap();
                        return o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "replaceWith", this).call(this, t, n)
                    }
                }
            }], [{
                key: "formats",
                value: function e(t) {
                    return t.tagName === this.tagName ? undefined : o(i.__proto__ || Object.getPrototypeOf(i), "formats", this).call(this, t)
                }
            }]);
            return i
        }(l.default);
        g.blotName = "list-item";
        g.tagName = "LI";
        var _ = function (e) {
            v(a, e);
            r(a, null, [{
                key: "create",
                value: function e(t) {
                    var n = t === "ordered" ? "OL" : "UL";
                    var i = o(a.__proto__ || Object.getPrototypeOf(a), "create", this).call(this, n);
                    if (t === "checked" || t === "unchecked") {
                        i.setAttribute("data-checked", t === "checked")
                    }
                    return i
                }
            }, {
                key: "formats",
                value: function e(t) {
                    if (t.tagName === "OL")
                        return "ordered";
                    if (t.tagName === "UL") {
                        if (t.hasAttribute("data-checked")) {
                            return t.getAttribute("data-checked") === "true" ? "checked" : "unchecked"
                        } else {
                            return "bullet"
                        }
                    }
                    return undefined
                }
            }]);

            function a(r) {
                d(this, a);
                var o = p(this, (a.__proto__ || Object.getPrototypeOf(a)).call(this, r));
                var e = function e(t) {
                    if (t.target.parentNode !== r)
                        return;
                    var n = o.statics.formats(r);
                    var i = s.default.find(t.target);
                    if (n === "checked") {
                        i.format("list", "unchecked")
                    } else if (n === "unchecked") {
                        i.format("list", "checked")
                    }
                };
                r.addEventListener("touchstart", e);
                r.addEventListener("mousedown", e);
                return o
            }
            r(a, [{
                key: "format",
                value: function e(t, n) {
                    if (this.children.length > 0) {
                        this.children.tail.format(t, n)
                    }
                }
            }, {
                key: "formats",
                value: function e() {
                    return h({}, this.statics.blotName, this.statics.formats(this.domNode))
                }
            }, {
                key: "insertBefore",
                value: function e(t, n) {
                    if (t instanceof g) {
                        o(a.prototype.__proto__ || Object.getPrototypeOf(a.prototype), "insertBefore", this).call(this, t, n)
                    } else {
                        var i = n == null ? this.length() : n.offset(this);
                        var r = this.split(i);
                        r.parent.insertBefore(t, r)
                    }
                }
            }, {
                key: "optimize",
                value: function e(t) {
                    o(a.prototype.__proto__ || Object.getPrototypeOf(a.prototype), "optimize", this).call(this, t);
                    var n = this.next;
                    if (n != null && n.prev === this && n.statics.blotName === this.statics.blotName && n.domNode.tagName === this.domNode.tagName && n.domNode.getAttribute("data-checked") === this.domNode.getAttribute("data-checked")) {
                        n.moveChildren(this);
                        n.remove()
                    }
                }
            }, {
                key: "replace",
                value: function e(t) {
                    if (t.statics.blotName !== this.statics.blotName) {
                        var n = s.default.create(this.statics.defaultChild);
                        t.moveChildren(n);
                        this.appendChild(n)
                    }
                    o(a.prototype.__proto__ || Object.getPrototypeOf(a.prototype), "replace", this).call(this, t)
                }
            }]);
            return a
        }(c.default);
        _.blotName = "list";
        _.scope = s.default.Scope.BLOCK_BLOT;
        _.tagName = ["OL", "UL"];
        _.defaultChild = "list-item";
        _.allowedChildren = [g];
        t.ListItem = g;
        t.default = _
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(56);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function a(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function s(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function l(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var u = function (e) {
            l(t, e);

            function t() {
                a(this, t);
                return s(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(r.default);
        u.blotName = "italic";
        u.tagName = ["EM", "I"];
        t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = n(6);
        var a = s(o);

        function s(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function l(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function u(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function c(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var f = function (e) {
            c(n, e);

            function n() {
                l(this, n);
                return u(this, (n.__proto__ || Object.getPrototypeOf(n)).apply(this, arguments))
            }
            i(n, null, [{
                key: "create",
                value: function e(t) {
                    if (t === "super") {
                        return document.createElement("sup")
                    } else if (t === "sub") {
                        return document.createElement("sub")
                    } else {
                        return r(n.__proto__ || Object.getPrototypeOf(n), "create", this).call(this, t)
                    }
                }
            }, {
                key: "formats",
                value: function e(t) {
                    if (t.tagName === "SUB")
                        return "sub";
                    if (t.tagName === "SUP")
                        return "super";
                    return undefined
                }
            }]);
            return n
        }(a.default);
        f.blotName = "script";
        f.tagName = ["SUB", "SUP"];
        t.default = f
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(6);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function a(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function s(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function l(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var u = function (e) {
            l(t, e);

            function t() {
                a(this, t);
                return s(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(r.default);
        u.blotName = "strike";
        u.tagName = "S";
        t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var i = n(6);
        var r = o(i);

        function o(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function a(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function s(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function l(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var u = function (e) {
            l(t, e);

            function t() {
                a(this, t);
                return s(this, (t.__proto__ || Object.getPrototypeOf(t)).apply(this, arguments))
            }
            return t
        }(r.default);
        u.blotName = "underline";
        u.tagName = "U";
        t.default = u
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(0);
        var a = l(i);
        var s = n(27);

        function l(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function u(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function c(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function f(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var h = ["alt", "height", "width"];
        var d = function (e) {
            f(i, e);

            function i() {
                u(this, i);
                return c(this, (i.__proto__ || Object.getPrototypeOf(i)).apply(this, arguments))
            }
            r(i, [{
                key: "format",
                value: function e(t, n) {
                    if (h.indexOf(t) > -1) {
                        if (n) {
                            this.domNode.setAttribute(t, n)
                        } else {
                            this.domNode.removeAttribute(t)
                        }
                    } else {
                        o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "format", this).call(this, t, n)
                    }
                }
            }], [{
                key: "create",
                value: function e(t) {
                    var n = o(i.__proto__ || Object.getPrototypeOf(i), "create", this).call(this, t);
                    if (typeof t === "string") {
                        n.setAttribute("src", this.sanitize(t))
                    }
                    return n
                }
            }, {
                key: "formats",
                value: function e(n) {
                    return h.reduce(function (e, t) {
                        if (n.hasAttribute(t)) {
                            e[t] = n.getAttribute(t)
                        }
                        return e
                    }, {})
                }
            }, {
                key: "match",
                value: function e(t) {
                    return /\.(jpe?g|gif|png)$/.test(t) || /^data:image\/.+;base64/.test(t)
                }
            }, {
                key: "sanitize",
                value: function e(t) {
                    return (0,
                        s.sanitize)(t, ["http", "https", "data"]) ? t : "//:0"
                }
            }, {
                key: "value",
                value: function e(t) {
                    return t.getAttribute("src")
                }
            }]);
            return i
        }(a.default.Embed);
        d.blotName = "image";
        d.tagName = "IMG";
        t.default = d
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(4);
        var a = n(27);
        var s = l(a);

        function l(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function u(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function c(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function f(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var h = ["height", "width"];
        var d = function (e) {
            f(i, e);

            function i() {
                u(this, i);
                return c(this, (i.__proto__ || Object.getPrototypeOf(i)).apply(this, arguments))
            }
            r(i, [{
                key: "format",
                value: function e(t, n) {
                    if (h.indexOf(t) > -1) {
                        if (n) {
                            this.domNode.setAttribute(t, n)
                        } else {
                            this.domNode.removeAttribute(t)
                        }
                    } else {
                        o(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "format", this).call(this, t, n)
                    }
                }
            }], [{
                key: "create",
                value: function e(t) {
                    var n = o(i.__proto__ || Object.getPrototypeOf(i), "create", this).call(this, t);
                    n.setAttribute("frameborder", "0");
                    n.setAttribute("allowfullscreen", true);
                    n.setAttribute("src", this.sanitize(t));
                    return n
                }
            }, {
                key: "formats",
                value: function e(n) {
                    return h.reduce(function (e, t) {
                        if (n.hasAttribute(t)) {
                            e[t] = n.getAttribute(t)
                        }
                        return e
                    }, {})
                }
            }, {
                key: "sanitize",
                value: function e(t) {
                    return s.default.sanitize(t)
                }
            }, {
                key: "value",
                value: function e(t) {
                    return t.getAttribute("src")
                }
            }]);
            return i
        }(i.BlockEmbed);
        d.blotName = "video";
        d.className = "ql-video";
        d.tagName = "IFRAME";
        t.default = d
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.FormulaBlot = undefined;
        var r = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var i = n(25);
        var a = f(i);
        var s = n(5);
        var l = f(s);
        var u = n(9);
        var c = f(u);

        function f(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function h(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function d(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function p(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var v = function (e) {
            p(i, e);

            function i() {
                h(this, i);
                return d(this, (i.__proto__ || Object.getPrototypeOf(i)).apply(this, arguments))
            }
            r(i, null, [{
                key: "create",
                value: function e(t) {
                    var n = o(i.__proto__ || Object.getPrototypeOf(i), "create", this).call(this, t);
                    if (typeof t === "string") {
                        window.katex.render(t, n, {
                            throwOnError: false,
                            errorColor: "#f00"
                        });
                        n.setAttribute("data-value", t)
                    }
                    return n
                }
            }, {
                key: "value",
                value: function e(t) {
                    return t.getAttribute("data-value")
                }
            }]);
            return i
        }(a.default);
        v.blotName = "formula";
        v.className = "ql-formula";
        v.tagName = "SPAN";
        var g = function (e) {
            p(t, e);
            r(t, null, [{
                key: "register",
                value: function e() {
                    l.default.register(v, true)
                }
            }]);

            function t() {
                h(this, t);
                var e = d(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this));
                if (window.katex == null) {
                    throw new Error("Formula module requires KaTeX.")
                }
                return e
            }
            return t
        }(c.default);
        t.FormulaBlot = v;
        t.default = g
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.CodeToken = t.CodeBlock = undefined;
        var i = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var r = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var o = n(0);
        var a = d(o);
        var s = n(5);
        var l = d(s);
        var u = n(9);
        var c = d(u);
        var f = n(13);
        var h = d(f);

        function d(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function p(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function v(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function g(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var _ = function (e) {
            g(n, e);

            function n() {
                p(this, n);
                return v(this, (n.__proto__ || Object.getPrototypeOf(n)).apply(this, arguments))
            }
            i(n, [{
                key: "replaceWith",
                value: function e(t) {
                    this.domNode.textContent = this.domNode.textContent;
                    this.attach();
                    r(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "replaceWith", this).call(this, t)
                }
            }, {
                key: "highlight",
                value: function e(t) {
                    var n = this.domNode.textContent;
                    if (this.cachedText !== n) {
                        if (n.trim().length > 0 || this.cachedText == null) {
                            this.domNode.innerHTML = t(n);
                            this.domNode.normalize();
                            this.attach()
                        }
                        this.cachedText = n
                    }
                }
            }]);
            return n
        }(h.default);
        _.className = "ql-syntax";
        var y = new a.default.Attributor.Class("token", "hljs", {
            scope: a.default.Scope.INLINE
        });
        var m = function (e) {
            g(r, e);
            i(r, null, [{
                key: "register",
                value: function e() {
                    l.default.register(y, true);
                    l.default.register(_, true)
                }
            }]);

            function r(e, t) {
                p(this, r);
                var n = v(this, (r.__proto__ || Object.getPrototypeOf(r)).call(this, e, t));
                if (typeof n.options.highlight !== "function") {
                    throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.")
                }
                var i = null;
                n.quill.on(l.default.events.SCROLL_OPTIMIZE, function () {
                    clearTimeout(i);
                    i = setTimeout(function () {
                        n.highlight();
                        i = null
                    }, n.options.interval)
                });
                n.highlight();
                return n
            }
            i(r, [{
                key: "highlight",
                value: function e() {
                    var t = this;
                    if (this.quill.selection.composing)
                        return;
                    this.quill.update(l.default.sources.USER);
                    var n = this.quill.getSelection();
                    this.quill.scroll.descendants(_).forEach(function (e) {
                        e.highlight(t.options.highlight)
                    });
                    this.quill.update(l.default.sources.SILENT);
                    if (n != null) {
                        this.quill.setSelection(n, l.default.sources.SILENT)
                    }
                }
            }]);
            return r
        }(c.default);
        m.DEFAULTS = {
            highlight: function () {
                if (window.hljs == null)
                    return null;
                return function (e) {
                    var t = window.hljs.highlightAuto(e);
                    return t.value
                }
            }(),
            interval: 1e3
        };
        t.CodeBlock = _;
        t.CodeToken = y;
        t.default = m
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'
    }, function (e, t) {
        e.exports = '<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'
    }, function (e, t) {
        e.exports = '<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'
    }, function (e, t) {
        e.exports = '<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'
    }, function (e, t, n) {
        "use strict";
        Object.defineProperty(t, "__esModule", {
            value: true
        });
        t.default = t.BubbleTooltip = undefined;
        var o = function e(t, n, i) {
            if (t === null)
                t = Function.prototype;
            var r = Object.getOwnPropertyDescriptor(t, n);
            if (r === undefined) {
                var o = Object.getPrototypeOf(t);
                if (o === null) {
                    return undefined
                } else {
                    return e(o, n, i)
                }
            } else if ("value" in r) {
                return r.value
            } else {
                var a = r.get;
                if (a === undefined) {
                    return undefined
                }
                return a.call(i)
            }
        };
        var a = function () {
            function i(e, t) {
                for (var n = 0; n < t.length; n++) {
                    var i = t[n];
                    i.enumerable = i.enumerable || false;
                    i.configurable = true;
                    if ("value" in i)
                        i.writable = true;
                    Object.defineProperty(e, i.key, i)
                }
            }
            return function (e, t, n) {
                if (t)
                    i(e.prototype, t);
                if (n)
                    i(e, n);
                return e
            }
        }();
        var i = n(3);
        var r = p(i);
        var s = n(8);
        var c = p(s);
        var l = n(43);
        var u = p(l);
        var f = n(15);
        var h = n(41);
        var d = p(h);

        function p(e) {
            return e && e.__esModule ? e : {
                default: e
            }
        }

        function v(e, t) {
            if (!(e instanceof t)) {
                throw new TypeError("Cannot call a class as a function")
            }
        }

        function g(e, t) {
            if (!e) {
                throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
            }
            return t && (typeof t === "object" || typeof t === "function") ? t : e
        }

        function _(e, t) {
            if (typeof t !== "function" && t !== null) {
                throw new TypeError("Super expression must either be null or a function, not " + typeof t)
            }
            e.prototype = Object.create(t && t.prototype, {
                constructor: {
                    value: e,
                    enumerable: false,
                    writable: true,
                    configurable: true
                }
            });
            if (t)
                Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t
        }
        var y = [
            ["bold", "italic", "link"],
            [{
                header: 1
            }, {
                header: 2
            }, "blockquote"]
        ];
        var m = function (e) {
            _(i, e);

            function i(e, t) {
                v(this, i);
                if (t.modules.toolbar != null && t.modules.toolbar.container == null) {
                    t.modules.toolbar.container = y
                }
                var n = g(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t));
                n.quill.container.classList.add("ql-bubble");
                return n
            }
            a(i, [{
                key: "extendToolbar",
                value: function e(t) {
                    this.tooltip = new b(this.quill, this.options.bounds);
                    this.tooltip.root.appendChild(t.container);
                    this.buildButtons([].slice.call(t.container.querySelectorAll("button")), d.default);
                    this.buildPickers([].slice.call(t.container.querySelectorAll("select")), d.default)
                }
            }]);
            return i
        }(u.default);
        m.DEFAULTS = (0,
            r.default)(true, {}, u.default.DEFAULTS, {
            modules: {
                toolbar: {
                    handlers: {
                        link: function e(t) {
                            if (!t) {
                                this.quill.format("link", false)
                            } else {
                                this.quill.theme.tooltip.edit()
                            }
                        }
                    }
                }
            }
        });
        var b = function (e) {
            _(r, e);

            function r(e, t) {
                v(this, r);
                var u = g(this, (r.__proto__ || Object.getPrototypeOf(r)).call(this, e, t));
                u.quill.on(c.default.events.EDITOR_CHANGE, function (e, t, n, i) {
                    if (e !== c.default.events.SELECTION_CHANGE)
                        return;
                    if (t != null && t.length > 0 && i === c.default.sources.USER) {
                        u.show();
                        u.root.style.left = "0px";
                        u.root.style.width = "";
                        u.root.style.width = u.root.offsetWidth + "px";
                        var r = u.quill.getLines(t.index, t.length);
                        if (r.length === 1) {
                            u.position(u.quill.getBounds(t))
                        } else {
                            var o = r[r.length - 1];
                            var a = u.quill.getIndex(o);
                            var s = Math.min(o.length() - 1, t.index + t.length - a);
                            var l = u.quill.getBounds(new f.Range(a, s));
                            u.position(l)
                        }
                    } else if (document.activeElement !== u.textbox && u.quill.hasFocus()) {
                        u.hide()
                    }
                });
                return u
            }
            a(r, [{
                key: "listen",
                value: function e() {
                    var t = this;
                    o(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "listen", this).call(this);
                    this.root.querySelector(".ql-close").addEventListener("click", function () {
                        t.root.classList.remove("ql-editing")
                    });
                    this.quill.on(c.default.events.SCROLL_OPTIMIZE, function () {
                        setTimeout(function () {
                            if (t.root.classList.contains("ql-hidden"))
                                return;
                            var e = t.quill.getSelection();
                            if (e != null) {
                                t.position(t.quill.getBounds(e))
                            }
                        }, 1)
                    })
                }
            }, {
                key: "cancel",
                value: function e() {
                    this.show()
                }
            }, {
                key: "position",
                value: function e(t) {
                    var n = o(r.prototype.__proto__ || Object.getPrototypeOf(r.prototype), "position", this).call(this, t);
                    var i = this.root.querySelector(".ql-tooltip-arrow");
                    i.style.marginLeft = "";
                    if (n === 0)
                        return n;
                    i.style.marginLeft = -1 * n - i.offsetWidth / 2 + "px"
                }
            }]);
            return r
        }(l.BaseTooltip);
        b.TEMPLATE = ['<span class="ql-tooltip-arrow"></span>', '<div class="ql-tooltip-editor">', '<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">', '<a class="ql-close"></a>', "</div>"].join("");
        t.BubbleTooltip = b;
        t.default = m
    }, function (e, t, n) {
        e.exports = n(63)
    }])["default"]
});

function Vector2(e, t) {
    this.x = e;
    this.y = t
}
Vector2.prototype.add = function (e) {
    return new Vector2(this.x + e.x, this.y + e.y)
};
Vector2.prototype.subtract = function (e) {
    return new Vector2(this.x - e.x, this.y - e.y)
};
Vector2.prototype.multiply = function (e) {
    return new Vector2(this.x * e, this.y * e)
};
Vector2.prototype.magnitude = function () {
    return Math.sqrt(this.x * this.x + this.y * this.y)
};
Vector2.prototype.normalize = function () {
    return this.multiply(1 / this.magnitude())
};
Vector2.prototype.distance = function (e) {
    var t = e.y - this.y;
    var n = e.x - this.x;
    return Math.sqrt(t * t + n * n)
};
Vector2.prototype.distanceSquared = function (e) {
    var t = e.y - this.y;
    var n = e.x - this.x;
    return t * t + n * n
};
Vector2.prototype.vectorIsWithinDist = function (e, t) {
    var n = this.distanceSquared(e);
    return n <= t * t
};
var DEBUG_LINE_SEGMENT = false;

function LineSegment(e, t) {
    this.startPoint = e;
    this.endPoint = t
}
LineSegment.prototype.calculateIntersectionWithLineSegment = function (e) {
    var t = .1;
    var n = new Line(this.startPoint, this.endPoint);
    var i = new Line(e.startPoint, e.endPoint);
    var r = n.calculateSlopeIntercept();
    var o = i.calculateSlopeIntercept();
    if (isNaN(r.m) || isNaN(o.m))
        return false;
    if (Math.abs(r.m) == Infinity) {
        if (Math.abs(o.m) == Infinity)
            return false;
        var a = this.__calculateIntersectionAsStraightLine(e, o, t);
        if (a)
            return a
    } else if (Math.abs(o.m) == Infinity) {
        var a = e.__calculateIntersectionAsStraightLine(this, r, t);
        if (a)
            return a
    }
    var s = (o.b - r.b) / (r.m - o.m);
    var l = r.m * s + r.b;
    var u = new Vector2(s, l);
    var c = this.pointInDomainAndRange(u, t) && e.pointInDomainAndRange(u, t);
    if (DEBUG_DRAW && DEBUG_LINE_SEGMENT) {
        var f = new Line(DEBUG_TRANSFORM_FUNCTION(this.startPoint), DEBUG_TRANSFORM_FUNCTION(this.endPoint));
        var h = f.extendPoints(999999);
        var d = new Line(DEBUG_TRANSFORM_FUNCTION(i.startPoint), DEBUG_TRANSFORM_FUNCTION(i.endPoint));
        var p = d.extendPoints(999999);
        var v = DEBUG_TRANSFORM_FUNCTION(u);
        DEBUG_DRAWER.drawLineSegment(h.startPoint, h.endPoint, {
            strokeStyle: "blue"
        });
        DEBUG_DRAWER.drawLineSegment(f.startPoint, f.endPoint, {
            strokeStyle: "cyan"
        });
        DEBUG_DRAWER.drawLineSegment(p.startPoint, p.endPoint, {
            strokeStyle: "DarkGoldenRod"
        });
        DEBUG_DRAWER.drawLineSegment(d.startPoint, d.endPoint, {
            strokeStyle: "yellow"
        });
        if (c) {
            DEBUG_DRAWER.drawX(v.x, v.y, 25, 25, {
                strokeStyle: "red"
            })
        }
    }
    return c ? u : false
};
LineSegment.prototype.__calculateIntersectionAsStraightLine = function (e, t, n) {
    if (e.isInDomain(this.startPoint.x, n)) {
        var i = new Vector2(this.startPoint.x, t.m * this.startPoint.x + t.b);
        if (this.isInRange(i.y, n) && e.isInRange(i.y, n)) {
            return i
        }
    }
    return false
};
LineSegment.prototype.calculateIntersectionWithPoint = function (e) {
    var t = new Line(this.startPoint, this.endPoint);
    var n = t.calculateSlopeIntercept();
    var i = e.x;
    var r = n.m * i + n.b;
    var o = new Vector2(i, r);
    var a = .2;
    var s = this.pointInDomainAndRange(o, a);
    var l = s && o.vectorIsWithinDist(e, a);
    if (DEBUG_DRAW && DEBUG_LINE_SEGMENT) {
        var u = new Line(DEBUG_TRANSFORM_FUNCTION(this.startPoint), DEBUG_TRANSFORM_FUNCTION(this.endPoint));
        var c = u.extendPoints(999999);
        var f = DEBUG_TRANSFORM_FUNCTION(o);
        DEBUG_DRAWER.drawLineSegment(c.startPoint, c.endPoint, {
            strokeStyle: "blue"
        });
        DEBUG_DRAWER.drawLineSegment(u.startPoint, u.endPoint, {
            strokeStyle: "cyan"
        });
        if (l) {
            DEBUG_DRAWER.drawX(f.x, f.y, 25, 25, {
                strokeStyle: "red"
            })
        }
    }
    return l ? o : false
};
LineSegment.prototype.pointInDomainAndRange = function (e, t) {
    if (t == undefined)
        t = 0;
    var n = this.isInDomain(e.x, t);
    var i = this.isInRange(e.y, t);
    return n && i
};
LineSegment.prototype.isInDomain = function (e, t) {
    if (t == undefined)
        t = 0;
    var n = Math.min(this.startPoint.x, this.endPoint.x);
    var i = Math.max(this.startPoint.x, this.endPoint.x);
    return e >= n - t && e <= i + t
};
LineSegment.prototype.isInRange = function (e, t) {
    if (t == undefined)
        t = 0;
    var n = Math.min(this.startPoint.y, this.endPoint.y);
    var i = Math.max(this.startPoint.y, this.endPoint.y);
    return e >= n - t && e <= i + t
};
LineSegment.prototype.domain = function () {
    var e = Math.min(this.startPoint.x, this.endPoint.x);
    var t = Math.max(this.startPoint.x, this.endPoint.x);
    return new Vector2(e, t)
};
LineSegment.prototype.range = function () {
    var e = Math.min(this.startPoint.y, this.endPoint.y);
    var t = Math.max(this.startPoint.y, this.endPoint.y);
    return new Vector2(e, t)
};

function Line(e, t) {
    this.startPoint = e;
    this.endPoint = t
}
Line.prototype.extendPoints = function (e) {
    var t = this.endPoint.subtract(this.startPoint).normalize();
    var n = t.multiply(e);
    return new Line(this.startPoint.subtract(n), this.startPoint.add(n))
};
Line.prototype.calculateSlopeIntercept = function () {
    var e = (this.endPoint.y - this.startPoint.y) / (this.endPoint.x - this.startPoint.x);
    var t = this.endPoint.y - e * this.endPoint.x;
    return {
        m: e,
        b: t
    }
};
var DEBUG_RAY = false;
var Ray = function (e, t) {
    this.startPoint = e;
    this.endPoint = t
};
Ray.prototype.extendPoint = function (e) {
    var t = this.endPoint.subtract(this.startPoint).normalize();
    var n = t.multiply(e);
    return new Ray(this.startPoint, this.startPoint.add(n))
};
Ray.prototype.calculateIntersectionWithLineSegment = function (e) {
    var t = this.extendPoint(999999);
    var n = new LineSegment(t.startPoint, t.endPoint);
    return n.calculateIntersectionWithLineSegment(e)
};
Ray.prototype.calculateIntersectionWithLineSegment = function (e) {
    var t = this.extendPoint(999999);
    var n = new LineSegment(t.startPoint, t.endPoint);
    return n.calculateIntersectionWithLineSegment(e)
};
Ray.prototype.calculateIntersectionWithPoint = function (e) {
    var t = this.extendPoint(999999);
    var n = new LineSegment(t.startPoint, t.endPoint);
    return n.calculateIntersectionWithPoint(e)
};
Ray.prototype.calculateIntersectionWithPoints = function (e) {
    var i = [];
    $.each(e, function (e, t) {
            var n = this.calculateIntersectionWithPoint(t);
            if (n)
                i.push(n)
        }
        .bind(this));
    return i
};
var DEBUG_POLYGON = false;
var Polygon = function (e) {
    this.points = e;
    this.centerPoint = this.calculateCenterPoint(this.points);
    this.lines = this.calculateLines(this.points)
};
Polygon.prototype.doesContainsPoint = function (e) {
    this.lines = this.calculateLines(this.points);
    if (e.vectorsWithinDist(this.points))
        return false;
    var i;
    var t;
    var n;
    var r = 0;
    do {
        r++;
        i = new Ray(e, new Vector2(e.x + Math.random() * 10 + 1, e.y + Math.random() * 10 + 1));
        t = i.calculateIntersectionWithPoints(this.points);
        n = t.length > 0
    } while (n && r < 15);
    var o = [];
    $.each(this.lines, function (e, t) {
        var n = i.calculateIntersectionWithLineSegment(t);
        if (n)
            o.push(n)
    });
    var a = o.length;
    var s = a % 2 == 0;
    var l = !Boolean(s);
    if (DEBUG_DRAW && DEBUG_POLYGON) {
        var u = new Ray(DEBUG_TRANSFORM_FUNCTION(i.startPoint), DEBUG_TRANSFORM_FUNCTION(i.endPoint));
        DEBUG_DRAWER.drawLineSegment(u.startPoint, u.extendPoint(999999).endPoint, {
            strokeStyle: "green"
        });
        $.each(this.lines, function (e, t) {
            var n = new LineSegment(DEBUG_TRANSFORM_FUNCTION(t.startPoint), DEBUG_TRANSFORM_FUNCTION(t.endPoint));
            DEBUG_DRAWER.drawLineSegment(n.startPoint, n.endPoint, {
                strokeStyle: "yellow"
            })
        });
        $.each(o, function (e, t) {
            var n = DEBUG_TRANSFORM_FUNCTION(t);
            DEBUG_DRAWER.drawX(n.x, n.y, 25, 25, {
                strokeStyle: "red"
            })
        })
    }
    return l
};
Polygon.prototype.calculateCenterPoint = function (e) {
    var n = 0;
    var i = 0;
    $.each(e, function (e, t) {
        n += t.x;
        i += t.y
    });
    var t = e.length;
    n /= t;
    i /= t;
    var r = new Vector2(n, i);
    if (DEBUG_DRAW && DEBUG_POLYGON) {
        var o = DEBUG_TRANSFORM_FUNCTION(r);
        DEBUG_DRAWER.drawCircle(o.x, o.y, 10, {
            fillStyle: "green"
        })
    }
    return r
};
Polygon.prototype.calculateLines = function (r) {
    var o = r.length;
    var a = [];
    $.each(r, function (e, t) {
            if (o > 1 && e != o - 1) {
                var n = r[e + 1];
                var i = new LineSegment(t, n);
                a.push(i)
            }
        }
        .bind(this));
    var e = new LineSegment(r[o - 1], r[0]);
    a.push(e);
    return a
};

function pointInPolygon(e, t) {
    var n = e[0],
        i = e[1];
    var r = false;
    for (var o = 0, a = t.length - 1; o < t.length; a = o++) {
        var s = t[o][0],
            l = t[o][1];
        var u = t[a][0],
            c = t[a][1];
        var f = l > i != c > i && n < (u - s) * (i - l) / (c - l) + s;
        if (f)
            r = !r
    }
    return r
}
var Drawer = function (e) {
    if (e)
        this.context = e;
    this.__noContextError = "You must define a context before drawing:\nvar myDrawer = new Drawer(context);\nor\nmyDrawer.context = canvas.getContext('2d');"
};
Drawer.prototype.drawLineSegment = function (e, t, n) {
    this.__startDraw(n);
    this.context.beginPath();
    this.context.moveTo(e.x, e.y);
    this.context.lineTo(t.x, t.y);
    this.__stroke(n);
    this.context.closePath()
};
Drawer.prototype.drawDoubleLineSegment = function (e, t, n, i) {
    this.drawLineSegment(e, t, n);
    this.drawLineSegment(e, t, i)
};
Drawer.prototype.drawDoublePoly = function (e, t, n) {
    this.drawPoly(e, t);
    this.drawPoly(e, n)
};
Drawer.prototype.drawPoly = function (i, r) {
    $.each(i, function (e, t) {
            var n = e == i.length - 1 ? i[0] : i[e + 1];
            this.drawLineSegment(t, n, r)
        }
        .bind(this))
};
Drawer.prototype.drawConnectedPoints = function (i, r) {
    $.each(i, function (e, t) {
            if (e == i.length - 1)
                return false;
            var n = i[e + 1];
            this.drawLineSegment(t, n, r)
        }
        .bind(this))
};
Drawer.prototype.drawDoubleConnectedPoints = function (e, t, n) {
    this.drawConnectedPoints(e, t);
    this.drawConnectedPoints(e, n)
};
Drawer.prototype.drawLine = function (e, t) {
    e = e.extendPoints(999999);
    this.drawLineSegment(e.startPoint, e.endPoint, t)
};
Drawer.prototype.drawCircle = function (e, t, n, i) {
    this.__startDraw(i);
    this.context.beginPath();
    this.context.arc(e, t, n, 0, 2 * Math.PI);
    this.__stroke(i);
    this.__fill(i);
    this.context.closePath()
};
Drawer.prototype.drawDoubleCircle = function (e, t, n, i, r) {
    this.drawCircle(e, t, n, i);
    this.drawCircle(e, t, n, r)
};
Drawer.prototype.drawConcentricCircles = function (e, t, n, i, r, o) {
    this.drawCircle(e, t, n, r);
    this.drawCircle(e, t, i, o)
};
Drawer.prototype.drawX = function (e, t, n, i, r) {
    this.__startDraw(r);
    var o = n / 2;
    var a = i / 2;
    this.context.beginPath();
    this.context.moveTo(e - o, t - o);
    this.context.lineTo(e + o, t + o);
    this.context.moveTo(e + o, t - o);
    this.context.lineTo(e - o, t + o);
    this.context.stroke();
    this.context.closePath()
};
Drawer.prototype.__startDraw = function (e) {
    if (!this.context)
        throw this.__noContextError;
    this.__resetStyle();
    this.__applyStyle(e)
};
Drawer.prototype.__applyStyle = function (e) {
    if (!e)
        return;
    if (e.fillStyle)
        this.context.fillStyle = e.fillStyle;
    if (e.strokeStyle)
        this.context.strokeStyle = e.strokeStyle;
    if (e.lineWidth)
        this.context.lineWidth = e.lineWidth;
    if (e.lineCap)
        this.context.lineCap = e.lineCap
};
Drawer.prototype.__resetStyle = function (e) {
    this.context.fillStyle = null;
    this.context.strokeStyle = null;
    this.context.lineWidth = 0
};
Drawer.prototype.__fill = function (e) {
    if (e && e.fillStyle)
        this.context.fill()
};
Drawer.prototype.__stroke = function (e) {
    if (e && (e.strokeStyle || e.lineWidth))
        this.context.stroke()
};
var SelectedBBDrawer = function () {
    this.BB_STROKE_STYLE = "rgb(65, 244, 226)";
    this.BB_LINE_WIDTH = 1;
    this.BB_LINE_DASH = [5];
    this.BB_PADDING = 10;
    this.BB_OUTER_LINE_STROKE_STYLE = "#0e6b9c";
    this.BB_INNER_LINE_STROKE_STYLE = "#7bc9f5";
    this.BB_OUTER_LINE_WIDTH = 3;
    this.BB_INNER_LINE_WIDTH = 1;
    this.DELETE_RADIUS = 8;
    this.IDLED_DELETE_FILL_STYLE = "rgba(255, 0, 0, .8)";
    this.HOVERED_DELETE_FILL_STYLE = "rgba(120, 0, 0, .8)";
    this.outerLineStyle = {
        strokeStyle: this.BB_OUTER_LINE_STROKE_STYLE,
        lineWidth: this.BB_OUTER_LINE_WIDTH,
        lineCap: "square"
    };
    this.innerLineStyle = {
        strokeStyle: this.BB_INNER_LINE_STROKE_STYLE,
        lineWidth: this.BB_INNER_LINE_WIDTH,
        lineCap: "square"
    };
    this.__drawer = new Drawer
};
SelectedBBDrawer.prototype.drawBB = function (e, t, n) {
    this.drawRect(e, t);
    this.drawDeleteCircle(e, t, n);
    this.drawDeleteCross(e, t)
};
SelectedBBDrawer.prototype.drawRect = function (e, t) {
    var n = {
        x: t.x + t.width / 2 + this.BB_PADDING - this.DELETE_RADIUS,
        y: t.y - t.height / 2 - this.BB_PADDING
    };
    var i = {
        x: t.x - t.width / 2 - this.BB_PADDING,
        y: t.y - t.height / 2 - this.BB_PADDING
    };
    var r = {
        x: t.x - t.width / 2 - this.BB_PADDING,
        y: t.y + t.height / 2 + this.BB_PADDING
    };
    var o = {
        x: t.x + t.width / 2 + this.BB_PADDING,
        y: t.y + t.height / 2 + this.BB_PADDING
    };
    var a = {
        x: t.x + t.width / 2 + this.BB_PADDING,
        y: t.y - t.height / 2 - this.BB_PADDING + this.DELETE_RADIUS
    };
    var s = [n, i, r, o, a];
    this.__drawer.context = e;
    e.setLineDash(this.BB_LINE_DASH);
    this.__drawer.drawDoubleConnectedPoints(s, this.outerLineStyle, this.innerLineStyle);
    e.setLineDash([])
};
SelectedBBDrawer.prototype.getDeleteButtonPos = function (e) {
    var t = e.x + e.width / 2 + this.BB_PADDING;
    var n = e.y + -e.height / 2 - this.BB_PADDING;
    return new Vector(t, n)
};
SelectedBBDrawer.prototype.drawDeleteCircle = function (e, t, n) {
    var i = t.x;
    var r = t.y;
    var o = this.IDLED_DELETE_FILL_STYLE;
    if (n)
        o = this.HOVERED_DELETE_FILL_STYLE;
    e.beginPath();
    e.arc(i + t.width / 2 + this.BB_PADDING, r - t.height / 2 - this.BB_PADDING, this.DELETE_RADIUS, 0, 2 * Math.PI);
    e.fillStyle = o;
    e.fill();
    e.closePath()
};
SelectedBBDrawer.prototype.drawDeleteCross = function (e, t) {
    var n = t.x;
    var i = t.y;
    e.strokeStyle = "white";
    e.lineWidth = 2;
    var r = .7;
    e.beginPath();
    e.moveTo(n + t.width / 2 + this.BB_PADDING - this.DELETE_RADIUS / Math.sqrt(2) * r, i - t.height / 2 - this.BB_PADDING - this.DELETE_RADIUS / Math.sqrt(2) * r);
    e.lineTo(n + t.width / 2 + this.BB_PADDING + this.DELETE_RADIUS / Math.sqrt(2) * r, i - t.height / 2 - this.BB_PADDING + this.DELETE_RADIUS / Math.sqrt(2) * r);
    e.moveTo(n + t.width / 2 + this.BB_PADDING - this.DELETE_RADIUS / Math.sqrt(2) * r, i - t.height / 2 - this.BB_PADDING + this.DELETE_RADIUS / Math.sqrt(2) * r);
    e.lineTo(n + t.width / 2 + this.BB_PADDING + this.DELETE_RADIUS / Math.sqrt(2) * r, i - t.height / 2 - this.BB_PADDING - this.DELETE_RADIUS / Math.sqrt(2) * r);
    e.stroke();
    e.closePath()
};
var PointDrawer = function () {
    this.OUTER_DOT_RADIUS = 10;
    this.INNER_DOT_RADIUS = .6 * this.OUTER_DOT_RADIUS;
    this.IDLED_DOT_OUTER_FILL_STYLE = "rgba(0, 124, 189, .75)";
    this.IDLED_DOT_INNER_FILL_STYLE = "rgba(131, 211, 255, .9)";
    this.HOVERED_DOT_OUTER_FILL_STYLE = "rgba(133, 52, 122, .75)";
    this.HOVERED_DOT_INNER_FILL_STYLE = "rgba(255, 131, 247, .9)";
    this.SELECTED_DOT_OUTER_FILL_STYLE = "rgba(20, 119, 65, .9)";
    this.SELECTED_DOT_INNER_FILL_STYLE = "rgba(178, 241, 130, .75)";
    this.__drawer = new Drawer
};
PointDrawer.prototype.drawPointScaled = function (e, t, n, i, r, o) {
    var a = this.IDLED_DOT_OUTER_FILL_STYLE;
    var s = this.IDLED_DOT_INNER_FILL_STYLE;
    if (i) {
        a = this.HOVERED_DOT_OUTER_FILL_STYLE;
        s = this.HOVERED_DOT_INNER_FILL_STYLE
    }
    if (r) {
        a = this.SELECTED_DOT_OUTER_FILL_STYLE;
        s = this.SELECTED_DOT_INNER_FILL_STYLE
    }
    this.__drawer.context = e;
    this.__drawer.drawConcentricCircles(t, n, this.OUTER_DOT_RADIUS * o, this.INNER_DOT_RADIUS * o, {
        fillStyle: a
    }, {
        fillStyle: s
    })
};
PointDrawer.prototype.drawPoint = function (e, t, n, i, r) {
    var o = this.IDLED_DOT_OUTER_FILL_STYLE;
    var a = this.IDLED_DOT_INNER_FILL_STYLE;
    if (i) {
        o = this.HOVERED_DOT_OUTER_FILL_STYLE;
        a = this.HOVERED_DOT_INNER_FILL_STYLE
    }
    if (r) {
        o = this.SELECTED_DOT_OUTER_FILL_STYLE;
        a = this.SELECTED_DOT_INNER_FILL_STYLE
    }
    this.__drawer.context = e;
    this.__drawer.drawConcentricCircles(t, n, this.OUTER_DOT_RADIUS, this.INNER_DOT_RADIUS, {
        fillStyle: o
    }, {
        fillStyle: a
    })
};
var PolyDrawer = function () {
    this.IDLED_OUTER_STROKE_STYLE = "rgba(0, 124, 189, 1)";
    this.IDLED_INNER_STROKE_STYLE = "rgba(131, 211, 255, 1)";
    this.HOVERED_OUTER_STROKE_STYLE = "rgba(133, 52, 122, 1)";
    this.HOVERED_INNER_STROKE_STYLE = "rgba(255, 131, 247, 1)";
    this.SELECTED_OUTER_STROKE_STYLE = "rgba(20, 119, 65, 1)";
    this.SELECTED_INNER_STROKE_STYLE = "rgba(178, 241, 130, 1)";
    this.OUTER_LINE_WIDTH = 3;
    this.INNER_LINE_WIDTH = 1;
    this.IDLED_OUTER_LINE_STYLE = {
        strokeStyle: this.IDLED_OUTER_STROKE_STYLE,
        lineWidth: this.OUTER_LINE_WIDTH,
        lineCap: "square"
    };
    this.IDLED_INNER_LINE_STYLE = {
        strokeStyle: this.IDLED_INNER_STROKE_STYLE,
        lineWidth: this.INNER_LINE_WIDTH,
        lineCap: "square"
    };
    this.HOVERED_OUTER_LINE_STYLE = {
        strokeStyle: this.HOVERED_OUTER_STROKE_STYLE,
        lineWidth: this.OUTER_LINE_WIDTH,
        lineCap: "square"
    };
    this.HOVERED_INNER_LINE_STYLE = {
        strokeStyle: this.HOVERED_INNER_STROKE_STYLE,
        lineWidth: this.INNER_LINE_WIDTH,
        lineCap: "square"
    };
    this.SELECTED_OUTER_LINE_STYLE = {
        strokeStyle: this.SELECTED_OUTER_STROKE_STYLE,
        lineWidth: this.OUTER_LINE_WIDTH,
        lineCap: "square"
    };
    this.SELECTED_INNER_LINE_STYLE = {
        strokeStyle: this.SELECTED_INNER_STROKE_STYLE,
        lineWidth: this.INNER_LINE_WIDTH,
        lineCap: "square"
    };
    this.IDLED_LINE_COLOR = "black";
    this.HOVERED_LINE_COLOR = "rgb(133, 52, 122)";
    this.SELECTED_LINE_COLOR = "rgb(178, 241, 130)";
    this.VERTEX_OUTER_RADIUS = 5;
    this.VERTEX_INNER_RADIUS = .6 * this.VERTEX_OUTER_RADIUS;
    this.IDLED_VERTEX_OUTER_FILL_STYLE = "rgba(0, 124, 189, .75)";
    this.IDLED_VERTEX_INNER_FILL_STYLE = "rgba(131, 211, 255, .9)";
    this.HOVERED_VERTEX_OUTER_FILL_STYLE = "rgba(133, 52, 122, .75)";
    this.HOVERED_VERTEX_INNER_FILL_STYLE = "rgba(255, 131, 247, .9)";
    this.SELECTED_VERTEX_OUTER_FILL_STYLE = "rgba(20, 119, 65, .9)";
    this.SELECTED_VERTEX_INNER_FILL_STYLE = "rgba(178, 241, 130, .75)";
    this.FIRST_VERTEX_SCALE = 2;
    this.X_WIDTH = this.X_HEIGHT = 10;
    this.X_STROKE_STYLE = "red";
    this.X_LINE_WIDTH = 2;
    this.__drawer = new Drawer
};
PolyDrawer.prototype.drawVertex = function (e, t, n, i, r, o, a) {
    var s = this.IDLED_VERTEX_OUTER_FILL_STYLE;
    var l = this.IDLED_VERTEX_INNER_FILL_STYLE;
    if (i || o) {
        s = this.HOVERED_VERTEX_OUTER_FILL_STYLE;
        l = this.HOVERED_VERTEX_INNER_FILL_STYLE
    }
    if (r || a) {
        s = this.SELECTED_VERTEX_OUTER_FILL_STYLE;
        l = this.SELECTED_VERTEX_INNER_FILL_STYLE
    }
    this.__drawer.context = e;
    this.__drawer.drawConcentricCircles(t, n, this.VERTEX_OUTER_RADIUS, this.VERTEX_INNER_RADIUS, {
        fillStyle: s
    }, {
        fillStyle: l
    })
};
PolyDrawer.prototype.drawFirstVertex = function (e, t, n) {
    this.drawVertex(e, t, n, false, true, false, false);
    return;
    this.__drawer.context = e;
    this.__drawer.drawConcentricCircles(t, n, this.VERTEX_OUTER_RADIUS * this.FIRST_VERTEX_SCALE, this.VERTEX_INNER_RADIUS * this.FIRST_VERTEX_SCALE, {
        fillStyle: this.SELECTED_VERTEX_OUTER_FILL_STYLE
    }, {
        fillStyle: this.SELECTED_VERTEX_INNER_FILL_STYLE
    })
};
PolyDrawer.prototype.drawLineSegment = function (e, t, n, i, r) {
    var o = this.IDLED_LINE_COLOR;
    var a = this.IDLED_OUTER_STROKE_STYLE;
    var s = this.IDLED_INNER_STROKE_STYLE;
    if (i) {
        o = this.HOVERED_LINE_COLOR
    }
    if (r) {
        o = this.SELECTED_LINE_COLOR
    }
    this.__drawer.context = e;
    this.__drawer.drawLineSegment(t, n, {
        strokeStyle: o,
        lineWidth: 1
    })
};
PolyDrawer.prototype.drawIntersection = function (e, t) {
    this.__drawer.context = e;
    this.__drawer.drawX(t.x, t.y, this.X_WIDTH, this.X_HEIGHT, {
        lineWidth: this.X_LINE_WIDTH,
        strokeStyle: this.X_STROKE_STYLE
    })
};
PolyDrawer.prototype.drawPoly = function (e, t, n, i, r, o) {
    this.__drawer.context = e;
    var a = this.IDLED_OUTER_LINE_STYLE;
    var s = this.IDLED_INNER_LINE_STYLE;
    if (n) {
        a = this.HOVERED_OUTER_LINE_STYLE;
        s = this.HOVERED_INNER_LINE_STYLE
    }
    if (i) {
        a = this.SELECTED_OUTER_LINE_STYLE;
        s = this.SELECTED_INNER_LINE_STYLE
    }
    this.__drawer.drawDoublePoly(t, a, s);
    this.drawVertices(e, t, n, i, r, o)
};
PolyDrawer.prototype.__drawLines = function (i, r, o, a) {
    $.each(r, function (e, t) {
            if (r.length > 1 && e != r.length - 1) {
                var n = r[e + 1];
                this.drawLineSegment(i, t, n, o, a)
            }
        }
        .bind(this));
    this.drawLineSegment(i, r[r.length - 1], r[0], o, a)
};
PolyDrawer.prototype.drawVertices = function (n, e, i, r, o, a) {
    $.each(e, function (e, t) {
            this.drawVertex(n, t.x, t.y, i, r, e == o, e == a)
        }
        .bind(this))
};
PolyDrawer.prototype.drawSlopeIntercept = function (e, t, n) {
    var i = {
        x: 0,
        y: t.b
    };
    var r = {
        x: 500,
        y: t.m * 500 + t.b
    };
    var o = ii.imageToCanvasCoords(i.x, i.y);
    var a = ii.imageToCanvasCoords(r.x, r.y);
    this.drawLineSegment(e, o, a, false, false)
};
var Annotation = function (e, t, n) {
    this.pos = new Vector(e, t);
    this.text = n;
    this.isHovered = false;
    this.isSelected = false;
    this.isDragging = false;
    this.type = "DEFAULT"
};
Annotation.prototype.setPosition = function (e, t) {
    this.pos.x = e;
    this.pos.y = t
};
Annotation.prototype.addPosition = function (e, t) {
    this.pos.x += e;
    this.pos.y += t
};
Annotation.prototype.setText = function (e) {
    this.text = e;
    $(this).triggerHandler("change")
};
Annotation.prototype.serialize = function () {};
Annotation.prototype.draw = function (e, t, n) {};
Annotation.prototype.onCanvasMouseDown = function (e) {};
Annotation.prototype.onDocumentMouseUp = function (e) {};
Annotation.prototype.onImageMouseMove = function (e, t) {};
Annotation.prototype.startDrag = function () {
    if (this.isDragging)
        return;
    this.isDragging = true;
    $(this).triggerHandler("change")
};
Annotation.prototype.stopDrag = function () {
    if (!this.isDragging)
        return;
    this.isDragging = false;
    $(this).triggerHandler("change")
};
Annotation.prototype.onDrag = function (e) {};
Annotation.prototype.getBB = function () {};
Annotation.prototype.select = function () {
    if (this.isSelected)
        return;
    this.isSelected = true;
    $(this).triggerHandler("change")
};
Annotation.prototype.deselect = function () {
    if (!this.isSelected)
        return;
    this.isSelected = false;
    $(this).triggerHandler("change")
};
Annotation.prototype.pointWithinObj = function (e) {};
Annotation.prototype.hover = function () {
    if (this.isHovered)
        return;
    this.isHovered = true;
    $(this).triggerHandler("change")
};
Annotation.prototype.dehover = function () {
    if (!this.isHovered)
        return;
    this.isHovered = false;
    $(this).triggerHandler("change")
};
Annotation.prototype.delete = function () {
    $(this).triggerHandler("delete")
};
var PointAnnotation = function (e, t, n) {
    Annotation.call(this, e, t, n);
    this.__pointDrawer = new PointDrawer;
    this.radius = this.__pointDrawer.OUTER_DOT_RADIUS;
    this.type = "DOT"
};
PointAnnotation.prototype = Object.create(Annotation.prototype);
PointAnnotation.prototype.constructor = Annotation;
PointAnnotation.prototype.draw = function (e, t, n) {
    Annotation.prototype.draw.call(this, e, t);
    this.__pointDrawer.drawPoint(e, t.x, t.y, this.isHovered, this.isSelected)
};
PointAnnotation.prototype.pointWithinObj = function (e) {
    var t = this.radius;
    var n = /Mobi|Tablet|iPad|iPhone/.test(navigator.userAgent);
    if (n)
        t *= 2;
    return this.pos.vectorWithinDist(e, t)
};
PointAnnotation.prototype.getBB = function () {
    return {
        x: this.pos.x,
        y: this.pos.y,
        width: this.radius * 2,
        height: this.radius * 2
    }
};
PointAnnotation.prototype.serialize = function (e) {
    var t = {
        x: this.pos.x / e,
        y: this.pos.y / e,
        text: this.text,
        type: this.type
    };
    return t
};
var pd;
var PolyAnnotation = function (e, t) {
    Annotation.call(this, 0, 0, t);
    this.__polyDrawer = new PolyDrawer;
    pd = this.__polyDrawer;
    var n = [];
    $.each(e, function (e, t) {
        n.push(new Vector2(t.x, t.y))
    });
    this.polygon = new Polygon(n);
    this.type = "POLY";
    this.hoveredPoint = null;
    this.draggedPoint = null
};
PolyAnnotation.prototype = Object.create(Annotation.prototype);
PolyAnnotation.prototype.constructor = Annotation;
PolyAnnotation.prototype.zoom = function (n) {
    $.each(this.polygon.points, function (e, t) {
            t.x *= n;
            t.y *= n
        }
        .bind(this))
};
PolyAnnotation.prototype.addPosition = function (n, i) {
    if (n == 0 && i == 0)
        return;
    $.each(this.polygon.points, function (e, t) {
            t.x += n;
            t.y += i
        }
        .bind(this));
    $(this).triggerHandler("change")
};
PolyAnnotation.prototype.setPosition = function (e, t) {
    var n = e - this.pos.x;
    var i = t - this.pos.y;
    $.each(this.polygon.points, function (e, t) {
            t.x += n;
            t.y += i
        }
        .bind(this));
    $(this).triggerHandler("change")
};
PolyAnnotation.prototype.onDrag = function (e) {
    if (this.isDragging) {
        var t = this.pos.x - e.x;
        var n = this.pos.y - e.y
    }
    $(this).triggerHandler("change")
};
PolyAnnotation.prototype.getBB = function () {
    var n = 99999999;
    var i = n;
    var r = -n;
    var o = -n;
    $.each(this.polygon.points, function (e, t) {
        n = Math.min(n, t.x);
        r = Math.max(r, t.x);
        i = Math.min(i, t.y);
        o = Math.max(o, t.y)
    });
    var e = r - n;
    var t = o - i;
    var a = {
        x: n + e / 2,
        y: i + t / 2,
        width: e,
        height: t
    };
    var s = this.__polyDrawer.VERTEX_OUTER_RADIUS;
    a.width += 2 * s;
    a.height += 2 * s;
    return a
};
PolyAnnotation.prototype.setHoveredPoint = function (e) {
    if (this.hoveredPoint == e)
        return;
    this.hoveredPointIndex = this.polygon.points.indexOf(e);
    this.hoveredPoint = e;
    $(this).triggerHandler("change")
};
PolyAnnotation.prototype.setDraggedPoint = function (e) {
    if (this.draggedPoint == e)
        return;
    this.draggedPointIndex = this.polygon.points.indexOf(e);
    this.draggedPoint = e;
    $(this).triggerHandler("change")
};
PolyAnnotation.prototype.draw = function (e, t, i) {
    Annotation.prototype.draw.call(this, e, t);
    var n = this.__polyDrawer.LINE_COLOR;
    if (this.isHovered)
        n = this.__polyDrawer.HOVERED_LINE_COLOR;
    if (this.isSelected)
        n = this.__polyDrawer.SELECTED_LINE_COLOR;
    var r = [];
    $.each(this.polygon.points, function (e, t) {
            var n = i.imageToCanvasCoords(t.x, t.y);
            r.push(new Vector(n.x, n.y))
        }
        .bind(this));
    this.__polyDrawer.drawPoly(e, r, this.isHovered, this.isSelected, this.hoveredPointIndex, this.draggedPointIndex)
};
PolyAnnotation.prototype.pointWithinObj = function (n) {
    var i = [];
    var r = false;
    $.each(this.polygon.points, function (e, t) {
            i.push([t.x, t.y]);
            if (t.vectorIsWithinDist(n, this.__polyDrawer.VERTEX_OUTER_RADIUS)) {
                r = true;
                return false
            }
        }
        .bind(this));
    return r || pointInPolygon([n.x, n.y], i)
};
PolyAnnotation.prototype.serialize = function (n) {
    var e = _.clone(this.polygon.points);
    $.each(e, function (e, t) {
        t.x /= n;
        t.y /= n
    });
    var t = {
        x: this.pos.x,
        y: this.pos.y,
        points: e,
        text: this.text,
        type: this.type
    };
    return t
};
var CircleAnnotation = function (e, t, n, i) {
    Annotation.call(this, e, t, i);
    this.radius = n;
    this.type = "CIRCLE";
    this.__drawer = new Drawer
};
CircleAnnotation.prototype = Object.create(Annotation.prototype);
CircleAnnotation.prototype.constructor = Annotation;
CircleAnnotation.prototype.draw = function (e, t, n) {
    Annotation.prototype.draw.call(this, e, t);
    var i;
    var r;
    if (this.isSelected) {
        i = "rgba(20, 119, 65, 1)";
        r = "rgba(178, 241, 130, 1)"
    } else if (this.isHovered) {
        i = "rgba(133, 52, 122, 1)";
        r = "rgba(255, 131, 247, 1)"
    } else {
        i = "rgba(0, 124, 189, 1)";
        r = "rgba(131, 211, 255, 1)"
    }
    this.__drawer.context = e;
    this.__drawer.drawDoubleCircle(t.x, t.y, this.radius, {
        strokeStyle: i,
        lineWidth: 3
    }, {
        strokeStyle: r,
        lineWidth: 1
    })
};
CircleAnnotation.prototype.zoom = function (e) {
    this.setPosition(this.pos.x * e, this.pos.y * e);
    this.radius *= e
};
CircleAnnotation.prototype.pointWithinObj = function (e) {
    return this.pos.vectorWithinDist(e, this.radius)
};
CircleAnnotation.prototype.getBB = function () {
    return {
        x: this.pos.x,
        y: this.pos.y,
        width: this.radius * 2,
        height: this.radius * 2
    }
};
CircleAnnotation.prototype.serialize = function (e) {
    var t = {
        x: this.pos.x / e,
        y: this.pos.y / e,
        radius: this.radius / e,
        text: this.text,
        type: this.type
    };
    return t
};
var Tool = function (e, t, n, i, r) {
    this.name = e;
    this.selector = t;
    this.annotator = n;
    this.interactiveImage = i;
    this.hotkey = r
};
Tool.prototype.activate = function () {
    $(this).trigger("change")
};
Tool.prototype.deactivate = function () {
    $(this).trigger("change")
};
Tool.prototype.draw = function (e) {};
Tool.prototype.onMouseOut = function (e) {};
Tool.prototype.onCanvasDblClick = function (e) {};
Tool.prototype.onCanvasMouseDown = function (e) {};
Tool.prototype.onDocumentMouseUp = function (e) {};
Tool.prototype.onImageMouseMove = function (e, t) {};
Tool.prototype.onDocumentKeyPress = function (e, t) {};
var Toolbox = function (e) {
    this.interactiveImage = e;
    this.canvas = this.interactiveImage.canvas;
    this.context = this.canvas.getContext("2d");
    this.activeTool = null;
    this.tools = {};
    this.hotkeys = {
        99: "c",
        67: "c",
        68: "d",
        98: "b",
        66: "b",
        114: "r",
        82: "r",
        118: "v",
        86: "v"
    };
    this.tooltip = new Tooltip;
    e.addToolbox(this);
    $("body").mouseout(this.__onMouseOut.bind(this));
    $(document).on("mousemove", this.__onDocumentMouseMove.bind(this));
    $(this.interactiveImage.canvas).on("mousedown", this.__onCanvasMouseDown.bind(this));
    $(document).on("mouseup", this.__onDocumentMouseUp.bind(this));
    $(this.interactiveImage.canvas).on("dblclick", this.__onCanvasDblClick.bind(this));
    $(document).on("keydown", this.__onDocumentKeyDown.bind(this));
    $(document).on("keypress", this.__onDocumentKeyPress.bind(this))
};
Toolbox.prototype.draw = function (n) {
    $.each(this.tools, function (e, t) {
            if (t != this.activeTool)
                return true;
            t.draw(n, null, this.interactiveImage)
        }
        .bind(this))
};
Toolbox.prototype.addTool = function (e) {
    this.tools[e.name] = e;
    if (!this.activeTool)
        this.selectTool(e.name);
    var t = $(this.tools[e.name].selector);
    t.on("click", this.toolSelectorClick.bind(this));
    t.hover(this.showToolTip.bind(this), this.hideToolTip.bind(this));
    $(e).on("change", this.__onToolChange.bind(this))
};
Toolbox.prototype.showToolTip = function (e) {
    var t = $(e.target).position().left;
    var n = $(e.target).position().top;
    var i = $(e.target).width();
    var r = $(e.target).height();
    var o = "#" + e.target.id;
    var a = null;
    $.each(this.tools, function (e, t) {
        if (t.selector == o)
            a = t
    });
    var s = a.name;
    if (s == "DOT")
        s = "POINT";
    s = s.toLowerCase();
    s = s.charAt(0).toUpperCase() + s.slice(1);
    hotkey = this.hotkeys[a.hotkey[0]];
    this.tooltip.show(t + i / 2, n + r, "<b>" + s + "</b> (" + hotkey + ")")
};
Toolbox.prototype.hideToolTip = function (e) {
    this.tooltip.hide()
};
Toolbox.prototype.getTool = function (e) {
    return this.tools[e]
};
Toolbox.prototype.__onToolChange = function (e) {
    $(this).triggerHandler("change")
};
Toolbox.prototype.selectTool = function (e) {
    if (this.activeTool) {
        $(this.activeTool.selector).removeClass("selected");
        this.activeTool.deactivate()
    }
    this.activeTool = this.tools[e];
    $(this.activeTool.selector).addClass("selected");
    this.activeTool.activate()
};
Toolbox.prototype.toolSelectorClick = function (e) {
    var n = "#" + e.target.id;
    var i = null;
    $.each(this.tools, function (e, t) {
        if (t.selector == n)
            i = t
    });
    this.selectTool(i.name)
};
Toolbox.prototype.release = function () {
    $.each(this.tools, function (e, t) {
            var n = $(this.tools[t.name].selector);
            n.off("click")
        }
        .bind(this))
};
Toolbox.prototype.__onMouseOut = function (n) {
    if (n.toElement != null || n.relatedTarget != null)
        return;
    $.each(this.tools, function (e, t) {
            if (t != this.activeTool)
                return true;
            t.onMouseOut(n)
        }
        .bind(this))
};
Toolbox.prototype.__onDocumentKeyDown = function (e) {
    this.__onDocumentKeyPress(e)
};
Toolbox.prototype.__onDocumentKeyPress = function (n) {
    if (document.activeElement != document.body)
        return;
    $.each(this.tools, function (e, t) {
            if (t.hotkey.includes(n.keyCode)) {
                this.selectTool(t.name);
                return false
            }
            if (t != this.activeTool)
                return true;
            t.onDocumentKeyPress(n)
        }
        .bind(this))
};
Toolbox.prototype.__onDocumentMouseMove = function (e) {
    var n = this.interactiveImage.pageToImageCoords(e.pageX, e.pageY);
    var i = this.interactiveImage.getSize();
    $.each(this.tools, function (e, t) {
            if (t != this.activeTool)
                return true;
            t.onImageMouseMove(new Vector(n.x, n.y), i, this.interactiveImage)
        }
        .bind(this))
};
Toolbox.prototype.__onCanvasMouseDown = function (n) {
    var i = this.interactiveImage.pageToImageCoords(n.pageX, n.pageY);
    $.each(this.tools, function (e, t) {
            if (t != this.activeTool)
                return true;
            t.onCanvasMouseDown(n, new Vector(i.x, i.y))
        }
        .bind(this))
};
Toolbox.prototype.__onDocumentMouseUp = function (e) {
    var n = this.interactiveImage.pageToImageCoords(e.pageX, e.pageY);
    $.each(this.tools, function (e, t) {
            if (t != this.activeTool)
                return true;
            t.onDocumentMouseUp(new Vector(n.x, n.y))
        }
        .bind(this))
};
Toolbox.prototype.__onCanvasDblClick = function (e) {
    var n = this.interactiveImage.pageToImageCoords(e.pageX, e.pageY);
    $.each(this.tools, function (e, t) {
            if (t != this.activeTool)
                return true;
            t.onCanvasDblClick(n)
        }
        .bind(this))
};
var ii;
var SelectTool = function (e, t, n, i) {
    ii = i;
    Tool.call(this, e, t, n, i, [118, 86]);
    this.hoveredAnnotation = null;
    this.selectedAnnotation = null;
    this.selectedBBDrawer = new SelectedBBDrawer;
    this.__deleteIsHovered = false;
    this.__isDragging = false;
    this.layerManager = new LayerManager;
    shortcut.add("Ctrl+Shift+A", function () {
            if (this.selectedAnnotation)
                this.__deselectAnnotation(this.selectedAnnotation);
            this.selectedAnnotation = null
        }
        .bind(this))
};
SelectTool.prototype = Object.create(Tool.prototype);
SelectTool.prototype.constructor = Tool;
SelectTool.prototype.deactivate = function () {
    if (this.selectedAnnotation)
        this.__deselectAnnotation(this.selectedAnnotation);
    if (this.hoveredAnnotation)
        this.hoveredAnnotation.dehover();
    this.selectedAnnotation = null;
    this.hoveredAnnotation = null;
    this.__deleteIsHovered = false;
    this.__isDragging = false;
    Tool.prototype.deactivate.call(this)
};
SelectTool.prototype.onDocumentKeyPress = function (e) {
    if (e.keyCode == 127 || e.keyCode == 46) {
        if (this.selectedAnnotation) {
            var t = this.selectedAnnotation;
            this.__deselectAnnotation(this.selectedAnnotation);
            this.annotator.deleteAnnotation(t);
            this.hoveredAnnotation = null;
            $("body").css("cursor", "default")
        }
    }
};
SelectTool.prototype.draw = function (e) {
    $("body").css("cursor", "default");
    if (this.hoveredAnnotation || this.__isDragging)
        $("body").css("cursor", "move");
    if (this.selectedAnnotation) {
        var t = this.selectedAnnotation.getBB();
        var n = this.interactiveImage.imageToCanvasCoords(t.x, t.y);
        t.x = n.x;
        t.y = n.y;
        this.selectedBBDrawer.drawBB(e, t, this.__deleteIsHovered)
    }
    if (this.__deleteIsHovered) {
        $("body").css("cursor", "pointer")
    }
};
SelectTool.prototype.__hoverAnnotation = function (e) {
    if (this.hoveredAnnotation == e)
        return;
    this.hoveredAnnotation = e;
    e.hover();
    $(this).trigger("change");
    console.log("SelectTool.__hoverAnnotation")
};
SelectTool.prototype.__dehoverAnnotation = function (e) {
    if (!e.isHovered || !this.hoveredAnnotation)
        return;
    this.hoveredAnnotation = null;
    e.dehover();
    $(this).trigger("change");
    console.log("SelectTool.__dehoverAnnotation")
};
SelectTool.prototype.__selectAnnotation = function (e) {
    if (this.selectedAnnotation == e)
        return;
    if (this.selectedAnnotation)
        this.__deselectAnnotation(this.selectedAnnotation, true);
    this.selectedAnnotation = e;
    e.select();
    this.annotator.deleteAnnotation(e);
    this.annotator.addAnnotation(e, true);
    $(this).trigger("change");
    $(this).trigger("ACTIVE_ANNOTATION_CHANGE", e);
    console.log("__selectAnnotation")
};
SelectTool.prototype.__deselectAnnotation = function (e, t) {
    if (!e || !e.isSelected)
        return;
    console.log("SelectTool.__deselectAnnotation");
    e.deselect();
    this.selectedAnnotation = null;
    $(this).trigger("change");
    if (!t)
        $(this).trigger("ACTIVE_ANNOTATION_CHANGE", false)
};
SelectTool.prototype.__startAnnotationDrag = function (e) {
    var t = this.__isDragging;
    e.startDrag();
    this.__isDragging = true;
    if (this.__isDragging != t)
        $(this).trigger("change");
    console.log("SelectTool.__startAnnotationDrag")
};
SelectTool.prototype.__handleAnnotationDrag = function (e, t, n, i) {
    if (this.__isDragging) {
        var r = _.clamp(e.x, 0, n.width);
        var o = _.clamp(e.y, 0, n.height);
        var a = e.x - t.x;
        var s = e.y - t.y;
        if (this.selectedAnnotation.type == "DOT" || this.selectedAnnotation.type == "CIRCLE") {
            this.selectedAnnotation.addPosition(a, s)
        } else {
            this.selectedAnnotation.addPosition(a, s)
        }
        $(this).triggerHandler("change");
        console.log("__handleAnnotationDrag")
    }
};
SelectTool.prototype.onCanvasMouseDown = function (e, t) {
    var n = false;
    var i = null;
    var r = this.selectedAnnotation;
    var o;
    $.each(this.annotator.annotations, function (e, t) {
            if (!t)
                return;
            if (this.__deleteIsHovered) {
                o = r;
                this.__deselectAnnotation(r)
            } else {
                if (!i && t == this.hoveredAnnotation) {
                    this.__selectAnnotation(t);
                    i = t;
                    this.__startAnnotationDrag(t);
                    n = true
                } else {
                    if (i != t)
                        this.__deselectAnnotation(t)
                }
            }
        }
        .bind(this));
    if (o) {
        this.annotator.deleteAnnotation(o);
        $("body").css("cursor", "default")
    }
    this.selectedAnnotation = i;
    $(this).trigger("change");
    console.log("MOUSEDOWN");
    if (n)
        e.stopImmediatePropagation()
};
SelectTool.prototype.onImageMouseMove = function (n, e, t) {
    if (!this.oldImageMousePos) {
        this.oldImageMousePos = {
            x: 0,
            y: 0
        }
    }
    var i = null;
    if (!this.__isDragging) {
        var r = _.clone(this.annotator.annotations);
        r.reverse();
        this.layerManager.sort(r);
        $.each(r, function (e, t) {
                if (t.pointWithinObj(n)) {
                    i = t
                } else {
                    this.__dehoverAnnotation(t)
                }
            }
            .bind(this));
        if (i) {
            this.__hoverAnnotation(i)
        }
    }
    var o = this.__deleteIsHovered;
    this.__deleteIsHovered = this.__checkIfDeleteIsHovered(n);
    if (o != this.__deleteIsHovered) {
        $(this).trigger("change");
        console.log("culprit")
    }
    this.__handleAnnotationDrag(n, this.oldImageMousePos, e, t);
    this.oldImageMousePos = n
};
SelectTool.prototype.onDocumentMouseUp = function (e) {
    this.__isDragging = false
};
SelectTool.prototype.__checkIfDeleteIsHovered = function (e) {
    if (this.selectedAnnotation == null)
        return false;
    var t = this.selectedAnnotation.getBB();
    var n = this.selectedBBDrawer.getDeleteButtonPos(t);
    if (e.vectorWithinDist(n, this.selectedBBDrawer.DELETE_RADIUS)) {
        return true
    } else {
        return false
    }
};
var DotTool = function (e, t, n, i) {
    Tool.call(this, e, t, n, i, [68]);
    this.imageX = null;
    this.imageY = null;
    this.__pointDrawer = new PointDrawer
};
DotTool.prototype = Object.create(Tool.prototype);
DotTool.prototype.constructor = Tool;
DotTool.prototype.draw = function (e) {
    $("body").css("cursor", "crosshair");
    if (this.imageX != null) {
        var t = this.interactiveImage.imageToCanvasCoords(this.imageX, this.imageY);
        this.__pointDrawer.drawPoint(e, t.x, t.y, false, true)
    }
};
DotTool.prototype.onImageMouseMove = function (e, t) {
    this.imageX = e.x;
    this.imageY = e.y;
    $(this).trigger("change")
};
DotTool.prototype.onCanvasMouseDown = function (e, t) {
    e.stopImmediatePropagation();
    var n = new PointAnnotation(t.x, t.y, "");
    this.annotator.addAnnotation(n)
};
var DEBUG_DRAW;
var DEBUG_CONTEXT;
var DEBUG_TRANSFORM_FUNCTION;
var DEBUG_DRAWER;
var POLY_TOOL_DEBUG = false;
var transformFunction;
var PolyTool = function (e, t, n, i) {
    DEBUG_DRAW = true;
    DEBUG_CONTEXT = i.context;
    DEBUG_DRAWER = new Drawer(DEBUG_CONTEXT);
    this.transformFunction = function (e) {
        var t = i.imageToCanvasCoords(e.x, e.y);
        return new Vector2(t.x, t.y)
    };
    DEBUG_TRANSFORM_FUNCTION = transformFunction;
    Tool.call(this, e, t, n, i, [98, 66]);
    this.pointRadius = 5;
    this.snapRadius = 30;
    polyResetVars(this);
    this.__polyDrawer = new PolyDrawer;
    this.__drawer = new Drawer
};

function polyResetVars(e) {
    e.draggedPoint = null;
    e.draggedAnnotation = null;
    e.isDrawing = false;
    e.isColliding = false;
    e.lastPoint = null;
    e.isSnapped = false;
    e.snapPoint = null;
    e.activeShape = null;
    e.currentPoly = [];
    e.shapes = [];
    e.hoverShapes = [];
    e.canReleaseDrag = true;
    e.__pointsBeingDrawn = []
}
PolyTool.prototype = Object.create(Tool.prototype);
PolyTool.prototype.constructor = Tool;
PolyTool.prototype.deactivate = function () {
    polyResetVars(this);
    $(this).trigger("change")
};
PolyTool.prototype.addShape = function (e) {
    var t = new PolyAnnotation(e, "");
    this.annotator.addAnnotation(t)
};
PolyTool.prototype.draw = function (i, e, o) {
    console.log("PolyTool draw");
    $("body").css("cursor", "crosshair");
    if (this.hoveredPoint != null || this.draggedPoint != null) {
        $("body").css("cursor", "move");
        return
    }
    if (!this.isDrawing && this.draggedPoint == null) {
        var e = o.imageToCanvasCoords(this.imageMouseX, this.imageMouseY);
        this.__polyDrawer.drawFirstVertex(i, e.x, e.y, "black")
    }
    this.isColliding = false;
    var t = _.clone(this.__pointsBeingDrawn);
    if (this.isDrawing) {
        var n = this.__pointsBeingDrawn[this.__pointsBeingDrawn.length - 1];
        var r = new Vector2(this.imageMouseX, this.imageMouseY);
        var a = this.__pointsBeingDrawn[0];
        var s = this.__attemptSnapPoint(r, a, this.snapRadius);
        this.isSnapped = false;
        if (_.isEqual(s, a)) {
            this.isSnapped = true;
            this.snapPoint = a
        }
        var l = new LineSegment(n, s);
        var u = this.__calculateLinesFromPoints(this.__pointsBeingDrawn);
        var c = this.__calculateIntersectionsOfLineWithLines(l, u);
        var f = [a, n];
        var h = .1;
        c = this.__cleanPointsWithinDistance(c, f, h);
        if (c.length > 0) {
            this.isColliding = true
        }
        var d = "black";
        if (this.isColliding)
            d = "red";
        t.push(s)
    }
    this.__drawLinesBetweenPoints(i, t, this.transformFunction);
    if (this.isDrawing) {
        $.each(c, function (e, t) {
                this.__polyDrawer.drawIntersection(i, this.transformFunction(t))
            }
            .bind(this))
    }
    $.each(this.currentPoly, function (e, t) {
            var n = o.imageToCanvasCoords(t.x, t.y);
            if (this.currentPoly.length > 1 && e != this.currentPoly.length - 1) {
                var i = this.currentPoly[e + 1];
                var r = o.imageToCanvasCoords(i.x, i.y)
            }
        }
        .bind(this));
    $.each(this.currentPoly, function (e, t) {
            var n = o.imageToCanvasCoords(t.x, t.y);
            if (e == 0) {
                this.__polyDrawer.drawFirstVertex(i, n.x, n.y)
            } else {
                this.__polyDrawer.drawVertex(i, n.x, n.y, false, true)
            }
        }
        .bind(this))
};
PolyTool.prototype.__checkPointsHover = function (i) {
    var r = null;
    var o = null;
    $.each(this.annotator.annotations, function (e, n) {
            if (n.type == "POLY") {
                n.setHoveredPoint(null);
                $.each(n.polygon.points, function (e, t) {
                        if (t.vectorIsWithinDist(i, this.__polyDrawer.VERTEX_OUTER_RADIUS * 2)) {
                            r = t;
                            o = n
                        }
                    }
                    .bind(this))
            }
        }
        .bind(this));
    this.hoveredPoint = r;
    this.hoveredAnnotation = o;
    if (this.hoveredAnnotation)
        this.hoveredAnnotation.setHoveredPoint(this.hoveredPoint)
};
PolyTool.prototype.drawIntersections = function (n, e) {
    $.each(e, function (e, t) {
            this.__polyDrawer.drawIntersection(n, this.transformFunction(t))
        }
        .bind(this))
};
PolyTool.prototype.__checkIfDragAllowed = function () {
    if (this.draggedAnnotation == null || this.draggedPoint == null)
        return;
    this.canReleaseDrag = true;
    var l = this.draggedAnnotation.polygon.calculateLines(this.draggedAnnotation.polygon.points);
    $.each(this.draggedAnnotation.polygon.points, function (e, t) {
            if (t.x == this.draggedPoint.x && t.y == this.draggedPoint.y) {
                if (e == 0) {
                    var n = [t, this.draggedAnnotation.polygon.points[e + 1]];
                    var i = [t, this.draggedAnnotation.polygon.points[this.draggedAnnotation.polygon.points.length - 1]]
                } else if (e == this.draggedAnnotation.polygon.points.length - 1) {
                    var n = [t, this.draggedAnnotation.polygon.points[0]];
                    var i = [t, this.draggedAnnotation.polygon.points[e - 1]]
                } else {
                    var n = [t, this.draggedAnnotation.polygon.points[e - 1]];
                    var i = [t, this.draggedAnnotation.polygon.points[e + 1]]
                }
                n = new LineSegment(n[0], n[1]);
                i = new LineSegment(i[0], i[1]);
                var r = this.__calculateIntersectionsOfLineWithLines(n, l);
                var o = this.__calculateIntersectionsOfLineWithLines(i, l);
                var a = [n.startPoint, n.endPoint, i.startPoint, i.endPoint];
                var s = .1;
                r = this.__cleanPointsWithinDistance(r, a, s);
                o = this.__cleanPointsWithinDistance(o, a, s);
                if (r.length > 0 || o.length > 0)
                    this.canReleaseDrag = false;
                this.drawIntersections(this.interactiveImage.context, r);
                this.drawIntersections(this.interactiveImage.context, o)
            }
        }
        .bind(this))
};
PolyTool.prototype.onImageMouseMove = function (e, t) {
    this.imageMouseX = e.x;
    this.imageMouseY = e.y;
    if (!this.isDrawing) {
        this.__checkPointsHover(e)
    }
    if (this.draggedPoint != null) {
        this.draggedPoint.x = this.imageMouseX;
        this.draggedPoint.y = this.imageMouseY
    }
    $(this).trigger("change");
    if (this.draggedPoint != null) {
        this.__checkIfDragAllowed()
    }
};
PolyTool.prototype.onDocumentKeyPress = function (e) {
    if (e.keyCode == 127 || e.keyCode == 27) {
        this.stopDraw(true)
    }
};
PolyTool.prototype.stopDraw = function (e) {
    this.__pointsBeingDrawn = [];
    this.isSnapped = false;
    this.snapPoint = null;
    this.isDrawing = false;
    this.isColliding = false;
    this.lastPoint = null;
    if (!e) {
        this.addShape(this.currentPoly)
    }
    this.currentPoly = [];
    $(this).trigger("change")
};
PolyTool.prototype.__attemptSnapPoint = function (e, t, n) {
    if (this.__pointsBeingDrawn.length <= 2)
        return e;
    if (e.vectorIsWithinDist(t, n)) {
        return t
    } else {
        return e
    }
};

function pointsWithinDist(e, t, n) {
    var i = t.x - e.x;
    var r = t.y - e.y;
    return i * i + r * r <= n * n
}
PolyTool.prototype.onDocumentMouseUp = function (e, t) {
    if (this.canReleaseDrag) {
        if (this.draggedPoint && this.draggedAnnotation) {
            this.draggedAnnotation.setDraggedPoint(null)
        }
        this.draggedPoint = null;
        this.draggedAnnotation = null
    }
};
PolyTool.prototype.onCanvasMouseDown = function (e, t) {
    if (this.draggedPoint != null)
        return;
    e.stopImmediatePropagation();
    if (this.isColliding)
        return;
    if (this.hoveredPoint != null) {
        this.draggedPoint = this.hoveredPoint;
        this.draggedAnnotation = this.hoveredAnnotation;
        this.draggedAnnotation.setDraggedPoint(this.draggedPoint);
        e.stopImmediatePropagation();
        return
    }
    if (!this.isDrawing && !this.hoveredPoint) {
        if (this.hoverShapes.length > 0) {
            this.activeShape = this.hoverShapes[0];
            $(this).trigger("change");
            return
        } else {
            this.isDrawing = true
        }
    }
    this.activeShape = null;
    if (this.isSnapped) {
        t = this.snapPoint;
        this.stopDraw();
        return
    }
    this.__startDraw(t.x, t.y);
    this.currentPoly.push(t);
    this.lastPoint = {
        x: t.x,
        y: t.y
    };
    $(this).trigger("change")
};
PolyTool.prototype.__startDraw = function (e, t) {
    var n = new Vector2(e, t);
    this.__pointsBeingDrawn.push(n)
};
PolyTool.prototype.__calculateLinesFromPoints = function (a) {
    var s = [];
    $.each(a, function (e, t) {
            var n = a.length > 1;
            var i = e == a.length - 1;
            if (n && !i) {
                var r = this.__pointsBeingDrawn[e + 1];
                var o = new LineSegment(t, r);
                s.push(o)
            }
        }
        .bind(this));
    return s
};
PolyTool.prototype.__drawLinesBetweenPoints = function (o, a, s) {
    var e = "rgba(20, 119, 65, 1)";
    var t = "rgba(178, 241, 130, 1)";
    var n = [];
    $.each(a, function (e, t) {
        if (s)
            t = s(t);
        n.push(t)
    });
    this.__drawer.context = o;
    this.__drawer.drawDoubleConnectedPoints(n, {
        lineWidth: 3,
        strokeStyle: e
    }, {
        lineWidth: 1,
        strokeStyle: t
    });
    return;
    $.each(a, function (e, t) {
            if (s)
                t = s(t);
            console.log("lorem", s);
            var n = a.length > 1;
            var i = e == a.length - 1;
            if (n && !i) {
                var r = this.__pointsBeingDrawn[e + 1];
                if (s)
                    r = s(r);
                this.__polyDrawer.drawLineSegment(o, t, r, false, true)
            }
        }
        .bind(this))
};
PolyTool.prototype.__calculateIntersectionsOfLineWithLines = function (i, e) {
    var r = [];
    $.each(e, function (e, t) {
            var n = i.calculateIntersectionWithLineSegment(t);
            if (n)
                r.push(n)
        }
        .bind(this));
    return r
};
PolyTool.prototype.__cleanPointsWithinDistance = function (e, t, r) {
    var o = [];
    $.each(e, function (e, n) {
        var i = false;
        $.each(t, function (e, t) {
            if (n.vectorIsWithinDist(t, r)) {
                i = true;
                return false
            }
        });
        if (!i)
            o.push(n)
    });
    return o
};
var RectTool = function (e, t, n, i) {
    Tool.call(this, e, t, n, i, [114, 82]);
    this.imageMousePos = null;
    this.startRectPos = null;
    this.__polyDrawer = new PolyDrawer
};
RectTool.prototype = Object.create(Tool.prototype);
RectTool.prototype.constructor = Tool;
RectTool.prototype.draw = function (e, t, i) {
    $("body").css("cursor", "crosshair");
    if (this.startRectPos != null) {
        if (this.imageMousePos != null) {
            var n = this.getPoly();
            var r = [];
            $.each(n, function (e, t) {
                var n = i.imageToCanvasCoords(t.x, t.y);
                r.push(new Vector(n.x, n.y))
            });
            this.__polyDrawer.drawPoly(e, r, false, true)
        }
    }
};
RectTool.prototype.getPoly = function () {
    var e = this.imageMousePos.x - this.startRectPos.x;
    var t = this.imageMousePos.y - this.startRectPos.y;
    var n = [];
    n.push(new Vector(this.startRectPos.x, this.startRectPos.y));
    n.push(new Vector(this.startRectPos.x, this.startRectPos.y + t));
    n.push(new Vector(this.startRectPos.x + e, this.startRectPos.y + t));
    n.push(new Vector(this.startRectPos.x + e, this.startRectPos.y));
    return n
};
RectTool.prototype.onImageMouseMove = function (e, t) {
    this.imageMousePos = e;
    if (this.startRectPos != null)
        $(this).trigger("change")
};
RectTool.prototype.onCanvasMouseDown = function (e, t) {
    e.stopImmediatePropagation();
    this.startRectPos = t
};
RectTool.prototype.deactivate = function () {
    this.stopDraw()
};
RectTool.prototype.stopDraw = function () {
    if (this.startRectPos == null || this.imageMousePos == null)
        return;
    this.startRectPos = null;
    this.imageMousePos = null;
    $(this).trigger("change")
};
RectTool.prototype.onDocumentKeyPress = function (e) {
    if (e.keyCode == 127 || e.keyCode == 27) {
        this.stopDraw()
    }
};
RectTool.prototype.onDocumentMouseUp = function (e, t) {
    if (this.startRectPos == null || this.imageMousePos == null)
        return;
    var n = this.getPoly();
    var i = new PolyAnnotation(n, "");
    this.annotator.addAnnotation(i);
    this.startRectPos = null;
    this.imageMousePos = null;
    $(this).trigger("change")
};
var CircleTool = function (e, t, n, i) {
    Tool.call(this, e, t, n, i, [99, 67]);
    this.isDrawing = false;
    this.imageX = null;
    this.imageY = null;
    this.startDrawX = null;
    this.startDrawY = null;
    this.__drawer = new Drawer;
    this.__pointDrawer = new PointDrawer;
    this.SELECTED_STROKE_STYLE = "rgb(178, 241, 130)"
};
CircleTool.prototype = Object.create(Tool.prototype);
CircleTool.prototype.constructor = Tool;
CircleTool.prototype.draw = function (e) {
    $("body").css("cursor", "crosshair");
    var t = this.interactiveImage.imageToCanvasCoords(this.imageX, this.imageY);
    if (this.isDrawing) {
        var n = this.interactiveImage.imageToCanvasCoords(this.startDrawX, this.startDrawY);
        var i = new Vector2(n.x, n.y);
        var r = new Vector2(t.x, t.y);
        var o = i.distance(r);
        var a = r.subtract(i);
        this.__drawer.context = this.interactiveImage.context;
        this.__drawer.drawLineSegment(i, r, {
            strokeStyle: this.SELECTED_STROKE_STYLE,
            lineWidth: 3
        });
        var s = "rgba(20, 119, 65, 1)";
        var l = "rgba(178, 241, 130, 1)";
        this.__drawer.drawDoubleCircle(t.x - a.x, t.y - a.y, o, {
            strokeStyle: s,
            lineWidth: 3
        }, {
            strokeStyle: l,
            lineWidth: 1
        });
        this.__pointDrawer.drawPointScaled(e, i.x, i.y, false, true, .75);
        this.__pointDrawer.drawPointScaled(e, t.x, t.y, false, true, .75)
    } else {
        if (this.imageX != null) {}
    }
};
CircleTool.prototype.deactivate = function () {
    this.stopDraw()
};
CircleTool.prototype.stopDraw = function () {
    if (this.startDrawX == null)
        return;
    this.startDrawX = null;
    this.startDrawY = null;
    this.isDrawing = false;
    $(this).trigger("change")
};
CircleTool.prototype.onDocumentKeyPress = function (e) {
    if (e.keyCode == 127 || e.keyCode == 27) {
        this.stopDraw()
    }
};
CircleTool.prototype.onImageMouseMove = function (e, t) {
    this.imageX = e.x;
    this.imageY = e.y;
    if (this.isDrawing)
        $(this).trigger("change")
};
CircleTool.prototype.onCanvasMouseDown = function (e, t) {
    this.startDrawX = t.x;
    this.startDrawY = t.y;
    this.isDrawing = true;
    e.stopImmediatePropagation()
};
CircleTool.prototype.onDocumentMouseUp = function (e, t) {
    if (this.startDrawX == null)
        return;
    var n = new Vector2(this.startDrawX, this.startDrawY);
    var i = new Vector2(this.imageX, this.imageY);
    var r = n.distance(i);
    var o = new CircleAnnotation(n.x, n.y, r, "");
    this.annotator.addAnnotation(o);
    this.startDrawX = null;
    this.startDrawY = null;
    this.isDrawing = false;
    $(this).trigger("change")
};
var PlaylistManager = function () {
    this.request = null;
    var t = function (e) {
        if (this.request) {
            this.request.abort()
        }
        this.request = $.ajax(e)
    };
    var e = {
        initialState: "uninitialized",
        states: {
            uninitialized: {
                INIT: "inactive"
            },
            inactive: {
                _onEnter: function () {},
                FETCH: function () {
                    this.transition("fetching");
                    var n = this;
                    t({
                        url: "/py/fetch_my_playlists.py",
                        type: "GET",
                        dataType: "json",
                        success: function (e, t) {
                            n.handle(e.status, e)
                        }
                    })
                },
                FETCH_PUBLIC: function () {
                    this.transition("fetching");
                    var n = this;
                    t({
                        url: "/py/fetch_public.py",
                        type: "GET",
                        dataType: "json",
                        success: function (e, t) {
                            n.handle(e.status, e)
                        }
                    })
                }
            },
            fetching: {
                _onEnter: function () {},
                FETCH_SUCCESSFUL: function (e) {
                    this.playlists = e.playlists;
                    this.transition("fetch_successful")
                },
                BAD_FETCH: "fetch_unsuccessful",
                INACTIVATE: "inactive",
                UPDATE: "inactive"
            },
            fetch_successful: {
                _onEnter: function () {},
                INACTIVATE: "inactive",
                UPDATE: function (e) {
                    this.transition("updating");
                    var n = this;
                    t({
                        url: "/py/update_playlists.py",
                        type: "POST",
                        data: {
                            data: JSON.stringify(e)
                        },
                        dataType: "json",
                        success: function (e, t) {
                            n.handle(e.status, e)
                        },
                        error: function (e) {
                            document.write(e.responseText)
                        }
                    })
                }
            },
            updating: {
                _onEnter: function () {},
                UPDATE_SUCCESSFUL: function (e) {
                    this.transition("inactive")
                },
                BAD_UPDATE: function (e) {
                    this.transition("inactive")
                }
            },
            fetch_unsuccessful: {
                _onEnter: function () {},
                INACTIVATE: "inactive",
                UPDATE: "inactivate"
            }
        },
        init: function () {
            this.handle("INIT")
        },
        fetch: function () {
            this.handle("FETCH")
        },
        fetchPublic: function () {
            this.handle("FETCH_PUBLIC")
        },
        fetchSuccessful: function () {
            this.handle("FETCH_SUCCESSFUL")
        },
        badFetch: function () {
            this.handle("BAD_FETCH")
        },
        inactivate: function () {
            this.handle("INACTIVATE")
        },
        update: function (e) {
            this.handle("UPDATE", e)
        }
    };
    return new machina.Fsm(e)
};
var crud = function (h, d, p) {
    if (!Array.isArray(p))
        $.error("crud: You must supply a list of primary keys, and each must be a string.");
    $.each(p, function (e, t) {
        if (typeof t != "string")
            $.error("crud: You must supply a list of primary keys, and each must be a string.")
    });
    var v = function (e) {
        return typeof e == "object" && e.constructor == Object
    };
    if (!v(h) || !v(d))
        $.error("crud: The parameters passed to crud must be objects.");
    var e = _.keys(h);
    var t = _.keys(d);
    if (!_.isEqual(e, t))
        $.error("crud: The two objects must have the same keys (representing the same tables).");
    var n = e;
    var g = {};
    $.each(n, function (e, t) {
        g[t] = {};
        var a = p[e];
        var s = h[t];
        var n = d[t];
        var i = [];
        var l = [];
        var r = [];
        if (s.length == 0 && n.length == 0) {} else {
            if (!(Array.isArray(s) && Array.isArray(n)))
                $.error("crud: Each object passed to crud must have a single value that is an Array (representing multiple rows).");
            $.each(s, function (e, t) {
                if (!v(t))
                    $.error("crud: Each row must be an object (representing column/value pairs).");
                $.each(n, function (e, t) {
                    if (!v(t))
                        $.error("crud: Each row must be an object (representing column/value pairs).")
                })
            });
            var o = function (e, t) {
                var n = e.filter(function (e) {
                    return a in e
                });
                var i = n.map(function (e) {
                    return e[a]
                });
                return i
            };
            var u = o(s, a);
            var c = o(n, a);
            i = n.filter(function (e) {
                var t = !(a in e);
                if (t) {
                    return true
                } else {
                    var n = e[a];
                    var i = u.indexOf(n) == -1;
                    if (i) {
                        $.error("crud: Insertion in obj2 contains a primaryKey field.")
                    }
                    return false
                }
            });
            r = s.filter(function (e) {
                var t = e[a];
                var n = c.indexOf(t) == -1;
                if (n) {
                    var i = a in e;
                    if (!i)
                        $.error("crud: Deletion in obj1 has no primaryKey field.");
                    return true
                } else {
                    return false
                }
            });
            var f = _.clone(n);
            $.each(i, function (e, t) {
                f.splice(f.indexOf(t), 1)
            });
            l = [];
            $.each(f, function (e, t) {
                var n = t[a];
                var i = u.indexOf(n);
                var r = s[i];
                var o = !_.isEqual(r, t);
                if (o)
                    l.push(t)
            })
        }
        g[t]["insertions"] = i;
        g[t]["deletions"] = r;
        g[t]["updates"] = l
    });
    return g
};
var isCrudEmpty = function (i) {
    var r = true;
    var e = Object.keys(i);
    $.each(e, function (e, n) {
        var t = Object.keys(i[n]);
        $.each(t, function (e, t) {
            if (i[n][t].length > 0) {
                r = false;
                return false
            }
        });
        if (!r)
            return false
    });
    return r
};
var LocusImagePositioner = function (e) {
    this.locusImage = e;
    this.canvas = this.locusImage.canvas;
    this.position();
    $(window).resize(function () {
            this.position()
        }
        .bind(this))
};
LocusImagePositioner.prototype.position = function (e) {
    var t = this.__getWorkAreaSize();
    var n = 1;
    if (this.locusImage.zoomer)
        n = this.locusImage.zoomer.zoom;
    var i = Math.min(this.locusImage.img.width * n, t.width);
    var r = Math.min(this.locusImage.img.height * n, t.height);
    this.locusImage.setSize(i, r);
    var o = this.__getCanvasSize();
    var a;
    if (t.width < o.width) {
        a = 0
    } else {
        a = (t.width - o.width) / 2
    }
    var s = $("#work_area").position().top;
    if (t.height >= o.height) {
        s += (t.height - o.height) / 2
    }
    $(this.canvas).css({
        position: "absolute",
        top: s,
        left: a
    });
    if (!e) {
        this.locusImage.draw()
    } else {}
    $(this).triggerHandler("position");
    $(this.locusImage).triggerHandler("change")
};
LocusImagePositioner.prototype.__getWorkAreaSize = function () {
    $(this.canvas).hide();
    var e = $(window).width();
    var t = $("footer").position().top - $("#work_area").position().top;
    $(this.canvas).show();
    return {
        width: e,
        height: t
    }
};
LocusImagePositioner.prototype.__getCanvasSize = function (e, t) {
    var n = $(this.canvas);
    return {
        width: this.locusImage.width,
        height: this.locusImage.height
    }
};
var Model = function () {
    this.session = session;
    this.playlistManager = new PlaylistManager;
    this.imageManager = new ImageManager
};
Model.prototype.init = function () {
    this.session.init();
    this.playlistManager.init();
    this.imageManager.init()
};
var ImageManager = function () {
    var e = function (e) {
        if (!e)
            throw "ImageManager: locusId is undefined";
        this.transition("image_loading");
        var t = {
            locus_id: e
        };
        var n = this;
        $.ajax({
            url: "/py/load_locus.py",
            type: "POST",
            data: t,
            dataType: "json",
            success: function (e, t) {
                n.handle(e.status, e)
            }
        })
    };
    var t = function () {
        return this.dots
    };
    var n = function (e) {
        return this.dots[e]
    };
    var i = function (e, t, n) {
        if (!n) {
            n = "Enter the dot's message here."
        }
        this.dots.push({
            x: e,
            y: t,
            text: n
        })
    };
    var r = function (e, t, n, i) {
        var r = this.dots[e];
        r.x = t;
        r.y = n;
        if (i)
            r.text = i
    };
    var o = function (e) {
        this.dots.splice(e, 1)
    };
    this.lastStateWithImage = "editing_new_locus";
    var a = {
        imageUploadUrl: "/py/image_upload.py",
        initialState: "uninitialized",
        states: {
            uninitialized: {
                INIT: "no_image_loaded"
            },
            no_image_loaded: {
                _onEnter: function () {},
                UPLOAD: function (e) {
                    this.transition("image_uploading");
                    e.submit()
                },
                OPEN: e
            },
            image_uploading: {
                _onEnter: function () {},
                BAD_UPLOAD: "no_image_loaded",
                INVALID_FILE_TYPE: function () {
                    this.transition("no_image_loaded")
                },
                INVALID_FILE_SIZE: function () {
                    this.transition("no_image_loaded")
                },
                UPLOAD_SUCCESSFUL: function (e) {
                    this.locusId = null;
                    this.imagePath = e.filename;
                    this.transition("editing_new_locus")
                }
            },
            image_loading: {
                _onEnter: function () {},
                BAD_OPEN: "no_image_loaded",
                OPEN_SUCCESSFUL: function (e) {
                    console.log("OPEN SUCCS");
                    console.log(e);
                    var t = JSON.parse(e.locus_json);
                    var n = t.id;
                    var i = t.name;
                    this.locusId = n;
                    this.locusName = i;
                    var r = t.owner_id;
                    var o = t.image;
                    var a = JSON.parse(t.dots);
                    this.imagePath = o;
                    this.dots = a;
                    this.scale = t.scale;
                    this.transition("editing_old_locus")
                }
            },
            editing_new_locus: {
                _onEnter: function () {
                    this.dots = [];
                    this.scale = 1;
                    this.lastStateWithImage = "editing_new_locus"
                },
                GET_DOTS: t,
                GET_DOT: n,
                CREATE_DOT: i,
                UPDATE_DOT: r,
                DELETE_DOT: o,
                PROMPT_SAVE_AS: "awaiting_save_as_info",
                DELETE: "no_image_loaded",
                OPEN: e,
                NEW: "no_image_loaded"
            },
            editing_old_locus: {
                _onEnter: function () {
                    this.lastStateWithImage = "editing_old_locus"
                },
                GET_DOTS: t,
                GET_DOT: n,
                CREATE_DOT: i,
                UPDATE_DOT: r,
                DELETE_DOT: o,
                SAVE: function (e) {
                    this.transition("saving_locus");
                    var t = JSON.stringify(canvasControllerGlobal.interactiveImage.serialize(e));
                    var n = {
                        locus_id: this.locusId,
                        locus_name: this.locusName,
                        dots: t,
                        scale: e,
                        image: this.imagePath
                    };
                    var i = this;
                    $.ajax({
                        url: "/py/save.py",
                        type: "POST",
                        data: n,
                        dataType: "json",
                        success: function (e, t) {
                            i.handle(e.status, e)
                        },
                        error: function (e) {}
                    })
                },
                VIEW: function () {
                    window.open("/viewer.html?id=" + this.locusId)
                },
                PROMPT_SAVE_AS: "awaiting_save_as_info",
                DELETE: function () {
                    this.transition("deleting");
                    var e = {
                        locus_id: this.locusId
                    };
                    var n = this;
                    $.ajax({
                        url: "/py/delete.py",
                        type: "POST",
                        data: e,
                        dataType: "json",
                        success: function (e, t) {
                            n.handle(e.status, e)
                        }
                    })
                },
                OPEN: e,
                NEW: "no_image_loaded"
            },
            deleting: {
                _onEnter: function () {},
                DELETE_SUCCESSFUL: "no_image_loaded",
                BAD_DELETE: "no_image_loaded"
            },
            awaiting_save_as_info: {
                _onEnter: function () {},
                SAVE_AS: function (e) {
                    console.log("LOL");
                    console.log(e);
                    this.transition("saving_locus_as");
                    this.scale = e.scale;
                    var t = JSON.stringify(canvasControllerGlobal.interactiveImage.serialize(this.scale));
                    var e = {
                        locus_name: e.name,
                        dots: t,
                        scale: e.scale,
                        image: e.image_path,
                        playlist_id: e.playlist_id
                    };
                    var n = this;
                    $.ajax({
                        url: "/py/save_as.py",
                        type: "POST",
                        data: e,
                        dataType: "json",
                        success: function (e, t) {
                            console.log("SAVE_AS_DONE", e, t);
                            n.handle(e.status, e)
                        },
                        error: function (e, t, n) {}
                    })
                },
                CANCEL: function () {
                    this.transition(this.lastStateWithImage)
                }
            },
            saving_locus_as: {
                _onEnter: function () {},
                SAVE_AS_SUCCESSFUL: function (n) {
                    var e = ii.serialize();
                    this.locusName = n.locus_name;
                    this.scale = n.scale;
                    this.locusId = n.locus_id;
                    $.each(e, function (e, t) {
                        if (t.type == "POLY") {
                            $.each(t.points, function (e, t) {
                                t.x *= n.scale;
                                t.y *= n.scale
                            })
                        }
                    });
                    this.dots = e;
                    this.transition("editing_old_locus")
                },
                BAD_SAVE_AS: this.lastStateWithImage
            },
            saving_locus: {
                _onEnter: function () {},
                SAVE_SUCCESSFUL: function (n) {
                    var e = ii.serialize();
                    this.scale = n.scale;
                    $.each(e, function (e, t) {
                        if (t.type == "POLY") {
                            $.each(t.points, function (e, t) {
                                t.x *= n.scale;
                                t.y *= n.scale
                            })
                        }
                    });
                    this.dots = e;
                    this.transition("editing_old_locus")
                },
                BAD_SAVE: "editing_old_locus"
            }
        },
        init: function () {
            this.handle("INIT")
        },
        upload: function () {
            this.handle("UPLOAD")
        },
        open: function (e) {
            this.handle("OPEN", e)
        },
        badUpload: function () {
            this.handle("BAD_UPLOAD")
        },
        uploadSuccessful: function () {
            this.handle("UPLOAD_SUCCESSFUL")
        },
        delete: function () {
            this.handle("DELETE")
        },
        badOpen: function () {
            this.handle("BAD_OPEN")
        },
        openSuccessful: function () {
            this.handle("OPEN_SUCCESSFUL")
        },
        promptSaveAs: function () {
            this.handle("PROMPT_SAVE_AS")
        },
        saveAs: function (e) {
            this.handle("SAVE_AS", e)
        },
        new: function () {
            this.handle("NEW")
        },
        save: function (e) {
            this.handle("SAVE", e)
        },
        view: function () {
            this.handle("VIEW")
        },
        cancel: function () {
            this.handle("CANCEL")
        },
        getDots: t,
        getDot: function (e) {
            return this.handle("GET_DOT", e)
        },
        createDot: function (e, t, n) {
            this.handle("CREATE_DOT", e, t, n)
        },
        updateDot: function (e, t, n, i) {
            this.handle("UPDATE_DOT", e, t, n, i)
        },
        deleteDot: function (e) {
            this.handle("DELETE_DOT", e)
        },
        doRender: function () {
            return this.compositeState() == "editing_old_locus" || this.compositeState() == "editing_new_locus"
        },
        uploadStart: function (e) {
            this.handle("UPLOAD", e)
        },
        uploadDone: function (e) {
            this.handle('e.result.status', e.result)
        }
    };
    var s = new machina.Fsm(a);
    return s
};
var CanvasView = function () {
    this.__init()
};
CanvasView.prototype.__init = function () {
    this.DELETE_KEYCODE = 46;
    this.CANVAS_ID = "canvas"
};
CanvasView.prototype.showLoading = function (e) {
    $("#canvas_area").html("");
    var t = "";
    t += '<img src="./img/loading.svg" />';
    $("#work_area").html(t)
};
CanvasView.prototype.showUploadWidget = function (e) {
    $("#canvas_area").html("");
    var t = "";
    t += '<div id="upload_text">';
    t += "<span>Upload a new image:&nbsp;</span>";
    t += '<input id="image_upload" type="file" name="image_file" accept="image/*" />';
    t += "</div>";
    $("#work_area").html(t);
    $("#image_upload").attr("data-url", e);
    $("#image_upload").fileupload({
        dataType: "json",
        add: function (e, t) {
                $(this).trigger("IMAGE_UPLOAD_STARTED", t)
            }
            .bind(this),
        done: function (e, t) {
                console.log(e, t);
                $(this).trigger("IMAGE_UPLOAD_DONE", t)
            }
            .bind(this),
        error: function (e, t, n) {
            console.log(e);
            console.log(t);
            console.log(n);
            console.log("c", e.responseText);
            document.write(e.responseText)
        }
    })
};
CanvasView.prototype.createCanvas = function () {
    $("#work_area").html("");
    $("#canvas_area").html('<canvas id="' + this.CANVAS_ID + '"></canvas>');
    $("#canvas").hide();
    var e = $("#" + this.CANVAS_ID)[0];
    this.context = e.getContext("2d");
    this.createListeners()
};
CanvasView.prototype.createListeners = function () {
    var u = this;
    $("#" + this.CANVAS_ID).on("mousedown touchstart", function (e) {
            $(this).trigger("CANVAS_MOUSE_DOWN", e);
            if (e.type == "touchstart") {
                var t = e.timeStamp;
                var n = $(this).data("lastTouch") || t;
                var i = t - n;
                var r = e.originalEvent.touches.length;
                $(this).data("lastTouch", t);
                var o = e.originalEvent.touches[0];
                var a = new Vector(o.screenX, o.screenY);
                var s = $(this).data("lastTouchCoords");
                $(this).data("lastTouchCoords", a);
                if (!i || i > 500 || r > 1) {
                    return
                }
                if (s) {
                    var l = a.distanceSquared(s);
                    console.log(l);
                    if (l > 125 * 125)
                        return
                }
                e.preventDefault();
                $(e.target).trigger("click");
                $(u).trigger("CANVAS_DOUBLE_CLICK", e);
                $(this).data("lastTouchCoords", null)
            }
        }
        .bind(this)).on("dblclick", function (e) {
        $(u).trigger("CANVAS_DOUBLE_CLICK", e)
    });
    $(document).on("mousemove touchmove", function (e) {
        $(u).trigger("DOCUMENT_MOUSE_MOVE", e)
    }).on("mouseup touchend", function (e) {
        $(u).trigger("DOCUMENT_MOUSE_UP", e)
    });
    $(document).keydown(function (e) {
        if (e.keyCode == u.DELETE_KEYCODE) {
            $(u).trigger("DOCUMENT_DELETE_KEY_DOWN", e)
        }
    });
    $(window).resize(function () {
        $(u).trigger("WINDOW_RESIZE")
    });
    quill.on("text-change", function (e, t, n) {
        if (!suppressQuillEvents)
            $(u).trigger("DOT_TEXT_CHANGE")
    });
    $("#dot_text").keyup(function (e) {
        if (!suppressQuillEvents)
            $(u).trigger("DOT_TEXT_CHANGE", e)
    });
    $("#scale_slider").on("input", function (e) {
        $(u).trigger("CANVAS_SCALE_CHANGE", e)
    })
};
CanvasView.prototype.destroyListeners = function () {
    quill.off("text-change");
    $("#" + this.CANVAS_ID).off("mousedown").off("touchstart").off("dblclick");
    $(document).off("mousemove").off("touchmove").off("mouseup").off("touchend");
    $(document).off("keydown");
    $(window).off("resize");
    $("#dot_text").off("keyup")
};
CanvasView.prototype.loadImageToCanvas = function (e, t) {
    var n = this;
    var i = $("<img>", {
        src: e
    });
    i.on("load", function () {
        n.image = this;
        n.sizeImage(t)
    })
};
CanvasView.prototype.updateSelectedDotTextarea = function (e) {
    quill.root.innerHTML = e
};
CanvasView.prototype.sizeImage = function (e) {
    this.scale = e;
    this.imageWidth = this.image.width * this.scale;
    this.imageHeight = this.image.height * this.scale;
    var t = $(window).width();
    var n = $("footer").position().top - $("#work_area").position().top;
    var i;
    var r;
    var o;
    var a = $("#work_area").position().top;
    if (t < this.imageWidth) {
        i = t;
        o = 0
    } else {
        i = this.imageWidth;
        o = (t - this.imageWidth) / 2
    }
    if (n < this.imageHeight) {
        r = n
    } else {
        r = this.imageHeight;
        a += (n - this.imageHeight) / 2
    }
    $("#canvas").attr("width", i);
    $("#canvas").attr("height", r);
    $("#canvas").css({
        position: "absolute",
        top: a,
        left: o
    });
    $("#canvas").show();
    this.canvasWidth = i;
    this.canvasHeight = r
};
CanvasView.prototype.draw = function (i, r, e, o, a, t) {
    return;
    if (!this.image)
        return;
    this.context.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
    this.context.drawImage(this.image, i, r, this.imageWidth, this.imageHeight);
    $("body").css("cursor", "default");
    if (o != -1) {
        $("body").css("cursor", "move")
    }
    if (t) {
        $("body").css("cursor", "pointer")
    }
    var s = this;
    $.each(e, function (e, t) {
        var n = e == a || e == o;
        if (e != a) {
            s.drawDot(t.x + i, t.y + r, n, e == a)
        }
    });
    if (a != -1) {
        var n = e[a];
        this.drawDot(n.x + i, n.y + r, true, true);
        this.activeBBDrawer.drawBB(this.context, n.x + i, n.y + r)
    }
};
CanvasView.prototype.drawDot = function (e, t, n, i) {
    return;
    this.dotDrawer.drawDot(this.context, e, t, n);
    return;
    this.context.beginPath();
    this.context.arc(e, t, this.DOT_RADIUS, 0, 2 * Math.PI);
    var r;
    if (n) {
        r = this.HIGHLIGHT_DOT_COLOR
    } else {
        r = this.DOT_COLOR
    }
    this.context.fillStyle = "rgba(" + r + ", " + this.DOT_OPACITY + ")";
    this.context.fill();
    this.context.closePath();
    if (i) {
        this.context.lineWidth = 0;
        this.context.rect(e - this.DOT_RADIUS / 2 - this.BOUNDING_BOX_PADDING, t - this.DOT_RADIUS / 2 - this.BOUNDING_BOX_PADDING, this.DOT_RADIUS + 2 * this.BOUNDING_BOX_PADDING, this.DOT_RADIUS + 2 * this.BOUNDING_BOX_PADDING);
        this.context.strokeStyle = "black";
        this.context.stroke();
        var o = {
            x: e + this.DOT_RADIUS / 2 + this.BOUNDING_BOX_PADDING,
            y: t - this.DOT_RADIUS / 2 - this.BOUNDING_BOX_PADDING
        };
        this.context.beginPath();
        this.context.arc(o.x, o.y, this.DELETE_SYMBOL_RADIUS, 0, 2 * Math.PI);
        this.context.fillStyle = "red";
        this.context.fill();
        this.context.lineWidth = 1;
        this.context.stroke();
        this.context.closePath();
        this.context.beginPath();
        this.context.lineWidth = 1;
        this.context.strokeStyle = "white";
        this.context.moveTo(o.x - this.DELETE_SYMBOL_RADIUS / 2, o.y - this.DELETE_SYMBOL_RADIUS / 2);
        this.context.lineTo(o.x + this.DELETE_SYMBOL_RADIUS / 2, o.y + this.DELETE_SYMBOL_RADIUS / 2);
        this.context.moveTo(o.x + this.DELETE_SYMBOL_RADIUS / 2, o.y - this.DELETE_SYMBOL_RADIUS / 2);
        this.context.lineTo(o.x - this.DELETE_SYMBOL_RADIUS / 2, o.y + this.DELETE_SYMBOL_RADIUS / 2);
        this.context.stroke();
        this.context.closePath()
    }
};
CanvasView.prototype.imageUploadElement = function () {
    return $("#image_upload")
};
CanvasView.prototype.imageUploading = function () {
    $("#work_area").html("<span>Uploading...</span>")
};
CanvasView.prototype.imageLoading = function () {
    $("#work_area").html("<span>Loading...</span>")
};
CanvasView.prototype.badOpen = function () {
    this.sessionController.prompt(["There was a problem opening the file..."], null)
};
CanvasView.prototype.enableSaveAsButton = function () {
    $("#file_menu option[value=SAVE_AS]").prop("disabled", false);
    $("#file_menu").niceSelect("update")
};
CanvasView.prototype.disableSaveAsButton = function () {
    $("#file_menu option[value=SAVE_AS]").prop("disabled", true);
    $("#file_menu").niceSelect("update")
};
var CanvasController = function (e, t) {
    this.model = e;
    this.canvasView = t;
    this.image = null;
    this.interactiveImage = null;
    this.TIMESTEP = 100;
    this.__init()
};
CanvasController.prototype.__init = function () {
    this.__createModelHandlers();
    this.__createViewHandlers()
};
CanvasController.prototype.__createModelHandlers = function () {
    this.model.imageManager.on("transitioned", function (e) {
            var t = this.model.imageManager.compositeState();
            this.__imageManagerStateChange(t, e);
            if (e.action == "image_uploading.INVALID_FILE_TYPE") {
                $.confirm(["<strong>Invalid Upload:</strong> You must upload a jpeg, png, or gif image."])
            } else if (e.action == "image_uploading.INVALID_FILE_SIZE") {
                $.confirm(["Invalid Upload: Your image must be < 10 mb in size."])
            }
            if (e.fromState == "editing_new_locus" || e.fromState == "editing_old_locus") {
                this.removeRender()
            }
        }
        .bind(this));
    shortcut.add("Ctrl+Q", function () {
        if (document.activeElement != document.body)
            return;
        setTimeout(function () {
            quill.focus()
        }, 1)
    })
};
CanvasController.prototype.__createViewHandlers = function () {
    $(this.canvasView).on("IMAGE_UPLOAD_STARTED", this.__imageUploadStarted.bind(this));
    $(this.canvasView).on("IMAGE_UPLOAD_DONE", this.__imageUploadDone.bind(this));
    $(this.canvasView).on("CANVAS_MOUSE_DOWN", this.canvasMouseDown.bind(this));
    $(this.canvasView).on("CANVAS_DOUBLE_CLICK", this.canvasDoubleClick.bind(this));
    $(this.canvasView).on("DOCUMENT_MOUSE_MOVE", this.documentMouseMove.bind(this));
    $(this.canvasView).on("DOCUMENT_MOUSE_UP", this.documentMouseUp.bind(this));
    $(this.canvasView).on("DOCUMENT_DELETE_KEY_DOWN", this.documentDeleteKeyDown.bind(this));
    $(this.canvasView).on("WINDOW_RESIZE", this.windowResize.bind(this));
    $(this.canvasView).on("DOT_TEXT_CHANGE", this.dotTextChange.bind(this));
    $(this.canvasView).on("CANVAS_SCALE_CHANGE", this.canvasScaleChange.bind(this))
};
CanvasController.prototype.canvasScaleChange = function (e) {
    this.setScale(this.getScale());
    this.resetScroll();
    this.canvasView.sizeImage(this.scale)
};
CanvasController.prototype.getScale = function () {
    return Number(ii.zoomer.zoom)
};
CanvasController.prototype.setScale = function (e) {
    this.scale = e;
    var t = e < 1 ? (e - 1) * 5 / .8 : (e - 1) / .8;
    var n = Math.round(t);
    $("#scale_slider").val(n)
};
CanvasController.prototype.resetUI = function () {
    quill.root.innerHTML = "";
    var e = this.interactiveImage.toolbox;
    disableQuill()
};
var toolbox;
CanvasController.prototype.__ResetImage = function (e) {
    if (this.interactiveImage) {
        this.interactiveImage.destroy()
    }
};
CanvasController.prototype.__loadNewImage = function (e) {
    var l;
    if (this.interactiveImage) {
        l = toolbox.activeTool.name;
        this.interactiveImage.destroy()
    }
    var u = e.scale ? e.scale : 1;
    var t = this.model.imageManager.locusId ? "/uploads/img/" + this.model.imageManager.locusId : this.model.imageManager.imagePath;
    var c = this.model.imageManager.dots;
    var f = this;
    $("<img>", {
        src: t
    }).on("load", function () {
        var e = new InteractiveImage;
        e.setSize(250, 250);
        e.setImg(this);
        var t = new Zoomer(e);
        e.addZoomer(t);
        e.zoomer.setZoom(u);
        var n = new AnnotatorNew(c, e);
        e.addAnnotator(n);
        toolbox = new Toolbox(e);
        toolbox.addTool(new SelectTool("SELECT", "#select_tool", n, e));
        toolbox.addTool(new DotTool("DOT", "#dot_tool", n, e));
        toolbox.addTool(new PolyTool("POLY", "#poly_tool", n, e));
        toolbox.addTool(new RectTool("RECT", "#rect_tool", n, e));
        toolbox.addTool(new CircleTool("CIRCLE", "#circle_tool", n, e));
        console.log(l);
        toolbox.selectTool(l ? l : "SELECT");
        var i = toolbox.getTool("SELECT");
        $(i).on("ACTIVE_ANNOTATION_CHANGE", f.activeAnnotationChange);
        var r = new Scroller;
        r.addBehavior(new DraggableScrollerBehavior(e.canvas));
        var o = new KeyboardScrollerBehavior;
        r.addBehavior(o);
        o.init();
        e.addScroller(r);
        var a = new LocusImagePositioner(e);
        e.addPositioner(a);
        var s = new OverlayUI(e);
        a.position();
        $("#popups").append($(e.canvas));
        f.interactiveImage = e;
        f.canvasView.createListeners();
        f.resetUI()
    })
};
CanvasController.prototype.__imageManagerStateChange = function (e, t) {
    if (e == "no_image_loaded") {
        this.__ResetImage();
        this.canvasView.showUploadWidget(this.model.imageManager.imageUploadUrl)
    } else if (e == "editing_old_locus" || e == "editing_new_locus") {
        if (this.model.imageManager.scale) {
            var n = this.model.imageManager.scale
        } else {
            n = 1
        }
        if (t.fromState != "awaiting_save_as_info") {
            this.__loadNewImage(this.model.imageManager)
        }
    } else if (e == "image_loading" || e == "image_uploading" || e == "saving_locus" || e == "saving_locus_as" || e == "deleting") {
        this.canvasView.showLoading()
    }
};
CanvasController.prototype.resetScroll = function () {
    this.scrollX = 0;
    this.scrollY = 0;
    this.dragOffsetX = 0;
    this.dragOffsetY = 0;
    this.mouseX = 0;
    this.mouseY = 0;
    this.lastMouseX = 0;
    this.lastMouseY = 0;
    this.hasProcessedTouchStart = false
};
CanvasController.prototype.__setupNewImage = function (e, t) {
    this.isDraggingImage = false;
    this.isDraggingDot = false;
    this.activeDotIndex = -1;
    this.resetScroll();
    this.setScale(t);
    this.canvasView.createCanvas();
    this.canvasView.loadImageToCanvas(e, this.scale);
    this.renderInterval = setInterval(this.render.bind(this), this.TIMESTEP);
    this.render()
};
CanvasController.prototype.removeRender = function () {
    clearInterval(this.renderInterval)
};
CanvasController.prototype.__imageUploadStarted = function (e, t) {
    this.model.imageManager.uploadStart(t)
};
CanvasController.prototype.__imageUploadDone = function (e, t) {
    this.model.imageManager.uploadDone(t)
};
var scaleDots = function (e, i) {
    dotsModified = [];
    $.each(e, function (e, t) {
        var n = $.extend({}, t);
        n.x = t.x * i;
        n.y = t.y * i;
        dotsModified.push(n)
    });
    return dotsModified
};
CanvasController.prototype.render = function () {
    if (!this.model.imageManager.doRender()) {
        return
    }
    this.canvasView.draw(this.scrollX, this.scrollY, scaleDots(this.model.imageManager.getDots(), this.scale), this.getHoverDotIndex(), this.activeDotIndex, this.isHoveringDelete)
};
CanvasController.prototype.getHoverDotIndex = function (a) {
    return;
    var s = this.canvasView.activeBBDrawer.DELETE_RADIUS;
    var l = this.canvasView.activeBBDrawer.BB_WIDTH;
    if (!a) {
        a = false
    }
    hoverDotIndex = -1;
    var u = this;
    var e = scaleDots(this.model.imageManager.getDots(), this.scale);
    $.each(e, function (e, t) {
        var n = u.imageToPageCoords(t.x, t.y);
        var i = {
            x: u.mouseX,
            y: u.mouseY
        };
        var r = u.canvasView.DOT_RADIUS;
        if (a) {
            r = r * 3
        }
        if (pointsWithinDist(n, i, r)) {
            hoverDotIndex = e;
            u.isHoveringDot = true
        }
        if (u.activeDotIndex != -1 && u.activeDotIndex == e) {
            var o = {
                x: n.x + l / 2,
                y: n.y - l / 2
            };
            if (pointsWithinDist(o, i, s)) {
                u.isHoveringDelete = true
            } else {
                u.isHoveringDelete = false
            }
        }
    });
    return hoverDotIndex
};
CanvasController.prototype.selectDot = function (e) {
    this.activeDotIndex = e;
    var t = this.model.imageManager.getDot(e).text;
    this.canvasView.updateSelectedDotTextarea(t)
};
CanvasController.prototype.canvasMouseDown = function (e, t) {
    var n;
    var i;
    if (t.type == "mousedown") {
        n = t.pageX;
        i = t.pageY
    } else if (t.type == "touchstart") {
        var r = t.originalEvent.touches[0] || t.originalEvent.changedTouches[0];
        n = r.pageX;
        i = r.pageY
    }
    this.mouseX = n;
    this.mouseY = i;
    var o = false;
    if (this.isHoveringDelete) {
        this.model.imageManager.deleteDot(this.activeDotIndex);
        this.isHoveringDelete = false;
        o = true
    }
    if (!o) {
        var a = this.getHoverDotIndex(t.type == "touchstart");
        if (a != -1) {
            this.selectDot(a);
            this.isDraggingDot = true
        } else {
            this.isDraggingImage = true
        }
    }
    this.hasProcessedTouchStart = false
};
CanvasController.prototype.canvasDoubleClick = function (e, t) {
    var n = this.getHoverDotIndex();
    var i;
    var r;
    if (t.type == "touchstart") {
        var o = t.originalEvent.touches[0] || t.originalEvent.changedTouches[0];
        i = o.pageX;
        r = o.pageY
    } else {
        i = t.pageX;
        r = t.pageY
    }
    if (n == -1) {
        var a = this.pageToImageCoords(i, r);
        this.model.imageManager.createDot(a.x, a.y);
        this.selectDot(this.model.imageManager.getDots().length - 1)
    } else {
        this.model.imageManager.deleteDot(n)
    }
};
CanvasController.prototype.documentMouseMove = function (e, t) {
    var n;
    var i;
    if (t.type == "mousemove") {
        n = t.pageX;
        i = t.pageY
    } else if (t.type == "touchmove") {
        var r = t.originalEvent.touches[0] || t.originalEvent.changedTouches[0];
        n = r.pageX;
        i = r.pageY
    }
    this.mouseX = n;
    this.mouseY = i;
    if (!this.hasProcessedTouchStart) {
        this.lastMouseX = this.mouseX;
        this.lastMouseY = this.mouseY;
        this.hasProcessedTouchStart = true;
        if (this.isDraggingDot) {
            var o = this.pageToImageCoords(this.mouseX, this.mouseY);
            var a = this.model.imageManager.getDots()[this.activeDotIndex];
            this.dragOffsetX = a.x - o.x;
            this.dragOffsetY = a.y - o.y
        }
    }
    if (this.canvasView.image)
        this.handleDrag();
    this.lastMouseX = n;
    this.lastMouseY = i
};
CanvasController.prototype.documentMouseUp = function (e, t) {
    this.isDraggingImage = false;
    this.isDraggingDot = false
};
CanvasController.prototype.documentDeleteKeyDown = function (e, t) {
    if (this.activeDotIndex == -1)
        return;
    this.model.imageManager.deleteDot(this.activeDotIndex)
};
CanvasController.prototype.windowResize = function () {
    this.canvasView.sizeImage();
    this.scrollX = 0;
    this.scrollY = 0;
    this.render()
};
var suppressQuillEvents;

function disableQuill() {
    suppressQuillEvents = true;
    quill.enable(false);
    quill.setText("Use the Select Tool to select an annotation and edit its text using this textbox.");
    $(".ql-editor").css("background-color", "#DDD")
}

function enableQuill() {
    suppressQuillEvents = false;
    quill.enable(true);
    $(".ql-editor").css("background-color", "white")
}
CanvasController.prototype.activeAnnotationChange = function (e, t) {
    if (!t) {
        disableQuill();
        return
    }
    enableQuill();
    if (typeof t.text == "string") {
        quill.setText(t.text)
    } else {
        quill.setContents(t.text)
    }
};
CanvasController.prototype.dotTextChange = function () {
    var e = this.interactiveImage.toolbox.activeTool;
    if (!e.name == "SELECT")
        return;
    if (!e.selectedAnnotation)
        return;
    var t = quill.getContents();
    e.selectedAnnotation.setText(t)
};
CanvasController.prototype.handleDrag = function () {
    if (this.isDraggingImage) {
        var e = $("#canvas").width();
        var t = $("#canvas").height();
        if (this.canvasView.imageWidth > e) {
            var n = this.mouseX - this.lastMouseX;
            this.scrollX += n;
            this.scrollX = Math.min(0, this.scrollX);
            this.scrollX = Math.max(-(this.canvasView.imageWidth - e), this.scrollX)
        }
        if (this.canvasView.imageHeight > t) {
            var i = this.mouseY - this.lastMouseY;
            this.scrollY += i;
            this.scrollY = Math.min(0, this.scrollY);
            this.scrollY = Math.max(-(this.canvasView.imageHeight - t), this.scrollY)
        }
    } else if (this.isDraggingDot) {
        var r = this.model.imageManager.getDots()[this.activeDotIndex];
        mousePointRelImage = this.pageToImageCoords(this.mouseX, this.mouseY);
        image_abs_x = Math.max(0, mousePointRelImage.x);
        image_abs_y = Math.max(0, mousePointRelImage.y);
        image_abs_x = Math.min(this.canvasView.imageWidth, mousePointRelImage.x);
        image_abs_y = Math.min(this.canvasView.imageHeight, mousePointRelImage.y);
        var o = mousePointRelImage.x + this.dragOffsetX;
        var a = mousePointRelImage.y + this.dragOffsetY;
        o = Math.max(0, o);
        a = Math.max(0, a);
        o = Math.min(this.canvasView.imageWidth / this.scale, o);
        a = Math.min(this.canvasView.imageHeight / this.scale, a);
        this.model.imageManager.updateDot(this.activeDotIndex, o, a)
    }
    this.render()
};
CanvasController.prototype.pageToImageCoords = function (e, t) {
    var n = e - $("#canvas").position().left - this.scrollX;
    var i = t - $("#canvas").position().top - this.scrollY;
    return {
        x: n / this.scale,
        y: i / this.scale
    }
};
CanvasController.prototype.imageToPageCoords = function (e, t) {
    var n = e + $("#canvas").position().left + this.scrollX;
    var i = t + $("#canvas").position().top + this.scrollY;
    return {
        x: n,
        y: i
    }
};

function pointsWithinDist(e, t, n) {
    var i = t.x - e.x;
    var r = t.y - e.y;
    return i * i + r * r <= n * n
}
var InstructionsPopupView = function () {
    this.__init()
};
InstructionsPopupView.prototype.__init = function () {
    $("#instructions_popup").popup()
};
InstructionsPopupView.prototype.show = function () {
    $("#instructions_popup").popup({
        autoopen: true
    })
};
InstructionsPopupView.prototype.hide = function () {
    $("#instructions_popup").popup("hide")
};
var InstructionsPopupController = function (e, t) {
    this.model = e;
    this.instructionsPopupView = t;
    this.__init()
};
InstructionsPopupController.prototype.__init = function () {
    if (!$.cookie("has_seen_instructions")) {
        $.cookie("has_seen_instructions", true, {
            expires: 999
        });
        this.instructionsPopupView.show()
    }
};
var SaveAsPopupView = function () {
    this.__init()
};
SaveAsPopupView.prototype.__init = function () {
    this.__selectrifyPlaylistsSelect();
    this.__createHandlers()
};
SaveAsPopupView.prototype.__createHandlers = function () {
    this.__toggleSaveButton(false);
    $("#save_as_popup").popup({
        onclose: function () {
                $(this).trigger("SAVE_AS_POPUP_CLOSE")
            }
            .bind(this),
        focuselement: "#save_as_popup input:first"
    });
    var e = function (e) {
            e.preventDefault();
            var t = $("#save_as_popup_save_as_button").hasClass("popup_button_disabled");
            if (t)
                return;
            $(this).trigger("SAVE_AS_POPUP_SAVE_AS_CLICK")
        }
        .bind(this);
    $("#save_as_popup_save_as_button").click(e);
    $("#save_as_popup_form").submit(e)
};
SaveAsPopupView.prototype.showFetchSuccessfulState = function (e) {
    this.__toggleSaveButton(true);
    $("#save_as_playlist").find("option").remove().end();
    $.each(e, function (e, t) {
            var n = t.playlists;
            $.each(n, function (e, t) {
                $("#save_as_playlist").find("option").end().append('<option value="' + t.playlist_id + '">' + t.name + "</option>")
            })
        }
        .bind(this));
    $("#save_as_playlist").css("width", $("input#save_as_popup_name").outerWidth() + 2 + "px");
    this.__selectrifyPlaylistsSelect()
};
SaveAsPopupView.prototype.showFetchingState = function () {
    console.log("fetching")
};
SaveAsPopupView.prototype.showFetchUnsuccessfulState = function () {
    console.log("fetchbad. bad fetch. why u no fetch?")
};
SaveAsPopupView.prototype.show = function () {
    $("#save_as_popup").popup("show")
};
SaveAsPopupView.prototype.hide = function () {
    $("#save_as_popup").popup("hide")
};
SaveAsPopupView.prototype.__toggleSaveButton = function (e) {
    if (e) {
        $("#save_as_popup_save_as_button").removeClass("popup_button_disabled")
    } else {
        $("#save_as_popup_save_as_button").addClass("popup_button_disabled")
    }
};
SaveAsPopupView.prototype.__selectrifyPlaylistsSelect = function () {
    $("#save_as_playlist").selectric({
        inheritOriginalWidth: true
    })
};
var SaveAsPopupController = function (e, t) {
    this.model = e;
    this.saveAsPopupView = t;
    this.__init()
};
SaveAsPopupController.prototype.__init = function () {
    this.__createModelHandlers();
    this.__createViewHandlers()
};
SaveAsPopupController.prototype.__createModelHandlers = function () {
    this.model.imageManager.on("transitioned", this.__onImageManagerTransitioned.bind(this));
    this.model.playlistManager.on("transitioned", this.__onPlaylistManagerTransitioned.bind(this))
};
SaveAsPopupController.prototype.__createViewHandlers = function () {
    $(this.saveAsPopupView).on("SAVE_AS_POPUP_SAVE_AS_CLICK", this.__onSaveAsPopupSaveAsClick.bind(this));
    $(this.saveAsPopupView).on("SAVE_AS_POPUP_CLOSE", this.__onSaveAsPopupCloseClick.bind(this))
};
SaveAsPopupController.prototype.__onImageManagerTransitioned = function (e) {
    var t = this.model.imageManager.compositeState();
    if (t == "awaiting_save_as_info") {
        this.saveAsPopupView.show()
    } else {
        this.saveAsPopupView.hide()
    }
};
SaveAsPopupController.prototype.__onPlaylistManagerTransitioned = function (e) {
    if (this.model.playlistManager.prompter != "SaveAs")
        return;
    console.log(e);
    if (e.action == "updating.UPDATE_SUCCESSFUL") {
        this.model.playlistManager.fetch()
    }
    if (e.toState == "fetching") {
        this.saveAsPopupView.showFetchingState()
    } else if (e.toState == "fetch_successful") {
        this.saveAsPopupView.showFetchSuccessfulState(this.model.playlistManager.playlists)
    } else if (e.toState == "fetch_unsuccessful") {
        this.saveAsPopupView.showFetchUnsuccessfulState()
    }
};
SaveAsPopupController.prototype.__onSaveAsPopupSaveAsClick = function () {
    console.log("HIIII");
    var e = $("#save_as_popup_name").val();
    var t = this.model.imageManager.getDots();
    var n = this.model.imageManager.imagePath;
    var i = $("#save_as_playlist").val();
    var r = canvasControllerGlobal.getScale();
    this.model.imageManager.saveAs({
        name: e,
        dots: t,
        image_path: n,
        playlist_id: i,
        scale: r
    })
};
SaveAsPopupController.prototype.__onSaveAsPopupCloseClick = function () {
    this.model.imageManager.cancel();
    this.model.playlistManager.inactivate()
};
var PlaylistTreeMgr = function () {
    this.treeElem = $("#playlist_tree");
    this.tree;
    this.tooltip = new Tooltip
};
PlaylistTreeMgr.prototype.getSelectedNode = function () {
    var e = this.tree.get_selected();
    if (!(e.length > 0))
        return;
    var t = e[0];
    var n = this.tree.get_node(t);
    return n
};
PlaylistTreeMgr.prototype.removeSelected = function () {
    var e = this.tree.get_selected();
    var t = e[0];
    var n = this.tree.get_node(t);
    this.tree.delete_node(n)
};
PlaylistTreeMgr.prototype.getNodeById = function (e) {
    return this.tree.get_node(e)
};
PlaylistTreeMgr.prototype.getTree = function () {
    var e = {
        flat: false
    };
    return this.tree.get_json("#", e)
};
PlaylistTreeMgr.prototype.addPlaylist = function (e, t) {
    var n = this.tree.create_node(t, {
        text: "New Playlist",
        type: "playlist",
        li_attr: {
            team_id: e
        }
    }, "last");
    this.tree.edit(n)
};
PlaylistTreeMgr.prototype.__checkCallback = function (e, t, n, i) {
    if (e == "delete_node") {
        if (t.li_attr.is_default) {
            $.confirm(["You can't delete a Team's Default playlist."]);
            return false
        }
        if (t.type == "team") {
            $.confirm(["Only administrator can delete Teams."]);
            return false
        }
        if (!this.canDeleteNode) {
            $.confirm(["Are you sure you want to delete?", "This action cannot be undone."], r.bind(this));

            function r() {
                this.canDeleteNode = true;
                var e = $("#playlist_tree").jstree(true);
                canDeleteNode = true;
                e.delete_node(t)
            }
            return false
        }
        this.canDeleteNode = false
    }
    if (e === "move_node") {
        if (n.id == "#" && i == 0)
            return false
    }
    if (t.id == "j1_1")
        return false;
    return true
};
PlaylistTreeMgr.prototype.__getTypes = function (e) {
    var t = {
        "#": {
            valid_children: ["team"],
            icon: "/img/icons/playlist.svg"
        },
        team: {
            valid_children: ["playlist"],
            icon: "/images/icons/team.svg"
        },
        playlist: {
            valid_children: ["locus"],
            icon: "/img/icons/playlist.svg"
        },
        locus: {
            max_children: 0,
            icon: "/img/icons/arrow.svg"
        }
    };
    return t
};
PlaylistTreeMgr.prototype.__getContextMenuItems = function (t) {
    var n = this.tree;
    var e = {};
    if (t.li_attr.is_default)
        return false;
    if (t.type == "playlist" || t.type == "locus") {
        e.renameItem = {
            label: "Rename",
            action: function (e) {
                n.edit(t)
            }
        };
        e.deleteItem = {
            label: "Delete",
            action: function (e) {
                n.delete_node(t)
            }
        }
    }
    return e
};
PlaylistTreeMgr.prototype.__createJstree = function (e) {
    var t = this.__checkCallback.bind(this);
    var n = this.__getTypes();
    var i = this.__getContextMenuItems.bind(this);
    var r = {
        check_while_dragging: true
    };
    var o = {
        three_state: false,
        whole_node: false,
        tie_selection: false
    };
    var a = ["types", "contextmenu", "dnd", "checkbox"];
    var s = {
        core: {
            data: e,
            check_callback: t
        },
        types: n,
        contextmenu: {
            items: i
        },
        dnd: r,
        checkbox: o,
        plugins: a
    };
    $("#playlist_tree").on("ready.jstree", function () {
        $("#playlist_tree").jstree("select_node", "ul > li:first");
        var e = $("#playlist_tree").jstree("get_selected");
        $("#playlist_tree").jstree("open_node", e, false, true)
    });
    $("#playlist_tree").jstree(s);
    this.tree = this.treeElem.jstree(true)
};
PlaylistTreeMgr.prototype.createTree = function (e) {
    var o = [];
    $.each(e, function (e, t) {
        var n = t["team_id"];
        var i = t["name"];
        var s = {
            text: i,
            type: "team",
            li_attr: {
                team_id: n
            },
            a_attr: {
                class: "no_checkbox"
            },
            children: []
        };
        var r = t["playlists"];
        $.each(r, function (e, t) {
            var n = t["playlist_id"];
            var i = t["name"];
            var r = t["is_default"];
            var o = !!t["is_public"];
            var a = {
                text: i,
                type: "playlist",
                li_attr: {
                    playlist_id: n,
                    is_default: r
                },
                state: {
                    checked: o
                },
                children: []
            };
            $.each(t["loci"], function (e, t) {
                var n = t["locus_id"];
                var i = t["name"];
                var r = t["owner_id"];
                var o = {
                    text: i,
                    type: "locus",
                    li_attr: {
                        locus_id: n,
                        owner_id: r
                    },
                    a_attr: {
                        class: "no_checkbox"
                    }
                };
                a.children.push(o)
            });
            s.children.push(a)
        });
        o.push(s)
    });
    $("#playlist_tree").jstree("destroy").empty();
    this.__addJstreeHandlers();
    this.__createJstree(o)
};
PlaylistTreeMgr.prototype.__addJstreeHandlers = function () {
    this.treeElem.on("loaded.jstree", this.__onJstreeLoaded.bind(this));
    this.treeElem.delegate("a", "dblclick", this.__onJstreeDblClick.bind(this))
};
PlaylistTreeMgr.prototype.__onJstreeLoaded = function (e) {
    var t = $(".jstree-checkbox");
    t.mouseover(this.__onCheckboxMouseOver.bind(this));
    t.mouseout(this.__onCheckboxMouseOut.bind(this))
};
PlaylistTreeMgr.prototype.__removeJstreeHandlers = function () {
    this.treeElem.off("loaded.jstree", this.__onJstreeLoaded.bind(this))
};
PlaylistTreeMgr.prototype.__onJstreeDblClick = function (e) {
    $(this).trigger("NODE_DBL_CLICK", e)
};
PlaylistTreeMgr.prototype.__onCheckboxMouseOver = function (e) {
    var t = $(e.target);
    var n = t.offset();
    var i = t.outerWidth();
    var r = t.outerHeight();
    var o = n.left - i / 2;
    var a = n.top + r / 2;
    this.tooltip.show(o, a, "Check to Make Playlist Public", "right")
};
PlaylistTreeMgr.prototype.__onCheckboxMouseOut = function (e) {
    this.tooltip.hide()
};
var PlaylistPopupView = function () {
    this.__init()
};
PlaylistPopupView.prototype.__init = function () {
    this.state = "closed";
    this.can_close = false;
    this.checkboxTooltip = new Tooltip;
    this.treeMgr = new PlaylistTreeMgr;
    this.__createHandlers()
};
PlaylistPopupView.prototype.__createHandlers = function () {
    $("#playlist_popup_new_button").click(function (e) {
            $(this).trigger("PLAYLIST_POPUP_NEW_CLICK", e)
        }
        .bind(this));
    $("#playlist_popup_open_button").click(function (e) {
            $(this).trigger("PLAYLIST_POPUP_OPEN_CLICK", e)
        }
        .bind(this));
    $("#playlist_popup_delete_button").click(function (e) {
            $(this).trigger("PLAYLIST_POPUP_DELETE_CLICK", e)
        }
        .bind(this));
    $("#playlist_popup_close_button").click(function (e) {
            this.__closePopup()
        }
        .bind(this));
    $("#playlist_popup").popup({
        opentransitionend: this.__onPopupOpened.bind(this),
        closetransitionend: this.__onPopupClosed.bind(this),
        blur: false,
        escape: false
    });
    $(this.treeMgr).on("NODE_DBL_CLICK", function (e) {
            $(this).trigger("PLAYLIST_POPUP_OPEN_CLICK", e)
        }
        .bind(this))
};
PlaylistPopupView.prototype.__onPopupOpened = function () {
    $(document).on("click", null, this.__onDocumentClickAttemptBlur.bind(this));
    $(document).on("keydown", null, this.__onDocumentKeyDownAttemptBlur.bind(this))
};
PlaylistPopupView.prototype.__onPopupClosed = function () {
    this.__closePopup()
};
PlaylistPopupView.prototype.__closePopup = function () {
    $(document).off("click", null, this.__onDocumentClickAttemptBlur.bind(this));
    $(document).off("keydown", null, this.__onDocumentKeyDownAttemptBlur.bind(this));
    $(this).trigger("PLAYLIST_POPUP_CLOSE")
};
PlaylistPopupView.prototype.__onDocumentKeyDownAttemptBlur = function (e) {
    if (e.keyCode == 27)
        this.__closePopup()
};
PlaylistPopupView.prototype.__onDocumentClickAttemptBlur = function (e) {
    var t = false;
    var n = $("#playlist_popup")[0].getBoundingClientRect();
    if (e.pageX >= n.left && e.pageX <= n.left + n.width) {
        if (e.pageY >= n.top && e.pageY <= n.top + n.height) {
            t = true
        }
    }
    if (!t)
        this.__closePopup()
};
PlaylistPopupView.prototype.showFetchingState = function () {
    $("#playlist_tree").html("Loading...")
};
PlaylistPopupView.prototype.showUpdatingState = function () {
    $("#playlist_tree").html("Saving changes...");
    this.show()
};
PlaylistPopupView.prototype.showFetchUnsuccessfulState = function () {
    $("#playlist_tree").html("Unable to load at this time.")
};
PlaylistPopupView.prototype.showFetchSuccessfulState = function (e) {
    this.treeMgr.createTree(e)
};
PlaylistPopupView.prototype.getTreeJson = function () {
    return this.treeMgr.getTree()
};
PlaylistPopupView.prototype.addPlaylist = function (e, t) {
    this.treeMgr.addPlaylist(e, t)
};
PlaylistPopupView.prototype.removeSelected = function () {
    this.treeMgr.removeSelected()
};
PlaylistPopupView.prototype.getSelectedNode = function () {
    return this.treeMgr.getSelectedNode()
};
PlaylistPopupView.prototype.showNoTeamSelectedPopup = function () {
    $.confirm(["You must select a Team first."])
};
PlaylistPopupView.prototype.show = function () {
    this.state = "open";
    $("#playlist_popup").popup("show")
};
PlaylistPopupView.prototype.hide = function () {
    this.state = "closed";
    $("#playlist_popup").popup("hide")
};
var PlaylistPopupController = function (e, t) {
    this.model = e;
    this.playlistPopupView = t;
    this.isOpening = false;
    this.__origData;
    this.__init()
};
PlaylistPopupController.prototype.__init = function () {
    this.__createModelHandlers();
    this.__createViewHandlers()
};
PlaylistPopupController.prototype.__createModelHandlers = function () {
    this.model.playlistManager.on("transitioned", this.__onPlaylistMgrTransitioned.bind(this))
};
PlaylistPopupController.prototype.__createViewHandlers = function () {
    $(this.playlistPopupView).on("PLAYLIST_POPUP_OPEN_CLICK", this.__onPlaylistPopupOpenClick.bind(this));
    $(this.playlistPopupView).on("PLAYLIST_POPUP_NEW_CLICK", this.__onPlaylistPopupNewClick.bind(this));
    $(this.playlistPopupView).on("PLAYLIST_POPUP_DELETE_CLICK", this.__onPlaylistPopupDeleteClick.bind(this));
    $(this.playlistPopupView).on("PLAYLIST_POPUP_CLOSE", this.__onPlaylistPopupClose.bind(this));
    $(this.playlistPopupView).on("PLAYLIST_POPUP_BLUR", this.__onPlaylistPopupBlur.bind(this))
};
PlaylistPopupController.prototype.__onPlaylistMgrTransitioned = function (e) {
    if (this.model.playlistManager.prompter != "Open")
        return;
    if (e.toState == "inactive") {
        this.playlistPopupView.hide()
    }
    if (e.toState == "updating") {
        this.playlistPopupView.showUpdatingState()
    }
    if (e.fromState == "inactive") {
        this.playlistPopupView.show()
    }
    if (e.toState == "fetching") {
        this.playlistPopupView.showFetchingState()
    }
    if (e.toState == "fetch_successful") {
        this.isOpening = false;
        this.playlistPopupView.showFetchSuccessfulState(this.model.playlistManager.playlists);
        this.__setOrigData(this.model.playlistManager.playlists)
    }
    if (e.toState == "fetch_unsuccessful") {
        this.playlistPopupView.showFetchUnsuccessfulState()
    }
};
PlaylistPopupController.prototype.__setOrigData = function (e) {
    var i = [];
    var r = [];
    $.each(e, function (e, t) {
        var n = t.playlists;
        $.each(n, function (e, n) {
            i.push({
                playlist_id: n.playlist_id,
                team_id: t.team_id,
                name: n.name,
                is_public: n.is_public,
                is_default: n.is_default,
                index: n.index
            });
            $.each(n.loci, function (e, t) {
                r.push({
                    locus_id: t.locus_id,
                    owner_id: t.owner_id,
                    playlist_id: n.playlist_id,
                    playlist_index: t.playlist_index,
                    name: t.name
                })
            })
        })
    });
    this.__origData = {
        Playlist: i,
        Locus: r
    }
};
PlaylistPopupController.prototype.__convertTreeJson = function (e) {
    var c = [];
    var f = [];
    var h = this.model.session.user_id;
    var d = 0;
    $.each(e, function (e, t) {
        var u = t.li_attr.team_id;
        var n = t.children;
        $.each(n, function (e, t) {
            var s = t.li_attr.playlist_id ? t.li_attr.playlist_id : false;
            var n = t.text;
            var i = t.state.checked ? 1 : 0;
            var r = t.li_attr.is_default ? t.li_attr.is_default : false;
            var o = e;
            var a = {};
            if (s)
                a["playlist_id"] = s;
            a["team_id"] = u;
            a["name"] = n;
            a["is_public"] = i;
            a["is_default"] = r;
            a["index"] = o;
            c.push(a);
            var l = t.children;
            $.each(l, function (e, t) {
                var n = t.li_attr.locus_id ? t.li_attr.locus_id : false;
                var i = t.owner_id ? t.owner_id : h;
                var r = e;
                if (!s)
                    s = "new_" + playlistNum;
                var o = t.text;
                var a = {};
                if (n)
                    a["locus_id"] = n;
                a["owner_id"] = i;
                a["playlist_id"] = s;
                a["playlist_index"] = r;
                a["name"] = o;
                f.push(a)
            });
            if (!s)
                d++
        })
    });
    var t = {
        Playlist: c,
        Locus: f
    };
    return t
};
PlaylistPopupController.prototype.__onPlaylistPopupBlur = function () {
    if (this.model.playlistManager.state == "fetching" || this.model.playlistManager.state == "updating") {
        return
    }
    this.playlistPopupView.hide()
};
PlaylistPopupController.prototype.__computeCrudDelta = function (e) {
    var t = this.playlistPopupView.getTreeJson();
    var n = this.__convertTreeJson(t);
    var i = this.__origData;
    var r = crud(i, n, ["playlist_id", "locus_id"]);
    console.log(r);
    return r
};
PlaylistPopupController.prototype.__openLocus = function (e) {
    this.isOpening = true;
    var t = this.__computeCrudDelta();
    var n = !isCrudEmpty(t);
    console.log(t);
    if (n) {
        this.model.playlistManager.transition("FETCH_SUCCESSFUL");
        this.model.playlistManager.update(t)
    }
    this.playlistPopupView.hide();
    this.model.imageManager.open(e)
};
PlaylistPopupController.prototype.__attemptOpenLocus = function (e) {
    var t = this.model.imageManager.compositeState();
    if (t == "editing_old_locus" || t == "editing_new_locus") {
        this.playlistPopupView.hide();
        $.confirm(["Are you sure you want to navigate away from this page?", "You will lose any unsaved changes."], n.bind(this))
    } else {
        this.__openLocus(e)
    }

    function n() {
        this.__openLocus(e)
    }
};
PlaylistPopupController.prototype.__onPlaylistPopupOpenClick = function () {
    var e = this.playlistPopupView.getSelectedNode();
    if (!e)
        return;
    if (e.type != "locus")
        return;
    var t = e.li_attr.locus_id;
    this.__attemptOpenLocus(t)
};
PlaylistPopupController.prototype.__onPlaylistPopupNewClick = function () {
    var e = this.playlistPopupView.getSelectedNode();
    if (!e) {
        this.playlistPopupView.showNoTeamSelectedPopup()
    } else {
        var t = e;
        while (t.type != "team") {
            var n = t.parent;
            var i = this.playlistPopupView.treeMgr.getNodeById(n);
            t = i
        }
        var r = t.id;
        var o = t.li_attr.team_id;
        this.playlistPopupView.addPlaylist(o, r)
    }
};
PlaylistPopupController.prototype.__onPlaylistPopupDeleteClick = function () {
    this.playlistPopupView.removeSelected()
};
PlaylistPopupController.prototype.__onPlaylistPopupClose = function () {
    if (this.isOpening)
        return;
    if (this.model.playlistManager.state == "fetching" || this.model.playlistManager.state == "updating" || this.model.playlistManager.state == "inactive") {
        return
    }
    var e = this.__computeCrudDelta();
    var t = !isCrudEmpty(e);
    if (t) {
        this.model.playlistManager.update(e)
    } else {
        this.model.playlistManager.inactivate()
    }
};
var MenuBarView = function () {
    this.__init()
};
MenuBarView.prototype.__init = function () {
    this.__setupFileMenu();
    this.__createHandlers()
};
MenuBarView.prototype.__setupFileMenu = function () {
    $("#file_menu").niceSelect()
};
MenuBarView.prototype.__createHandlers = function () {
    $("#file_menu").change(function () {
            var e = $("#file_menu")[0].value + "_CLICK";
            $(this).trigger(e)
        }
        .bind(this));
    $("#view_button").click(function () {
            $(this).trigger("VIEW_CLICK")
        }
        .bind(this));
    $("#login_button").click(function () {
            $(this).trigger("LOGIN_CLICK")
        }
        .bind(this));
    $("#logout_button").click(function () {
            $(this).trigger("LOGOUT_CLICK")
        }
        .bind(this));
    $("#register_button").click(function () {
            $(this).trigger("REGISTER_CLICK")
        }
        .bind(this));
    $("#help_button").click(function () {
            $(this).trigger("HELP_CLICK")
        }
        .bind(this))
};
MenuBarView.prototype.showLoginButton = function () {
    $("#login_button").show()
};
MenuBarView.prototype.hideLoginButton = function () {
    $("#login_button").hide()
};
MenuBarView.prototype.showLogoutButton = function () {
    $("#logout_button").show()
};
MenuBarView.prototype.hideLogoutButton = function () {
    $("#logout_button").hide()
};
MenuBarView.prototype.showRegisterButton = function () {
    $("#register_button").show()
};
MenuBarView.prototype.hideRegisterButton = function () {
    $("#register_button").hide()
};
MenuBarView.prototype.showViewButton = function () {
    $("#view_button").show()
};
MenuBarView.prototype.hideViewButton = function () {
    $("#view_button").hide()
};
MenuBarView.prototype.setStatusText = function (e) {
    $("#status_text").html(e)
};
MenuBarView.prototype.fileOptionIsEnabled = function (e) {
    return !$("#file_menu option[value=" + e + "]").prop("disabled")
};
MenuBarView.prototype.enableFileOption = function (e) {
    $("#file_menu option[value=" + e + "]").prop("disabled", false);
    $("#file_menu").niceSelect("update")
};
MenuBarView.prototype.disableFileOption = function (e) {
    $("#file_menu option[value=" + e + "]").prop("disabled", true);
    $("#file_menu").niceSelect("update")
};
var MenuBarController = function (e, t) {
    this.model = e;
    this.menuBarView = t;
    this.__init()
};
MenuBarController.prototype.__init = function () {
    this.__createModelHandlers();
    this.__createViewHandlers()
};
MenuBarController.prototype.__createModelHandlers = function () {
    this.model.session.on("transitioned", function (e) {
            this.__modelStateChanged()
        }
        .bind(this));
    this.model.imageManager.on("transitioned", function (e) {
            this.__modelStateChanged()
        }
        .bind(this))
};
MenuBarController.prototype.__createViewHandlers = function () {
    $(this.menuBarView).on("NEW_CLICK", this.__newClick.bind(this));
    $(this.menuBarView).on("OPEN_CLICK", this.__openClick.bind(this));
    $(this.menuBarView).on("SAVE_CLICK", this.__saveClick.bind(this));
    $(this.menuBarView).on("SAVE_AS_CLICK", this.__saveAsClick.bind(this));
    $(this.menuBarView).on("DELETE_CLICK", this.__deleteClick.bind(this));
    $(this.menuBarView).on("VIEW_CLICK", this.__viewClick.bind(this));
    $(this.menuBarView).on("LOGIN_CLICK", this.__loginClick.bind(this));
    $(this.menuBarView).on("LOGOUT_CLICK", this.__logoutClick.bind(this));
    $(this.menuBarView).on("REGISTER_CLICK", this.__registerClick.bind(this));
    $(this.menuBarView).on("HELP_CLICK", this.__helpClick.bind(this));
    shortcut.add("Ctrl+S", function () {
            if (this.menuBarView.fileOptionIsEnabled("SAVE"))
                this.__saveClick()
        }
        .bind(this));
    shortcut.add("Ctrl+Shift+S", function () {
            if (this.menuBarView.fileOptionIsEnabled("SAVE_AS"))
                this.__saveAsClick()
        }
        .bind(this));
    shortcut.add("Ctrl+O", function () {
            if (this.menuBarView.fileOptionIsEnabled("OPEN"))
                this.__openClick()
        }
        .bind(this));
    shortcut.add("Ctrl+Shift+V", function () {
            if (this.menuBarView.fileOptionIsEnabled("VIEW"))
                this.__viewClick()
        }
        .bind(this))
};
MenuBarController.prototype.__modelStateChanged = function () {
    var e = this.model.session.compositeState();
    var t = this.model.imageManager.compositeState();
    this.menuBarView.disableFileOption("SAVE");
    this.menuBarView.disableFileOption("SAVE_AS");
    this.menuBarView.disableFileOption("DELETE");
    this.menuBarView.disableFileOption("NEW");
    if (t == "editing_old_locus" || t == "editing_new_locus") {
        this.menuBarView.enableFileOption("NEW")
    }
    this.menuBarView.hideViewButton();
    if (e == "logged_out") {
        this.menuBarView.setStatusText("");
        this.menuBarView.showLoginButton();
        this.menuBarView.showRegisterButton();
        this.menuBarView.hideLogoutButton();
        this.menuBarView.disableFileOption("OPEN");
        this.menuBarView.disableFileOption("SAVE");
        this.menuBarView.disableFileOption("SAVE_AS");
        this.menuBarView.disableFileOption("DELETE")
    } else if (e == "awaiting_login_info") {
        this.menuBarView.setStatusText("");
        this.menuBarView.hideLogoutButton();
        this.menuBarView.hideLoginButton();
        this.menuBarView.hideRegisterButton();
        this.menuBarView.disableFileOption("OPEN");
        this.menuBarView.disableFileOption("SAVE");
        this.menuBarView.disableFileOption("SAVE_AS");
        this.menuBarView.disableFileOption("DELETE")
    } else if (e == "awaiting_registration_info") {
        this.menuBarView.setStatusText("");
        this.menuBarView.hideLogoutButton();
        this.menuBarView.hideLoginButton();
        this.menuBarView.hideRegisterButton();
        this.menuBarView.disableFileOption("OPEN");
        this.menuBarView.disableFileOption("SAVE");
        this.menuBarView.disableFileOption("SAVE_AS");
        this.menuBarView.disableFileOption("DELETE")
    } else if (e == "authenticating") {
        this.menuBarView.setStatusText("Authenticating");
        this.menuBarView.hideLogoutButton();
        this.menuBarView.hideLoginButton();
        this.menuBarView.hideRegisterButton();
        this.menuBarView.disableFileOption("OPEN");
        this.menuBarView.disableFileOption("SAVE");
        this.menuBarView.disableFileOption("SAVE_AS");
        this.menuBarView.disableFileOption("DELETE")
    } else if (e == "registering") {
        this.menuBarView.setStatusText("Registering");
        this.menuBarView.hideLogoutButton();
        this.menuBarView.hideLoginButton();
        this.menuBarView.hideRegisterButton();
        this.menuBarView.disableFileOption("OPEN");
        this.menuBarView.disableFileOption("SAVE");
        this.menuBarView.disableFileOption("SAVE_AS");
        this.menuBarView.disableFileOption("DELETE")
    } else if (e == "logged_in") {
        this.menuBarView.setStatusText(this.model.session.username);
        this.menuBarView.showLogoutButton();
        this.menuBarView.hideLoginButton();
        this.menuBarView.hideRegisterButton();
        this.menuBarView.enableFileOption("OPEN");
        if (t == "editing_old_locus" || t == "editing_new_locus") {
            this.menuBarView.enableFileOption("SAVE_AS")
        }
        if (t == "editing_old_locus") {
            this.menuBarView.enableFileOption("SAVE");
            this.menuBarView.enableFileOption("DELETE");
            this.menuBarView.showViewButton()
        } else {
            this.menuBarView.disableFileOption("SAVE");
            this.menuBarView.disableFileOption("DELETE")
        }
    }
};
MenuBarController.prototype.__newClick = function () {
    $.confirm(["Are you sure you want to navigate away from this page?", "You will lose any unsaved changes."], function () {
            this.model.imageManager.new()
        }
        .bind(this))
};
MenuBarController.prototype.__openClick = function () {
    this.model.playlistManager.prompter = "Open";
    this.model.playlistManager.fetch()
};
MenuBarController.prototype.__saveClick = function () {
    var e = canvasControllerGlobal.getScale();
    this.model.imageManager.save(e)
};
MenuBarController.prototype.__saveAsClick = function () {
    this.model.playlistManager.prompter = "SaveAs";
    this.model.playlistManager.fetch();
    this.model.imageManager.promptSaveAs()
};
MenuBarController.prototype.__deleteClick = function () {
    $.confirm(["Are you sure?", "This action cannot be undone."], function () {
            this.model.imageManager.delete()
        }
        .bind(this))
};
MenuBarController.prototype.__viewClick = function () {
    this.model.imageManager.view()
};
MenuBarController.prototype.__loginClick = function () {
    this.model.session.promptLogin()
};
MenuBarController.prototype.__logoutClick = function () {
    this.model.session.logout()
};
MenuBarController.prototype.__registerClick = function () {
    this.model.session.promptRegistration()
};
MenuBarController.prototype.__helpClick = function () {
    $("#instructions_popup").popup({
        autoopen: true
    })
};
var DEBUG = false;
var canvasControllerGlobal;
var quill;
$(document).ready(function () {
    function e() {
        window.onbeforeunload = function (e) {
            return false;
            var t = "Please make sure you have saved all your content.";
            e = e || window.event;
            if (e) {
                e.returnValue = t
            }
            return t
        }
    }
    e();
    var t = /Mobi|Tablet|iPad|iPhone/.test(navigator.userAgent);
    if (t) {
        var n = "";
        n += '<img id="pixorize_logo" src="/images/logo_with_text.svg">';
        n += "<h1>We're sorry, but the Pixorize Editor does not currently support mobile devices.</h1>";
        n += '<a href="/">Back to Home</a>';
        document.write(n);
        $("body").css("display", "flex");
        $("body").css("flex-flow", "row wrap");
        $("body").css("justify-content", "center");
        $("body").css("align-content", "center");
        $("body").css("font-family", "Arial");
        $("body").css("padding", "1rem");
        $("a").css("font-size", "2rem");
        $("a").css("color", "#7b369e");
        $("a").css("font-weight", "bold");
        document.close();
        throw new Error("Mobile Not Allowed");
        return
    }
    var i = new Model;
    model_global = i;
    var r = new MenuBarView;
    var o = new MenuBarController(i, r);
    var a = new InstructionsPopupView;
    var s = new InstructionsPopupController(i, a);
    var l = new SaveAsPopupView;
    var u = new SaveAsPopupController(i, l);
    var c = new CanvasView;
    var f = new CanvasController(i, c);
    canvasControllerGlobal = f;
    var h = new PlaylistPopupView;
    var d = new PlaylistPopupController(i, h);
    // quill = new Quill("#editor-container", {
    //     modules: {
    //         toolbar: [
    //             ["bold", "italic", "underline"]
    //         ]
    //     },
    //     placeholder: "Enter text for the selected annotation here",
    //     theme: "snow",
    //     formats: ["bold", "underline", "italic"]
    // });
    // disableQuill();
    i.init();
    $(document).bind("touchmove", function (e) {
        e.preventDefault()
    })
});
//# sourceMappingURL=editor.js.map